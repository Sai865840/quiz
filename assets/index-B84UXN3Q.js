(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))i(a);new MutationObserver(a=>{for(const l of a)if(l.type==="childList")for(const u of l.addedNodes)u.tagName==="LINK"&&u.rel==="modulepreload"&&i(u)}).observe(document,{childList:!0,subtree:!0});function t(a){const l={};return a.integrity&&(l.integrity=a.integrity),a.referrerPolicy&&(l.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?l.credentials="include":a.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function i(a){if(a.ep)return;a.ep=!0;const l=t(a);fetch(a.href,l)}})();function C2(s){return s&&s.__esModule&&Object.prototype.hasOwnProperty.call(s,"default")?s.default:s}var Tg={exports:{}},Jc={};var bE;function R2(){if(bE)return Jc;bE=1;var s=Symbol.for("react.transitional.element"),e=Symbol.for("react.fragment");function t(i,a,l){var u=null;if(l!==void 0&&(u=""+l),a.key!==void 0&&(u=""+a.key),"key"in a){l={};for(var f in a)f!=="key"&&(l[f]=a[f])}else l=a;return a=l.ref,{$$typeof:s,type:i,key:u,ref:a!==void 0?a:null,props:l}}return Jc.Fragment=e,Jc.jsx=t,Jc.jsxs=t,Jc}var EE;function D2(){return EE||(EE=1,Tg.exports=R2()),Tg.exports}var d=D2(),xg={exports:{}},je={};var TE;function N2(){if(TE)return je;TE=1;var s=Symbol.for("react.transitional.element"),e=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),i=Symbol.for("react.strict_mode"),a=Symbol.for("react.profiler"),l=Symbol.for("react.consumer"),u=Symbol.for("react.context"),f=Symbol.for("react.forward_ref"),p=Symbol.for("react.suspense"),y=Symbol.for("react.memo"),_=Symbol.for("react.lazy"),b=Symbol.for("react.activity"),x=Symbol.iterator;function k(U){return U===null||typeof U!="object"?null:(U=x&&U[x]||U["@@iterator"],typeof U=="function"?U:null)}var M={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},j=Object.assign,V={};function ee(U,z,ue){this.props=U,this.context=z,this.refs=V,this.updater=ue||M}ee.prototype.isReactComponent={},ee.prototype.setState=function(U,z){if(typeof U!="object"&&typeof U!="function"&&U!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,U,z,"setState")},ee.prototype.forceUpdate=function(U){this.updater.enqueueForceUpdate(this,U,"forceUpdate")};function ne(){}ne.prototype=ee.prototype;function Y(U,z,ue){this.props=U,this.context=z,this.refs=V,this.updater=ue||M}var ie=Y.prototype=new ne;ie.constructor=Y,j(ie,ee.prototype),ie.isPureReactComponent=!0;var F=Array.isArray;function J(){}var C={H:null,A:null,T:null,S:null},R=Object.prototype.hasOwnProperty;function w(U,z,ue){var re=ue.ref;return{$$typeof:s,type:U,key:z,ref:re!==void 0?re:null,props:ue}}function I(U,z){return w(U.type,z,U.props)}function D(U){return typeof U=="object"&&U!==null&&U.$$typeof===s}function L(U){var z={"=":"=0",":":"=2"};return"$"+U.replace(/[=:]/g,function(ue){return z[ue]})}var O=/\/+/g;function Se(U,z){return typeof U=="object"&&U!==null&&U.key!=null?L(""+U.key):z.toString(36)}function pe(U){switch(U.status){case"fulfilled":return U.value;case"rejected":throw U.reason;default:switch(typeof U.status=="string"?U.then(J,J):(U.status="pending",U.then(function(z){U.status==="pending"&&(U.status="fulfilled",U.value=z)},function(z){U.status==="pending"&&(U.status="rejected",U.reason=z)})),U.status){case"fulfilled":return U.value;case"rejected":throw U.reason}}throw U}function G(U,z,ue,re,ge){var Ie=typeof U;(Ie==="undefined"||Ie==="boolean")&&(U=null);var Ne=!1;if(U===null)Ne=!0;else switch(Ie){case"bigint":case"string":case"number":Ne=!0;break;case"object":switch(U.$$typeof){case s:case e:Ne=!0;break;case _:return Ne=U._init,G(Ne(U._payload),z,ue,re,ge)}}if(Ne)return ge=ge(U),Ne=re===""?"."+Se(U,0):re,F(ge)?(ue="",Ne!=null&&(ue=Ne.replace(O,"$&/")+"/"),G(ge,z,ue,"",function(Di){return Di})):ge!=null&&(D(ge)&&(ge=I(ge,ue+(ge.key==null||U&&U.key===ge.key?"":(""+ge.key).replace(O,"$&/")+"/")+Ne)),z.push(ge)),1;Ne=0;var Qe=re===""?".":re+":";if(F(U))for(var $e=0;$e<U.length;$e++)re=U[$e],Ie=Qe+Se(re,$e),Ne+=G(re,z,ue,Ie,ge);else if($e=k(U),typeof $e=="function")for(U=$e.call(U),$e=0;!(re=U.next()).done;)re=re.value,Ie=Qe+Se(re,$e++),Ne+=G(re,z,ue,Ie,ge);else if(Ie==="object"){if(typeof U.then=="function")return G(pe(U),z,ue,re,ge);throw z=String(U),Error("Objects are not valid as a React child (found: "+(z==="[object Object]"?"object with keys {"+Object.keys(U).join(", ")+"}":z)+"). If you meant to render a collection of children, use an array instead.")}return Ne}function le(U,z,ue){if(U==null)return U;var re=[],ge=0;return G(U,re,"","",function(Ie){return z.call(ue,Ie,ge++)}),re}function ye(U){if(U._status===-1){var z=U._result;z=z(),z.then(function(ue){(U._status===0||U._status===-1)&&(U._status=1,U._result=ue)},function(ue){(U._status===0||U._status===-1)&&(U._status=2,U._result=ue)}),U._status===-1&&(U._status=0,U._result=z)}if(U._status===1)return U._result.default;throw U._result}var Te=typeof reportError=="function"?reportError:function(U){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var z=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof U=="object"&&U!==null&&typeof U.message=="string"?String(U.message):String(U),error:U});if(!window.dispatchEvent(z))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",U);return}console.error(U)},Ve={map:le,forEach:function(U,z,ue){le(U,function(){z.apply(this,arguments)},ue)},count:function(U){var z=0;return le(U,function(){z++}),z},toArray:function(U){return le(U,function(z){return z})||[]},only:function(U){if(!D(U))throw Error("React.Children.only expected to receive a single React element child.");return U}};return je.Activity=b,je.Children=Ve,je.Component=ee,je.Fragment=t,je.Profiler=a,je.PureComponent=Y,je.StrictMode=i,je.Suspense=p,je.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=C,je.__COMPILER_RUNTIME={__proto__:null,c:function(U){return C.H.useMemoCache(U)}},je.cache=function(U){return function(){return U.apply(null,arguments)}},je.cacheSignal=function(){return null},je.cloneElement=function(U,z,ue){if(U==null)throw Error("The argument must be a React element, but you passed "+U+".");var re=j({},U.props),ge=U.key;if(z!=null)for(Ie in z.key!==void 0&&(ge=""+z.key),z)!R.call(z,Ie)||Ie==="key"||Ie==="__self"||Ie==="__source"||Ie==="ref"&&z.ref===void 0||(re[Ie]=z[Ie]);var Ie=arguments.length-2;if(Ie===1)re.children=ue;else if(1<Ie){for(var Ne=Array(Ie),Qe=0;Qe<Ie;Qe++)Ne[Qe]=arguments[Qe+2];re.children=Ne}return w(U.type,ge,re)},je.createContext=function(U){return U={$$typeof:u,_currentValue:U,_currentValue2:U,_threadCount:0,Provider:null,Consumer:null},U.Provider=U,U.Consumer={$$typeof:l,_context:U},U},je.createElement=function(U,z,ue){var re,ge={},Ie=null;if(z!=null)for(re in z.key!==void 0&&(Ie=""+z.key),z)R.call(z,re)&&re!=="key"&&re!=="__self"&&re!=="__source"&&(ge[re]=z[re]);var Ne=arguments.length-2;if(Ne===1)ge.children=ue;else if(1<Ne){for(var Qe=Array(Ne),$e=0;$e<Ne;$e++)Qe[$e]=arguments[$e+2];ge.children=Qe}if(U&&U.defaultProps)for(re in Ne=U.defaultProps,Ne)ge[re]===void 0&&(ge[re]=Ne[re]);return w(U,Ie,ge)},je.createRef=function(){return{current:null}},je.forwardRef=function(U){return{$$typeof:f,render:U}},je.isValidElement=D,je.lazy=function(U){return{$$typeof:_,_payload:{_status:-1,_result:U},_init:ye}},je.memo=function(U,z){return{$$typeof:y,type:U,compare:z===void 0?null:z}},je.startTransition=function(U){var z=C.T,ue={};C.T=ue;try{var re=U(),ge=C.S;ge!==null&&ge(ue,re),typeof re=="object"&&re!==null&&typeof re.then=="function"&&re.then(J,Te)}catch(Ie){Te(Ie)}finally{z!==null&&ue.types!==null&&(z.types=ue.types),C.T=z}},je.unstable_useCacheRefresh=function(){return C.H.useCacheRefresh()},je.use=function(U){return C.H.use(U)},je.useActionState=function(U,z,ue){return C.H.useActionState(U,z,ue)},je.useCallback=function(U,z){return C.H.useCallback(U,z)},je.useContext=function(U){return C.H.useContext(U)},je.useDebugValue=function(){},je.useDeferredValue=function(U,z){return C.H.useDeferredValue(U,z)},je.useEffect=function(U,z){return C.H.useEffect(U,z)},je.useEffectEvent=function(U){return C.H.useEffectEvent(U)},je.useId=function(){return C.H.useId()},je.useImperativeHandle=function(U,z,ue){return C.H.useImperativeHandle(U,z,ue)},je.useInsertionEffect=function(U,z){return C.H.useInsertionEffect(U,z)},je.useLayoutEffect=function(U,z){return C.H.useLayoutEffect(U,z)},je.useMemo=function(U,z){return C.H.useMemo(U,z)},je.useOptimistic=function(U,z){return C.H.useOptimistic(U,z)},je.useReducer=function(U,z,ue){return C.H.useReducer(U,z,ue)},je.useRef=function(U){return C.H.useRef(U)},je.useState=function(U){return C.H.useState(U)},je.useSyncExternalStore=function(U,z,ue){return C.H.useSyncExternalStore(U,z,ue)},je.useTransition=function(){return C.H.useTransition()},je.version="19.2.4",je}var xE;function Oy(){return xE||(xE=1,xg.exports=N2()),xg.exports}var N=Oy();const Od=C2(N);var Sg={exports:{}},Zc={},wg={exports:{}},Ag={};var SE;function j2(){return SE||(SE=1,(function(s){function e(G,le){var ye=G.length;G.push(le);e:for(;0<ye;){var Te=ye-1>>>1,Ve=G[Te];if(0<a(Ve,le))G[Te]=le,G[ye]=Ve,ye=Te;else break e}}function t(G){return G.length===0?null:G[0]}function i(G){if(G.length===0)return null;var le=G[0],ye=G.pop();if(ye!==le){G[0]=ye;e:for(var Te=0,Ve=G.length,U=Ve>>>1;Te<U;){var z=2*(Te+1)-1,ue=G[z],re=z+1,ge=G[re];if(0>a(ue,ye))re<Ve&&0>a(ge,ue)?(G[Te]=ge,G[re]=ye,Te=re):(G[Te]=ue,G[z]=ye,Te=z);else if(re<Ve&&0>a(ge,ye))G[Te]=ge,G[re]=ye,Te=re;else break e}}return le}function a(G,le){var ye=G.sortIndex-le.sortIndex;return ye!==0?ye:G.id-le.id}if(s.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var l=performance;s.unstable_now=function(){return l.now()}}else{var u=Date,f=u.now();s.unstable_now=function(){return u.now()-f}}var p=[],y=[],_=1,b=null,x=3,k=!1,M=!1,j=!1,V=!1,ee=typeof setTimeout=="function"?setTimeout:null,ne=typeof clearTimeout=="function"?clearTimeout:null,Y=typeof setImmediate<"u"?setImmediate:null;function ie(G){for(var le=t(y);le!==null;){if(le.callback===null)i(y);else if(le.startTime<=G)i(y),le.sortIndex=le.expirationTime,e(p,le);else break;le=t(y)}}function F(G){if(j=!1,ie(G),!M)if(t(p)!==null)M=!0,J||(J=!0,L());else{var le=t(y);le!==null&&pe(F,le.startTime-G)}}var J=!1,C=-1,R=5,w=-1;function I(){return V?!0:!(s.unstable_now()-w<R)}function D(){if(V=!1,J){var G=s.unstable_now();w=G;var le=!0;try{e:{M=!1,j&&(j=!1,ne(C),C=-1),k=!0;var ye=x;try{t:{for(ie(G),b=t(p);b!==null&&!(b.expirationTime>G&&I());){var Te=b.callback;if(typeof Te=="function"){b.callback=null,x=b.priorityLevel;var Ve=Te(b.expirationTime<=G);if(G=s.unstable_now(),typeof Ve=="function"){b.callback=Ve,ie(G),le=!0;break t}b===t(p)&&i(p),ie(G)}else i(p);b=t(p)}if(b!==null)le=!0;else{var U=t(y);U!==null&&pe(F,U.startTime-G),le=!1}}break e}finally{b=null,x=ye,k=!1}le=void 0}}finally{le?L():J=!1}}}var L;if(typeof Y=="function")L=function(){Y(D)};else if(typeof MessageChannel<"u"){var O=new MessageChannel,Se=O.port2;O.port1.onmessage=D,L=function(){Se.postMessage(null)}}else L=function(){ee(D,0)};function pe(G,le){C=ee(function(){G(s.unstable_now())},le)}s.unstable_IdlePriority=5,s.unstable_ImmediatePriority=1,s.unstable_LowPriority=4,s.unstable_NormalPriority=3,s.unstable_Profiling=null,s.unstable_UserBlockingPriority=2,s.unstable_cancelCallback=function(G){G.callback=null},s.unstable_forceFrameRate=function(G){0>G||125<G?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):R=0<G?Math.floor(1e3/G):5},s.unstable_getCurrentPriorityLevel=function(){return x},s.unstable_next=function(G){switch(x){case 1:case 2:case 3:var le=3;break;default:le=x}var ye=x;x=le;try{return G()}finally{x=ye}},s.unstable_requestPaint=function(){V=!0},s.unstable_runWithPriority=function(G,le){switch(G){case 1:case 2:case 3:case 4:case 5:break;default:G=3}var ye=x;x=G;try{return le()}finally{x=ye}},s.unstable_scheduleCallback=function(G,le,ye){var Te=s.unstable_now();switch(typeof ye=="object"&&ye!==null?(ye=ye.delay,ye=typeof ye=="number"&&0<ye?Te+ye:Te):ye=Te,G){case 1:var Ve=-1;break;case 2:Ve=250;break;case 5:Ve=1073741823;break;case 4:Ve=1e4;break;default:Ve=5e3}return Ve=ye+Ve,G={id:_++,callback:le,priorityLevel:G,startTime:ye,expirationTime:Ve,sortIndex:-1},ye>Te?(G.sortIndex=ye,e(y,G),t(p)===null&&G===t(y)&&(j?(ne(C),C=-1):j=!0,pe(F,ye-Te))):(G.sortIndex=Ve,e(p,G),M||k||(M=!0,J||(J=!0,L()))),G},s.unstable_shouldYield=I,s.unstable_wrapCallback=function(G){var le=x;return function(){var ye=x;x=le;try{return G.apply(this,arguments)}finally{x=ye}}}})(Ag)),Ag}var wE;function k2(){return wE||(wE=1,wg.exports=j2()),wg.exports}var Ig={exports:{}},on={};var AE;function O2(){if(AE)return on;AE=1;var s=Oy();function e(p){var y="https://react.dev/errors/"+p;if(1<arguments.length){y+="?args[]="+encodeURIComponent(arguments[1]);for(var _=2;_<arguments.length;_++)y+="&args[]="+encodeURIComponent(arguments[_])}return"Minified React error #"+p+"; visit "+y+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function t(){}var i={d:{f:t,r:function(){throw Error(e(522))},D:t,C:t,L:t,m:t,X:t,S:t,M:t},p:0,findDOMNode:null},a=Symbol.for("react.portal");function l(p,y,_){var b=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:a,key:b==null?null:""+b,children:p,containerInfo:y,implementation:_}}var u=s.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function f(p,y){if(p==="font")return"";if(typeof y=="string")return y==="use-credentials"?y:""}return on.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=i,on.createPortal=function(p,y){var _=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!y||y.nodeType!==1&&y.nodeType!==9&&y.nodeType!==11)throw Error(e(299));return l(p,y,null,_)},on.flushSync=function(p){var y=u.T,_=i.p;try{if(u.T=null,i.p=2,p)return p()}finally{u.T=y,i.p=_,i.d.f()}},on.preconnect=function(p,y){typeof p=="string"&&(y?(y=y.crossOrigin,y=typeof y=="string"?y==="use-credentials"?y:"":void 0):y=null,i.d.C(p,y))},on.prefetchDNS=function(p){typeof p=="string"&&i.d.D(p)},on.preinit=function(p,y){if(typeof p=="string"&&y&&typeof y.as=="string"){var _=y.as,b=f(_,y.crossOrigin),x=typeof y.integrity=="string"?y.integrity:void 0,k=typeof y.fetchPriority=="string"?y.fetchPriority:void 0;_==="style"?i.d.S(p,typeof y.precedence=="string"?y.precedence:void 0,{crossOrigin:b,integrity:x,fetchPriority:k}):_==="script"&&i.d.X(p,{crossOrigin:b,integrity:x,fetchPriority:k,nonce:typeof y.nonce=="string"?y.nonce:void 0})}},on.preinitModule=function(p,y){if(typeof p=="string")if(typeof y=="object"&&y!==null){if(y.as==null||y.as==="script"){var _=f(y.as,y.crossOrigin);i.d.M(p,{crossOrigin:_,integrity:typeof y.integrity=="string"?y.integrity:void 0,nonce:typeof y.nonce=="string"?y.nonce:void 0})}}else y==null&&i.d.M(p)},on.preload=function(p,y){if(typeof p=="string"&&typeof y=="object"&&y!==null&&typeof y.as=="string"){var _=y.as,b=f(_,y.crossOrigin);i.d.L(p,_,{crossOrigin:b,integrity:typeof y.integrity=="string"?y.integrity:void 0,nonce:typeof y.nonce=="string"?y.nonce:void 0,type:typeof y.type=="string"?y.type:void 0,fetchPriority:typeof y.fetchPriority=="string"?y.fetchPriority:void 0,referrerPolicy:typeof y.referrerPolicy=="string"?y.referrerPolicy:void 0,imageSrcSet:typeof y.imageSrcSet=="string"?y.imageSrcSet:void 0,imageSizes:typeof y.imageSizes=="string"?y.imageSizes:void 0,media:typeof y.media=="string"?y.media:void 0})}},on.preloadModule=function(p,y){if(typeof p=="string")if(y){var _=f(y.as,y.crossOrigin);i.d.m(p,{as:typeof y.as=="string"&&y.as!=="script"?y.as:void 0,crossOrigin:_,integrity:typeof y.integrity=="string"?y.integrity:void 0})}else i.d.m(p)},on.requestFormReset=function(p){i.d.r(p)},on.unstable_batchedUpdates=function(p,y){return p(y)},on.useFormState=function(p,y,_){return u.H.useFormState(p,y,_)},on.useFormStatus=function(){return u.H.useHostTransitionStatus()},on.version="19.2.4",on}var IE;function M2(){if(IE)return Ig.exports;IE=1;function s(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(s)}catch(e){console.error(e)}}return s(),Ig.exports=O2(),Ig.exports}var CE;function V2(){if(CE)return Zc;CE=1;var s=k2(),e=Oy(),t=M2();function i(n){var r="https://react.dev/errors/"+n;if(1<arguments.length){r+="?args[]="+encodeURIComponent(arguments[1]);for(var o=2;o<arguments.length;o++)r+="&args[]="+encodeURIComponent(arguments[o])}return"Minified React error #"+n+"; visit "+r+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function a(n){return!(!n||n.nodeType!==1&&n.nodeType!==9&&n.nodeType!==11)}function l(n){var r=n,o=n;if(n.alternate)for(;r.return;)r=r.return;else{n=r;do r=n,(r.flags&4098)!==0&&(o=r.return),n=r.return;while(n)}return r.tag===3?o:null}function u(n){if(n.tag===13){var r=n.memoizedState;if(r===null&&(n=n.alternate,n!==null&&(r=n.memoizedState)),r!==null)return r.dehydrated}return null}function f(n){if(n.tag===31){var r=n.memoizedState;if(r===null&&(n=n.alternate,n!==null&&(r=n.memoizedState)),r!==null)return r.dehydrated}return null}function p(n){if(l(n)!==n)throw Error(i(188))}function y(n){var r=n.alternate;if(!r){if(r=l(n),r===null)throw Error(i(188));return r!==n?null:n}for(var o=n,c=r;;){var m=o.return;if(m===null)break;var g=m.alternate;if(g===null){if(c=m.return,c!==null){o=c;continue}break}if(m.child===g.child){for(g=m.child;g;){if(g===o)return p(m),n;if(g===c)return p(m),r;g=g.sibling}throw Error(i(188))}if(o.return!==c.return)o=m,c=g;else{for(var E=!1,S=m.child;S;){if(S===o){E=!0,o=m,c=g;break}if(S===c){E=!0,c=m,o=g;break}S=S.sibling}if(!E){for(S=g.child;S;){if(S===o){E=!0,o=g,c=m;break}if(S===c){E=!0,c=g,o=m;break}S=S.sibling}if(!E)throw Error(i(189))}}if(o.alternate!==c)throw Error(i(190))}if(o.tag!==3)throw Error(i(188));return o.stateNode.current===o?n:r}function _(n){var r=n.tag;if(r===5||r===26||r===27||r===6)return n;for(n=n.child;n!==null;){if(r=_(n),r!==null)return r;n=n.sibling}return null}var b=Object.assign,x=Symbol.for("react.element"),k=Symbol.for("react.transitional.element"),M=Symbol.for("react.portal"),j=Symbol.for("react.fragment"),V=Symbol.for("react.strict_mode"),ee=Symbol.for("react.profiler"),ne=Symbol.for("react.consumer"),Y=Symbol.for("react.context"),ie=Symbol.for("react.forward_ref"),F=Symbol.for("react.suspense"),J=Symbol.for("react.suspense_list"),C=Symbol.for("react.memo"),R=Symbol.for("react.lazy"),w=Symbol.for("react.activity"),I=Symbol.for("react.memo_cache_sentinel"),D=Symbol.iterator;function L(n){return n===null||typeof n!="object"?null:(n=D&&n[D]||n["@@iterator"],typeof n=="function"?n:null)}var O=Symbol.for("react.client.reference");function Se(n){if(n==null)return null;if(typeof n=="function")return n.$$typeof===O?null:n.displayName||n.name||null;if(typeof n=="string")return n;switch(n){case j:return"Fragment";case ee:return"Profiler";case V:return"StrictMode";case F:return"Suspense";case J:return"SuspenseList";case w:return"Activity"}if(typeof n=="object")switch(n.$$typeof){case M:return"Portal";case Y:return n.displayName||"Context";case ne:return(n._context.displayName||"Context")+".Consumer";case ie:var r=n.render;return n=n.displayName,n||(n=r.displayName||r.name||"",n=n!==""?"ForwardRef("+n+")":"ForwardRef"),n;case C:return r=n.displayName||null,r!==null?r:Se(n.type)||"Memo";case R:r=n._payload,n=n._init;try{return Se(n(r))}catch{}}return null}var pe=Array.isArray,G=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,le=t.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,ye={pending:!1,data:null,method:null,action:null},Te=[],Ve=-1;function U(n){return{current:n}}function z(n){0>Ve||(n.current=Te[Ve],Te[Ve]=null,Ve--)}function ue(n,r){Ve++,Te[Ve]=n.current,n.current=r}var re=U(null),ge=U(null),Ie=U(null),Ne=U(null);function Qe(n,r){switch(ue(Ie,r),ue(ge,n),ue(re,null),r.nodeType){case 9:case 11:n=(n=r.documentElement)&&(n=n.namespaceURI)?qb(n):0;break;default:if(n=r.tagName,r=r.namespaceURI)r=qb(r),n=Hb(r,n);else switch(n){case"svg":n=1;break;case"math":n=2;break;default:n=0}}z(re),ue(re,n)}function $e(){z(re),z(ge),z(Ie)}function Di(n){n.memoizedState!==null&&ue(Ne,n);var r=re.current,o=Hb(r,n.type);r!==o&&(ue(ge,n),ue(re,o))}function ps(n){ge.current===n&&(z(re),z(ge)),Ne.current===n&&(z(Ne),$c._currentValue=ye)}var gs,Js;function mn(n){if(gs===void 0)try{throw Error()}catch(o){var r=o.stack.trim().match(/\n( *(at )?)/);gs=r&&r[1]||"",Js=-1<o.stack.indexOf(`
    at`)?" (<anonymous>)":-1<o.stack.indexOf("@")?"@unknown:0:0":""}return`
`+gs+n+Js}var Zs=!1;function ys(n,r){if(!n||Zs)return"";Zs=!0;var o=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var c={DetermineComponentFrameRoot:function(){try{if(r){var oe=function(){throw Error()};if(Object.defineProperty(oe.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(oe,[])}catch(Z){var W=Z}Reflect.construct(n,[],oe)}else{try{oe.call()}catch(Z){W=Z}n.call(oe.prototype)}}else{try{throw Error()}catch(Z){W=Z}(oe=n())&&typeof oe.catch=="function"&&oe.catch(function(){})}}catch(Z){if(Z&&W&&typeof Z.stack=="string")return[Z.stack,W.stack]}return[null,null]}};c.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var m=Object.getOwnPropertyDescriptor(c.DetermineComponentFrameRoot,"name");m&&m.configurable&&Object.defineProperty(c.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var g=c.DetermineComponentFrameRoot(),E=g[0],S=g[1];if(E&&S){var P=E.split(`
`),$=S.split(`
`);for(m=c=0;c<P.length&&!P[c].includes("DetermineComponentFrameRoot");)c++;for(;m<$.length&&!$[m].includes("DetermineComponentFrameRoot");)m++;if(c===P.length||m===$.length)for(c=P.length-1,m=$.length-1;1<=c&&0<=m&&P[c]!==$[m];)m--;for(;1<=c&&0<=m;c--,m--)if(P[c]!==$[m]){if(c!==1||m!==1)do if(c--,m--,0>m||P[c]!==$[m]){var se=`
`+P[c].replace(" at new "," at ");return n.displayName&&se.includes("<anonymous>")&&(se=se.replace("<anonymous>",n.displayName)),se}while(1<=c&&0<=m);break}}}finally{Zs=!1,Error.prepareStackTrace=o}return(o=n?n.displayName||n.name:"")?mn(o):""}function Ni(n,r){switch(n.tag){case 26:case 27:case 5:return mn(n.type);case 16:return mn("Lazy");case 13:return n.child!==r&&r!==null?mn("Suspense Fallback"):mn("Suspense");case 19:return mn("SuspenseList");case 0:case 15:return ys(n.type,!1);case 11:return ys(n.type.render,!1);case 1:return ys(n.type,!0);case 31:return mn("Activity");default:return""}}function ji(n){try{var r="",o=null;do r+=Ni(n,o),o=n,n=n.return;while(n);return r}catch(c){return`
Error generating stack: `+c.message+`
`+c.stack}}var He=Object.prototype.hasOwnProperty,ft=s.unstable_scheduleCallback,hi=s.unstable_cancelCallback,fo=s.unstable_shouldYield,aa=s.unstable_requestPaint,vt=s.unstable_now,Kn=s.unstable_getCurrentPriorityLevel,oa=s.unstable_ImmediatePriority,la=s.unstable_UserBlockingPriority,ki=s.unstable_NormalPriority,mo=s.unstable_LowPriority,po=s.unstable_IdlePriority,ca=s.log,go=s.unstable_setDisableYieldValue,Dn=null,qt=null;function _n(n){if(typeof ca=="function"&&go(n),qt&&typeof qt.setStrictMode=="function")try{qt.setStrictMode(Dn,n)}catch{}}var de=Math.clz32?Math.clz32:er,Jt=Math.log,Nn=Math.LN2;function er(n){return n>>>=0,n===0?32:31-(Jt(n)/Nn|0)|0}var ht=256,vs=262144,mt=4194304;function Oi(n){var r=n&42;if(r!==0)return r;switch(n&-n){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return n&261888;case 262144:case 524288:case 1048576:case 2097152:return n&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return n&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return n}}function Mi(n,r,o){var c=n.pendingLanes;if(c===0)return 0;var m=0,g=n.suspendedLanes,E=n.pingedLanes;n=n.warmLanes;var S=c&134217727;return S!==0?(c=S&~g,c!==0?m=Oi(c):(E&=S,E!==0?m=Oi(E):o||(o=S&~n,o!==0&&(m=Oi(o))))):(S=c&~g,S!==0?m=Oi(S):E!==0?m=Oi(E):o||(o=c&~n,o!==0&&(m=Oi(o)))),m===0?0:r!==0&&r!==m&&(r&g)===0&&(g=m&-m,o=r&-r,g>=o||g===32&&(o&4194048)!==0)?r:m}function di(n,r){return(n.pendingLanes&~(n.suspendedLanes&~n.pingedLanes)&r)===0}function Am(n,r){switch(n){case 1:case 2:case 4:case 8:case 64:return r+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return r+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function hh(){var n=mt;return mt<<=1,(mt&62914560)===0&&(mt=4194304),n}function Vi(n){for(var r=[],o=0;31>o;o++)r.push(n);return r}function ua(n,r){n.pendingLanes|=r,r!==268435456&&(n.suspendedLanes=0,n.pingedLanes=0,n.warmLanes=0)}function Im(n,r,o,c,m,g){var E=n.pendingLanes;n.pendingLanes=o,n.suspendedLanes=0,n.pingedLanes=0,n.warmLanes=0,n.expiredLanes&=o,n.entangledLanes&=o,n.errorRecoveryDisabledLanes&=o,n.shellSuspendCounter=0;var S=n.entanglements,P=n.expirationTimes,$=n.hiddenUpdates;for(o=E&~o;0<o;){var se=31-de(o),oe=1<<se;S[se]=0,P[se]=-1;var W=$[se];if(W!==null)for($[se]=null,se=0;se<W.length;se++){var Z=W[se];Z!==null&&(Z.lane&=-536870913)}o&=~oe}c!==0&&ha(n,c,0),g!==0&&m===0&&n.tag!==0&&(n.suspendedLanes|=g&~(E&~r))}function ha(n,r,o){n.pendingLanes|=r,n.suspendedLanes&=~r;var c=31-de(r);n.entangledLanes|=r,n.entanglements[c]=n.entanglements[c]|1073741824|o&261930}function Zl(n,r){var o=n.entangledLanes|=r;for(n=n.entanglements;o;){var c=31-de(o),m=1<<c;m&r|n[c]&r&&(n[c]|=r),o&=~m}}function ec(n,r){var o=r&-r;return o=(o&42)!==0?1:da(o),(o&(n.suspendedLanes|r))!==0?0:o}function da(n){switch(n){case 2:n=1;break;case 8:n=4;break;case 32:n=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:n=128;break;case 268435456:n=134217728;break;default:n=0}return n}function _s(n){return n&=-n,2<n?8<n?(n&134217727)!==0?32:268435456:8:2}function dh(){var n=le.p;return n!==0?n:(n=window.event,n===void 0?32:fE(n.type))}function fi(n,r){var o=le.p;try{return le.p=n,r()}finally{le.p=o}}var mi=Math.random().toString(36).slice(2),Ot="__reactFiber$"+mi,$t="__reactProps$"+mi,Pi="__reactContainer$"+mi,yo="__reactEvents$"+mi,Cm="__reactListeners$"+mi,fh="__reactHandles$"+mi,mh="__reactResources$"+mi,Li="__reactMarker$"+mi;function vo(n){delete n[Ot],delete n[$t],delete n[yo],delete n[Cm],delete n[fh]}function Ui(n){var r=n[Ot];if(r)return r;for(var o=n.parentNode;o;){if(r=o[Pi]||o[Ot]){if(o=r.alternate,r.child!==null||o!==null&&o.child!==null)for(n=Xb(n);n!==null;){if(o=n[Ot])return o;n=Xb(n)}return r}n=o,o=n.parentNode}return null}function $n(n){if(n=n[Ot]||n[Pi]){var r=n.tag;if(r===5||r===6||r===13||r===31||r===26||r===27||r===3)return n}return null}function jn(n){var r=n.tag;if(r===5||r===26||r===27||r===6)return n.stateNode;throw Error(i(33))}function zi(n){var r=n[mh];return r||(r=n[mh]={hoistableStyles:new Map,hoistableScripts:new Map}),r}function Mt(n){n[Li]=!0}var tc=new Set,nc={};function Bi(n,r){Fi(n,r),Fi(n+"Capture",r)}function Fi(n,r){for(nc[n]=r,n=0;n<r.length;n++)tc.add(r[n])}var ic=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),sc={},rc={};function ph(n){return He.call(rc,n)?!0:He.call(sc,n)?!1:ic.test(n)?rc[n]=!0:(sc[n]=!0,!1)}function _o(n,r,o){if(ph(r))if(o===null)n.removeAttribute(r);else{switch(typeof o){case"undefined":case"function":case"symbol":n.removeAttribute(r);return;case"boolean":var c=r.toLowerCase().slice(0,5);if(c!=="data-"&&c!=="aria-"){n.removeAttribute(r);return}}n.setAttribute(r,""+o)}}function kn(n,r,o){if(o===null)n.removeAttribute(r);else{switch(typeof o){case"undefined":case"function":case"symbol":case"boolean":n.removeAttribute(r);return}n.setAttribute(r,""+o)}}function Vt(n,r,o,c){if(c===null)n.removeAttribute(o);else{switch(typeof c){case"undefined":case"function":case"symbol":case"boolean":n.removeAttribute(o);return}n.setAttributeNS(r,o,""+c)}}function Wt(n){switch(typeof n){case"bigint":case"boolean":case"number":case"string":case"undefined":return n;case"object":return n;default:return""}}function tr(n){var r=n.type;return(n=n.nodeName)&&n.toLowerCase()==="input"&&(r==="checkbox"||r==="radio")}function ac(n,r,o){var c=Object.getOwnPropertyDescriptor(n.constructor.prototype,r);if(!n.hasOwnProperty(r)&&typeof c<"u"&&typeof c.get=="function"&&typeof c.set=="function"){var m=c.get,g=c.set;return Object.defineProperty(n,r,{configurable:!0,get:function(){return m.call(this)},set:function(E){o=""+E,g.call(this,E)}}),Object.defineProperty(n,r,{enumerable:c.enumerable}),{getValue:function(){return o},setValue:function(E){o=""+E},stopTracking:function(){n._valueTracker=null,delete n[r]}}}}function et(n){if(!n._valueTracker){var r=tr(n)?"checked":"value";n._valueTracker=ac(n,r,""+n[r])}}function fa(n){if(!n)return!1;var r=n._valueTracker;if(!r)return!0;var o=r.getValue(),c="";return n&&(c=tr(n)?n.checked?"true":"false":n.value),n=c,n!==o?(r.setValue(n),!0):!1}function qi(n){if(n=n||(typeof document<"u"?document:void 0),typeof n>"u")return null;try{return n.activeElement||n.body}catch{return n.body}}var ma=/[\n"\\]/g;function bn(n){return n.replace(ma,function(r){return"\\"+r.charCodeAt(0).toString(16)+" "})}function bo(n,r,o,c,m,g,E,S){n.name="",E!=null&&typeof E!="function"&&typeof E!="symbol"&&typeof E!="boolean"?n.type=E:n.removeAttribute("type"),r!=null?E==="number"?(r===0&&n.value===""||n.value!=r)&&(n.value=""+Wt(r)):n.value!==""+Wt(r)&&(n.value=""+Wt(r)):E!=="submit"&&E!=="reset"||n.removeAttribute("value"),r!=null?oc(n,E,Wt(r)):o!=null?oc(n,E,Wt(o)):c!=null&&n.removeAttribute("value"),m==null&&g!=null&&(n.defaultChecked=!!g),m!=null&&(n.checked=m&&typeof m!="function"&&typeof m!="symbol"),S!=null&&typeof S!="function"&&typeof S!="symbol"&&typeof S!="boolean"?n.name=""+Wt(S):n.removeAttribute("name")}function gh(n,r,o,c,m,g,E,S){if(g!=null&&typeof g!="function"&&typeof g!="symbol"&&typeof g!="boolean"&&(n.type=g),r!=null||o!=null){if(!(g!=="submit"&&g!=="reset"||r!=null)){et(n);return}o=o!=null?""+Wt(o):"",r=r!=null?""+Wt(r):o,S||r===n.value||(n.value=r),n.defaultValue=r}c=c??m,c=typeof c!="function"&&typeof c!="symbol"&&!!c,n.checked=S?n.checked:!!c,n.defaultChecked=!!c,E!=null&&typeof E!="function"&&typeof E!="symbol"&&typeof E!="boolean"&&(n.name=E),et(n)}function oc(n,r,o){r==="number"&&qi(n.ownerDocument)===n||n.defaultValue===""+o||(n.defaultValue=""+o)}function nr(n,r,o,c){if(n=n.options,r){r={};for(var m=0;m<o.length;m++)r["$"+o[m]]=!0;for(o=0;o<n.length;o++)m=r.hasOwnProperty("$"+n[o].value),n[o].selected!==m&&(n[o].selected=m),m&&c&&(n[o].defaultSelected=!0)}else{for(o=""+Wt(o),r=null,m=0;m<n.length;m++){if(n[m].value===o){n[m].selected=!0,c&&(n[m].defaultSelected=!0);return}r!==null||n[m].disabled||(r=n[m])}r!==null&&(r.selected=!0)}}function yh(n,r,o){if(r!=null&&(r=""+Wt(r),r!==n.value&&(n.value=r),o==null)){n.defaultValue!==r&&(n.defaultValue=r);return}n.defaultValue=o!=null?""+Wt(o):""}function ir(n,r,o,c){if(r==null){if(c!=null){if(o!=null)throw Error(i(92));if(pe(c)){if(1<c.length)throw Error(i(93));c=c[0]}o=c}o==null&&(o=""),r=o}o=Wt(r),n.defaultValue=o,c=n.textContent,c===o&&c!==""&&c!==null&&(n.value=c),et(n)}function En(n,r){if(r){var o=n.firstChild;if(o&&o===n.lastChild&&o.nodeType===3){o.nodeValue=r;return}}n.textContent=r}var vh=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function lc(n,r,o){var c=r.indexOf("--")===0;o==null||typeof o=="boolean"||o===""?c?n.setProperty(r,""):r==="float"?n.cssFloat="":n[r]="":c?n.setProperty(r,o):typeof o!="number"||o===0||vh.has(r)?r==="float"?n.cssFloat=o:n[r]=(""+o).trim():n[r]=o+"px"}function cc(n,r,o){if(r!=null&&typeof r!="object")throw Error(i(62));if(n=n.style,o!=null){for(var c in o)!o.hasOwnProperty(c)||r!=null&&r.hasOwnProperty(c)||(c.indexOf("--")===0?n.setProperty(c,""):c==="float"?n.cssFloat="":n[c]="");for(var m in r)c=r[m],r.hasOwnProperty(m)&&o[m]!==c&&lc(n,m,c)}else for(var g in r)r.hasOwnProperty(g)&&lc(n,g,r[g])}function Eo(n){if(n.indexOf("-")===-1)return!1;switch(n){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var _h=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),sr=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function To(n){return sr.test(""+n)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":n}function pi(){}var uc=null;function Wn(n){return n=n.target||n.srcElement||window,n.correspondingUseElement&&(n=n.correspondingUseElement),n.nodeType===3?n.parentNode:n}var rr=null,Hi=null;function pa(n){var r=$n(n);if(r&&(n=r.stateNode)){var o=n[$t]||null;e:switch(n=r.stateNode,r.type){case"input":if(bo(n,o.value,o.defaultValue,o.defaultValue,o.checked,o.defaultChecked,o.type,o.name),r=o.name,o.type==="radio"&&r!=null){for(o=n;o.parentNode;)o=o.parentNode;for(o=o.querySelectorAll('input[name="'+bn(""+r)+'"][type="radio"]'),r=0;r<o.length;r++){var c=o[r];if(c!==n&&c.form===n.form){var m=c[$t]||null;if(!m)throw Error(i(90));bo(c,m.value,m.defaultValue,m.defaultValue,m.checked,m.defaultChecked,m.type,m.name)}}for(r=0;r<o.length;r++)c=o[r],c.form===n.form&&fa(c)}break e;case"textarea":yh(n,o.value,o.defaultValue);break e;case"select":r=o.value,r!=null&&nr(n,!!o.multiple,r,!1)}}}var xo=!1;function ar(n,r,o){if(xo)return n(r,o);xo=!0;try{var c=n(r);return c}finally{if(xo=!1,(rr!==null||Hi!==null)&&(dd(),rr&&(r=rr,n=Hi,Hi=rr=null,pa(r),n)))for(r=0;r<n.length;r++)pa(n[r])}}function gi(n,r){var o=n.stateNode;if(o===null)return null;var c=o[$t]||null;if(c===null)return null;o=c[r];e:switch(r){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(c=!c.disabled)||(n=n.type,c=!(n==="button"||n==="input"||n==="select"||n==="textarea")),n=!c;break e;default:n=!1}if(n)return null;if(o&&typeof o!="function")throw Error(i(231,r,typeof o));return o}var Yn=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),ga=!1;if(Yn)try{var at={};Object.defineProperty(at,"passive",{get:function(){ga=!0}}),window.addEventListener("test",at,at),window.removeEventListener("test",at,at)}catch{ga=!1}var Gi=null,hc=null,ya=null;function dc(){if(ya)return ya;var n,r=hc,o=r.length,c,m="value"in Gi?Gi.value:Gi.textContent,g=m.length;for(n=0;n<o&&r[n]===m[n];n++);var E=o-n;for(c=1;c<=E&&r[o-c]===m[g-c];c++);return ya=m.slice(n,1<c?1-c:void 0)}function va(n){var r=n.keyCode;return"charCode"in n?(n=n.charCode,n===0&&r===13&&(n=13)):n=r,n===10&&(n=13),32<=n||n===13?n:0}function bs(){return!0}function yi(){return!1}function Zt(n){function r(o,c,m,g,E){this._reactName=o,this._targetInst=m,this.type=c,this.nativeEvent=g,this.target=E,this.currentTarget=null;for(var S in n)n.hasOwnProperty(S)&&(o=n[S],this[S]=o?o(g):g[S]);return this.isDefaultPrevented=(g.defaultPrevented!=null?g.defaultPrevented:g.returnValue===!1)?bs:yi,this.isPropagationStopped=yi,this}return b(r.prototype,{preventDefault:function(){this.defaultPrevented=!0;var o=this.nativeEvent;o&&(o.preventDefault?o.preventDefault():typeof o.returnValue!="unknown"&&(o.returnValue=!1),this.isDefaultPrevented=bs)},stopPropagation:function(){var o=this.nativeEvent;o&&(o.stopPropagation?o.stopPropagation():typeof o.cancelBubble!="unknown"&&(o.cancelBubble=!0),this.isPropagationStopped=bs)},persist:function(){},isPersistent:bs}),r}var Es={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(n){return n.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Qi=Zt(Es),or=b({},Es,{view:0,detail:0}),fc=Zt(or),lr,So,Ki,wo=b({},or,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:cr,button:0,buttons:0,relatedTarget:function(n){return n.relatedTarget===void 0?n.fromElement===n.srcElement?n.toElement:n.fromElement:n.relatedTarget},movementX:function(n){return"movementX"in n?n.movementX:(n!==Ki&&(Ki&&n.type==="mousemove"?(lr=n.screenX-Ki.screenX,So=n.screenY-Ki.screenY):So=lr=0,Ki=n),lr)},movementY:function(n){return"movementY"in n?n.movementY:So}}),mc=Zt(wo),_a=b({},wo,{dataTransfer:0}),bh=Zt(_a),Eh=b({},or,{relatedTarget:0}),ba=Zt(Eh),pc=b({},Es,{animationName:0,elapsedTime:0,pseudoElement:0}),Th=Zt(pc),Ao=b({},Es,{clipboardData:function(n){return"clipboardData"in n?n.clipboardData:window.clipboardData}}),xh=Zt(Ao),Sh=b({},Es,{data:0}),$i=Zt(Sh),wh={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Ah={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Ih={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Ch(n){var r=this.nativeEvent;return r.getModifierState?r.getModifierState(n):(n=Ih[n])?!!r[n]:!1}function cr(){return Ch}var pn=b({},or,{key:function(n){if(n.key){var r=wh[n.key]||n.key;if(r!=="Unidentified")return r}return n.type==="keypress"?(n=va(n),n===13?"Enter":String.fromCharCode(n)):n.type==="keydown"||n.type==="keyup"?Ah[n.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:cr,charCode:function(n){return n.type==="keypress"?va(n):0},keyCode:function(n){return n.type==="keydown"||n.type==="keyup"?n.keyCode:0},which:function(n){return n.type==="keypress"?va(n):n.type==="keydown"||n.type==="keyup"?n.keyCode:0}}),Rh=Zt(pn),Dh=b({},wo,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Ts=Zt(Dh),h=b({},or,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:cr}),v=Zt(h),T=b({},Es,{propertyName:0,elapsedTime:0,pseudoElement:0}),A=Zt(T),Q=b({},wo,{deltaX:function(n){return"deltaX"in n?n.deltaX:"wheelDeltaX"in n?-n.wheelDeltaX:0},deltaY:function(n){return"deltaY"in n?n.deltaY:"wheelDeltaY"in n?-n.wheelDeltaY:"wheelDelta"in n?-n.wheelDelta:0},deltaZ:0,deltaMode:0}),X=Zt(Q),fe=b({},Es,{newState:0,oldState:0}),ke=Zt(fe),Ct=[9,13,27,32],Xe=Yn&&"CompositionEvent"in window,_t=null;Yn&&"documentMode"in document&&(_t=document.documentMode);var Xn=Yn&&"TextEvent"in window&&!_t,Wi=Yn&&(!Xe||_t&&8<_t&&11>=_t),vi=" ",_i=!1;function Ea(n,r){switch(n){case"keyup":return Ct.indexOf(r.keyCode)!==-1;case"keydown":return r.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Io(n){return n=n.detail,typeof n=="object"&&"data"in n?n.data:null}var Co=!1;function JA(n,r){switch(n){case"compositionend":return Io(r);case"keypress":return r.which!==32?null:(_i=!0,vi);case"textInput":return n=r.data,n===vi&&_i?null:n;default:return null}}function ZA(n,r){if(Co)return n==="compositionend"||!Xe&&Ea(n,r)?(n=dc(),ya=hc=Gi=null,Co=!1,n):null;switch(n){case"paste":return null;case"keypress":if(!(r.ctrlKey||r.altKey||r.metaKey)||r.ctrlKey&&r.altKey){if(r.char&&1<r.char.length)return r.char;if(r.which)return String.fromCharCode(r.which)}return null;case"compositionend":return Wi&&r.locale!=="ko"?null:r.data;default:return null}}var eI={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function e_(n){var r=n&&n.nodeName&&n.nodeName.toLowerCase();return r==="input"?!!eI[n.type]:r==="textarea"}function t_(n,r,o,c){rr?Hi?Hi.push(c):Hi=[c]:rr=c,r=_d(r,"onChange"),0<r.length&&(o=new Qi("onChange","change",null,o,c),n.push({event:o,listeners:r}))}var gc=null,yc=null;function tI(n){Pb(n,0)}function Nh(n){var r=jn(n);if(fa(r))return n}function n_(n,r){if(n==="change")return r}var i_=!1;if(Yn){var Rm;if(Yn){var Dm="oninput"in document;if(!Dm){var s_=document.createElement("div");s_.setAttribute("oninput","return;"),Dm=typeof s_.oninput=="function"}Rm=Dm}else Rm=!1;i_=Rm&&(!document.documentMode||9<document.documentMode)}function r_(){gc&&(gc.detachEvent("onpropertychange",a_),yc=gc=null)}function a_(n){if(n.propertyName==="value"&&Nh(yc)){var r=[];t_(r,yc,n,Wn(n)),ar(tI,r)}}function nI(n,r,o){n==="focusin"?(r_(),gc=r,yc=o,gc.attachEvent("onpropertychange",a_)):n==="focusout"&&r_()}function iI(n){if(n==="selectionchange"||n==="keyup"||n==="keydown")return Nh(yc)}function sI(n,r){if(n==="click")return Nh(r)}function rI(n,r){if(n==="input"||n==="change")return Nh(r)}function aI(n,r){return n===r&&(n!==0||1/n===1/r)||n!==n&&r!==r}var On=typeof Object.is=="function"?Object.is:aI;function vc(n,r){if(On(n,r))return!0;if(typeof n!="object"||n===null||typeof r!="object"||r===null)return!1;var o=Object.keys(n),c=Object.keys(r);if(o.length!==c.length)return!1;for(c=0;c<o.length;c++){var m=o[c];if(!He.call(r,m)||!On(n[m],r[m]))return!1}return!0}function o_(n){for(;n&&n.firstChild;)n=n.firstChild;return n}function l_(n,r){var o=o_(n);n=0;for(var c;o;){if(o.nodeType===3){if(c=n+o.textContent.length,n<=r&&c>=r)return{node:o,offset:r-n};n=c}e:{for(;o;){if(o.nextSibling){o=o.nextSibling;break e}o=o.parentNode}o=void 0}o=o_(o)}}function c_(n,r){return n&&r?n===r?!0:n&&n.nodeType===3?!1:r&&r.nodeType===3?c_(n,r.parentNode):"contains"in n?n.contains(r):n.compareDocumentPosition?!!(n.compareDocumentPosition(r)&16):!1:!1}function u_(n){n=n!=null&&n.ownerDocument!=null&&n.ownerDocument.defaultView!=null?n.ownerDocument.defaultView:window;for(var r=qi(n.document);r instanceof n.HTMLIFrameElement;){try{var o=typeof r.contentWindow.location.href=="string"}catch{o=!1}if(o)n=r.contentWindow;else break;r=qi(n.document)}return r}function Nm(n){var r=n&&n.nodeName&&n.nodeName.toLowerCase();return r&&(r==="input"&&(n.type==="text"||n.type==="search"||n.type==="tel"||n.type==="url"||n.type==="password")||r==="textarea"||n.contentEditable==="true")}var oI=Yn&&"documentMode"in document&&11>=document.documentMode,Ro=null,jm=null,_c=null,km=!1;function h_(n,r,o){var c=o.window===o?o.document:o.nodeType===9?o:o.ownerDocument;km||Ro==null||Ro!==qi(c)||(c=Ro,"selectionStart"in c&&Nm(c)?c={start:c.selectionStart,end:c.selectionEnd}:(c=(c.ownerDocument&&c.ownerDocument.defaultView||window).getSelection(),c={anchorNode:c.anchorNode,anchorOffset:c.anchorOffset,focusNode:c.focusNode,focusOffset:c.focusOffset}),_c&&vc(_c,c)||(_c=c,c=_d(jm,"onSelect"),0<c.length&&(r=new Qi("onSelect","select",null,r,o),n.push({event:r,listeners:c}),r.target=Ro)))}function Ta(n,r){var o={};return o[n.toLowerCase()]=r.toLowerCase(),o["Webkit"+n]="webkit"+r,o["Moz"+n]="moz"+r,o}var Do={animationend:Ta("Animation","AnimationEnd"),animationiteration:Ta("Animation","AnimationIteration"),animationstart:Ta("Animation","AnimationStart"),transitionrun:Ta("Transition","TransitionRun"),transitionstart:Ta("Transition","TransitionStart"),transitioncancel:Ta("Transition","TransitionCancel"),transitionend:Ta("Transition","TransitionEnd")},Om={},d_={};Yn&&(d_=document.createElement("div").style,"AnimationEvent"in window||(delete Do.animationend.animation,delete Do.animationiteration.animation,delete Do.animationstart.animation),"TransitionEvent"in window||delete Do.transitionend.transition);function xa(n){if(Om[n])return Om[n];if(!Do[n])return n;var r=Do[n],o;for(o in r)if(r.hasOwnProperty(o)&&o in d_)return Om[n]=r[o];return n}var f_=xa("animationend"),m_=xa("animationiteration"),p_=xa("animationstart"),lI=xa("transitionrun"),cI=xa("transitionstart"),uI=xa("transitioncancel"),g_=xa("transitionend"),y_=new Map,Mm="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");Mm.push("scrollEnd");function bi(n,r){y_.set(n,r),Bi(r,[n])}var jh=typeof reportError=="function"?reportError:function(n){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var r=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof n=="object"&&n!==null&&typeof n.message=="string"?String(n.message):String(n),error:n});if(!window.dispatchEvent(r))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",n);return}console.error(n)},Jn=[],No=0,Vm=0;function kh(){for(var n=No,r=Vm=No=0;r<n;){var o=Jn[r];Jn[r++]=null;var c=Jn[r];Jn[r++]=null;var m=Jn[r];Jn[r++]=null;var g=Jn[r];if(Jn[r++]=null,c!==null&&m!==null){var E=c.pending;E===null?m.next=m:(m.next=E.next,E.next=m),c.pending=m}g!==0&&v_(o,m,g)}}function Oh(n,r,o,c){Jn[No++]=n,Jn[No++]=r,Jn[No++]=o,Jn[No++]=c,Vm|=c,n.lanes|=c,n=n.alternate,n!==null&&(n.lanes|=c)}function Pm(n,r,o,c){return Oh(n,r,o,c),Mh(n)}function Sa(n,r){return Oh(n,null,null,r),Mh(n)}function v_(n,r,o){n.lanes|=o;var c=n.alternate;c!==null&&(c.lanes|=o);for(var m=!1,g=n.return;g!==null;)g.childLanes|=o,c=g.alternate,c!==null&&(c.childLanes|=o),g.tag===22&&(n=g.stateNode,n===null||n._visibility&1||(m=!0)),n=g,g=g.return;return n.tag===3?(g=n.stateNode,m&&r!==null&&(m=31-de(o),n=g.hiddenUpdates,c=n[m],c===null?n[m]=[r]:c.push(r),r.lane=o|536870912),g):null}function Mh(n){if(50<Bc)throw Bc=0,Qp=null,Error(i(185));for(var r=n.return;r!==null;)n=r,r=n.return;return n.tag===3?n.stateNode:null}var jo={};function hI(n,r,o,c){this.tag=n,this.key=o,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=r,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=c,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Mn(n,r,o,c){return new hI(n,r,o,c)}function Lm(n){return n=n.prototype,!(!n||!n.isReactComponent)}function xs(n,r){var o=n.alternate;return o===null?(o=Mn(n.tag,r,n.key,n.mode),o.elementType=n.elementType,o.type=n.type,o.stateNode=n.stateNode,o.alternate=n,n.alternate=o):(o.pendingProps=r,o.type=n.type,o.flags=0,o.subtreeFlags=0,o.deletions=null),o.flags=n.flags&65011712,o.childLanes=n.childLanes,o.lanes=n.lanes,o.child=n.child,o.memoizedProps=n.memoizedProps,o.memoizedState=n.memoizedState,o.updateQueue=n.updateQueue,r=n.dependencies,o.dependencies=r===null?null:{lanes:r.lanes,firstContext:r.firstContext},o.sibling=n.sibling,o.index=n.index,o.ref=n.ref,o.refCleanup=n.refCleanup,o}function __(n,r){n.flags&=65011714;var o=n.alternate;return o===null?(n.childLanes=0,n.lanes=r,n.child=null,n.subtreeFlags=0,n.memoizedProps=null,n.memoizedState=null,n.updateQueue=null,n.dependencies=null,n.stateNode=null):(n.childLanes=o.childLanes,n.lanes=o.lanes,n.child=o.child,n.subtreeFlags=0,n.deletions=null,n.memoizedProps=o.memoizedProps,n.memoizedState=o.memoizedState,n.updateQueue=o.updateQueue,n.type=o.type,r=o.dependencies,n.dependencies=r===null?null:{lanes:r.lanes,firstContext:r.firstContext}),n}function Vh(n,r,o,c,m,g){var E=0;if(c=n,typeof n=="function")Lm(n)&&(E=1);else if(typeof n=="string")E=g2(n,o,re.current)?26:n==="html"||n==="head"||n==="body"?27:5;else e:switch(n){case w:return n=Mn(31,o,r,m),n.elementType=w,n.lanes=g,n;case j:return wa(o.children,m,g,r);case V:E=8,m|=24;break;case ee:return n=Mn(12,o,r,m|2),n.elementType=ee,n.lanes=g,n;case F:return n=Mn(13,o,r,m),n.elementType=F,n.lanes=g,n;case J:return n=Mn(19,o,r,m),n.elementType=J,n.lanes=g,n;default:if(typeof n=="object"&&n!==null)switch(n.$$typeof){case Y:E=10;break e;case ne:E=9;break e;case ie:E=11;break e;case C:E=14;break e;case R:E=16,c=null;break e}E=29,o=Error(i(130,n===null?"null":typeof n,"")),c=null}return r=Mn(E,o,r,m),r.elementType=n,r.type=c,r.lanes=g,r}function wa(n,r,o,c){return n=Mn(7,n,c,r),n.lanes=o,n}function Um(n,r,o){return n=Mn(6,n,null,r),n.lanes=o,n}function b_(n){var r=Mn(18,null,null,0);return r.stateNode=n,r}function zm(n,r,o){return r=Mn(4,n.children!==null?n.children:[],n.key,r),r.lanes=o,r.stateNode={containerInfo:n.containerInfo,pendingChildren:null,implementation:n.implementation},r}var E_=new WeakMap;function Zn(n,r){if(typeof n=="object"&&n!==null){var o=E_.get(n);return o!==void 0?o:(r={value:n,source:r,stack:ji(r)},E_.set(n,r),r)}return{value:n,source:r,stack:ji(r)}}var ko=[],Oo=0,Ph=null,bc=0,ei=[],ti=0,ur=null,Yi=1,Xi="";function Ss(n,r){ko[Oo++]=bc,ko[Oo++]=Ph,Ph=n,bc=r}function T_(n,r,o){ei[ti++]=Yi,ei[ti++]=Xi,ei[ti++]=ur,ur=n;var c=Yi;n=Xi;var m=32-de(c)-1;c&=~(1<<m),o+=1;var g=32-de(r)+m;if(30<g){var E=m-m%5;g=(c&(1<<E)-1).toString(32),c>>=E,m-=E,Yi=1<<32-de(r)+m|o<<m|c,Xi=g+n}else Yi=1<<g|o<<m|c,Xi=n}function Bm(n){n.return!==null&&(Ss(n,1),T_(n,1,0))}function Fm(n){for(;n===Ph;)Ph=ko[--Oo],ko[Oo]=null,bc=ko[--Oo],ko[Oo]=null;for(;n===ur;)ur=ei[--ti],ei[ti]=null,Xi=ei[--ti],ei[ti]=null,Yi=ei[--ti],ei[ti]=null}function x_(n,r){ei[ti++]=Yi,ei[ti++]=Xi,ei[ti++]=ur,Yi=r.id,Xi=r.overflow,ur=n}var en=null,pt=null,Ge=!1,hr=null,ni=!1,qm=Error(i(519));function dr(n){var r=Error(i(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw Ec(Zn(r,n)),qm}function S_(n){var r=n.stateNode,o=n.type,c=n.memoizedProps;switch(r[Ot]=n,r[$t]=c,o){case"dialog":Ue("cancel",r),Ue("close",r);break;case"iframe":case"object":case"embed":Ue("load",r);break;case"video":case"audio":for(o=0;o<qc.length;o++)Ue(qc[o],r);break;case"source":Ue("error",r);break;case"img":case"image":case"link":Ue("error",r),Ue("load",r);break;case"details":Ue("toggle",r);break;case"input":Ue("invalid",r),gh(r,c.value,c.defaultValue,c.checked,c.defaultChecked,c.type,c.name,!0);break;case"select":Ue("invalid",r);break;case"textarea":Ue("invalid",r),ir(r,c.value,c.defaultValue,c.children)}o=c.children,typeof o!="string"&&typeof o!="number"&&typeof o!="bigint"||r.textContent===""+o||c.suppressHydrationWarning===!0||Bb(r.textContent,o)?(c.popover!=null&&(Ue("beforetoggle",r),Ue("toggle",r)),c.onScroll!=null&&Ue("scroll",r),c.onScrollEnd!=null&&Ue("scrollend",r),c.onClick!=null&&(r.onclick=pi),r=!0):r=!1,r||dr(n,!0)}function w_(n){for(en=n.return;en;)switch(en.tag){case 5:case 31:case 13:ni=!1;return;case 27:case 3:ni=!0;return;default:en=en.return}}function Mo(n){if(n!==en)return!1;if(!Ge)return w_(n),Ge=!0,!1;var r=n.tag,o;if((o=r!==3&&r!==27)&&((o=r===5)&&(o=n.type,o=!(o!=="form"&&o!=="button")||og(n.type,n.memoizedProps)),o=!o),o&&pt&&dr(n),w_(n),r===13){if(n=n.memoizedState,n=n!==null?n.dehydrated:null,!n)throw Error(i(317));pt=Yb(n)}else if(r===31){if(n=n.memoizedState,n=n!==null?n.dehydrated:null,!n)throw Error(i(317));pt=Yb(n)}else r===27?(r=pt,Ar(n.type)?(n=dg,dg=null,pt=n):pt=r):pt=en?si(n.stateNode.nextSibling):null;return!0}function Aa(){pt=en=null,Ge=!1}function Hm(){var n=hr;return n!==null&&(wn===null?wn=n:wn.push.apply(wn,n),hr=null),n}function Ec(n){hr===null?hr=[n]:hr.push(n)}var Gm=U(null),Ia=null,ws=null;function fr(n,r,o){ue(Gm,r._currentValue),r._currentValue=o}function As(n){n._currentValue=Gm.current,z(Gm)}function Qm(n,r,o){for(;n!==null;){var c=n.alternate;if((n.childLanes&r)!==r?(n.childLanes|=r,c!==null&&(c.childLanes|=r)):c!==null&&(c.childLanes&r)!==r&&(c.childLanes|=r),n===o)break;n=n.return}}function Km(n,r,o,c){var m=n.child;for(m!==null&&(m.return=n);m!==null;){var g=m.dependencies;if(g!==null){var E=m.child;g=g.firstContext;e:for(;g!==null;){var S=g;g=m;for(var P=0;P<r.length;P++)if(S.context===r[P]){g.lanes|=o,S=g.alternate,S!==null&&(S.lanes|=o),Qm(g.return,o,n),c||(E=null);break e}g=S.next}}else if(m.tag===18){if(E=m.return,E===null)throw Error(i(341));E.lanes|=o,g=E.alternate,g!==null&&(g.lanes|=o),Qm(E,o,n),E=null}else E=m.child;if(E!==null)E.return=m;else for(E=m;E!==null;){if(E===n){E=null;break}if(m=E.sibling,m!==null){m.return=E.return,E=m;break}E=E.return}m=E}}function Vo(n,r,o,c){n=null;for(var m=r,g=!1;m!==null;){if(!g){if((m.flags&524288)!==0)g=!0;else if((m.flags&262144)!==0)break}if(m.tag===10){var E=m.alternate;if(E===null)throw Error(i(387));if(E=E.memoizedProps,E!==null){var S=m.type;On(m.pendingProps.value,E.value)||(n!==null?n.push(S):n=[S])}}else if(m===Ne.current){if(E=m.alternate,E===null)throw Error(i(387));E.memoizedState.memoizedState!==m.memoizedState.memoizedState&&(n!==null?n.push($c):n=[$c])}m=m.return}n!==null&&Km(r,n,o,c),r.flags|=262144}function Lh(n){for(n=n.firstContext;n!==null;){if(!On(n.context._currentValue,n.memoizedValue))return!0;n=n.next}return!1}function Ca(n){Ia=n,ws=null,n=n.dependencies,n!==null&&(n.firstContext=null)}function tn(n){return A_(Ia,n)}function Uh(n,r){return Ia===null&&Ca(n),A_(n,r)}function A_(n,r){var o=r._currentValue;if(r={context:r,memoizedValue:o,next:null},ws===null){if(n===null)throw Error(i(308));ws=r,n.dependencies={lanes:0,firstContext:r},n.flags|=524288}else ws=ws.next=r;return o}var dI=typeof AbortController<"u"?AbortController:function(){var n=[],r=this.signal={aborted:!1,addEventListener:function(o,c){n.push(c)}};this.abort=function(){r.aborted=!0,n.forEach(function(o){return o()})}},fI=s.unstable_scheduleCallback,mI=s.unstable_NormalPriority,Pt={$$typeof:Y,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function $m(){return{controller:new dI,data:new Map,refCount:0}}function Tc(n){n.refCount--,n.refCount===0&&fI(mI,function(){n.controller.abort()})}var xc=null,Wm=0,Po=0,Lo=null;function pI(n,r){if(xc===null){var o=xc=[];Wm=0,Po=Jp(),Lo={status:"pending",value:void 0,then:function(c){o.push(c)}}}return Wm++,r.then(I_,I_),r}function I_(){if(--Wm===0&&xc!==null){Lo!==null&&(Lo.status="fulfilled");var n=xc;xc=null,Po=0,Lo=null;for(var r=0;r<n.length;r++)(0,n[r])()}}function gI(n,r){var o=[],c={status:"pending",value:null,reason:null,then:function(m){o.push(m)}};return n.then(function(){c.status="fulfilled",c.value=r;for(var m=0;m<o.length;m++)(0,o[m])(r)},function(m){for(c.status="rejected",c.reason=m,m=0;m<o.length;m++)(0,o[m])(void 0)}),c}var C_=G.S;G.S=function(n,r){hb=vt(),typeof r=="object"&&r!==null&&typeof r.then=="function"&&pI(n,r),C_!==null&&C_(n,r)};var Ra=U(null);function Ym(){var n=Ra.current;return n!==null?n:ut.pooledCache}function zh(n,r){r===null?ue(Ra,Ra.current):ue(Ra,r.pool)}function R_(){var n=Ym();return n===null?null:{parent:Pt._currentValue,pool:n}}var Uo=Error(i(460)),Xm=Error(i(474)),Bh=Error(i(542)),Fh={then:function(){}};function D_(n){return n=n.status,n==="fulfilled"||n==="rejected"}function N_(n,r,o){switch(o=n[o],o===void 0?n.push(r):o!==r&&(r.then(pi,pi),r=o),r.status){case"fulfilled":return r.value;case"rejected":throw n=r.reason,k_(n),n;default:if(typeof r.status=="string")r.then(pi,pi);else{if(n=ut,n!==null&&100<n.shellSuspendCounter)throw Error(i(482));n=r,n.status="pending",n.then(function(c){if(r.status==="pending"){var m=r;m.status="fulfilled",m.value=c}},function(c){if(r.status==="pending"){var m=r;m.status="rejected",m.reason=c}})}switch(r.status){case"fulfilled":return r.value;case"rejected":throw n=r.reason,k_(n),n}throw Na=r,Uo}}function Da(n){try{var r=n._init;return r(n._payload)}catch(o){throw o!==null&&typeof o=="object"&&typeof o.then=="function"?(Na=o,Uo):o}}var Na=null;function j_(){if(Na===null)throw Error(i(459));var n=Na;return Na=null,n}function k_(n){if(n===Uo||n===Bh)throw Error(i(483))}var zo=null,Sc=0;function qh(n){var r=Sc;return Sc+=1,zo===null&&(zo=[]),N_(zo,n,r)}function wc(n,r){r=r.props.ref,n.ref=r!==void 0?r:null}function Hh(n,r){throw r.$$typeof===x?Error(i(525)):(n=Object.prototype.toString.call(r),Error(i(31,n==="[object Object]"?"object with keys {"+Object.keys(r).join(", ")+"}":n)))}function O_(n){function r(q,B){if(n){var K=q.deletions;K===null?(q.deletions=[B],q.flags|=16):K.push(B)}}function o(q,B){if(!n)return null;for(;B!==null;)r(q,B),B=B.sibling;return null}function c(q){for(var B=new Map;q!==null;)q.key!==null?B.set(q.key,q):B.set(q.index,q),q=q.sibling;return B}function m(q,B){return q=xs(q,B),q.index=0,q.sibling=null,q}function g(q,B,K){return q.index=K,n?(K=q.alternate,K!==null?(K=K.index,K<B?(q.flags|=67108866,B):K):(q.flags|=67108866,B)):(q.flags|=1048576,B)}function E(q){return n&&q.alternate===null&&(q.flags|=67108866),q}function S(q,B,K,ae){return B===null||B.tag!==6?(B=Um(K,q.mode,ae),B.return=q,B):(B=m(B,K),B.return=q,B)}function P(q,B,K,ae){var we=K.type;return we===j?se(q,B,K.props.children,ae,K.key):B!==null&&(B.elementType===we||typeof we=="object"&&we!==null&&we.$$typeof===R&&Da(we)===B.type)?(B=m(B,K.props),wc(B,K),B.return=q,B):(B=Vh(K.type,K.key,K.props,null,q.mode,ae),wc(B,K),B.return=q,B)}function $(q,B,K,ae){return B===null||B.tag!==4||B.stateNode.containerInfo!==K.containerInfo||B.stateNode.implementation!==K.implementation?(B=zm(K,q.mode,ae),B.return=q,B):(B=m(B,K.children||[]),B.return=q,B)}function se(q,B,K,ae,we){return B===null||B.tag!==7?(B=wa(K,q.mode,ae,we),B.return=q,B):(B=m(B,K),B.return=q,B)}function oe(q,B,K){if(typeof B=="string"&&B!==""||typeof B=="number"||typeof B=="bigint")return B=Um(""+B,q.mode,K),B.return=q,B;if(typeof B=="object"&&B!==null){switch(B.$$typeof){case k:return K=Vh(B.type,B.key,B.props,null,q.mode,K),wc(K,B),K.return=q,K;case M:return B=zm(B,q.mode,K),B.return=q,B;case R:return B=Da(B),oe(q,B,K)}if(pe(B)||L(B))return B=wa(B,q.mode,K,null),B.return=q,B;if(typeof B.then=="function")return oe(q,qh(B),K);if(B.$$typeof===Y)return oe(q,Uh(q,B),K);Hh(q,B)}return null}function W(q,B,K,ae){var we=B!==null?B.key:null;if(typeof K=="string"&&K!==""||typeof K=="number"||typeof K=="bigint")return we!==null?null:S(q,B,""+K,ae);if(typeof K=="object"&&K!==null){switch(K.$$typeof){case k:return K.key===we?P(q,B,K,ae):null;case M:return K.key===we?$(q,B,K,ae):null;case R:return K=Da(K),W(q,B,K,ae)}if(pe(K)||L(K))return we!==null?null:se(q,B,K,ae,null);if(typeof K.then=="function")return W(q,B,qh(K),ae);if(K.$$typeof===Y)return W(q,B,Uh(q,K),ae);Hh(q,K)}return null}function Z(q,B,K,ae,we){if(typeof ae=="string"&&ae!==""||typeof ae=="number"||typeof ae=="bigint")return q=q.get(K)||null,S(B,q,""+ae,we);if(typeof ae=="object"&&ae!==null){switch(ae.$$typeof){case k:return q=q.get(ae.key===null?K:ae.key)||null,P(B,q,ae,we);case M:return q=q.get(ae.key===null?K:ae.key)||null,$(B,q,ae,we);case R:return ae=Da(ae),Z(q,B,K,ae,we)}if(pe(ae)||L(ae))return q=q.get(K)||null,se(B,q,ae,we,null);if(typeof ae.then=="function")return Z(q,B,K,qh(ae),we);if(ae.$$typeof===Y)return Z(q,B,K,Uh(B,ae),we);Hh(B,ae)}return null}function _e(q,B,K,ae){for(var we=null,We=null,Ee=B,Me=B=0,Be=null;Ee!==null&&Me<K.length;Me++){Ee.index>Me?(Be=Ee,Ee=null):Be=Ee.sibling;var Ye=W(q,Ee,K[Me],ae);if(Ye===null){Ee===null&&(Ee=Be);break}n&&Ee&&Ye.alternate===null&&r(q,Ee),B=g(Ye,B,Me),We===null?we=Ye:We.sibling=Ye,We=Ye,Ee=Be}if(Me===K.length)return o(q,Ee),Ge&&Ss(q,Me),we;if(Ee===null){for(;Me<K.length;Me++)Ee=oe(q,K[Me],ae),Ee!==null&&(B=g(Ee,B,Me),We===null?we=Ee:We.sibling=Ee,We=Ee);return Ge&&Ss(q,Me),we}for(Ee=c(Ee);Me<K.length;Me++)Be=Z(Ee,q,Me,K[Me],ae),Be!==null&&(n&&Be.alternate!==null&&Ee.delete(Be.key===null?Me:Be.key),B=g(Be,B,Me),We===null?we=Be:We.sibling=Be,We=Be);return n&&Ee.forEach(function(Nr){return r(q,Nr)}),Ge&&Ss(q,Me),we}function Ce(q,B,K,ae){if(K==null)throw Error(i(151));for(var we=null,We=null,Ee=B,Me=B=0,Be=null,Ye=K.next();Ee!==null&&!Ye.done;Me++,Ye=K.next()){Ee.index>Me?(Be=Ee,Ee=null):Be=Ee.sibling;var Nr=W(q,Ee,Ye.value,ae);if(Nr===null){Ee===null&&(Ee=Be);break}n&&Ee&&Nr.alternate===null&&r(q,Ee),B=g(Nr,B,Me),We===null?we=Nr:We.sibling=Nr,We=Nr,Ee=Be}if(Ye.done)return o(q,Ee),Ge&&Ss(q,Me),we;if(Ee===null){for(;!Ye.done;Me++,Ye=K.next())Ye=oe(q,Ye.value,ae),Ye!==null&&(B=g(Ye,B,Me),We===null?we=Ye:We.sibling=Ye,We=Ye);return Ge&&Ss(q,Me),we}for(Ee=c(Ee);!Ye.done;Me++,Ye=K.next())Ye=Z(Ee,q,Me,Ye.value,ae),Ye!==null&&(n&&Ye.alternate!==null&&Ee.delete(Ye.key===null?Me:Ye.key),B=g(Ye,B,Me),We===null?we=Ye:We.sibling=Ye,We=Ye);return n&&Ee.forEach(function(I2){return r(q,I2)}),Ge&&Ss(q,Me),we}function ct(q,B,K,ae){if(typeof K=="object"&&K!==null&&K.type===j&&K.key===null&&(K=K.props.children),typeof K=="object"&&K!==null){switch(K.$$typeof){case k:e:{for(var we=K.key;B!==null;){if(B.key===we){if(we=K.type,we===j){if(B.tag===7){o(q,B.sibling),ae=m(B,K.props.children),ae.return=q,q=ae;break e}}else if(B.elementType===we||typeof we=="object"&&we!==null&&we.$$typeof===R&&Da(we)===B.type){o(q,B.sibling),ae=m(B,K.props),wc(ae,K),ae.return=q,q=ae;break e}o(q,B);break}else r(q,B);B=B.sibling}K.type===j?(ae=wa(K.props.children,q.mode,ae,K.key),ae.return=q,q=ae):(ae=Vh(K.type,K.key,K.props,null,q.mode,ae),wc(ae,K),ae.return=q,q=ae)}return E(q);case M:e:{for(we=K.key;B!==null;){if(B.key===we)if(B.tag===4&&B.stateNode.containerInfo===K.containerInfo&&B.stateNode.implementation===K.implementation){o(q,B.sibling),ae=m(B,K.children||[]),ae.return=q,q=ae;break e}else{o(q,B);break}else r(q,B);B=B.sibling}ae=zm(K,q.mode,ae),ae.return=q,q=ae}return E(q);case R:return K=Da(K),ct(q,B,K,ae)}if(pe(K))return _e(q,B,K,ae);if(L(K)){if(we=L(K),typeof we!="function")throw Error(i(150));return K=we.call(K),Ce(q,B,K,ae)}if(typeof K.then=="function")return ct(q,B,qh(K),ae);if(K.$$typeof===Y)return ct(q,B,Uh(q,K),ae);Hh(q,K)}return typeof K=="string"&&K!==""||typeof K=="number"||typeof K=="bigint"?(K=""+K,B!==null&&B.tag===6?(o(q,B.sibling),ae=m(B,K),ae.return=q,q=ae):(o(q,B),ae=Um(K,q.mode,ae),ae.return=q,q=ae),E(q)):o(q,B)}return function(q,B,K,ae){try{Sc=0;var we=ct(q,B,K,ae);return zo=null,we}catch(Ee){if(Ee===Uo||Ee===Bh)throw Ee;var We=Mn(29,Ee,null,q.mode);return We.lanes=ae,We.return=q,We}}}var ja=O_(!0),M_=O_(!1),mr=!1;function Jm(n){n.updateQueue={baseState:n.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function Zm(n,r){n=n.updateQueue,r.updateQueue===n&&(r.updateQueue={baseState:n.baseState,firstBaseUpdate:n.firstBaseUpdate,lastBaseUpdate:n.lastBaseUpdate,shared:n.shared,callbacks:null})}function pr(n){return{lane:n,tag:0,payload:null,callback:null,next:null}}function gr(n,r,o){var c=n.updateQueue;if(c===null)return null;if(c=c.shared,(Je&2)!==0){var m=c.pending;return m===null?r.next=r:(r.next=m.next,m.next=r),c.pending=r,r=Mh(n),v_(n,null,o),r}return Oh(n,c,r,o),Mh(n)}function Ac(n,r,o){if(r=r.updateQueue,r!==null&&(r=r.shared,(o&4194048)!==0)){var c=r.lanes;c&=n.pendingLanes,o|=c,r.lanes=o,Zl(n,o)}}function ep(n,r){var o=n.updateQueue,c=n.alternate;if(c!==null&&(c=c.updateQueue,o===c)){var m=null,g=null;if(o=o.firstBaseUpdate,o!==null){do{var E={lane:o.lane,tag:o.tag,payload:o.payload,callback:null,next:null};g===null?m=g=E:g=g.next=E,o=o.next}while(o!==null);g===null?m=g=r:g=g.next=r}else m=g=r;o={baseState:c.baseState,firstBaseUpdate:m,lastBaseUpdate:g,shared:c.shared,callbacks:c.callbacks},n.updateQueue=o;return}n=o.lastBaseUpdate,n===null?o.firstBaseUpdate=r:n.next=r,o.lastBaseUpdate=r}var tp=!1;function Ic(){if(tp){var n=Lo;if(n!==null)throw n}}function Cc(n,r,o,c){tp=!1;var m=n.updateQueue;mr=!1;var g=m.firstBaseUpdate,E=m.lastBaseUpdate,S=m.shared.pending;if(S!==null){m.shared.pending=null;var P=S,$=P.next;P.next=null,E===null?g=$:E.next=$,E=P;var se=n.alternate;se!==null&&(se=se.updateQueue,S=se.lastBaseUpdate,S!==E&&(S===null?se.firstBaseUpdate=$:S.next=$,se.lastBaseUpdate=P))}if(g!==null){var oe=m.baseState;E=0,se=$=P=null,S=g;do{var W=S.lane&-536870913,Z=W!==S.lane;if(Z?(ze&W)===W:(c&W)===W){W!==0&&W===Po&&(tp=!0),se!==null&&(se=se.next={lane:0,tag:S.tag,payload:S.payload,callback:null,next:null});e:{var _e=n,Ce=S;W=r;var ct=o;switch(Ce.tag){case 1:if(_e=Ce.payload,typeof _e=="function"){oe=_e.call(ct,oe,W);break e}oe=_e;break e;case 3:_e.flags=_e.flags&-65537|128;case 0:if(_e=Ce.payload,W=typeof _e=="function"?_e.call(ct,oe,W):_e,W==null)break e;oe=b({},oe,W);break e;case 2:mr=!0}}W=S.callback,W!==null&&(n.flags|=64,Z&&(n.flags|=8192),Z=m.callbacks,Z===null?m.callbacks=[W]:Z.push(W))}else Z={lane:W,tag:S.tag,payload:S.payload,callback:S.callback,next:null},se===null?($=se=Z,P=oe):se=se.next=Z,E|=W;if(S=S.next,S===null){if(S=m.shared.pending,S===null)break;Z=S,S=Z.next,Z.next=null,m.lastBaseUpdate=Z,m.shared.pending=null}}while(!0);se===null&&(P=oe),m.baseState=P,m.firstBaseUpdate=$,m.lastBaseUpdate=se,g===null&&(m.shared.lanes=0),Er|=E,n.lanes=E,n.memoizedState=oe}}function V_(n,r){if(typeof n!="function")throw Error(i(191,n));n.call(r)}function P_(n,r){var o=n.callbacks;if(o!==null)for(n.callbacks=null,n=0;n<o.length;n++)V_(o[n],r)}var Bo=U(null),Gh=U(0);function L_(n,r){n=Ms,ue(Gh,n),ue(Bo,r),Ms=n|r.baseLanes}function np(){ue(Gh,Ms),ue(Bo,Bo.current)}function ip(){Ms=Gh.current,z(Bo),z(Gh)}var Vn=U(null),ii=null;function yr(n){var r=n.alternate;ue(Rt,Rt.current&1),ue(Vn,n),ii===null&&(r===null||Bo.current!==null||r.memoizedState!==null)&&(ii=n)}function sp(n){ue(Rt,Rt.current),ue(Vn,n),ii===null&&(ii=n)}function U_(n){n.tag===22?(ue(Rt,Rt.current),ue(Vn,n),ii===null&&(ii=n)):vr()}function vr(){ue(Rt,Rt.current),ue(Vn,Vn.current)}function Pn(n){z(Vn),ii===n&&(ii=null),z(Rt)}var Rt=U(0);function Qh(n){for(var r=n;r!==null;){if(r.tag===13){var o=r.memoizedState;if(o!==null&&(o=o.dehydrated,o===null||ug(o)||hg(o)))return r}else if(r.tag===19&&(r.memoizedProps.revealOrder==="forwards"||r.memoizedProps.revealOrder==="backwards"||r.memoizedProps.revealOrder==="unstable_legacy-backwards"||r.memoizedProps.revealOrder==="together")){if((r.flags&128)!==0)return r}else if(r.child!==null){r.child.return=r,r=r.child;continue}if(r===n)break;for(;r.sibling===null;){if(r.return===null||r.return===n)return null;r=r.return}r.sibling.return=r.return,r=r.sibling}return null}var Is=0,Oe=null,ot=null,Lt=null,Kh=!1,Fo=!1,ka=!1,$h=0,Rc=0,qo=null,yI=0;function St(){throw Error(i(321))}function rp(n,r){if(r===null)return!1;for(var o=0;o<r.length&&o<n.length;o++)if(!On(n[o],r[o]))return!1;return!0}function ap(n,r,o,c,m,g){return Is=g,Oe=r,r.memoizedState=null,r.updateQueue=null,r.lanes=0,G.H=n===null||n.memoizedState===null?T0:Ep,ka=!1,g=o(c,m),ka=!1,Fo&&(g=B_(r,o,c,m)),z_(n),g}function z_(n){G.H=jc;var r=ot!==null&&ot.next!==null;if(Is=0,Lt=ot=Oe=null,Kh=!1,Rc=0,qo=null,r)throw Error(i(300));n===null||Ut||(n=n.dependencies,n!==null&&Lh(n)&&(Ut=!0))}function B_(n,r,o,c){Oe=n;var m=0;do{if(Fo&&(qo=null),Rc=0,Fo=!1,25<=m)throw Error(i(301));if(m+=1,Lt=ot=null,n.updateQueue!=null){var g=n.updateQueue;g.lastEffect=null,g.events=null,g.stores=null,g.memoCache!=null&&(g.memoCache.index=0)}G.H=x0,g=r(o,c)}while(Fo);return g}function vI(){var n=G.H,r=n.useState()[0];return r=typeof r.then=="function"?Dc(r):r,n=n.useState()[0],(ot!==null?ot.memoizedState:null)!==n&&(Oe.flags|=1024),r}function op(){var n=$h!==0;return $h=0,n}function lp(n,r,o){r.updateQueue=n.updateQueue,r.flags&=-2053,n.lanes&=~o}function cp(n){if(Kh){for(n=n.memoizedState;n!==null;){var r=n.queue;r!==null&&(r.pending=null),n=n.next}Kh=!1}Is=0,Lt=ot=Oe=null,Fo=!1,Rc=$h=0,qo=null}function gn(){var n={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Lt===null?Oe.memoizedState=Lt=n:Lt=Lt.next=n,Lt}function Dt(){if(ot===null){var n=Oe.alternate;n=n!==null?n.memoizedState:null}else n=ot.next;var r=Lt===null?Oe.memoizedState:Lt.next;if(r!==null)Lt=r,ot=n;else{if(n===null)throw Oe.alternate===null?Error(i(467)):Error(i(310));ot=n,n={memoizedState:ot.memoizedState,baseState:ot.baseState,baseQueue:ot.baseQueue,queue:ot.queue,next:null},Lt===null?Oe.memoizedState=Lt=n:Lt=Lt.next=n}return Lt}function Wh(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function Dc(n){var r=Rc;return Rc+=1,qo===null&&(qo=[]),n=N_(qo,n,r),r=Oe,(Lt===null?r.memoizedState:Lt.next)===null&&(r=r.alternate,G.H=r===null||r.memoizedState===null?T0:Ep),n}function Yh(n){if(n!==null&&typeof n=="object"){if(typeof n.then=="function")return Dc(n);if(n.$$typeof===Y)return tn(n)}throw Error(i(438,String(n)))}function up(n){var r=null,o=Oe.updateQueue;if(o!==null&&(r=o.memoCache),r==null){var c=Oe.alternate;c!==null&&(c=c.updateQueue,c!==null&&(c=c.memoCache,c!=null&&(r={data:c.data.map(function(m){return m.slice()}),index:0})))}if(r==null&&(r={data:[],index:0}),o===null&&(o=Wh(),Oe.updateQueue=o),o.memoCache=r,o=r.data[r.index],o===void 0)for(o=r.data[r.index]=Array(n),c=0;c<n;c++)o[c]=I;return r.index++,o}function Cs(n,r){return typeof r=="function"?r(n):r}function Xh(n){var r=Dt();return hp(r,ot,n)}function hp(n,r,o){var c=n.queue;if(c===null)throw Error(i(311));c.lastRenderedReducer=o;var m=n.baseQueue,g=c.pending;if(g!==null){if(m!==null){var E=m.next;m.next=g.next,g.next=E}r.baseQueue=m=g,c.pending=null}if(g=n.baseState,m===null)n.memoizedState=g;else{r=m.next;var S=E=null,P=null,$=r,se=!1;do{var oe=$.lane&-536870913;if(oe!==$.lane?(ze&oe)===oe:(Is&oe)===oe){var W=$.revertLane;if(W===0)P!==null&&(P=P.next={lane:0,revertLane:0,gesture:null,action:$.action,hasEagerState:$.hasEagerState,eagerState:$.eagerState,next:null}),oe===Po&&(se=!0);else if((Is&W)===W){$=$.next,W===Po&&(se=!0);continue}else oe={lane:0,revertLane:$.revertLane,gesture:null,action:$.action,hasEagerState:$.hasEagerState,eagerState:$.eagerState,next:null},P===null?(S=P=oe,E=g):P=P.next=oe,Oe.lanes|=W,Er|=W;oe=$.action,ka&&o(g,oe),g=$.hasEagerState?$.eagerState:o(g,oe)}else W={lane:oe,revertLane:$.revertLane,gesture:$.gesture,action:$.action,hasEagerState:$.hasEagerState,eagerState:$.eagerState,next:null},P===null?(S=P=W,E=g):P=P.next=W,Oe.lanes|=oe,Er|=oe;$=$.next}while($!==null&&$!==r);if(P===null?E=g:P.next=S,!On(g,n.memoizedState)&&(Ut=!0,se&&(o=Lo,o!==null)))throw o;n.memoizedState=g,n.baseState=E,n.baseQueue=P,c.lastRenderedState=g}return m===null&&(c.lanes=0),[n.memoizedState,c.dispatch]}function dp(n){var r=Dt(),o=r.queue;if(o===null)throw Error(i(311));o.lastRenderedReducer=n;var c=o.dispatch,m=o.pending,g=r.memoizedState;if(m!==null){o.pending=null;var E=m=m.next;do g=n(g,E.action),E=E.next;while(E!==m);On(g,r.memoizedState)||(Ut=!0),r.memoizedState=g,r.baseQueue===null&&(r.baseState=g),o.lastRenderedState=g}return[g,c]}function F_(n,r,o){var c=Oe,m=Dt(),g=Ge;if(g){if(o===void 0)throw Error(i(407));o=o()}else o=r();var E=!On((ot||m).memoizedState,o);if(E&&(m.memoizedState=o,Ut=!0),m=m.queue,pp(G_.bind(null,c,m,n),[n]),m.getSnapshot!==r||E||Lt!==null&&Lt.memoizedState.tag&1){if(c.flags|=2048,Ho(9,{destroy:void 0},H_.bind(null,c,m,o,r),null),ut===null)throw Error(i(349));g||(Is&127)!==0||q_(c,r,o)}return o}function q_(n,r,o){n.flags|=16384,n={getSnapshot:r,value:o},r=Oe.updateQueue,r===null?(r=Wh(),Oe.updateQueue=r,r.stores=[n]):(o=r.stores,o===null?r.stores=[n]:o.push(n))}function H_(n,r,o,c){r.value=o,r.getSnapshot=c,Q_(r)&&K_(n)}function G_(n,r,o){return o(function(){Q_(r)&&K_(n)})}function Q_(n){var r=n.getSnapshot;n=n.value;try{var o=r();return!On(n,o)}catch{return!0}}function K_(n){var r=Sa(n,2);r!==null&&An(r,n,2)}function fp(n){var r=gn();if(typeof n=="function"){var o=n;if(n=o(),ka){_n(!0);try{o()}finally{_n(!1)}}}return r.memoizedState=r.baseState=n,r.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Cs,lastRenderedState:n},r}function $_(n,r,o,c){return n.baseState=o,hp(n,ot,typeof c=="function"?c:Cs)}function _I(n,r,o,c,m){if(ed(n))throw Error(i(485));if(n=r.action,n!==null){var g={payload:m,action:n,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(E){g.listeners.push(E)}};G.T!==null?o(!0):g.isTransition=!1,c(g),o=r.pending,o===null?(g.next=r.pending=g,W_(r,g)):(g.next=o.next,r.pending=o.next=g)}}function W_(n,r){var o=r.action,c=r.payload,m=n.state;if(r.isTransition){var g=G.T,E={};G.T=E;try{var S=o(m,c),P=G.S;P!==null&&P(E,S),Y_(n,r,S)}catch($){mp(n,r,$)}finally{g!==null&&E.types!==null&&(g.types=E.types),G.T=g}}else try{g=o(m,c),Y_(n,r,g)}catch($){mp(n,r,$)}}function Y_(n,r,o){o!==null&&typeof o=="object"&&typeof o.then=="function"?o.then(function(c){X_(n,r,c)},function(c){return mp(n,r,c)}):X_(n,r,o)}function X_(n,r,o){r.status="fulfilled",r.value=o,J_(r),n.state=o,r=n.pending,r!==null&&(o=r.next,o===r?n.pending=null:(o=o.next,r.next=o,W_(n,o)))}function mp(n,r,o){var c=n.pending;if(n.pending=null,c!==null){c=c.next;do r.status="rejected",r.reason=o,J_(r),r=r.next;while(r!==c)}n.action=null}function J_(n){n=n.listeners;for(var r=0;r<n.length;r++)(0,n[r])()}function Z_(n,r){return r}function e0(n,r){if(Ge){var o=ut.formState;if(o!==null){e:{var c=Oe;if(Ge){if(pt){t:{for(var m=pt,g=ni;m.nodeType!==8;){if(!g){m=null;break t}if(m=si(m.nextSibling),m===null){m=null;break t}}g=m.data,m=g==="F!"||g==="F"?m:null}if(m){pt=si(m.nextSibling),c=m.data==="F!";break e}}dr(c)}c=!1}c&&(r=o[0])}}return o=gn(),o.memoizedState=o.baseState=r,c={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Z_,lastRenderedState:r},o.queue=c,o=_0.bind(null,Oe,c),c.dispatch=o,c=fp(!1),g=bp.bind(null,Oe,!1,c.queue),c=gn(),m={state:r,dispatch:null,action:n,pending:null},c.queue=m,o=_I.bind(null,Oe,m,g,o),m.dispatch=o,c.memoizedState=n,[r,o,!1]}function t0(n){var r=Dt();return n0(r,ot,n)}function n0(n,r,o){if(r=hp(n,r,Z_)[0],n=Xh(Cs)[0],typeof r=="object"&&r!==null&&typeof r.then=="function")try{var c=Dc(r)}catch(E){throw E===Uo?Bh:E}else c=r;r=Dt();var m=r.queue,g=m.dispatch;return o!==r.memoizedState&&(Oe.flags|=2048,Ho(9,{destroy:void 0},bI.bind(null,m,o),null)),[c,g,n]}function bI(n,r){n.action=r}function i0(n){var r=Dt(),o=ot;if(o!==null)return n0(r,o,n);Dt(),r=r.memoizedState,o=Dt();var c=o.queue.dispatch;return o.memoizedState=n,[r,c,!1]}function Ho(n,r,o,c){return n={tag:n,create:o,deps:c,inst:r,next:null},r=Oe.updateQueue,r===null&&(r=Wh(),Oe.updateQueue=r),o=r.lastEffect,o===null?r.lastEffect=n.next=n:(c=o.next,o.next=n,n.next=c,r.lastEffect=n),n}function s0(){return Dt().memoizedState}function Jh(n,r,o,c){var m=gn();Oe.flags|=n,m.memoizedState=Ho(1|r,{destroy:void 0},o,c===void 0?null:c)}function Zh(n,r,o,c){var m=Dt();c=c===void 0?null:c;var g=m.memoizedState.inst;ot!==null&&c!==null&&rp(c,ot.memoizedState.deps)?m.memoizedState=Ho(r,g,o,c):(Oe.flags|=n,m.memoizedState=Ho(1|r,g,o,c))}function r0(n,r){Jh(8390656,8,n,r)}function pp(n,r){Zh(2048,8,n,r)}function EI(n){Oe.flags|=4;var r=Oe.updateQueue;if(r===null)r=Wh(),Oe.updateQueue=r,r.events=[n];else{var o=r.events;o===null?r.events=[n]:o.push(n)}}function a0(n){var r=Dt().memoizedState;return EI({ref:r,nextImpl:n}),function(){if((Je&2)!==0)throw Error(i(440));return r.impl.apply(void 0,arguments)}}function o0(n,r){return Zh(4,2,n,r)}function l0(n,r){return Zh(4,4,n,r)}function c0(n,r){if(typeof r=="function"){n=n();var o=r(n);return function(){typeof o=="function"?o():r(null)}}if(r!=null)return n=n(),r.current=n,function(){r.current=null}}function u0(n,r,o){o=o!=null?o.concat([n]):null,Zh(4,4,c0.bind(null,r,n),o)}function gp(){}function h0(n,r){var o=Dt();r=r===void 0?null:r;var c=o.memoizedState;return r!==null&&rp(r,c[1])?c[0]:(o.memoizedState=[n,r],n)}function d0(n,r){var o=Dt();r=r===void 0?null:r;var c=o.memoizedState;if(r!==null&&rp(r,c[1]))return c[0];if(c=n(),ka){_n(!0);try{n()}finally{_n(!1)}}return o.memoizedState=[c,r],c}function yp(n,r,o){return o===void 0||(Is&1073741824)!==0&&(ze&261930)===0?n.memoizedState=r:(n.memoizedState=o,n=fb(),Oe.lanes|=n,Er|=n,o)}function f0(n,r,o,c){return On(o,r)?o:Bo.current!==null?(n=yp(n,o,c),On(n,r)||(Ut=!0),n):(Is&42)===0||(Is&1073741824)!==0&&(ze&261930)===0?(Ut=!0,n.memoizedState=o):(n=fb(),Oe.lanes|=n,Er|=n,r)}function m0(n,r,o,c,m){var g=le.p;le.p=g!==0&&8>g?g:8;var E=G.T,S={};G.T=S,bp(n,!1,r,o);try{var P=m(),$=G.S;if($!==null&&$(S,P),P!==null&&typeof P=="object"&&typeof P.then=="function"){var se=gI(P,c);Nc(n,r,se,zn(n))}else Nc(n,r,c,zn(n))}catch(oe){Nc(n,r,{then:function(){},status:"rejected",reason:oe},zn())}finally{le.p=g,E!==null&&S.types!==null&&(E.types=S.types),G.T=E}}function TI(){}function vp(n,r,o,c){if(n.tag!==5)throw Error(i(476));var m=p0(n).queue;m0(n,m,r,ye,o===null?TI:function(){return g0(n),o(c)})}function p0(n){var r=n.memoizedState;if(r!==null)return r;r={memoizedState:ye,baseState:ye,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Cs,lastRenderedState:ye},next:null};var o={};return r.next={memoizedState:o,baseState:o,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Cs,lastRenderedState:o},next:null},n.memoizedState=r,n=n.alternate,n!==null&&(n.memoizedState=r),r}function g0(n){var r=p0(n);r.next===null&&(r=n.alternate.memoizedState),Nc(n,r.next.queue,{},zn())}function _p(){return tn($c)}function y0(){return Dt().memoizedState}function v0(){return Dt().memoizedState}function xI(n){for(var r=n.return;r!==null;){switch(r.tag){case 24:case 3:var o=zn();n=pr(o);var c=gr(r,n,o);c!==null&&(An(c,r,o),Ac(c,r,o)),r={cache:$m()},n.payload=r;return}r=r.return}}function SI(n,r,o){var c=zn();o={lane:c,revertLane:0,gesture:null,action:o,hasEagerState:!1,eagerState:null,next:null},ed(n)?b0(r,o):(o=Pm(n,r,o,c),o!==null&&(An(o,n,c),E0(o,r,c)))}function _0(n,r,o){var c=zn();Nc(n,r,o,c)}function Nc(n,r,o,c){var m={lane:c,revertLane:0,gesture:null,action:o,hasEagerState:!1,eagerState:null,next:null};if(ed(n))b0(r,m);else{var g=n.alternate;if(n.lanes===0&&(g===null||g.lanes===0)&&(g=r.lastRenderedReducer,g!==null))try{var E=r.lastRenderedState,S=g(E,o);if(m.hasEagerState=!0,m.eagerState=S,On(S,E))return Oh(n,r,m,0),ut===null&&kh(),!1}catch{}if(o=Pm(n,r,m,c),o!==null)return An(o,n,c),E0(o,r,c),!0}return!1}function bp(n,r,o,c){if(c={lane:2,revertLane:Jp(),gesture:null,action:c,hasEagerState:!1,eagerState:null,next:null},ed(n)){if(r)throw Error(i(479))}else r=Pm(n,o,c,2),r!==null&&An(r,n,2)}function ed(n){var r=n.alternate;return n===Oe||r!==null&&r===Oe}function b0(n,r){Fo=Kh=!0;var o=n.pending;o===null?r.next=r:(r.next=o.next,o.next=r),n.pending=r}function E0(n,r,o){if((o&4194048)!==0){var c=r.lanes;c&=n.pendingLanes,o|=c,r.lanes=o,Zl(n,o)}}var jc={readContext:tn,use:Yh,useCallback:St,useContext:St,useEffect:St,useImperativeHandle:St,useLayoutEffect:St,useInsertionEffect:St,useMemo:St,useReducer:St,useRef:St,useState:St,useDebugValue:St,useDeferredValue:St,useTransition:St,useSyncExternalStore:St,useId:St,useHostTransitionStatus:St,useFormState:St,useActionState:St,useOptimistic:St,useMemoCache:St,useCacheRefresh:St};jc.useEffectEvent=St;var T0={readContext:tn,use:Yh,useCallback:function(n,r){return gn().memoizedState=[n,r===void 0?null:r],n},useContext:tn,useEffect:r0,useImperativeHandle:function(n,r,o){o=o!=null?o.concat([n]):null,Jh(4194308,4,c0.bind(null,r,n),o)},useLayoutEffect:function(n,r){return Jh(4194308,4,n,r)},useInsertionEffect:function(n,r){Jh(4,2,n,r)},useMemo:function(n,r){var o=gn();r=r===void 0?null:r;var c=n();if(ka){_n(!0);try{n()}finally{_n(!1)}}return o.memoizedState=[c,r],c},useReducer:function(n,r,o){var c=gn();if(o!==void 0){var m=o(r);if(ka){_n(!0);try{o(r)}finally{_n(!1)}}}else m=r;return c.memoizedState=c.baseState=m,n={pending:null,lanes:0,dispatch:null,lastRenderedReducer:n,lastRenderedState:m},c.queue=n,n=n.dispatch=SI.bind(null,Oe,n),[c.memoizedState,n]},useRef:function(n){var r=gn();return n={current:n},r.memoizedState=n},useState:function(n){n=fp(n);var r=n.queue,o=_0.bind(null,Oe,r);return r.dispatch=o,[n.memoizedState,o]},useDebugValue:gp,useDeferredValue:function(n,r){var o=gn();return yp(o,n,r)},useTransition:function(){var n=fp(!1);return n=m0.bind(null,Oe,n.queue,!0,!1),gn().memoizedState=n,[!1,n]},useSyncExternalStore:function(n,r,o){var c=Oe,m=gn();if(Ge){if(o===void 0)throw Error(i(407));o=o()}else{if(o=r(),ut===null)throw Error(i(349));(ze&127)!==0||q_(c,r,o)}m.memoizedState=o;var g={value:o,getSnapshot:r};return m.queue=g,r0(G_.bind(null,c,g,n),[n]),c.flags|=2048,Ho(9,{destroy:void 0},H_.bind(null,c,g,o,r),null),o},useId:function(){var n=gn(),r=ut.identifierPrefix;if(Ge){var o=Xi,c=Yi;o=(c&~(1<<32-de(c)-1)).toString(32)+o,r="_"+r+"R_"+o,o=$h++,0<o&&(r+="H"+o.toString(32)),r+="_"}else o=yI++,r="_"+r+"r_"+o.toString(32)+"_";return n.memoizedState=r},useHostTransitionStatus:_p,useFormState:e0,useActionState:e0,useOptimistic:function(n){var r=gn();r.memoizedState=r.baseState=n;var o={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return r.queue=o,r=bp.bind(null,Oe,!0,o),o.dispatch=r,[n,r]},useMemoCache:up,useCacheRefresh:function(){return gn().memoizedState=xI.bind(null,Oe)},useEffectEvent:function(n){var r=gn(),o={impl:n};return r.memoizedState=o,function(){if((Je&2)!==0)throw Error(i(440));return o.impl.apply(void 0,arguments)}}},Ep={readContext:tn,use:Yh,useCallback:h0,useContext:tn,useEffect:pp,useImperativeHandle:u0,useInsertionEffect:o0,useLayoutEffect:l0,useMemo:d0,useReducer:Xh,useRef:s0,useState:function(){return Xh(Cs)},useDebugValue:gp,useDeferredValue:function(n,r){var o=Dt();return f0(o,ot.memoizedState,n,r)},useTransition:function(){var n=Xh(Cs)[0],r=Dt().memoizedState;return[typeof n=="boolean"?n:Dc(n),r]},useSyncExternalStore:F_,useId:y0,useHostTransitionStatus:_p,useFormState:t0,useActionState:t0,useOptimistic:function(n,r){var o=Dt();return $_(o,ot,n,r)},useMemoCache:up,useCacheRefresh:v0};Ep.useEffectEvent=a0;var x0={readContext:tn,use:Yh,useCallback:h0,useContext:tn,useEffect:pp,useImperativeHandle:u0,useInsertionEffect:o0,useLayoutEffect:l0,useMemo:d0,useReducer:dp,useRef:s0,useState:function(){return dp(Cs)},useDebugValue:gp,useDeferredValue:function(n,r){var o=Dt();return ot===null?yp(o,n,r):f0(o,ot.memoizedState,n,r)},useTransition:function(){var n=dp(Cs)[0],r=Dt().memoizedState;return[typeof n=="boolean"?n:Dc(n),r]},useSyncExternalStore:F_,useId:y0,useHostTransitionStatus:_p,useFormState:i0,useActionState:i0,useOptimistic:function(n,r){var o=Dt();return ot!==null?$_(o,ot,n,r):(o.baseState=n,[n,o.queue.dispatch])},useMemoCache:up,useCacheRefresh:v0};x0.useEffectEvent=a0;function Tp(n,r,o,c){r=n.memoizedState,o=o(c,r),o=o==null?r:b({},r,o),n.memoizedState=o,n.lanes===0&&(n.updateQueue.baseState=o)}var xp={enqueueSetState:function(n,r,o){n=n._reactInternals;var c=zn(),m=pr(c);m.payload=r,o!=null&&(m.callback=o),r=gr(n,m,c),r!==null&&(An(r,n,c),Ac(r,n,c))},enqueueReplaceState:function(n,r,o){n=n._reactInternals;var c=zn(),m=pr(c);m.tag=1,m.payload=r,o!=null&&(m.callback=o),r=gr(n,m,c),r!==null&&(An(r,n,c),Ac(r,n,c))},enqueueForceUpdate:function(n,r){n=n._reactInternals;var o=zn(),c=pr(o);c.tag=2,r!=null&&(c.callback=r),r=gr(n,c,o),r!==null&&(An(r,n,o),Ac(r,n,o))}};function S0(n,r,o,c,m,g,E){return n=n.stateNode,typeof n.shouldComponentUpdate=="function"?n.shouldComponentUpdate(c,g,E):r.prototype&&r.prototype.isPureReactComponent?!vc(o,c)||!vc(m,g):!0}function w0(n,r,o,c){n=r.state,typeof r.componentWillReceiveProps=="function"&&r.componentWillReceiveProps(o,c),typeof r.UNSAFE_componentWillReceiveProps=="function"&&r.UNSAFE_componentWillReceiveProps(o,c),r.state!==n&&xp.enqueueReplaceState(r,r.state,null)}function Oa(n,r){var o=r;if("ref"in r){o={};for(var c in r)c!=="ref"&&(o[c]=r[c])}if(n=n.defaultProps){o===r&&(o=b({},o));for(var m in n)o[m]===void 0&&(o[m]=n[m])}return o}function A0(n){jh(n)}function I0(n){console.error(n)}function C0(n){jh(n)}function td(n,r){try{var o=n.onUncaughtError;o(r.value,{componentStack:r.stack})}catch(c){setTimeout(function(){throw c})}}function R0(n,r,o){try{var c=n.onCaughtError;c(o.value,{componentStack:o.stack,errorBoundary:r.tag===1?r.stateNode:null})}catch(m){setTimeout(function(){throw m})}}function Sp(n,r,o){return o=pr(o),o.tag=3,o.payload={element:null},o.callback=function(){td(n,r)},o}function D0(n){return n=pr(n),n.tag=3,n}function N0(n,r,o,c){var m=o.type.getDerivedStateFromError;if(typeof m=="function"){var g=c.value;n.payload=function(){return m(g)},n.callback=function(){R0(r,o,c)}}var E=o.stateNode;E!==null&&typeof E.componentDidCatch=="function"&&(n.callback=function(){R0(r,o,c),typeof m!="function"&&(Tr===null?Tr=new Set([this]):Tr.add(this));var S=c.stack;this.componentDidCatch(c.value,{componentStack:S!==null?S:""})})}function wI(n,r,o,c,m){if(o.flags|=32768,c!==null&&typeof c=="object"&&typeof c.then=="function"){if(r=o.alternate,r!==null&&Vo(r,o,m,!0),o=Vn.current,o!==null){switch(o.tag){case 31:case 13:return ii===null?fd():o.alternate===null&&wt===0&&(wt=3),o.flags&=-257,o.flags|=65536,o.lanes=m,c===Fh?o.flags|=16384:(r=o.updateQueue,r===null?o.updateQueue=new Set([c]):r.add(c),Wp(n,c,m)),!1;case 22:return o.flags|=65536,c===Fh?o.flags|=16384:(r=o.updateQueue,r===null?(r={transitions:null,markerInstances:null,retryQueue:new Set([c])},o.updateQueue=r):(o=r.retryQueue,o===null?r.retryQueue=new Set([c]):o.add(c)),Wp(n,c,m)),!1}throw Error(i(435,o.tag))}return Wp(n,c,m),fd(),!1}if(Ge)return r=Vn.current,r!==null?((r.flags&65536)===0&&(r.flags|=256),r.flags|=65536,r.lanes=m,c!==qm&&(n=Error(i(422),{cause:c}),Ec(Zn(n,o)))):(c!==qm&&(r=Error(i(423),{cause:c}),Ec(Zn(r,o))),n=n.current.alternate,n.flags|=65536,m&=-m,n.lanes|=m,c=Zn(c,o),m=Sp(n.stateNode,c,m),ep(n,m),wt!==4&&(wt=2)),!1;var g=Error(i(520),{cause:c});if(g=Zn(g,o),zc===null?zc=[g]:zc.push(g),wt!==4&&(wt=2),r===null)return!0;c=Zn(c,o),o=r;do{switch(o.tag){case 3:return o.flags|=65536,n=m&-m,o.lanes|=n,n=Sp(o.stateNode,c,n),ep(o,n),!1;case 1:if(r=o.type,g=o.stateNode,(o.flags&128)===0&&(typeof r.getDerivedStateFromError=="function"||g!==null&&typeof g.componentDidCatch=="function"&&(Tr===null||!Tr.has(g))))return o.flags|=65536,m&=-m,o.lanes|=m,m=D0(m),N0(m,n,o,c),ep(o,m),!1}o=o.return}while(o!==null);return!1}var wp=Error(i(461)),Ut=!1;function nn(n,r,o,c){r.child=n===null?M_(r,null,o,c):ja(r,n.child,o,c)}function j0(n,r,o,c,m){o=o.render;var g=r.ref;if("ref"in c){var E={};for(var S in c)S!=="ref"&&(E[S]=c[S])}else E=c;return Ca(r),c=ap(n,r,o,E,g,m),S=op(),n!==null&&!Ut?(lp(n,r,m),Rs(n,r,m)):(Ge&&S&&Bm(r),r.flags|=1,nn(n,r,c,m),r.child)}function k0(n,r,o,c,m){if(n===null){var g=o.type;return typeof g=="function"&&!Lm(g)&&g.defaultProps===void 0&&o.compare===null?(r.tag=15,r.type=g,O0(n,r,g,c,m)):(n=Vh(o.type,null,c,r,r.mode,m),n.ref=r.ref,n.return=r,r.child=n)}if(g=n.child,!kp(n,m)){var E=g.memoizedProps;if(o=o.compare,o=o!==null?o:vc,o(E,c)&&n.ref===r.ref)return Rs(n,r,m)}return r.flags|=1,n=xs(g,c),n.ref=r.ref,n.return=r,r.child=n}function O0(n,r,o,c,m){if(n!==null){var g=n.memoizedProps;if(vc(g,c)&&n.ref===r.ref)if(Ut=!1,r.pendingProps=c=g,kp(n,m))(n.flags&131072)!==0&&(Ut=!0);else return r.lanes=n.lanes,Rs(n,r,m)}return Ap(n,r,o,c,m)}function M0(n,r,o,c){var m=c.children,g=n!==null?n.memoizedState:null;if(n===null&&r.stateNode===null&&(r.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),c.mode==="hidden"){if((r.flags&128)!==0){if(g=g!==null?g.baseLanes|o:o,n!==null){for(c=r.child=n.child,m=0;c!==null;)m=m|c.lanes|c.childLanes,c=c.sibling;c=m&~g}else c=0,r.child=null;return V0(n,r,g,o,c)}if((o&536870912)!==0)r.memoizedState={baseLanes:0,cachePool:null},n!==null&&zh(r,g!==null?g.cachePool:null),g!==null?L_(r,g):np(),U_(r);else return c=r.lanes=536870912,V0(n,r,g!==null?g.baseLanes|o:o,o,c)}else g!==null?(zh(r,g.cachePool),L_(r,g),vr(),r.memoizedState=null):(n!==null&&zh(r,null),np(),vr());return nn(n,r,m,o),r.child}function kc(n,r){return n!==null&&n.tag===22||r.stateNode!==null||(r.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),r.sibling}function V0(n,r,o,c,m){var g=Ym();return g=g===null?null:{parent:Pt._currentValue,pool:g},r.memoizedState={baseLanes:o,cachePool:g},n!==null&&zh(r,null),np(),U_(r),n!==null&&Vo(n,r,c,!0),r.childLanes=m,null}function nd(n,r){return r=sd({mode:r.mode,children:r.children},n.mode),r.ref=n.ref,n.child=r,r.return=n,r}function P0(n,r,o){return ja(r,n.child,null,o),n=nd(r,r.pendingProps),n.flags|=2,Pn(r),r.memoizedState=null,n}function AI(n,r,o){var c=r.pendingProps,m=(r.flags&128)!==0;if(r.flags&=-129,n===null){if(Ge){if(c.mode==="hidden")return n=nd(r,c),r.lanes=536870912,kc(null,n);if(sp(r),(n=pt)?(n=Wb(n,ni),n=n!==null&&n.data==="&"?n:null,n!==null&&(r.memoizedState={dehydrated:n,treeContext:ur!==null?{id:Yi,overflow:Xi}:null,retryLane:536870912,hydrationErrors:null},o=b_(n),o.return=r,r.child=o,en=r,pt=null)):n=null,n===null)throw dr(r);return r.lanes=536870912,null}return nd(r,c)}var g=n.memoizedState;if(g!==null){var E=g.dehydrated;if(sp(r),m)if(r.flags&256)r.flags&=-257,r=P0(n,r,o);else if(r.memoizedState!==null)r.child=n.child,r.flags|=128,r=null;else throw Error(i(558));else if(Ut||Vo(n,r,o,!1),m=(o&n.childLanes)!==0,Ut||m){if(c=ut,c!==null&&(E=ec(c,o),E!==0&&E!==g.retryLane))throw g.retryLane=E,Sa(n,E),An(c,n,E),wp;fd(),r=P0(n,r,o)}else n=g.treeContext,pt=si(E.nextSibling),en=r,Ge=!0,hr=null,ni=!1,n!==null&&x_(r,n),r=nd(r,c),r.flags|=4096;return r}return n=xs(n.child,{mode:c.mode,children:c.children}),n.ref=r.ref,r.child=n,n.return=r,n}function id(n,r){var o=r.ref;if(o===null)n!==null&&n.ref!==null&&(r.flags|=4194816);else{if(typeof o!="function"&&typeof o!="object")throw Error(i(284));(n===null||n.ref!==o)&&(r.flags|=4194816)}}function Ap(n,r,o,c,m){return Ca(r),o=ap(n,r,o,c,void 0,m),c=op(),n!==null&&!Ut?(lp(n,r,m),Rs(n,r,m)):(Ge&&c&&Bm(r),r.flags|=1,nn(n,r,o,m),r.child)}function L0(n,r,o,c,m,g){return Ca(r),r.updateQueue=null,o=B_(r,c,o,m),z_(n),c=op(),n!==null&&!Ut?(lp(n,r,g),Rs(n,r,g)):(Ge&&c&&Bm(r),r.flags|=1,nn(n,r,o,g),r.child)}function U0(n,r,o,c,m){if(Ca(r),r.stateNode===null){var g=jo,E=o.contextType;typeof E=="object"&&E!==null&&(g=tn(E)),g=new o(c,g),r.memoizedState=g.state!==null&&g.state!==void 0?g.state:null,g.updater=xp,r.stateNode=g,g._reactInternals=r,g=r.stateNode,g.props=c,g.state=r.memoizedState,g.refs={},Jm(r),E=o.contextType,g.context=typeof E=="object"&&E!==null?tn(E):jo,g.state=r.memoizedState,E=o.getDerivedStateFromProps,typeof E=="function"&&(Tp(r,o,E,c),g.state=r.memoizedState),typeof o.getDerivedStateFromProps=="function"||typeof g.getSnapshotBeforeUpdate=="function"||typeof g.UNSAFE_componentWillMount!="function"&&typeof g.componentWillMount!="function"||(E=g.state,typeof g.componentWillMount=="function"&&g.componentWillMount(),typeof g.UNSAFE_componentWillMount=="function"&&g.UNSAFE_componentWillMount(),E!==g.state&&xp.enqueueReplaceState(g,g.state,null),Cc(r,c,g,m),Ic(),g.state=r.memoizedState),typeof g.componentDidMount=="function"&&(r.flags|=4194308),c=!0}else if(n===null){g=r.stateNode;var S=r.memoizedProps,P=Oa(o,S);g.props=P;var $=g.context,se=o.contextType;E=jo,typeof se=="object"&&se!==null&&(E=tn(se));var oe=o.getDerivedStateFromProps;se=typeof oe=="function"||typeof g.getSnapshotBeforeUpdate=="function",S=r.pendingProps!==S,se||typeof g.UNSAFE_componentWillReceiveProps!="function"&&typeof g.componentWillReceiveProps!="function"||(S||$!==E)&&w0(r,g,c,E),mr=!1;var W=r.memoizedState;g.state=W,Cc(r,c,g,m),Ic(),$=r.memoizedState,S||W!==$||mr?(typeof oe=="function"&&(Tp(r,o,oe,c),$=r.memoizedState),(P=mr||S0(r,o,P,c,W,$,E))?(se||typeof g.UNSAFE_componentWillMount!="function"&&typeof g.componentWillMount!="function"||(typeof g.componentWillMount=="function"&&g.componentWillMount(),typeof g.UNSAFE_componentWillMount=="function"&&g.UNSAFE_componentWillMount()),typeof g.componentDidMount=="function"&&(r.flags|=4194308)):(typeof g.componentDidMount=="function"&&(r.flags|=4194308),r.memoizedProps=c,r.memoizedState=$),g.props=c,g.state=$,g.context=E,c=P):(typeof g.componentDidMount=="function"&&(r.flags|=4194308),c=!1)}else{g=r.stateNode,Zm(n,r),E=r.memoizedProps,se=Oa(o,E),g.props=se,oe=r.pendingProps,W=g.context,$=o.contextType,P=jo,typeof $=="object"&&$!==null&&(P=tn($)),S=o.getDerivedStateFromProps,($=typeof S=="function"||typeof g.getSnapshotBeforeUpdate=="function")||typeof g.UNSAFE_componentWillReceiveProps!="function"&&typeof g.componentWillReceiveProps!="function"||(E!==oe||W!==P)&&w0(r,g,c,P),mr=!1,W=r.memoizedState,g.state=W,Cc(r,c,g,m),Ic();var Z=r.memoizedState;E!==oe||W!==Z||mr||n!==null&&n.dependencies!==null&&Lh(n.dependencies)?(typeof S=="function"&&(Tp(r,o,S,c),Z=r.memoizedState),(se=mr||S0(r,o,se,c,W,Z,P)||n!==null&&n.dependencies!==null&&Lh(n.dependencies))?($||typeof g.UNSAFE_componentWillUpdate!="function"&&typeof g.componentWillUpdate!="function"||(typeof g.componentWillUpdate=="function"&&g.componentWillUpdate(c,Z,P),typeof g.UNSAFE_componentWillUpdate=="function"&&g.UNSAFE_componentWillUpdate(c,Z,P)),typeof g.componentDidUpdate=="function"&&(r.flags|=4),typeof g.getSnapshotBeforeUpdate=="function"&&(r.flags|=1024)):(typeof g.componentDidUpdate!="function"||E===n.memoizedProps&&W===n.memoizedState||(r.flags|=4),typeof g.getSnapshotBeforeUpdate!="function"||E===n.memoizedProps&&W===n.memoizedState||(r.flags|=1024),r.memoizedProps=c,r.memoizedState=Z),g.props=c,g.state=Z,g.context=P,c=se):(typeof g.componentDidUpdate!="function"||E===n.memoizedProps&&W===n.memoizedState||(r.flags|=4),typeof g.getSnapshotBeforeUpdate!="function"||E===n.memoizedProps&&W===n.memoizedState||(r.flags|=1024),c=!1)}return g=c,id(n,r),c=(r.flags&128)!==0,g||c?(g=r.stateNode,o=c&&typeof o.getDerivedStateFromError!="function"?null:g.render(),r.flags|=1,n!==null&&c?(r.child=ja(r,n.child,null,m),r.child=ja(r,null,o,m)):nn(n,r,o,m),r.memoizedState=g.state,n=r.child):n=Rs(n,r,m),n}function z0(n,r,o,c){return Aa(),r.flags|=256,nn(n,r,o,c),r.child}var Ip={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function Cp(n){return{baseLanes:n,cachePool:R_()}}function Rp(n,r,o){return n=n!==null?n.childLanes&~o:0,r&&(n|=Un),n}function B0(n,r,o){var c=r.pendingProps,m=!1,g=(r.flags&128)!==0,E;if((E=g)||(E=n!==null&&n.memoizedState===null?!1:(Rt.current&2)!==0),E&&(m=!0,r.flags&=-129),E=(r.flags&32)!==0,r.flags&=-33,n===null){if(Ge){if(m?yr(r):vr(),(n=pt)?(n=Wb(n,ni),n=n!==null&&n.data!=="&"?n:null,n!==null&&(r.memoizedState={dehydrated:n,treeContext:ur!==null?{id:Yi,overflow:Xi}:null,retryLane:536870912,hydrationErrors:null},o=b_(n),o.return=r,r.child=o,en=r,pt=null)):n=null,n===null)throw dr(r);return hg(n)?r.lanes=32:r.lanes=536870912,null}var S=c.children;return c=c.fallback,m?(vr(),m=r.mode,S=sd({mode:"hidden",children:S},m),c=wa(c,m,o,null),S.return=r,c.return=r,S.sibling=c,r.child=S,c=r.child,c.memoizedState=Cp(o),c.childLanes=Rp(n,E,o),r.memoizedState=Ip,kc(null,c)):(yr(r),Dp(r,S))}var P=n.memoizedState;if(P!==null&&(S=P.dehydrated,S!==null)){if(g)r.flags&256?(yr(r),r.flags&=-257,r=Np(n,r,o)):r.memoizedState!==null?(vr(),r.child=n.child,r.flags|=128,r=null):(vr(),S=c.fallback,m=r.mode,c=sd({mode:"visible",children:c.children},m),S=wa(S,m,o,null),S.flags|=2,c.return=r,S.return=r,c.sibling=S,r.child=c,ja(r,n.child,null,o),c=r.child,c.memoizedState=Cp(o),c.childLanes=Rp(n,E,o),r.memoizedState=Ip,r=kc(null,c));else if(yr(r),hg(S)){if(E=S.nextSibling&&S.nextSibling.dataset,E)var $=E.dgst;E=$,c=Error(i(419)),c.stack="",c.digest=E,Ec({value:c,source:null,stack:null}),r=Np(n,r,o)}else if(Ut||Vo(n,r,o,!1),E=(o&n.childLanes)!==0,Ut||E){if(E=ut,E!==null&&(c=ec(E,o),c!==0&&c!==P.retryLane))throw P.retryLane=c,Sa(n,c),An(E,n,c),wp;ug(S)||fd(),r=Np(n,r,o)}else ug(S)?(r.flags|=192,r.child=n.child,r=null):(n=P.treeContext,pt=si(S.nextSibling),en=r,Ge=!0,hr=null,ni=!1,n!==null&&x_(r,n),r=Dp(r,c.children),r.flags|=4096);return r}return m?(vr(),S=c.fallback,m=r.mode,P=n.child,$=P.sibling,c=xs(P,{mode:"hidden",children:c.children}),c.subtreeFlags=P.subtreeFlags&65011712,$!==null?S=xs($,S):(S=wa(S,m,o,null),S.flags|=2),S.return=r,c.return=r,c.sibling=S,r.child=c,kc(null,c),c=r.child,S=n.child.memoizedState,S===null?S=Cp(o):(m=S.cachePool,m!==null?(P=Pt._currentValue,m=m.parent!==P?{parent:P,pool:P}:m):m=R_(),S={baseLanes:S.baseLanes|o,cachePool:m}),c.memoizedState=S,c.childLanes=Rp(n,E,o),r.memoizedState=Ip,kc(n.child,c)):(yr(r),o=n.child,n=o.sibling,o=xs(o,{mode:"visible",children:c.children}),o.return=r,o.sibling=null,n!==null&&(E=r.deletions,E===null?(r.deletions=[n],r.flags|=16):E.push(n)),r.child=o,r.memoizedState=null,o)}function Dp(n,r){return r=sd({mode:"visible",children:r},n.mode),r.return=n,n.child=r}function sd(n,r){return n=Mn(22,n,null,r),n.lanes=0,n}function Np(n,r,o){return ja(r,n.child,null,o),n=Dp(r,r.pendingProps.children),n.flags|=2,r.memoizedState=null,n}function F0(n,r,o){n.lanes|=r;var c=n.alternate;c!==null&&(c.lanes|=r),Qm(n.return,r,o)}function jp(n,r,o,c,m,g){var E=n.memoizedState;E===null?n.memoizedState={isBackwards:r,rendering:null,renderingStartTime:0,last:c,tail:o,tailMode:m,treeForkCount:g}:(E.isBackwards=r,E.rendering=null,E.renderingStartTime=0,E.last=c,E.tail=o,E.tailMode=m,E.treeForkCount=g)}function q0(n,r,o){var c=r.pendingProps,m=c.revealOrder,g=c.tail;c=c.children;var E=Rt.current,S=(E&2)!==0;if(S?(E=E&1|2,r.flags|=128):E&=1,ue(Rt,E),nn(n,r,c,o),c=Ge?bc:0,!S&&n!==null&&(n.flags&128)!==0)e:for(n=r.child;n!==null;){if(n.tag===13)n.memoizedState!==null&&F0(n,o,r);else if(n.tag===19)F0(n,o,r);else if(n.child!==null){n.child.return=n,n=n.child;continue}if(n===r)break e;for(;n.sibling===null;){if(n.return===null||n.return===r)break e;n=n.return}n.sibling.return=n.return,n=n.sibling}switch(m){case"forwards":for(o=r.child,m=null;o!==null;)n=o.alternate,n!==null&&Qh(n)===null&&(m=o),o=o.sibling;o=m,o===null?(m=r.child,r.child=null):(m=o.sibling,o.sibling=null),jp(r,!1,m,o,g,c);break;case"backwards":case"unstable_legacy-backwards":for(o=null,m=r.child,r.child=null;m!==null;){if(n=m.alternate,n!==null&&Qh(n)===null){r.child=m;break}n=m.sibling,m.sibling=o,o=m,m=n}jp(r,!0,o,null,g,c);break;case"together":jp(r,!1,null,null,void 0,c);break;default:r.memoizedState=null}return r.child}function Rs(n,r,o){if(n!==null&&(r.dependencies=n.dependencies),Er|=r.lanes,(o&r.childLanes)===0)if(n!==null){if(Vo(n,r,o,!1),(o&r.childLanes)===0)return null}else return null;if(n!==null&&r.child!==n.child)throw Error(i(153));if(r.child!==null){for(n=r.child,o=xs(n,n.pendingProps),r.child=o,o.return=r;n.sibling!==null;)n=n.sibling,o=o.sibling=xs(n,n.pendingProps),o.return=r;o.sibling=null}return r.child}function kp(n,r){return(n.lanes&r)!==0?!0:(n=n.dependencies,!!(n!==null&&Lh(n)))}function II(n,r,o){switch(r.tag){case 3:Qe(r,r.stateNode.containerInfo),fr(r,Pt,n.memoizedState.cache),Aa();break;case 27:case 5:Di(r);break;case 4:Qe(r,r.stateNode.containerInfo);break;case 10:fr(r,r.type,r.memoizedProps.value);break;case 31:if(r.memoizedState!==null)return r.flags|=128,sp(r),null;break;case 13:var c=r.memoizedState;if(c!==null)return c.dehydrated!==null?(yr(r),r.flags|=128,null):(o&r.child.childLanes)!==0?B0(n,r,o):(yr(r),n=Rs(n,r,o),n!==null?n.sibling:null);yr(r);break;case 19:var m=(n.flags&128)!==0;if(c=(o&r.childLanes)!==0,c||(Vo(n,r,o,!1),c=(o&r.childLanes)!==0),m){if(c)return q0(n,r,o);r.flags|=128}if(m=r.memoizedState,m!==null&&(m.rendering=null,m.tail=null,m.lastEffect=null),ue(Rt,Rt.current),c)break;return null;case 22:return r.lanes=0,M0(n,r,o,r.pendingProps);case 24:fr(r,Pt,n.memoizedState.cache)}return Rs(n,r,o)}function H0(n,r,o){if(n!==null)if(n.memoizedProps!==r.pendingProps)Ut=!0;else{if(!kp(n,o)&&(r.flags&128)===0)return Ut=!1,II(n,r,o);Ut=(n.flags&131072)!==0}else Ut=!1,Ge&&(r.flags&1048576)!==0&&T_(r,bc,r.index);switch(r.lanes=0,r.tag){case 16:e:{var c=r.pendingProps;if(n=Da(r.elementType),r.type=n,typeof n=="function")Lm(n)?(c=Oa(n,c),r.tag=1,r=U0(null,r,n,c,o)):(r.tag=0,r=Ap(null,r,n,c,o));else{if(n!=null){var m=n.$$typeof;if(m===ie){r.tag=11,r=j0(null,r,n,c,o);break e}else if(m===C){r.tag=14,r=k0(null,r,n,c,o);break e}}throw r=Se(n)||n,Error(i(306,r,""))}}return r;case 0:return Ap(n,r,r.type,r.pendingProps,o);case 1:return c=r.type,m=Oa(c,r.pendingProps),U0(n,r,c,m,o);case 3:e:{if(Qe(r,r.stateNode.containerInfo),n===null)throw Error(i(387));c=r.pendingProps;var g=r.memoizedState;m=g.element,Zm(n,r),Cc(r,c,null,o);var E=r.memoizedState;if(c=E.cache,fr(r,Pt,c),c!==g.cache&&Km(r,[Pt],o,!0),Ic(),c=E.element,g.isDehydrated)if(g={element:c,isDehydrated:!1,cache:E.cache},r.updateQueue.baseState=g,r.memoizedState=g,r.flags&256){r=z0(n,r,c,o);break e}else if(c!==m){m=Zn(Error(i(424)),r),Ec(m),r=z0(n,r,c,o);break e}else for(n=r.stateNode.containerInfo,n.nodeType===9?n=n.body:n=n.nodeName==="HTML"?n.ownerDocument.body:n,pt=si(n.firstChild),en=r,Ge=!0,hr=null,ni=!0,o=M_(r,null,c,o),r.child=o;o;)o.flags=o.flags&-3|4096,o=o.sibling;else{if(Aa(),c===m){r=Rs(n,r,o);break e}nn(n,r,c,o)}r=r.child}return r;case 26:return id(n,r),n===null?(o=tE(r.type,null,r.pendingProps,null))?r.memoizedState=o:Ge||(o=r.type,n=r.pendingProps,c=bd(Ie.current).createElement(o),c[Ot]=r,c[$t]=n,sn(c,o,n),Mt(c),r.stateNode=c):r.memoizedState=tE(r.type,n.memoizedProps,r.pendingProps,n.memoizedState),null;case 27:return Di(r),n===null&&Ge&&(c=r.stateNode=Jb(r.type,r.pendingProps,Ie.current),en=r,ni=!0,m=pt,Ar(r.type)?(dg=m,pt=si(c.firstChild)):pt=m),nn(n,r,r.pendingProps.children,o),id(n,r),n===null&&(r.flags|=4194304),r.child;case 5:return n===null&&Ge&&((m=c=pt)&&(c=i2(c,r.type,r.pendingProps,ni),c!==null?(r.stateNode=c,en=r,pt=si(c.firstChild),ni=!1,m=!0):m=!1),m||dr(r)),Di(r),m=r.type,g=r.pendingProps,E=n!==null?n.memoizedProps:null,c=g.children,og(m,g)?c=null:E!==null&&og(m,E)&&(r.flags|=32),r.memoizedState!==null&&(m=ap(n,r,vI,null,null,o),$c._currentValue=m),id(n,r),nn(n,r,c,o),r.child;case 6:return n===null&&Ge&&((n=o=pt)&&(o=s2(o,r.pendingProps,ni),o!==null?(r.stateNode=o,en=r,pt=null,n=!0):n=!1),n||dr(r)),null;case 13:return B0(n,r,o);case 4:return Qe(r,r.stateNode.containerInfo),c=r.pendingProps,n===null?r.child=ja(r,null,c,o):nn(n,r,c,o),r.child;case 11:return j0(n,r,r.type,r.pendingProps,o);case 7:return nn(n,r,r.pendingProps,o),r.child;case 8:return nn(n,r,r.pendingProps.children,o),r.child;case 12:return nn(n,r,r.pendingProps.children,o),r.child;case 10:return c=r.pendingProps,fr(r,r.type,c.value),nn(n,r,c.children,o),r.child;case 9:return m=r.type._context,c=r.pendingProps.children,Ca(r),m=tn(m),c=c(m),r.flags|=1,nn(n,r,c,o),r.child;case 14:return k0(n,r,r.type,r.pendingProps,o);case 15:return O0(n,r,r.type,r.pendingProps,o);case 19:return q0(n,r,o);case 31:return AI(n,r,o);case 22:return M0(n,r,o,r.pendingProps);case 24:return Ca(r),c=tn(Pt),n===null?(m=Ym(),m===null&&(m=ut,g=$m(),m.pooledCache=g,g.refCount++,g!==null&&(m.pooledCacheLanes|=o),m=g),r.memoizedState={parent:c,cache:m},Jm(r),fr(r,Pt,m)):((n.lanes&o)!==0&&(Zm(n,r),Cc(r,null,null,o),Ic()),m=n.memoizedState,g=r.memoizedState,m.parent!==c?(m={parent:c,cache:c},r.memoizedState=m,r.lanes===0&&(r.memoizedState=r.updateQueue.baseState=m),fr(r,Pt,c)):(c=g.cache,fr(r,Pt,c),c!==m.cache&&Km(r,[Pt],o,!0))),nn(n,r,r.pendingProps.children,o),r.child;case 29:throw r.pendingProps}throw Error(i(156,r.tag))}function Ds(n){n.flags|=4}function Op(n,r,o,c,m){if((r=(n.mode&32)!==0)&&(r=!1),r){if(n.flags|=16777216,(m&335544128)===m)if(n.stateNode.complete)n.flags|=8192;else if(yb())n.flags|=8192;else throw Na=Fh,Xm}else n.flags&=-16777217}function G0(n,r){if(r.type!=="stylesheet"||(r.state.loading&4)!==0)n.flags&=-16777217;else if(n.flags|=16777216,!aE(r))if(yb())n.flags|=8192;else throw Na=Fh,Xm}function rd(n,r){r!==null&&(n.flags|=4),n.flags&16384&&(r=n.tag!==22?hh():536870912,n.lanes|=r,$o|=r)}function Oc(n,r){if(!Ge)switch(n.tailMode){case"hidden":r=n.tail;for(var o=null;r!==null;)r.alternate!==null&&(o=r),r=r.sibling;o===null?n.tail=null:o.sibling=null;break;case"collapsed":o=n.tail;for(var c=null;o!==null;)o.alternate!==null&&(c=o),o=o.sibling;c===null?r||n.tail===null?n.tail=null:n.tail.sibling=null:c.sibling=null}}function gt(n){var r=n.alternate!==null&&n.alternate.child===n.child,o=0,c=0;if(r)for(var m=n.child;m!==null;)o|=m.lanes|m.childLanes,c|=m.subtreeFlags&65011712,c|=m.flags&65011712,m.return=n,m=m.sibling;else for(m=n.child;m!==null;)o|=m.lanes|m.childLanes,c|=m.subtreeFlags,c|=m.flags,m.return=n,m=m.sibling;return n.subtreeFlags|=c,n.childLanes=o,r}function CI(n,r,o){var c=r.pendingProps;switch(Fm(r),r.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return gt(r),null;case 1:return gt(r),null;case 3:return o=r.stateNode,c=null,n!==null&&(c=n.memoizedState.cache),r.memoizedState.cache!==c&&(r.flags|=2048),As(Pt),$e(),o.pendingContext&&(o.context=o.pendingContext,o.pendingContext=null),(n===null||n.child===null)&&(Mo(r)?Ds(r):n===null||n.memoizedState.isDehydrated&&(r.flags&256)===0||(r.flags|=1024,Hm())),gt(r),null;case 26:var m=r.type,g=r.memoizedState;return n===null?(Ds(r),g!==null?(gt(r),G0(r,g)):(gt(r),Op(r,m,null,c,o))):g?g!==n.memoizedState?(Ds(r),gt(r),G0(r,g)):(gt(r),r.flags&=-16777217):(n=n.memoizedProps,n!==c&&Ds(r),gt(r),Op(r,m,n,c,o)),null;case 27:if(ps(r),o=Ie.current,m=r.type,n!==null&&r.stateNode!=null)n.memoizedProps!==c&&Ds(r);else{if(!c){if(r.stateNode===null)throw Error(i(166));return gt(r),null}n=re.current,Mo(r)?S_(r):(n=Jb(m,c,o),r.stateNode=n,Ds(r))}return gt(r),null;case 5:if(ps(r),m=r.type,n!==null&&r.stateNode!=null)n.memoizedProps!==c&&Ds(r);else{if(!c){if(r.stateNode===null)throw Error(i(166));return gt(r),null}if(g=re.current,Mo(r))S_(r);else{var E=bd(Ie.current);switch(g){case 1:g=E.createElementNS("http://www.w3.org/2000/svg",m);break;case 2:g=E.createElementNS("http://www.w3.org/1998/Math/MathML",m);break;default:switch(m){case"svg":g=E.createElementNS("http://www.w3.org/2000/svg",m);break;case"math":g=E.createElementNS("http://www.w3.org/1998/Math/MathML",m);break;case"script":g=E.createElement("div"),g.innerHTML="<script><\/script>",g=g.removeChild(g.firstChild);break;case"select":g=typeof c.is=="string"?E.createElement("select",{is:c.is}):E.createElement("select"),c.multiple?g.multiple=!0:c.size&&(g.size=c.size);break;default:g=typeof c.is=="string"?E.createElement(m,{is:c.is}):E.createElement(m)}}g[Ot]=r,g[$t]=c;e:for(E=r.child;E!==null;){if(E.tag===5||E.tag===6)g.appendChild(E.stateNode);else if(E.tag!==4&&E.tag!==27&&E.child!==null){E.child.return=E,E=E.child;continue}if(E===r)break e;for(;E.sibling===null;){if(E.return===null||E.return===r)break e;E=E.return}E.sibling.return=E.return,E=E.sibling}r.stateNode=g;e:switch(sn(g,m,c),m){case"button":case"input":case"select":case"textarea":c=!!c.autoFocus;break e;case"img":c=!0;break e;default:c=!1}c&&Ds(r)}}return gt(r),Op(r,r.type,n===null?null:n.memoizedProps,r.pendingProps,o),null;case 6:if(n&&r.stateNode!=null)n.memoizedProps!==c&&Ds(r);else{if(typeof c!="string"&&r.stateNode===null)throw Error(i(166));if(n=Ie.current,Mo(r)){if(n=r.stateNode,o=r.memoizedProps,c=null,m=en,m!==null)switch(m.tag){case 27:case 5:c=m.memoizedProps}n[Ot]=r,n=!!(n.nodeValue===o||c!==null&&c.suppressHydrationWarning===!0||Bb(n.nodeValue,o)),n||dr(r,!0)}else n=bd(n).createTextNode(c),n[Ot]=r,r.stateNode=n}return gt(r),null;case 31:if(o=r.memoizedState,n===null||n.memoizedState!==null){if(c=Mo(r),o!==null){if(n===null){if(!c)throw Error(i(318));if(n=r.memoizedState,n=n!==null?n.dehydrated:null,!n)throw Error(i(557));n[Ot]=r}else Aa(),(r.flags&128)===0&&(r.memoizedState=null),r.flags|=4;gt(r),n=!1}else o=Hm(),n!==null&&n.memoizedState!==null&&(n.memoizedState.hydrationErrors=o),n=!0;if(!n)return r.flags&256?(Pn(r),r):(Pn(r),null);if((r.flags&128)!==0)throw Error(i(558))}return gt(r),null;case 13:if(c=r.memoizedState,n===null||n.memoizedState!==null&&n.memoizedState.dehydrated!==null){if(m=Mo(r),c!==null&&c.dehydrated!==null){if(n===null){if(!m)throw Error(i(318));if(m=r.memoizedState,m=m!==null?m.dehydrated:null,!m)throw Error(i(317));m[Ot]=r}else Aa(),(r.flags&128)===0&&(r.memoizedState=null),r.flags|=4;gt(r),m=!1}else m=Hm(),n!==null&&n.memoizedState!==null&&(n.memoizedState.hydrationErrors=m),m=!0;if(!m)return r.flags&256?(Pn(r),r):(Pn(r),null)}return Pn(r),(r.flags&128)!==0?(r.lanes=o,r):(o=c!==null,n=n!==null&&n.memoizedState!==null,o&&(c=r.child,m=null,c.alternate!==null&&c.alternate.memoizedState!==null&&c.alternate.memoizedState.cachePool!==null&&(m=c.alternate.memoizedState.cachePool.pool),g=null,c.memoizedState!==null&&c.memoizedState.cachePool!==null&&(g=c.memoizedState.cachePool.pool),g!==m&&(c.flags|=2048)),o!==n&&o&&(r.child.flags|=8192),rd(r,r.updateQueue),gt(r),null);case 4:return $e(),n===null&&ng(r.stateNode.containerInfo),gt(r),null;case 10:return As(r.type),gt(r),null;case 19:if(z(Rt),c=r.memoizedState,c===null)return gt(r),null;if(m=(r.flags&128)!==0,g=c.rendering,g===null)if(m)Oc(c,!1);else{if(wt!==0||n!==null&&(n.flags&128)!==0)for(n=r.child;n!==null;){if(g=Qh(n),g!==null){for(r.flags|=128,Oc(c,!1),n=g.updateQueue,r.updateQueue=n,rd(r,n),r.subtreeFlags=0,n=o,o=r.child;o!==null;)__(o,n),o=o.sibling;return ue(Rt,Rt.current&1|2),Ge&&Ss(r,c.treeForkCount),r.child}n=n.sibling}c.tail!==null&&vt()>ud&&(r.flags|=128,m=!0,Oc(c,!1),r.lanes=4194304)}else{if(!m)if(n=Qh(g),n!==null){if(r.flags|=128,m=!0,n=n.updateQueue,r.updateQueue=n,rd(r,n),Oc(c,!0),c.tail===null&&c.tailMode==="hidden"&&!g.alternate&&!Ge)return gt(r),null}else 2*vt()-c.renderingStartTime>ud&&o!==536870912&&(r.flags|=128,m=!0,Oc(c,!1),r.lanes=4194304);c.isBackwards?(g.sibling=r.child,r.child=g):(n=c.last,n!==null?n.sibling=g:r.child=g,c.last=g)}return c.tail!==null?(n=c.tail,c.rendering=n,c.tail=n.sibling,c.renderingStartTime=vt(),n.sibling=null,o=Rt.current,ue(Rt,m?o&1|2:o&1),Ge&&Ss(r,c.treeForkCount),n):(gt(r),null);case 22:case 23:return Pn(r),ip(),c=r.memoizedState!==null,n!==null?n.memoizedState!==null!==c&&(r.flags|=8192):c&&(r.flags|=8192),c?(o&536870912)!==0&&(r.flags&128)===0&&(gt(r),r.subtreeFlags&6&&(r.flags|=8192)):gt(r),o=r.updateQueue,o!==null&&rd(r,o.retryQueue),o=null,n!==null&&n.memoizedState!==null&&n.memoizedState.cachePool!==null&&(o=n.memoizedState.cachePool.pool),c=null,r.memoizedState!==null&&r.memoizedState.cachePool!==null&&(c=r.memoizedState.cachePool.pool),c!==o&&(r.flags|=2048),n!==null&&z(Ra),null;case 24:return o=null,n!==null&&(o=n.memoizedState.cache),r.memoizedState.cache!==o&&(r.flags|=2048),As(Pt),gt(r),null;case 25:return null;case 30:return null}throw Error(i(156,r.tag))}function RI(n,r){switch(Fm(r),r.tag){case 1:return n=r.flags,n&65536?(r.flags=n&-65537|128,r):null;case 3:return As(Pt),$e(),n=r.flags,(n&65536)!==0&&(n&128)===0?(r.flags=n&-65537|128,r):null;case 26:case 27:case 5:return ps(r),null;case 31:if(r.memoizedState!==null){if(Pn(r),r.alternate===null)throw Error(i(340));Aa()}return n=r.flags,n&65536?(r.flags=n&-65537|128,r):null;case 13:if(Pn(r),n=r.memoizedState,n!==null&&n.dehydrated!==null){if(r.alternate===null)throw Error(i(340));Aa()}return n=r.flags,n&65536?(r.flags=n&-65537|128,r):null;case 19:return z(Rt),null;case 4:return $e(),null;case 10:return As(r.type),null;case 22:case 23:return Pn(r),ip(),n!==null&&z(Ra),n=r.flags,n&65536?(r.flags=n&-65537|128,r):null;case 24:return As(Pt),null;case 25:return null;default:return null}}function Q0(n,r){switch(Fm(r),r.tag){case 3:As(Pt),$e();break;case 26:case 27:case 5:ps(r);break;case 4:$e();break;case 31:r.memoizedState!==null&&Pn(r);break;case 13:Pn(r);break;case 19:z(Rt);break;case 10:As(r.type);break;case 22:case 23:Pn(r),ip(),n!==null&&z(Ra);break;case 24:As(Pt)}}function Mc(n,r){try{var o=r.updateQueue,c=o!==null?o.lastEffect:null;if(c!==null){var m=c.next;o=m;do{if((o.tag&n)===n){c=void 0;var g=o.create,E=o.inst;c=g(),E.destroy=c}o=o.next}while(o!==m)}}catch(S){nt(r,r.return,S)}}function _r(n,r,o){try{var c=r.updateQueue,m=c!==null?c.lastEffect:null;if(m!==null){var g=m.next;c=g;do{if((c.tag&n)===n){var E=c.inst,S=E.destroy;if(S!==void 0){E.destroy=void 0,m=r;var P=o,$=S;try{$()}catch(se){nt(m,P,se)}}}c=c.next}while(c!==g)}}catch(se){nt(r,r.return,se)}}function K0(n){var r=n.updateQueue;if(r!==null){var o=n.stateNode;try{P_(r,o)}catch(c){nt(n,n.return,c)}}}function $0(n,r,o){o.props=Oa(n.type,n.memoizedProps),o.state=n.memoizedState;try{o.componentWillUnmount()}catch(c){nt(n,r,c)}}function Vc(n,r){try{var o=n.ref;if(o!==null){switch(n.tag){case 26:case 27:case 5:var c=n.stateNode;break;case 30:c=n.stateNode;break;default:c=n.stateNode}typeof o=="function"?n.refCleanup=o(c):o.current=c}}catch(m){nt(n,r,m)}}function Ji(n,r){var o=n.ref,c=n.refCleanup;if(o!==null)if(typeof c=="function")try{c()}catch(m){nt(n,r,m)}finally{n.refCleanup=null,n=n.alternate,n!=null&&(n.refCleanup=null)}else if(typeof o=="function")try{o(null)}catch(m){nt(n,r,m)}else o.current=null}function W0(n){var r=n.type,o=n.memoizedProps,c=n.stateNode;try{e:switch(r){case"button":case"input":case"select":case"textarea":o.autoFocus&&c.focus();break e;case"img":o.src?c.src=o.src:o.srcSet&&(c.srcset=o.srcSet)}}catch(m){nt(n,n.return,m)}}function Mp(n,r,o){try{var c=n.stateNode;XI(c,n.type,o,r),c[$t]=r}catch(m){nt(n,n.return,m)}}function Y0(n){return n.tag===5||n.tag===3||n.tag===26||n.tag===27&&Ar(n.type)||n.tag===4}function Vp(n){e:for(;;){for(;n.sibling===null;){if(n.return===null||Y0(n.return))return null;n=n.return}for(n.sibling.return=n.return,n=n.sibling;n.tag!==5&&n.tag!==6&&n.tag!==18;){if(n.tag===27&&Ar(n.type)||n.flags&2||n.child===null||n.tag===4)continue e;n.child.return=n,n=n.child}if(!(n.flags&2))return n.stateNode}}function Pp(n,r,o){var c=n.tag;if(c===5||c===6)n=n.stateNode,r?(o.nodeType===9?o.body:o.nodeName==="HTML"?o.ownerDocument.body:o).insertBefore(n,r):(r=o.nodeType===9?o.body:o.nodeName==="HTML"?o.ownerDocument.body:o,r.appendChild(n),o=o._reactRootContainer,o!=null||r.onclick!==null||(r.onclick=pi));else if(c!==4&&(c===27&&Ar(n.type)&&(o=n.stateNode,r=null),n=n.child,n!==null))for(Pp(n,r,o),n=n.sibling;n!==null;)Pp(n,r,o),n=n.sibling}function ad(n,r,o){var c=n.tag;if(c===5||c===6)n=n.stateNode,r?o.insertBefore(n,r):o.appendChild(n);else if(c!==4&&(c===27&&Ar(n.type)&&(o=n.stateNode),n=n.child,n!==null))for(ad(n,r,o),n=n.sibling;n!==null;)ad(n,r,o),n=n.sibling}function X0(n){var r=n.stateNode,o=n.memoizedProps;try{for(var c=n.type,m=r.attributes;m.length;)r.removeAttributeNode(m[0]);sn(r,c,o),r[Ot]=n,r[$t]=o}catch(g){nt(n,n.return,g)}}var Ns=!1,zt=!1,Lp=!1,J0=typeof WeakSet=="function"?WeakSet:Set,Yt=null;function DI(n,r){if(n=n.containerInfo,rg=Id,n=u_(n),Nm(n)){if("selectionStart"in n)var o={start:n.selectionStart,end:n.selectionEnd};else e:{o=(o=n.ownerDocument)&&o.defaultView||window;var c=o.getSelection&&o.getSelection();if(c&&c.rangeCount!==0){o=c.anchorNode;var m=c.anchorOffset,g=c.focusNode;c=c.focusOffset;try{o.nodeType,g.nodeType}catch{o=null;break e}var E=0,S=-1,P=-1,$=0,se=0,oe=n,W=null;t:for(;;){for(var Z;oe!==o||m!==0&&oe.nodeType!==3||(S=E+m),oe!==g||c!==0&&oe.nodeType!==3||(P=E+c),oe.nodeType===3&&(E+=oe.nodeValue.length),(Z=oe.firstChild)!==null;)W=oe,oe=Z;for(;;){if(oe===n)break t;if(W===o&&++$===m&&(S=E),W===g&&++se===c&&(P=E),(Z=oe.nextSibling)!==null)break;oe=W,W=oe.parentNode}oe=Z}o=S===-1||P===-1?null:{start:S,end:P}}else o=null}o=o||{start:0,end:0}}else o=null;for(ag={focusedElem:n,selectionRange:o},Id=!1,Yt=r;Yt!==null;)if(r=Yt,n=r.child,(r.subtreeFlags&1028)!==0&&n!==null)n.return=r,Yt=n;else for(;Yt!==null;){switch(r=Yt,g=r.alternate,n=r.flags,r.tag){case 0:if((n&4)!==0&&(n=r.updateQueue,n=n!==null?n.events:null,n!==null))for(o=0;o<n.length;o++)m=n[o],m.ref.impl=m.nextImpl;break;case 11:case 15:break;case 1:if((n&1024)!==0&&g!==null){n=void 0,o=r,m=g.memoizedProps,g=g.memoizedState,c=o.stateNode;try{var _e=Oa(o.type,m);n=c.getSnapshotBeforeUpdate(_e,g),c.__reactInternalSnapshotBeforeUpdate=n}catch(Ce){nt(o,o.return,Ce)}}break;case 3:if((n&1024)!==0){if(n=r.stateNode.containerInfo,o=n.nodeType,o===9)cg(n);else if(o===1)switch(n.nodeName){case"HEAD":case"HTML":case"BODY":cg(n);break;default:n.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((n&1024)!==0)throw Error(i(163))}if(n=r.sibling,n!==null){n.return=r.return,Yt=n;break}Yt=r.return}}function Z0(n,r,o){var c=o.flags;switch(o.tag){case 0:case 11:case 15:ks(n,o),c&4&&Mc(5,o);break;case 1:if(ks(n,o),c&4)if(n=o.stateNode,r===null)try{n.componentDidMount()}catch(E){nt(o,o.return,E)}else{var m=Oa(o.type,r.memoizedProps);r=r.memoizedState;try{n.componentDidUpdate(m,r,n.__reactInternalSnapshotBeforeUpdate)}catch(E){nt(o,o.return,E)}}c&64&&K0(o),c&512&&Vc(o,o.return);break;case 3:if(ks(n,o),c&64&&(n=o.updateQueue,n!==null)){if(r=null,o.child!==null)switch(o.child.tag){case 27:case 5:r=o.child.stateNode;break;case 1:r=o.child.stateNode}try{P_(n,r)}catch(E){nt(o,o.return,E)}}break;case 27:r===null&&c&4&&X0(o);case 26:case 5:ks(n,o),r===null&&c&4&&W0(o),c&512&&Vc(o,o.return);break;case 12:ks(n,o);break;case 31:ks(n,o),c&4&&nb(n,o);break;case 13:ks(n,o),c&4&&ib(n,o),c&64&&(n=o.memoizedState,n!==null&&(n=n.dehydrated,n!==null&&(o=UI.bind(null,o),r2(n,o))));break;case 22:if(c=o.memoizedState!==null||Ns,!c){r=r!==null&&r.memoizedState!==null||zt,m=Ns;var g=zt;Ns=c,(zt=r)&&!g?Os(n,o,(o.subtreeFlags&8772)!==0):ks(n,o),Ns=m,zt=g}break;case 30:break;default:ks(n,o)}}function eb(n){var r=n.alternate;r!==null&&(n.alternate=null,eb(r)),n.child=null,n.deletions=null,n.sibling=null,n.tag===5&&(r=n.stateNode,r!==null&&vo(r)),n.stateNode=null,n.return=null,n.dependencies=null,n.memoizedProps=null,n.memoizedState=null,n.pendingProps=null,n.stateNode=null,n.updateQueue=null}var bt=null,Tn=!1;function js(n,r,o){for(o=o.child;o!==null;)tb(n,r,o),o=o.sibling}function tb(n,r,o){if(qt&&typeof qt.onCommitFiberUnmount=="function")try{qt.onCommitFiberUnmount(Dn,o)}catch{}switch(o.tag){case 26:zt||Ji(o,r),js(n,r,o),o.memoizedState?o.memoizedState.count--:o.stateNode&&(o=o.stateNode,o.parentNode.removeChild(o));break;case 27:zt||Ji(o,r);var c=bt,m=Tn;Ar(o.type)&&(bt=o.stateNode,Tn=!1),js(n,r,o),Gc(o.stateNode),bt=c,Tn=m;break;case 5:zt||Ji(o,r);case 6:if(c=bt,m=Tn,bt=null,js(n,r,o),bt=c,Tn=m,bt!==null)if(Tn)try{(bt.nodeType===9?bt.body:bt.nodeName==="HTML"?bt.ownerDocument.body:bt).removeChild(o.stateNode)}catch(g){nt(o,r,g)}else try{bt.removeChild(o.stateNode)}catch(g){nt(o,r,g)}break;case 18:bt!==null&&(Tn?(n=bt,Kb(n.nodeType===9?n.body:n.nodeName==="HTML"?n.ownerDocument.body:n,o.stateNode),nl(n)):Kb(bt,o.stateNode));break;case 4:c=bt,m=Tn,bt=o.stateNode.containerInfo,Tn=!0,js(n,r,o),bt=c,Tn=m;break;case 0:case 11:case 14:case 15:_r(2,o,r),zt||_r(4,o,r),js(n,r,o);break;case 1:zt||(Ji(o,r),c=o.stateNode,typeof c.componentWillUnmount=="function"&&$0(o,r,c)),js(n,r,o);break;case 21:js(n,r,o);break;case 22:zt=(c=zt)||o.memoizedState!==null,js(n,r,o),zt=c;break;default:js(n,r,o)}}function nb(n,r){if(r.memoizedState===null&&(n=r.alternate,n!==null&&(n=n.memoizedState,n!==null))){n=n.dehydrated;try{nl(n)}catch(o){nt(r,r.return,o)}}}function ib(n,r){if(r.memoizedState===null&&(n=r.alternate,n!==null&&(n=n.memoizedState,n!==null&&(n=n.dehydrated,n!==null))))try{nl(n)}catch(o){nt(r,r.return,o)}}function NI(n){switch(n.tag){case 31:case 13:case 19:var r=n.stateNode;return r===null&&(r=n.stateNode=new J0),r;case 22:return n=n.stateNode,r=n._retryCache,r===null&&(r=n._retryCache=new J0),r;default:throw Error(i(435,n.tag))}}function od(n,r){var o=NI(n);r.forEach(function(c){if(!o.has(c)){o.add(c);var m=zI.bind(null,n,c);c.then(m,m)}})}function xn(n,r){var o=r.deletions;if(o!==null)for(var c=0;c<o.length;c++){var m=o[c],g=n,E=r,S=E;e:for(;S!==null;){switch(S.tag){case 27:if(Ar(S.type)){bt=S.stateNode,Tn=!1;break e}break;case 5:bt=S.stateNode,Tn=!1;break e;case 3:case 4:bt=S.stateNode.containerInfo,Tn=!0;break e}S=S.return}if(bt===null)throw Error(i(160));tb(g,E,m),bt=null,Tn=!1,g=m.alternate,g!==null&&(g.return=null),m.return=null}if(r.subtreeFlags&13886)for(r=r.child;r!==null;)sb(r,n),r=r.sibling}var Ei=null;function sb(n,r){var o=n.alternate,c=n.flags;switch(n.tag){case 0:case 11:case 14:case 15:xn(r,n),Sn(n),c&4&&(_r(3,n,n.return),Mc(3,n),_r(5,n,n.return));break;case 1:xn(r,n),Sn(n),c&512&&(zt||o===null||Ji(o,o.return)),c&64&&Ns&&(n=n.updateQueue,n!==null&&(c=n.callbacks,c!==null&&(o=n.shared.hiddenCallbacks,n.shared.hiddenCallbacks=o===null?c:o.concat(c))));break;case 26:var m=Ei;if(xn(r,n),Sn(n),c&512&&(zt||o===null||Ji(o,o.return)),c&4){var g=o!==null?o.memoizedState:null;if(c=n.memoizedState,o===null)if(c===null)if(n.stateNode===null){e:{c=n.type,o=n.memoizedProps,m=m.ownerDocument||m;t:switch(c){case"title":g=m.getElementsByTagName("title")[0],(!g||g[Li]||g[Ot]||g.namespaceURI==="http://www.w3.org/2000/svg"||g.hasAttribute("itemprop"))&&(g=m.createElement(c),m.head.insertBefore(g,m.querySelector("head > title"))),sn(g,c,o),g[Ot]=n,Mt(g),c=g;break e;case"link":var E=sE("link","href",m).get(c+(o.href||""));if(E){for(var S=0;S<E.length;S++)if(g=E[S],g.getAttribute("href")===(o.href==null||o.href===""?null:o.href)&&g.getAttribute("rel")===(o.rel==null?null:o.rel)&&g.getAttribute("title")===(o.title==null?null:o.title)&&g.getAttribute("crossorigin")===(o.crossOrigin==null?null:o.crossOrigin)){E.splice(S,1);break t}}g=m.createElement(c),sn(g,c,o),m.head.appendChild(g);break;case"meta":if(E=sE("meta","content",m).get(c+(o.content||""))){for(S=0;S<E.length;S++)if(g=E[S],g.getAttribute("content")===(o.content==null?null:""+o.content)&&g.getAttribute("name")===(o.name==null?null:o.name)&&g.getAttribute("property")===(o.property==null?null:o.property)&&g.getAttribute("http-equiv")===(o.httpEquiv==null?null:o.httpEquiv)&&g.getAttribute("charset")===(o.charSet==null?null:o.charSet)){E.splice(S,1);break t}}g=m.createElement(c),sn(g,c,o),m.head.appendChild(g);break;default:throw Error(i(468,c))}g[Ot]=n,Mt(g),c=g}n.stateNode=c}else rE(m,n.type,n.stateNode);else n.stateNode=iE(m,c,n.memoizedProps);else g!==c?(g===null?o.stateNode!==null&&(o=o.stateNode,o.parentNode.removeChild(o)):g.count--,c===null?rE(m,n.type,n.stateNode):iE(m,c,n.memoizedProps)):c===null&&n.stateNode!==null&&Mp(n,n.memoizedProps,o.memoizedProps)}break;case 27:xn(r,n),Sn(n),c&512&&(zt||o===null||Ji(o,o.return)),o!==null&&c&4&&Mp(n,n.memoizedProps,o.memoizedProps);break;case 5:if(xn(r,n),Sn(n),c&512&&(zt||o===null||Ji(o,o.return)),n.flags&32){m=n.stateNode;try{En(m,"")}catch(_e){nt(n,n.return,_e)}}c&4&&n.stateNode!=null&&(m=n.memoizedProps,Mp(n,m,o!==null?o.memoizedProps:m)),c&1024&&(Lp=!0);break;case 6:if(xn(r,n),Sn(n),c&4){if(n.stateNode===null)throw Error(i(162));c=n.memoizedProps,o=n.stateNode;try{o.nodeValue=c}catch(_e){nt(n,n.return,_e)}}break;case 3:if(xd=null,m=Ei,Ei=Ed(r.containerInfo),xn(r,n),Ei=m,Sn(n),c&4&&o!==null&&o.memoizedState.isDehydrated)try{nl(r.containerInfo)}catch(_e){nt(n,n.return,_e)}Lp&&(Lp=!1,rb(n));break;case 4:c=Ei,Ei=Ed(n.stateNode.containerInfo),xn(r,n),Sn(n),Ei=c;break;case 12:xn(r,n),Sn(n);break;case 31:xn(r,n),Sn(n),c&4&&(c=n.updateQueue,c!==null&&(n.updateQueue=null,od(n,c)));break;case 13:xn(r,n),Sn(n),n.child.flags&8192&&n.memoizedState!==null!=(o!==null&&o.memoizedState!==null)&&(cd=vt()),c&4&&(c=n.updateQueue,c!==null&&(n.updateQueue=null,od(n,c)));break;case 22:m=n.memoizedState!==null;var P=o!==null&&o.memoizedState!==null,$=Ns,se=zt;if(Ns=$||m,zt=se||P,xn(r,n),zt=se,Ns=$,Sn(n),c&8192)e:for(r=n.stateNode,r._visibility=m?r._visibility&-2:r._visibility|1,m&&(o===null||P||Ns||zt||Ma(n)),o=null,r=n;;){if(r.tag===5||r.tag===26){if(o===null){P=o=r;try{if(g=P.stateNode,m)E=g.style,typeof E.setProperty=="function"?E.setProperty("display","none","important"):E.display="none";else{S=P.stateNode;var oe=P.memoizedProps.style,W=oe!=null&&oe.hasOwnProperty("display")?oe.display:null;S.style.display=W==null||typeof W=="boolean"?"":(""+W).trim()}}catch(_e){nt(P,P.return,_e)}}}else if(r.tag===6){if(o===null){P=r;try{P.stateNode.nodeValue=m?"":P.memoizedProps}catch(_e){nt(P,P.return,_e)}}}else if(r.tag===18){if(o===null){P=r;try{var Z=P.stateNode;m?$b(Z,!0):$b(P.stateNode,!1)}catch(_e){nt(P,P.return,_e)}}}else if((r.tag!==22&&r.tag!==23||r.memoizedState===null||r===n)&&r.child!==null){r.child.return=r,r=r.child;continue}if(r===n)break e;for(;r.sibling===null;){if(r.return===null||r.return===n)break e;o===r&&(o=null),r=r.return}o===r&&(o=null),r.sibling.return=r.return,r=r.sibling}c&4&&(c=n.updateQueue,c!==null&&(o=c.retryQueue,o!==null&&(c.retryQueue=null,od(n,o))));break;case 19:xn(r,n),Sn(n),c&4&&(c=n.updateQueue,c!==null&&(n.updateQueue=null,od(n,c)));break;case 30:break;case 21:break;default:xn(r,n),Sn(n)}}function Sn(n){var r=n.flags;if(r&2){try{for(var o,c=n.return;c!==null;){if(Y0(c)){o=c;break}c=c.return}if(o==null)throw Error(i(160));switch(o.tag){case 27:var m=o.stateNode,g=Vp(n);ad(n,g,m);break;case 5:var E=o.stateNode;o.flags&32&&(En(E,""),o.flags&=-33);var S=Vp(n);ad(n,S,E);break;case 3:case 4:var P=o.stateNode.containerInfo,$=Vp(n);Pp(n,$,P);break;default:throw Error(i(161))}}catch(se){nt(n,n.return,se)}n.flags&=-3}r&4096&&(n.flags&=-4097)}function rb(n){if(n.subtreeFlags&1024)for(n=n.child;n!==null;){var r=n;rb(r),r.tag===5&&r.flags&1024&&r.stateNode.reset(),n=n.sibling}}function ks(n,r){if(r.subtreeFlags&8772)for(r=r.child;r!==null;)Z0(n,r.alternate,r),r=r.sibling}function Ma(n){for(n=n.child;n!==null;){var r=n;switch(r.tag){case 0:case 11:case 14:case 15:_r(4,r,r.return),Ma(r);break;case 1:Ji(r,r.return);var o=r.stateNode;typeof o.componentWillUnmount=="function"&&$0(r,r.return,o),Ma(r);break;case 27:Gc(r.stateNode);case 26:case 5:Ji(r,r.return),Ma(r);break;case 22:r.memoizedState===null&&Ma(r);break;case 30:Ma(r);break;default:Ma(r)}n=n.sibling}}function Os(n,r,o){for(o=o&&(r.subtreeFlags&8772)!==0,r=r.child;r!==null;){var c=r.alternate,m=n,g=r,E=g.flags;switch(g.tag){case 0:case 11:case 15:Os(m,g,o),Mc(4,g);break;case 1:if(Os(m,g,o),c=g,m=c.stateNode,typeof m.componentDidMount=="function")try{m.componentDidMount()}catch($){nt(c,c.return,$)}if(c=g,m=c.updateQueue,m!==null){var S=c.stateNode;try{var P=m.shared.hiddenCallbacks;if(P!==null)for(m.shared.hiddenCallbacks=null,m=0;m<P.length;m++)V_(P[m],S)}catch($){nt(c,c.return,$)}}o&&E&64&&K0(g),Vc(g,g.return);break;case 27:X0(g);case 26:case 5:Os(m,g,o),o&&c===null&&E&4&&W0(g),Vc(g,g.return);break;case 12:Os(m,g,o);break;case 31:Os(m,g,o),o&&E&4&&nb(m,g);break;case 13:Os(m,g,o),o&&E&4&&ib(m,g);break;case 22:g.memoizedState===null&&Os(m,g,o),Vc(g,g.return);break;case 30:break;default:Os(m,g,o)}r=r.sibling}}function Up(n,r){var o=null;n!==null&&n.memoizedState!==null&&n.memoizedState.cachePool!==null&&(o=n.memoizedState.cachePool.pool),n=null,r.memoizedState!==null&&r.memoizedState.cachePool!==null&&(n=r.memoizedState.cachePool.pool),n!==o&&(n!=null&&n.refCount++,o!=null&&Tc(o))}function zp(n,r){n=null,r.alternate!==null&&(n=r.alternate.memoizedState.cache),r=r.memoizedState.cache,r!==n&&(r.refCount++,n!=null&&Tc(n))}function Ti(n,r,o,c){if(r.subtreeFlags&10256)for(r=r.child;r!==null;)ab(n,r,o,c),r=r.sibling}function ab(n,r,o,c){var m=r.flags;switch(r.tag){case 0:case 11:case 15:Ti(n,r,o,c),m&2048&&Mc(9,r);break;case 1:Ti(n,r,o,c);break;case 3:Ti(n,r,o,c),m&2048&&(n=null,r.alternate!==null&&(n=r.alternate.memoizedState.cache),r=r.memoizedState.cache,r!==n&&(r.refCount++,n!=null&&Tc(n)));break;case 12:if(m&2048){Ti(n,r,o,c),n=r.stateNode;try{var g=r.memoizedProps,E=g.id,S=g.onPostCommit;typeof S=="function"&&S(E,r.alternate===null?"mount":"update",n.passiveEffectDuration,-0)}catch(P){nt(r,r.return,P)}}else Ti(n,r,o,c);break;case 31:Ti(n,r,o,c);break;case 13:Ti(n,r,o,c);break;case 23:break;case 22:g=r.stateNode,E=r.alternate,r.memoizedState!==null?g._visibility&2?Ti(n,r,o,c):Pc(n,r):g._visibility&2?Ti(n,r,o,c):(g._visibility|=2,Go(n,r,o,c,(r.subtreeFlags&10256)!==0||!1)),m&2048&&Up(E,r);break;case 24:Ti(n,r,o,c),m&2048&&zp(r.alternate,r);break;default:Ti(n,r,o,c)}}function Go(n,r,o,c,m){for(m=m&&((r.subtreeFlags&10256)!==0||!1),r=r.child;r!==null;){var g=n,E=r,S=o,P=c,$=E.flags;switch(E.tag){case 0:case 11:case 15:Go(g,E,S,P,m),Mc(8,E);break;case 23:break;case 22:var se=E.stateNode;E.memoizedState!==null?se._visibility&2?Go(g,E,S,P,m):Pc(g,E):(se._visibility|=2,Go(g,E,S,P,m)),m&&$&2048&&Up(E.alternate,E);break;case 24:Go(g,E,S,P,m),m&&$&2048&&zp(E.alternate,E);break;default:Go(g,E,S,P,m)}r=r.sibling}}function Pc(n,r){if(r.subtreeFlags&10256)for(r=r.child;r!==null;){var o=n,c=r,m=c.flags;switch(c.tag){case 22:Pc(o,c),m&2048&&Up(c.alternate,c);break;case 24:Pc(o,c),m&2048&&zp(c.alternate,c);break;default:Pc(o,c)}r=r.sibling}}var Lc=8192;function Qo(n,r,o){if(n.subtreeFlags&Lc)for(n=n.child;n!==null;)ob(n,r,o),n=n.sibling}function ob(n,r,o){switch(n.tag){case 26:Qo(n,r,o),n.flags&Lc&&n.memoizedState!==null&&y2(o,Ei,n.memoizedState,n.memoizedProps);break;case 5:Qo(n,r,o);break;case 3:case 4:var c=Ei;Ei=Ed(n.stateNode.containerInfo),Qo(n,r,o),Ei=c;break;case 22:n.memoizedState===null&&(c=n.alternate,c!==null&&c.memoizedState!==null?(c=Lc,Lc=16777216,Qo(n,r,o),Lc=c):Qo(n,r,o));break;default:Qo(n,r,o)}}function lb(n){var r=n.alternate;if(r!==null&&(n=r.child,n!==null)){r.child=null;do r=n.sibling,n.sibling=null,n=r;while(n!==null)}}function Uc(n){var r=n.deletions;if((n.flags&16)!==0){if(r!==null)for(var o=0;o<r.length;o++){var c=r[o];Yt=c,ub(c,n)}lb(n)}if(n.subtreeFlags&10256)for(n=n.child;n!==null;)cb(n),n=n.sibling}function cb(n){switch(n.tag){case 0:case 11:case 15:Uc(n),n.flags&2048&&_r(9,n,n.return);break;case 3:Uc(n);break;case 12:Uc(n);break;case 22:var r=n.stateNode;n.memoizedState!==null&&r._visibility&2&&(n.return===null||n.return.tag!==13)?(r._visibility&=-3,ld(n)):Uc(n);break;default:Uc(n)}}function ld(n){var r=n.deletions;if((n.flags&16)!==0){if(r!==null)for(var o=0;o<r.length;o++){var c=r[o];Yt=c,ub(c,n)}lb(n)}for(n=n.child;n!==null;){switch(r=n,r.tag){case 0:case 11:case 15:_r(8,r,r.return),ld(r);break;case 22:o=r.stateNode,o._visibility&2&&(o._visibility&=-3,ld(r));break;default:ld(r)}n=n.sibling}}function ub(n,r){for(;Yt!==null;){var o=Yt;switch(o.tag){case 0:case 11:case 15:_r(8,o,r);break;case 23:case 22:if(o.memoizedState!==null&&o.memoizedState.cachePool!==null){var c=o.memoizedState.cachePool.pool;c!=null&&c.refCount++}break;case 24:Tc(o.memoizedState.cache)}if(c=o.child,c!==null)c.return=o,Yt=c;else e:for(o=n;Yt!==null;){c=Yt;var m=c.sibling,g=c.return;if(eb(c),c===o){Yt=null;break e}if(m!==null){m.return=g,Yt=m;break e}Yt=g}}}var jI={getCacheForType:function(n){var r=tn(Pt),o=r.data.get(n);return o===void 0&&(o=n(),r.data.set(n,o)),o},cacheSignal:function(){return tn(Pt).controller.signal}},kI=typeof WeakMap=="function"?WeakMap:Map,Je=0,ut=null,Le=null,ze=0,tt=0,Ln=null,br=!1,Ko=!1,Bp=!1,Ms=0,wt=0,Er=0,Va=0,Fp=0,Un=0,$o=0,zc=null,wn=null,qp=!1,cd=0,hb=0,ud=1/0,hd=null,Tr=null,Ht=0,xr=null,Wo=null,Vs=0,Hp=0,Gp=null,db=null,Bc=0,Qp=null;function zn(){return(Je&2)!==0&&ze!==0?ze&-ze:G.T!==null?Jp():dh()}function fb(){if(Un===0)if((ze&536870912)===0||Ge){var n=vs;vs<<=1,(vs&3932160)===0&&(vs=262144),Un=n}else Un=536870912;return n=Vn.current,n!==null&&(n.flags|=32),Un}function An(n,r,o){(n===ut&&(tt===2||tt===9)||n.cancelPendingCommit!==null)&&(Yo(n,0),Sr(n,ze,Un,!1)),ua(n,o),((Je&2)===0||n!==ut)&&(n===ut&&((Je&2)===0&&(Va|=o),wt===4&&Sr(n,ze,Un,!1)),Zi(n))}function mb(n,r,o){if((Je&6)!==0)throw Error(i(327));var c=!o&&(r&127)===0&&(r&n.expiredLanes)===0||di(n,r),m=c?VI(n,r):$p(n,r,!0),g=c;do{if(m===0){Ko&&!c&&Sr(n,r,0,!1);break}else{if(o=n.current.alternate,g&&!OI(o)){m=$p(n,r,!1),g=!1;continue}if(m===2){if(g=r,n.errorRecoveryDisabledLanes&g)var E=0;else E=n.pendingLanes&-536870913,E=E!==0?E:E&536870912?536870912:0;if(E!==0){r=E;e:{var S=n;m=zc;var P=S.current.memoizedState.isDehydrated;if(P&&(Yo(S,E).flags|=256),E=$p(S,E,!1),E!==2){if(Bp&&!P){S.errorRecoveryDisabledLanes|=g,Va|=g,m=4;break e}g=wn,wn=m,g!==null&&(wn===null?wn=g:wn.push.apply(wn,g))}m=E}if(g=!1,m!==2)continue}}if(m===1){Yo(n,0),Sr(n,r,0,!0);break}e:{switch(c=n,g=m,g){case 0:case 1:throw Error(i(345));case 4:if((r&4194048)!==r)break;case 6:Sr(c,r,Un,!br);break e;case 2:wn=null;break;case 3:case 5:break;default:throw Error(i(329))}if((r&62914560)===r&&(m=cd+300-vt(),10<m)){if(Sr(c,r,Un,!br),Mi(c,0,!0)!==0)break e;Vs=r,c.timeoutHandle=Gb(pb.bind(null,c,o,wn,hd,qp,r,Un,Va,$o,br,g,"Throttled",-0,0),m);break e}pb(c,o,wn,hd,qp,r,Un,Va,$o,br,g,null,-0,0)}}break}while(!0);Zi(n)}function pb(n,r,o,c,m,g,E,S,P,$,se,oe,W,Z){if(n.timeoutHandle=-1,oe=r.subtreeFlags,oe&8192||(oe&16785408)===16785408){oe={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:pi},ob(r,g,oe);var _e=(g&62914560)===g?cd-vt():(g&4194048)===g?hb-vt():0;if(_e=v2(oe,_e),_e!==null){Vs=g,n.cancelPendingCommit=_e(xb.bind(null,n,r,g,o,c,m,E,S,P,se,oe,null,W,Z)),Sr(n,g,E,!$);return}}xb(n,r,g,o,c,m,E,S,P)}function OI(n){for(var r=n;;){var o=r.tag;if((o===0||o===11||o===15)&&r.flags&16384&&(o=r.updateQueue,o!==null&&(o=o.stores,o!==null)))for(var c=0;c<o.length;c++){var m=o[c],g=m.getSnapshot;m=m.value;try{if(!On(g(),m))return!1}catch{return!1}}if(o=r.child,r.subtreeFlags&16384&&o!==null)o.return=r,r=o;else{if(r===n)break;for(;r.sibling===null;){if(r.return===null||r.return===n)return!0;r=r.return}r.sibling.return=r.return,r=r.sibling}}return!0}function Sr(n,r,o,c){r&=~Fp,r&=~Va,n.suspendedLanes|=r,n.pingedLanes&=~r,c&&(n.warmLanes|=r),c=n.expirationTimes;for(var m=r;0<m;){var g=31-de(m),E=1<<g;c[g]=-1,m&=~E}o!==0&&ha(n,o,r)}function dd(){return(Je&6)===0?(Fc(0),!1):!0}function Kp(){if(Le!==null){if(tt===0)var n=Le.return;else n=Le,ws=Ia=null,cp(n),zo=null,Sc=0,n=Le;for(;n!==null;)Q0(n.alternate,n),n=n.return;Le=null}}function Yo(n,r){var o=n.timeoutHandle;o!==-1&&(n.timeoutHandle=-1,e2(o)),o=n.cancelPendingCommit,o!==null&&(n.cancelPendingCommit=null,o()),Vs=0,Kp(),ut=n,Le=o=xs(n.current,null),ze=r,tt=0,Ln=null,br=!1,Ko=di(n,r),Bp=!1,$o=Un=Fp=Va=Er=wt=0,wn=zc=null,qp=!1,(r&8)!==0&&(r|=r&32);var c=n.entangledLanes;if(c!==0)for(n=n.entanglements,c&=r;0<c;){var m=31-de(c),g=1<<m;r|=n[m],c&=~g}return Ms=r,kh(),o}function gb(n,r){Oe=null,G.H=jc,r===Uo||r===Bh?(r=j_(),tt=3):r===Xm?(r=j_(),tt=4):tt=r===wp?8:r!==null&&typeof r=="object"&&typeof r.then=="function"?6:1,Ln=r,Le===null&&(wt=1,td(n,Zn(r,n.current)))}function yb(){var n=Vn.current;return n===null?!0:(ze&4194048)===ze?ii===null:(ze&62914560)===ze||(ze&536870912)!==0?n===ii:!1}function vb(){var n=G.H;return G.H=jc,n===null?jc:n}function _b(){var n=G.A;return G.A=jI,n}function fd(){wt=4,br||(ze&4194048)!==ze&&Vn.current!==null||(Ko=!0),(Er&134217727)===0&&(Va&134217727)===0||ut===null||Sr(ut,ze,Un,!1)}function $p(n,r,o){var c=Je;Je|=2;var m=vb(),g=_b();(ut!==n||ze!==r)&&(hd=null,Yo(n,r)),r=!1;var E=wt;e:do try{if(tt!==0&&Le!==null){var S=Le,P=Ln;switch(tt){case 8:Kp(),E=6;break e;case 3:case 2:case 9:case 6:Vn.current===null&&(r=!0);var $=tt;if(tt=0,Ln=null,Xo(n,S,P,$),o&&Ko){E=0;break e}break;default:$=tt,tt=0,Ln=null,Xo(n,S,P,$)}}MI(),E=wt;break}catch(se){gb(n,se)}while(!0);return r&&n.shellSuspendCounter++,ws=Ia=null,Je=c,G.H=m,G.A=g,Le===null&&(ut=null,ze=0,kh()),E}function MI(){for(;Le!==null;)bb(Le)}function VI(n,r){var o=Je;Je|=2;var c=vb(),m=_b();ut!==n||ze!==r?(hd=null,ud=vt()+500,Yo(n,r)):Ko=di(n,r);e:do try{if(tt!==0&&Le!==null){r=Le;var g=Ln;t:switch(tt){case 1:tt=0,Ln=null,Xo(n,r,g,1);break;case 2:case 9:if(D_(g)){tt=0,Ln=null,Eb(r);break}r=function(){tt!==2&&tt!==9||ut!==n||(tt=7),Zi(n)},g.then(r,r);break e;case 3:tt=7;break e;case 4:tt=5;break e;case 7:D_(g)?(tt=0,Ln=null,Eb(r)):(tt=0,Ln=null,Xo(n,r,g,7));break;case 5:var E=null;switch(Le.tag){case 26:E=Le.memoizedState;case 5:case 27:var S=Le;if(E?aE(E):S.stateNode.complete){tt=0,Ln=null;var P=S.sibling;if(P!==null)Le=P;else{var $=S.return;$!==null?(Le=$,md($)):Le=null}break t}}tt=0,Ln=null,Xo(n,r,g,5);break;case 6:tt=0,Ln=null,Xo(n,r,g,6);break;case 8:Kp(),wt=6;break e;default:throw Error(i(462))}}PI();break}catch(se){gb(n,se)}while(!0);return ws=Ia=null,G.H=c,G.A=m,Je=o,Le!==null?0:(ut=null,ze=0,kh(),wt)}function PI(){for(;Le!==null&&!fo();)bb(Le)}function bb(n){var r=H0(n.alternate,n,Ms);n.memoizedProps=n.pendingProps,r===null?md(n):Le=r}function Eb(n){var r=n,o=r.alternate;switch(r.tag){case 15:case 0:r=L0(o,r,r.pendingProps,r.type,void 0,ze);break;case 11:r=L0(o,r,r.pendingProps,r.type.render,r.ref,ze);break;case 5:cp(r);default:Q0(o,r),r=Le=__(r,Ms),r=H0(o,r,Ms)}n.memoizedProps=n.pendingProps,r===null?md(n):Le=r}function Xo(n,r,o,c){ws=Ia=null,cp(r),zo=null,Sc=0;var m=r.return;try{if(wI(n,m,r,o,ze)){wt=1,td(n,Zn(o,n.current)),Le=null;return}}catch(g){if(m!==null)throw Le=m,g;wt=1,td(n,Zn(o,n.current)),Le=null;return}r.flags&32768?(Ge||c===1?n=!0:Ko||(ze&536870912)!==0?n=!1:(br=n=!0,(c===2||c===9||c===3||c===6)&&(c=Vn.current,c!==null&&c.tag===13&&(c.flags|=16384))),Tb(r,n)):md(r)}function md(n){var r=n;do{if((r.flags&32768)!==0){Tb(r,br);return}n=r.return;var o=CI(r.alternate,r,Ms);if(o!==null){Le=o;return}if(r=r.sibling,r!==null){Le=r;return}Le=r=n}while(r!==null);wt===0&&(wt=5)}function Tb(n,r){do{var o=RI(n.alternate,n);if(o!==null){o.flags&=32767,Le=o;return}if(o=n.return,o!==null&&(o.flags|=32768,o.subtreeFlags=0,o.deletions=null),!r&&(n=n.sibling,n!==null)){Le=n;return}Le=n=o}while(n!==null);wt=6,Le=null}function xb(n,r,o,c,m,g,E,S,P){n.cancelPendingCommit=null;do pd();while(Ht!==0);if((Je&6)!==0)throw Error(i(327));if(r!==null){if(r===n.current)throw Error(i(177));if(g=r.lanes|r.childLanes,g|=Vm,Im(n,o,g,E,S,P),n===ut&&(Le=ut=null,ze=0),Wo=r,xr=n,Vs=o,Hp=g,Gp=m,db=c,(r.subtreeFlags&10256)!==0||(r.flags&10256)!==0?(n.callbackNode=null,n.callbackPriority=0,BI(ki,function(){return Cb(),null})):(n.callbackNode=null,n.callbackPriority=0),c=(r.flags&13878)!==0,(r.subtreeFlags&13878)!==0||c){c=G.T,G.T=null,m=le.p,le.p=2,E=Je,Je|=4;try{DI(n,r,o)}finally{Je=E,le.p=m,G.T=c}}Ht=1,Sb(),wb(),Ab()}}function Sb(){if(Ht===1){Ht=0;var n=xr,r=Wo,o=(r.flags&13878)!==0;if((r.subtreeFlags&13878)!==0||o){o=G.T,G.T=null;var c=le.p;le.p=2;var m=Je;Je|=4;try{sb(r,n);var g=ag,E=u_(n.containerInfo),S=g.focusedElem,P=g.selectionRange;if(E!==S&&S&&S.ownerDocument&&c_(S.ownerDocument.documentElement,S)){if(P!==null&&Nm(S)){var $=P.start,se=P.end;if(se===void 0&&(se=$),"selectionStart"in S)S.selectionStart=$,S.selectionEnd=Math.min(se,S.value.length);else{var oe=S.ownerDocument||document,W=oe&&oe.defaultView||window;if(W.getSelection){var Z=W.getSelection(),_e=S.textContent.length,Ce=Math.min(P.start,_e),ct=P.end===void 0?Ce:Math.min(P.end,_e);!Z.extend&&Ce>ct&&(E=ct,ct=Ce,Ce=E);var q=l_(S,Ce),B=l_(S,ct);if(q&&B&&(Z.rangeCount!==1||Z.anchorNode!==q.node||Z.anchorOffset!==q.offset||Z.focusNode!==B.node||Z.focusOffset!==B.offset)){var K=oe.createRange();K.setStart(q.node,q.offset),Z.removeAllRanges(),Ce>ct?(Z.addRange(K),Z.extend(B.node,B.offset)):(K.setEnd(B.node,B.offset),Z.addRange(K))}}}}for(oe=[],Z=S;Z=Z.parentNode;)Z.nodeType===1&&oe.push({element:Z,left:Z.scrollLeft,top:Z.scrollTop});for(typeof S.focus=="function"&&S.focus(),S=0;S<oe.length;S++){var ae=oe[S];ae.element.scrollLeft=ae.left,ae.element.scrollTop=ae.top}}Id=!!rg,ag=rg=null}finally{Je=m,le.p=c,G.T=o}}n.current=r,Ht=2}}function wb(){if(Ht===2){Ht=0;var n=xr,r=Wo,o=(r.flags&8772)!==0;if((r.subtreeFlags&8772)!==0||o){o=G.T,G.T=null;var c=le.p;le.p=2;var m=Je;Je|=4;try{Z0(n,r.alternate,r)}finally{Je=m,le.p=c,G.T=o}}Ht=3}}function Ab(){if(Ht===4||Ht===3){Ht=0,aa();var n=xr,r=Wo,o=Vs,c=db;(r.subtreeFlags&10256)!==0||(r.flags&10256)!==0?Ht=5:(Ht=0,Wo=xr=null,Ib(n,n.pendingLanes));var m=n.pendingLanes;if(m===0&&(Tr=null),_s(o),r=r.stateNode,qt&&typeof qt.onCommitFiberRoot=="function")try{qt.onCommitFiberRoot(Dn,r,void 0,(r.current.flags&128)===128)}catch{}if(c!==null){r=G.T,m=le.p,le.p=2,G.T=null;try{for(var g=n.onRecoverableError,E=0;E<c.length;E++){var S=c[E];g(S.value,{componentStack:S.stack})}}finally{G.T=r,le.p=m}}(Vs&3)!==0&&pd(),Zi(n),m=n.pendingLanes,(o&261930)!==0&&(m&42)!==0?n===Qp?Bc++:(Bc=0,Qp=n):Bc=0,Fc(0)}}function Ib(n,r){(n.pooledCacheLanes&=r)===0&&(r=n.pooledCache,r!=null&&(n.pooledCache=null,Tc(r)))}function pd(){return Sb(),wb(),Ab(),Cb()}function Cb(){if(Ht!==5)return!1;var n=xr,r=Hp;Hp=0;var o=_s(Vs),c=G.T,m=le.p;try{le.p=32>o?32:o,G.T=null,o=Gp,Gp=null;var g=xr,E=Vs;if(Ht=0,Wo=xr=null,Vs=0,(Je&6)!==0)throw Error(i(331));var S=Je;if(Je|=4,cb(g.current),ab(g,g.current,E,o),Je=S,Fc(0,!1),qt&&typeof qt.onPostCommitFiberRoot=="function")try{qt.onPostCommitFiberRoot(Dn,g)}catch{}return!0}finally{le.p=m,G.T=c,Ib(n,r)}}function Rb(n,r,o){r=Zn(o,r),r=Sp(n.stateNode,r,2),n=gr(n,r,2),n!==null&&(ua(n,2),Zi(n))}function nt(n,r,o){if(n.tag===3)Rb(n,n,o);else for(;r!==null;){if(r.tag===3){Rb(r,n,o);break}else if(r.tag===1){var c=r.stateNode;if(typeof r.type.getDerivedStateFromError=="function"||typeof c.componentDidCatch=="function"&&(Tr===null||!Tr.has(c))){n=Zn(o,n),o=D0(2),c=gr(r,o,2),c!==null&&(N0(o,c,r,n),ua(c,2),Zi(c));break}}r=r.return}}function Wp(n,r,o){var c=n.pingCache;if(c===null){c=n.pingCache=new kI;var m=new Set;c.set(r,m)}else m=c.get(r),m===void 0&&(m=new Set,c.set(r,m));m.has(o)||(Bp=!0,m.add(o),n=LI.bind(null,n,r,o),r.then(n,n))}function LI(n,r,o){var c=n.pingCache;c!==null&&c.delete(r),n.pingedLanes|=n.suspendedLanes&o,n.warmLanes&=~o,ut===n&&(ze&o)===o&&(wt===4||wt===3&&(ze&62914560)===ze&&300>vt()-cd?(Je&2)===0&&Yo(n,0):Fp|=o,$o===ze&&($o=0)),Zi(n)}function Db(n,r){r===0&&(r=hh()),n=Sa(n,r),n!==null&&(ua(n,r),Zi(n))}function UI(n){var r=n.memoizedState,o=0;r!==null&&(o=r.retryLane),Db(n,o)}function zI(n,r){var o=0;switch(n.tag){case 31:case 13:var c=n.stateNode,m=n.memoizedState;m!==null&&(o=m.retryLane);break;case 19:c=n.stateNode;break;case 22:c=n.stateNode._retryCache;break;default:throw Error(i(314))}c!==null&&c.delete(r),Db(n,o)}function BI(n,r){return ft(n,r)}var gd=null,Jo=null,Yp=!1,yd=!1,Xp=!1,wr=0;function Zi(n){n!==Jo&&n.next===null&&(Jo===null?gd=Jo=n:Jo=Jo.next=n),yd=!0,Yp||(Yp=!0,qI())}function Fc(n,r){if(!Xp&&yd){Xp=!0;do for(var o=!1,c=gd;c!==null;){if(n!==0){var m=c.pendingLanes;if(m===0)var g=0;else{var E=c.suspendedLanes,S=c.pingedLanes;g=(1<<31-de(42|n)+1)-1,g&=m&~(E&~S),g=g&201326741?g&201326741|1:g?g|2:0}g!==0&&(o=!0,Ob(c,g))}else g=ze,g=Mi(c,c===ut?g:0,c.cancelPendingCommit!==null||c.timeoutHandle!==-1),(g&3)===0||di(c,g)||(o=!0,Ob(c,g));c=c.next}while(o);Xp=!1}}function FI(){Nb()}function Nb(){yd=Yp=!1;var n=0;wr!==0&&ZI()&&(n=wr);for(var r=vt(),o=null,c=gd;c!==null;){var m=c.next,g=jb(c,r);g===0?(c.next=null,o===null?gd=m:o.next=m,m===null&&(Jo=o)):(o=c,(n!==0||(g&3)!==0)&&(yd=!0)),c=m}Ht!==0&&Ht!==5||Fc(n),wr!==0&&(wr=0)}function jb(n,r){for(var o=n.suspendedLanes,c=n.pingedLanes,m=n.expirationTimes,g=n.pendingLanes&-62914561;0<g;){var E=31-de(g),S=1<<E,P=m[E];P===-1?((S&o)===0||(S&c)!==0)&&(m[E]=Am(S,r)):P<=r&&(n.expiredLanes|=S),g&=~S}if(r=ut,o=ze,o=Mi(n,n===r?o:0,n.cancelPendingCommit!==null||n.timeoutHandle!==-1),c=n.callbackNode,o===0||n===r&&(tt===2||tt===9)||n.cancelPendingCommit!==null)return c!==null&&c!==null&&hi(c),n.callbackNode=null,n.callbackPriority=0;if((o&3)===0||di(n,o)){if(r=o&-o,r===n.callbackPriority)return r;switch(c!==null&&hi(c),_s(o)){case 2:case 8:o=la;break;case 32:o=ki;break;case 268435456:o=po;break;default:o=ki}return c=kb.bind(null,n),o=ft(o,c),n.callbackPriority=r,n.callbackNode=o,r}return c!==null&&c!==null&&hi(c),n.callbackPriority=2,n.callbackNode=null,2}function kb(n,r){if(Ht!==0&&Ht!==5)return n.callbackNode=null,n.callbackPriority=0,null;var o=n.callbackNode;if(pd()&&n.callbackNode!==o)return null;var c=ze;return c=Mi(n,n===ut?c:0,n.cancelPendingCommit!==null||n.timeoutHandle!==-1),c===0?null:(mb(n,c,r),jb(n,vt()),n.callbackNode!=null&&n.callbackNode===o?kb.bind(null,n):null)}function Ob(n,r){if(pd())return null;mb(n,r,!0)}function qI(){t2(function(){(Je&6)!==0?ft(oa,FI):Nb()})}function Jp(){if(wr===0){var n=Po;n===0&&(n=ht,ht<<=1,(ht&261888)===0&&(ht=256)),wr=n}return wr}function Mb(n){return n==null||typeof n=="symbol"||typeof n=="boolean"?null:typeof n=="function"?n:To(""+n)}function Vb(n,r){var o=r.ownerDocument.createElement("input");return o.name=r.name,o.value=r.value,n.id&&o.setAttribute("form",n.id),r.parentNode.insertBefore(o,r),n=new FormData(n),o.parentNode.removeChild(o),n}function HI(n,r,o,c,m){if(r==="submit"&&o&&o.stateNode===m){var g=Mb((m[$t]||null).action),E=c.submitter;E&&(r=(r=E[$t]||null)?Mb(r.formAction):E.getAttribute("formAction"),r!==null&&(g=r,E=null));var S=new Qi("action","action",null,c,m);n.push({event:S,listeners:[{instance:null,listener:function(){if(c.defaultPrevented){if(wr!==0){var P=E?Vb(m,E):new FormData(m);vp(o,{pending:!0,data:P,method:m.method,action:g},null,P)}}else typeof g=="function"&&(S.preventDefault(),P=E?Vb(m,E):new FormData(m),vp(o,{pending:!0,data:P,method:m.method,action:g},g,P))},currentTarget:m}]})}}for(var Zp=0;Zp<Mm.length;Zp++){var eg=Mm[Zp],GI=eg.toLowerCase(),QI=eg[0].toUpperCase()+eg.slice(1);bi(GI,"on"+QI)}bi(f_,"onAnimationEnd"),bi(m_,"onAnimationIteration"),bi(p_,"onAnimationStart"),bi("dblclick","onDoubleClick"),bi("focusin","onFocus"),bi("focusout","onBlur"),bi(lI,"onTransitionRun"),bi(cI,"onTransitionStart"),bi(uI,"onTransitionCancel"),bi(g_,"onTransitionEnd"),Fi("onMouseEnter",["mouseout","mouseover"]),Fi("onMouseLeave",["mouseout","mouseover"]),Fi("onPointerEnter",["pointerout","pointerover"]),Fi("onPointerLeave",["pointerout","pointerover"]),Bi("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),Bi("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),Bi("onBeforeInput",["compositionend","keypress","textInput","paste"]),Bi("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),Bi("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),Bi("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var qc="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),KI=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(qc));function Pb(n,r){r=(r&4)!==0;for(var o=0;o<n.length;o++){var c=n[o],m=c.event;c=c.listeners;e:{var g=void 0;if(r)for(var E=c.length-1;0<=E;E--){var S=c[E],P=S.instance,$=S.currentTarget;if(S=S.listener,P!==g&&m.isPropagationStopped())break e;g=S,m.currentTarget=$;try{g(m)}catch(se){jh(se)}m.currentTarget=null,g=P}else for(E=0;E<c.length;E++){if(S=c[E],P=S.instance,$=S.currentTarget,S=S.listener,P!==g&&m.isPropagationStopped())break e;g=S,m.currentTarget=$;try{g(m)}catch(se){jh(se)}m.currentTarget=null,g=P}}}}function Ue(n,r){var o=r[yo];o===void 0&&(o=r[yo]=new Set);var c=n+"__bubble";o.has(c)||(Lb(r,n,2,!1),o.add(c))}function tg(n,r,o){var c=0;r&&(c|=4),Lb(o,n,c,r)}var vd="_reactListening"+Math.random().toString(36).slice(2);function ng(n){if(!n[vd]){n[vd]=!0,tc.forEach(function(o){o!=="selectionchange"&&(KI.has(o)||tg(o,!1,n),tg(o,!0,n))});var r=n.nodeType===9?n:n.ownerDocument;r===null||r[vd]||(r[vd]=!0,tg("selectionchange",!1,r))}}function Lb(n,r,o,c){switch(fE(r)){case 2:var m=E2;break;case 8:m=T2;break;default:m=yg}o=m.bind(null,r,o,n),m=void 0,!ga||r!=="touchstart"&&r!=="touchmove"&&r!=="wheel"||(m=!0),c?m!==void 0?n.addEventListener(r,o,{capture:!0,passive:m}):n.addEventListener(r,o,!0):m!==void 0?n.addEventListener(r,o,{passive:m}):n.addEventListener(r,o,!1)}function ig(n,r,o,c,m){var g=c;if((r&1)===0&&(r&2)===0&&c!==null)e:for(;;){if(c===null)return;var E=c.tag;if(E===3||E===4){var S=c.stateNode.containerInfo;if(S===m)break;if(E===4)for(E=c.return;E!==null;){var P=E.tag;if((P===3||P===4)&&E.stateNode.containerInfo===m)return;E=E.return}for(;S!==null;){if(E=Ui(S),E===null)return;if(P=E.tag,P===5||P===6||P===26||P===27){c=g=E;continue e}S=S.parentNode}}c=c.return}ar(function(){var $=g,se=Wn(o),oe=[];e:{var W=y_.get(n);if(W!==void 0){var Z=Qi,_e=n;switch(n){case"keypress":if(va(o)===0)break e;case"keydown":case"keyup":Z=Rh;break;case"focusin":_e="focus",Z=ba;break;case"focusout":_e="blur",Z=ba;break;case"beforeblur":case"afterblur":Z=ba;break;case"click":if(o.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":Z=mc;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":Z=bh;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":Z=v;break;case f_:case m_:case p_:Z=Th;break;case g_:Z=A;break;case"scroll":case"scrollend":Z=fc;break;case"wheel":Z=X;break;case"copy":case"cut":case"paste":Z=xh;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":Z=Ts;break;case"toggle":case"beforetoggle":Z=ke}var Ce=(r&4)!==0,ct=!Ce&&(n==="scroll"||n==="scrollend"),q=Ce?W!==null?W+"Capture":null:W;Ce=[];for(var B=$,K;B!==null;){var ae=B;if(K=ae.stateNode,ae=ae.tag,ae!==5&&ae!==26&&ae!==27||K===null||q===null||(ae=gi(B,q),ae!=null&&Ce.push(Hc(B,ae,K))),ct)break;B=B.return}0<Ce.length&&(W=new Z(W,_e,null,o,se),oe.push({event:W,listeners:Ce}))}}if((r&7)===0){e:{if(W=n==="mouseover"||n==="pointerover",Z=n==="mouseout"||n==="pointerout",W&&o!==uc&&(_e=o.relatedTarget||o.fromElement)&&(Ui(_e)||_e[Pi]))break e;if((Z||W)&&(W=se.window===se?se:(W=se.ownerDocument)?W.defaultView||W.parentWindow:window,Z?(_e=o.relatedTarget||o.toElement,Z=$,_e=_e?Ui(_e):null,_e!==null&&(ct=l(_e),Ce=_e.tag,_e!==ct||Ce!==5&&Ce!==27&&Ce!==6)&&(_e=null)):(Z=null,_e=$),Z!==_e)){if(Ce=mc,ae="onMouseLeave",q="onMouseEnter",B="mouse",(n==="pointerout"||n==="pointerover")&&(Ce=Ts,ae="onPointerLeave",q="onPointerEnter",B="pointer"),ct=Z==null?W:jn(Z),K=_e==null?W:jn(_e),W=new Ce(ae,B+"leave",Z,o,se),W.target=ct,W.relatedTarget=K,ae=null,Ui(se)===$&&(Ce=new Ce(q,B+"enter",_e,o,se),Ce.target=K,Ce.relatedTarget=ct,ae=Ce),ct=ae,Z&&_e)t:{for(Ce=$I,q=Z,B=_e,K=0,ae=q;ae;ae=Ce(ae))K++;ae=0;for(var we=B;we;we=Ce(we))ae++;for(;0<K-ae;)q=Ce(q),K--;for(;0<ae-K;)B=Ce(B),ae--;for(;K--;){if(q===B||B!==null&&q===B.alternate){Ce=q;break t}q=Ce(q),B=Ce(B)}Ce=null}else Ce=null;Z!==null&&Ub(oe,W,Z,Ce,!1),_e!==null&&ct!==null&&Ub(oe,ct,_e,Ce,!0)}}e:{if(W=$?jn($):window,Z=W.nodeName&&W.nodeName.toLowerCase(),Z==="select"||Z==="input"&&W.type==="file")var We=n_;else if(e_(W))if(i_)We=rI;else{We=iI;var Ee=nI}else Z=W.nodeName,!Z||Z.toLowerCase()!=="input"||W.type!=="checkbox"&&W.type!=="radio"?$&&Eo($.elementType)&&(We=n_):We=sI;if(We&&(We=We(n,$))){t_(oe,We,o,se);break e}Ee&&Ee(n,W,$),n==="focusout"&&$&&W.type==="number"&&$.memoizedProps.value!=null&&oc(W,"number",W.value)}switch(Ee=$?jn($):window,n){case"focusin":(e_(Ee)||Ee.contentEditable==="true")&&(Ro=Ee,jm=$,_c=null);break;case"focusout":_c=jm=Ro=null;break;case"mousedown":km=!0;break;case"contextmenu":case"mouseup":case"dragend":km=!1,h_(oe,o,se);break;case"selectionchange":if(oI)break;case"keydown":case"keyup":h_(oe,o,se)}var Me;if(Xe)e:{switch(n){case"compositionstart":var Be="onCompositionStart";break e;case"compositionend":Be="onCompositionEnd";break e;case"compositionupdate":Be="onCompositionUpdate";break e}Be=void 0}else Co?Ea(n,o)&&(Be="onCompositionEnd"):n==="keydown"&&o.keyCode===229&&(Be="onCompositionStart");Be&&(Wi&&o.locale!=="ko"&&(Co||Be!=="onCompositionStart"?Be==="onCompositionEnd"&&Co&&(Me=dc()):(Gi=se,hc="value"in Gi?Gi.value:Gi.textContent,Co=!0)),Ee=_d($,Be),0<Ee.length&&(Be=new $i(Be,n,null,o,se),oe.push({event:Be,listeners:Ee}),Me?Be.data=Me:(Me=Io(o),Me!==null&&(Be.data=Me)))),(Me=Xn?JA(n,o):ZA(n,o))&&(Be=_d($,"onBeforeInput"),0<Be.length&&(Ee=new $i("onBeforeInput","beforeinput",null,o,se),oe.push({event:Ee,listeners:Be}),Ee.data=Me)),HI(oe,n,$,o,se)}Pb(oe,r)})}function Hc(n,r,o){return{instance:n,listener:r,currentTarget:o}}function _d(n,r){for(var o=r+"Capture",c=[];n!==null;){var m=n,g=m.stateNode;if(m=m.tag,m!==5&&m!==26&&m!==27||g===null||(m=gi(n,o),m!=null&&c.unshift(Hc(n,m,g)),m=gi(n,r),m!=null&&c.push(Hc(n,m,g))),n.tag===3)return c;n=n.return}return[]}function $I(n){if(n===null)return null;do n=n.return;while(n&&n.tag!==5&&n.tag!==27);return n||null}function Ub(n,r,o,c,m){for(var g=r._reactName,E=[];o!==null&&o!==c;){var S=o,P=S.alternate,$=S.stateNode;if(S=S.tag,P!==null&&P===c)break;S!==5&&S!==26&&S!==27||$===null||(P=$,m?($=gi(o,g),$!=null&&E.unshift(Hc(o,$,P))):m||($=gi(o,g),$!=null&&E.push(Hc(o,$,P)))),o=o.return}E.length!==0&&n.push({event:r,listeners:E})}var WI=/\r\n?/g,YI=/\u0000|\uFFFD/g;function zb(n){return(typeof n=="string"?n:""+n).replace(WI,`
`).replace(YI,"")}function Bb(n,r){return r=zb(r),zb(n)===r}function lt(n,r,o,c,m,g){switch(o){case"children":typeof c=="string"?r==="body"||r==="textarea"&&c===""||En(n,c):(typeof c=="number"||typeof c=="bigint")&&r!=="body"&&En(n,""+c);break;case"className":kn(n,"class",c);break;case"tabIndex":kn(n,"tabindex",c);break;case"dir":case"role":case"viewBox":case"width":case"height":kn(n,o,c);break;case"style":cc(n,c,g);break;case"data":if(r!=="object"){kn(n,"data",c);break}case"src":case"href":if(c===""&&(r!=="a"||o!=="href")){n.removeAttribute(o);break}if(c==null||typeof c=="function"||typeof c=="symbol"||typeof c=="boolean"){n.removeAttribute(o);break}c=To(""+c),n.setAttribute(o,c);break;case"action":case"formAction":if(typeof c=="function"){n.setAttribute(o,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof g=="function"&&(o==="formAction"?(r!=="input"&&lt(n,r,"name",m.name,m,null),lt(n,r,"formEncType",m.formEncType,m,null),lt(n,r,"formMethod",m.formMethod,m,null),lt(n,r,"formTarget",m.formTarget,m,null)):(lt(n,r,"encType",m.encType,m,null),lt(n,r,"method",m.method,m,null),lt(n,r,"target",m.target,m,null)));if(c==null||typeof c=="symbol"||typeof c=="boolean"){n.removeAttribute(o);break}c=To(""+c),n.setAttribute(o,c);break;case"onClick":c!=null&&(n.onclick=pi);break;case"onScroll":c!=null&&Ue("scroll",n);break;case"onScrollEnd":c!=null&&Ue("scrollend",n);break;case"dangerouslySetInnerHTML":if(c!=null){if(typeof c!="object"||!("__html"in c))throw Error(i(61));if(o=c.__html,o!=null){if(m.children!=null)throw Error(i(60));n.innerHTML=o}}break;case"multiple":n.multiple=c&&typeof c!="function"&&typeof c!="symbol";break;case"muted":n.muted=c&&typeof c!="function"&&typeof c!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(c==null||typeof c=="function"||typeof c=="boolean"||typeof c=="symbol"){n.removeAttribute("xlink:href");break}o=To(""+c),n.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",o);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":c!=null&&typeof c!="function"&&typeof c!="symbol"?n.setAttribute(o,""+c):n.removeAttribute(o);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":c&&typeof c!="function"&&typeof c!="symbol"?n.setAttribute(o,""):n.removeAttribute(o);break;case"capture":case"download":c===!0?n.setAttribute(o,""):c!==!1&&c!=null&&typeof c!="function"&&typeof c!="symbol"?n.setAttribute(o,c):n.removeAttribute(o);break;case"cols":case"rows":case"size":case"span":c!=null&&typeof c!="function"&&typeof c!="symbol"&&!isNaN(c)&&1<=c?n.setAttribute(o,c):n.removeAttribute(o);break;case"rowSpan":case"start":c==null||typeof c=="function"||typeof c=="symbol"||isNaN(c)?n.removeAttribute(o):n.setAttribute(o,c);break;case"popover":Ue("beforetoggle",n),Ue("toggle",n),_o(n,"popover",c);break;case"xlinkActuate":Vt(n,"http://www.w3.org/1999/xlink","xlink:actuate",c);break;case"xlinkArcrole":Vt(n,"http://www.w3.org/1999/xlink","xlink:arcrole",c);break;case"xlinkRole":Vt(n,"http://www.w3.org/1999/xlink","xlink:role",c);break;case"xlinkShow":Vt(n,"http://www.w3.org/1999/xlink","xlink:show",c);break;case"xlinkTitle":Vt(n,"http://www.w3.org/1999/xlink","xlink:title",c);break;case"xlinkType":Vt(n,"http://www.w3.org/1999/xlink","xlink:type",c);break;case"xmlBase":Vt(n,"http://www.w3.org/XML/1998/namespace","xml:base",c);break;case"xmlLang":Vt(n,"http://www.w3.org/XML/1998/namespace","xml:lang",c);break;case"xmlSpace":Vt(n,"http://www.w3.org/XML/1998/namespace","xml:space",c);break;case"is":_o(n,"is",c);break;case"innerText":case"textContent":break;default:(!(2<o.length)||o[0]!=="o"&&o[0]!=="O"||o[1]!=="n"&&o[1]!=="N")&&(o=_h.get(o)||o,_o(n,o,c))}}function sg(n,r,o,c,m,g){switch(o){case"style":cc(n,c,g);break;case"dangerouslySetInnerHTML":if(c!=null){if(typeof c!="object"||!("__html"in c))throw Error(i(61));if(o=c.__html,o!=null){if(m.children!=null)throw Error(i(60));n.innerHTML=o}}break;case"children":typeof c=="string"?En(n,c):(typeof c=="number"||typeof c=="bigint")&&En(n,""+c);break;case"onScroll":c!=null&&Ue("scroll",n);break;case"onScrollEnd":c!=null&&Ue("scrollend",n);break;case"onClick":c!=null&&(n.onclick=pi);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!nc.hasOwnProperty(o))e:{if(o[0]==="o"&&o[1]==="n"&&(m=o.endsWith("Capture"),r=o.slice(2,m?o.length-7:void 0),g=n[$t]||null,g=g!=null?g[o]:null,typeof g=="function"&&n.removeEventListener(r,g,m),typeof c=="function")){typeof g!="function"&&g!==null&&(o in n?n[o]=null:n.hasAttribute(o)&&n.removeAttribute(o)),n.addEventListener(r,c,m);break e}o in n?n[o]=c:c===!0?n.setAttribute(o,""):_o(n,o,c)}}}function sn(n,r,o){switch(r){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":Ue("error",n),Ue("load",n);var c=!1,m=!1,g;for(g in o)if(o.hasOwnProperty(g)){var E=o[g];if(E!=null)switch(g){case"src":c=!0;break;case"srcSet":m=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(i(137,r));default:lt(n,r,g,E,o,null)}}m&&lt(n,r,"srcSet",o.srcSet,o,null),c&&lt(n,r,"src",o.src,o,null);return;case"input":Ue("invalid",n);var S=g=E=m=null,P=null,$=null;for(c in o)if(o.hasOwnProperty(c)){var se=o[c];if(se!=null)switch(c){case"name":m=se;break;case"type":E=se;break;case"checked":P=se;break;case"defaultChecked":$=se;break;case"value":g=se;break;case"defaultValue":S=se;break;case"children":case"dangerouslySetInnerHTML":if(se!=null)throw Error(i(137,r));break;default:lt(n,r,c,se,o,null)}}gh(n,g,S,P,$,E,m,!1);return;case"select":Ue("invalid",n),c=E=g=null;for(m in o)if(o.hasOwnProperty(m)&&(S=o[m],S!=null))switch(m){case"value":g=S;break;case"defaultValue":E=S;break;case"multiple":c=S;default:lt(n,r,m,S,o,null)}r=g,o=E,n.multiple=!!c,r!=null?nr(n,!!c,r,!1):o!=null&&nr(n,!!c,o,!0);return;case"textarea":Ue("invalid",n),g=m=c=null;for(E in o)if(o.hasOwnProperty(E)&&(S=o[E],S!=null))switch(E){case"value":c=S;break;case"defaultValue":m=S;break;case"children":g=S;break;case"dangerouslySetInnerHTML":if(S!=null)throw Error(i(91));break;default:lt(n,r,E,S,o,null)}ir(n,c,m,g);return;case"option":for(P in o)o.hasOwnProperty(P)&&(c=o[P],c!=null)&&(P==="selected"?n.selected=c&&typeof c!="function"&&typeof c!="symbol":lt(n,r,P,c,o,null));return;case"dialog":Ue("beforetoggle",n),Ue("toggle",n),Ue("cancel",n),Ue("close",n);break;case"iframe":case"object":Ue("load",n);break;case"video":case"audio":for(c=0;c<qc.length;c++)Ue(qc[c],n);break;case"image":Ue("error",n),Ue("load",n);break;case"details":Ue("toggle",n);break;case"embed":case"source":case"link":Ue("error",n),Ue("load",n);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for($ in o)if(o.hasOwnProperty($)&&(c=o[$],c!=null))switch($){case"children":case"dangerouslySetInnerHTML":throw Error(i(137,r));default:lt(n,r,$,c,o,null)}return;default:if(Eo(r)){for(se in o)o.hasOwnProperty(se)&&(c=o[se],c!==void 0&&sg(n,r,se,c,o,void 0));return}}for(S in o)o.hasOwnProperty(S)&&(c=o[S],c!=null&&lt(n,r,S,c,o,null))}function XI(n,r,o,c){switch(r){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var m=null,g=null,E=null,S=null,P=null,$=null,se=null;for(Z in o){var oe=o[Z];if(o.hasOwnProperty(Z)&&oe!=null)switch(Z){case"checked":break;case"value":break;case"defaultValue":P=oe;default:c.hasOwnProperty(Z)||lt(n,r,Z,null,c,oe)}}for(var W in c){var Z=c[W];if(oe=o[W],c.hasOwnProperty(W)&&(Z!=null||oe!=null))switch(W){case"type":g=Z;break;case"name":m=Z;break;case"checked":$=Z;break;case"defaultChecked":se=Z;break;case"value":E=Z;break;case"defaultValue":S=Z;break;case"children":case"dangerouslySetInnerHTML":if(Z!=null)throw Error(i(137,r));break;default:Z!==oe&&lt(n,r,W,Z,c,oe)}}bo(n,E,S,P,$,se,g,m);return;case"select":Z=E=S=W=null;for(g in o)if(P=o[g],o.hasOwnProperty(g)&&P!=null)switch(g){case"value":break;case"multiple":Z=P;default:c.hasOwnProperty(g)||lt(n,r,g,null,c,P)}for(m in c)if(g=c[m],P=o[m],c.hasOwnProperty(m)&&(g!=null||P!=null))switch(m){case"value":W=g;break;case"defaultValue":S=g;break;case"multiple":E=g;default:g!==P&&lt(n,r,m,g,c,P)}r=S,o=E,c=Z,W!=null?nr(n,!!o,W,!1):!!c!=!!o&&(r!=null?nr(n,!!o,r,!0):nr(n,!!o,o?[]:"",!1));return;case"textarea":Z=W=null;for(S in o)if(m=o[S],o.hasOwnProperty(S)&&m!=null&&!c.hasOwnProperty(S))switch(S){case"value":break;case"children":break;default:lt(n,r,S,null,c,m)}for(E in c)if(m=c[E],g=o[E],c.hasOwnProperty(E)&&(m!=null||g!=null))switch(E){case"value":W=m;break;case"defaultValue":Z=m;break;case"children":break;case"dangerouslySetInnerHTML":if(m!=null)throw Error(i(91));break;default:m!==g&&lt(n,r,E,m,c,g)}yh(n,W,Z);return;case"option":for(var _e in o)W=o[_e],o.hasOwnProperty(_e)&&W!=null&&!c.hasOwnProperty(_e)&&(_e==="selected"?n.selected=!1:lt(n,r,_e,null,c,W));for(P in c)W=c[P],Z=o[P],c.hasOwnProperty(P)&&W!==Z&&(W!=null||Z!=null)&&(P==="selected"?n.selected=W&&typeof W!="function"&&typeof W!="symbol":lt(n,r,P,W,c,Z));return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var Ce in o)W=o[Ce],o.hasOwnProperty(Ce)&&W!=null&&!c.hasOwnProperty(Ce)&&lt(n,r,Ce,null,c,W);for($ in c)if(W=c[$],Z=o[$],c.hasOwnProperty($)&&W!==Z&&(W!=null||Z!=null))switch($){case"children":case"dangerouslySetInnerHTML":if(W!=null)throw Error(i(137,r));break;default:lt(n,r,$,W,c,Z)}return;default:if(Eo(r)){for(var ct in o)W=o[ct],o.hasOwnProperty(ct)&&W!==void 0&&!c.hasOwnProperty(ct)&&sg(n,r,ct,void 0,c,W);for(se in c)W=c[se],Z=o[se],!c.hasOwnProperty(se)||W===Z||W===void 0&&Z===void 0||sg(n,r,se,W,c,Z);return}}for(var q in o)W=o[q],o.hasOwnProperty(q)&&W!=null&&!c.hasOwnProperty(q)&&lt(n,r,q,null,c,W);for(oe in c)W=c[oe],Z=o[oe],!c.hasOwnProperty(oe)||W===Z||W==null&&Z==null||lt(n,r,oe,W,c,Z)}function Fb(n){switch(n){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function JI(){if(typeof performance.getEntriesByType=="function"){for(var n=0,r=0,o=performance.getEntriesByType("resource"),c=0;c<o.length;c++){var m=o[c],g=m.transferSize,E=m.initiatorType,S=m.duration;if(g&&S&&Fb(E)){for(E=0,S=m.responseEnd,c+=1;c<o.length;c++){var P=o[c],$=P.startTime;if($>S)break;var se=P.transferSize,oe=P.initiatorType;se&&Fb(oe)&&(P=P.responseEnd,E+=se*(P<S?1:(S-$)/(P-$)))}if(--c,r+=8*(g+E)/(m.duration/1e3),n++,10<n)break}}if(0<n)return r/n/1e6}return navigator.connection&&(n=navigator.connection.downlink,typeof n=="number")?n:5}var rg=null,ag=null;function bd(n){return n.nodeType===9?n:n.ownerDocument}function qb(n){switch(n){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function Hb(n,r){if(n===0)switch(r){case"svg":return 1;case"math":return 2;default:return 0}return n===1&&r==="foreignObject"?0:n}function og(n,r){return n==="textarea"||n==="noscript"||typeof r.children=="string"||typeof r.children=="number"||typeof r.children=="bigint"||typeof r.dangerouslySetInnerHTML=="object"&&r.dangerouslySetInnerHTML!==null&&r.dangerouslySetInnerHTML.__html!=null}var lg=null;function ZI(){var n=window.event;return n&&n.type==="popstate"?n===lg?!1:(lg=n,!0):(lg=null,!1)}var Gb=typeof setTimeout=="function"?setTimeout:void 0,e2=typeof clearTimeout=="function"?clearTimeout:void 0,Qb=typeof Promise=="function"?Promise:void 0,t2=typeof queueMicrotask=="function"?queueMicrotask:typeof Qb<"u"?function(n){return Qb.resolve(null).then(n).catch(n2)}:Gb;function n2(n){setTimeout(function(){throw n})}function Ar(n){return n==="head"}function Kb(n,r){var o=r,c=0;do{var m=o.nextSibling;if(n.removeChild(o),m&&m.nodeType===8)if(o=m.data,o==="/$"||o==="/&"){if(c===0){n.removeChild(m),nl(r);return}c--}else if(o==="$"||o==="$?"||o==="$~"||o==="$!"||o==="&")c++;else if(o==="html")Gc(n.ownerDocument.documentElement);else if(o==="head"){o=n.ownerDocument.head,Gc(o);for(var g=o.firstChild;g;){var E=g.nextSibling,S=g.nodeName;g[Li]||S==="SCRIPT"||S==="STYLE"||S==="LINK"&&g.rel.toLowerCase()==="stylesheet"||o.removeChild(g),g=E}}else o==="body"&&Gc(n.ownerDocument.body);o=m}while(o);nl(r)}function $b(n,r){var o=n;n=0;do{var c=o.nextSibling;if(o.nodeType===1?r?(o._stashedDisplay=o.style.display,o.style.display="none"):(o.style.display=o._stashedDisplay||"",o.getAttribute("style")===""&&o.removeAttribute("style")):o.nodeType===3&&(r?(o._stashedText=o.nodeValue,o.nodeValue=""):o.nodeValue=o._stashedText||""),c&&c.nodeType===8)if(o=c.data,o==="/$"){if(n===0)break;n--}else o!=="$"&&o!=="$?"&&o!=="$~"&&o!=="$!"||n++;o=c}while(o)}function cg(n){var r=n.firstChild;for(r&&r.nodeType===10&&(r=r.nextSibling);r;){var o=r;switch(r=r.nextSibling,o.nodeName){case"HTML":case"HEAD":case"BODY":cg(o),vo(o);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(o.rel.toLowerCase()==="stylesheet")continue}n.removeChild(o)}}function i2(n,r,o,c){for(;n.nodeType===1;){var m=o;if(n.nodeName.toLowerCase()!==r.toLowerCase()){if(!c&&(n.nodeName!=="INPUT"||n.type!=="hidden"))break}else if(c){if(!n[Li])switch(r){case"meta":if(!n.hasAttribute("itemprop"))break;return n;case"link":if(g=n.getAttribute("rel"),g==="stylesheet"&&n.hasAttribute("data-precedence"))break;if(g!==m.rel||n.getAttribute("href")!==(m.href==null||m.href===""?null:m.href)||n.getAttribute("crossorigin")!==(m.crossOrigin==null?null:m.crossOrigin)||n.getAttribute("title")!==(m.title==null?null:m.title))break;return n;case"style":if(n.hasAttribute("data-precedence"))break;return n;case"script":if(g=n.getAttribute("src"),(g!==(m.src==null?null:m.src)||n.getAttribute("type")!==(m.type==null?null:m.type)||n.getAttribute("crossorigin")!==(m.crossOrigin==null?null:m.crossOrigin))&&g&&n.hasAttribute("async")&&!n.hasAttribute("itemprop"))break;return n;default:return n}}else if(r==="input"&&n.type==="hidden"){var g=m.name==null?null:""+m.name;if(m.type==="hidden"&&n.getAttribute("name")===g)return n}else return n;if(n=si(n.nextSibling),n===null)break}return null}function s2(n,r,o){if(r==="")return null;for(;n.nodeType!==3;)if((n.nodeType!==1||n.nodeName!=="INPUT"||n.type!=="hidden")&&!o||(n=si(n.nextSibling),n===null))return null;return n}function Wb(n,r){for(;n.nodeType!==8;)if((n.nodeType!==1||n.nodeName!=="INPUT"||n.type!=="hidden")&&!r||(n=si(n.nextSibling),n===null))return null;return n}function ug(n){return n.data==="$?"||n.data==="$~"}function hg(n){return n.data==="$!"||n.data==="$?"&&n.ownerDocument.readyState!=="loading"}function r2(n,r){var o=n.ownerDocument;if(n.data==="$~")n._reactRetry=r;else if(n.data!=="$?"||o.readyState!=="loading")r();else{var c=function(){r(),o.removeEventListener("DOMContentLoaded",c)};o.addEventListener("DOMContentLoaded",c),n._reactRetry=c}}function si(n){for(;n!=null;n=n.nextSibling){var r=n.nodeType;if(r===1||r===3)break;if(r===8){if(r=n.data,r==="$"||r==="$!"||r==="$?"||r==="$~"||r==="&"||r==="F!"||r==="F")break;if(r==="/$"||r==="/&")return null}}return n}var dg=null;function Yb(n){n=n.nextSibling;for(var r=0;n;){if(n.nodeType===8){var o=n.data;if(o==="/$"||o==="/&"){if(r===0)return si(n.nextSibling);r--}else o!=="$"&&o!=="$!"&&o!=="$?"&&o!=="$~"&&o!=="&"||r++}n=n.nextSibling}return null}function Xb(n){n=n.previousSibling;for(var r=0;n;){if(n.nodeType===8){var o=n.data;if(o==="$"||o==="$!"||o==="$?"||o==="$~"||o==="&"){if(r===0)return n;r--}else o!=="/$"&&o!=="/&"||r++}n=n.previousSibling}return null}function Jb(n,r,o){switch(r=bd(o),n){case"html":if(n=r.documentElement,!n)throw Error(i(452));return n;case"head":if(n=r.head,!n)throw Error(i(453));return n;case"body":if(n=r.body,!n)throw Error(i(454));return n;default:throw Error(i(451))}}function Gc(n){for(var r=n.attributes;r.length;)n.removeAttributeNode(r[0]);vo(n)}var ri=new Map,Zb=new Set;function Ed(n){return typeof n.getRootNode=="function"?n.getRootNode():n.nodeType===9?n:n.ownerDocument}var Ps=le.d;le.d={f:a2,r:o2,D:l2,C:c2,L:u2,m:h2,X:f2,S:d2,M:m2};function a2(){var n=Ps.f(),r=dd();return n||r}function o2(n){var r=$n(n);r!==null&&r.tag===5&&r.type==="form"?g0(r):Ps.r(n)}var Zo=typeof document>"u"?null:document;function eE(n,r,o){var c=Zo;if(c&&typeof r=="string"&&r){var m=bn(r);m='link[rel="'+n+'"][href="'+m+'"]',typeof o=="string"&&(m+='[crossorigin="'+o+'"]'),Zb.has(m)||(Zb.add(m),n={rel:n,crossOrigin:o,href:r},c.querySelector(m)===null&&(r=c.createElement("link"),sn(r,"link",n),Mt(r),c.head.appendChild(r)))}}function l2(n){Ps.D(n),eE("dns-prefetch",n,null)}function c2(n,r){Ps.C(n,r),eE("preconnect",n,r)}function u2(n,r,o){Ps.L(n,r,o);var c=Zo;if(c&&n&&r){var m='link[rel="preload"][as="'+bn(r)+'"]';r==="image"&&o&&o.imageSrcSet?(m+='[imagesrcset="'+bn(o.imageSrcSet)+'"]',typeof o.imageSizes=="string"&&(m+='[imagesizes="'+bn(o.imageSizes)+'"]')):m+='[href="'+bn(n)+'"]';var g=m;switch(r){case"style":g=el(n);break;case"script":g=tl(n)}ri.has(g)||(n=b({rel:"preload",href:r==="image"&&o&&o.imageSrcSet?void 0:n,as:r},o),ri.set(g,n),c.querySelector(m)!==null||r==="style"&&c.querySelector(Qc(g))||r==="script"&&c.querySelector(Kc(g))||(r=c.createElement("link"),sn(r,"link",n),Mt(r),c.head.appendChild(r)))}}function h2(n,r){Ps.m(n,r);var o=Zo;if(o&&n){var c=r&&typeof r.as=="string"?r.as:"script",m='link[rel="modulepreload"][as="'+bn(c)+'"][href="'+bn(n)+'"]',g=m;switch(c){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":g=tl(n)}if(!ri.has(g)&&(n=b({rel:"modulepreload",href:n},r),ri.set(g,n),o.querySelector(m)===null)){switch(c){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(o.querySelector(Kc(g)))return}c=o.createElement("link"),sn(c,"link",n),Mt(c),o.head.appendChild(c)}}}function d2(n,r,o){Ps.S(n,r,o);var c=Zo;if(c&&n){var m=zi(c).hoistableStyles,g=el(n);r=r||"default";var E=m.get(g);if(!E){var S={loading:0,preload:null};if(E=c.querySelector(Qc(g)))S.loading=5;else{n=b({rel:"stylesheet",href:n,"data-precedence":r},o),(o=ri.get(g))&&fg(n,o);var P=E=c.createElement("link");Mt(P),sn(P,"link",n),P._p=new Promise(function($,se){P.onload=$,P.onerror=se}),P.addEventListener("load",function(){S.loading|=1}),P.addEventListener("error",function(){S.loading|=2}),S.loading|=4,Td(E,r,c)}E={type:"stylesheet",instance:E,count:1,state:S},m.set(g,E)}}}function f2(n,r){Ps.X(n,r);var o=Zo;if(o&&n){var c=zi(o).hoistableScripts,m=tl(n),g=c.get(m);g||(g=o.querySelector(Kc(m)),g||(n=b({src:n,async:!0},r),(r=ri.get(m))&&mg(n,r),g=o.createElement("script"),Mt(g),sn(g,"link",n),o.head.appendChild(g)),g={type:"script",instance:g,count:1,state:null},c.set(m,g))}}function m2(n,r){Ps.M(n,r);var o=Zo;if(o&&n){var c=zi(o).hoistableScripts,m=tl(n),g=c.get(m);g||(g=o.querySelector(Kc(m)),g||(n=b({src:n,async:!0,type:"module"},r),(r=ri.get(m))&&mg(n,r),g=o.createElement("script"),Mt(g),sn(g,"link",n),o.head.appendChild(g)),g={type:"script",instance:g,count:1,state:null},c.set(m,g))}}function tE(n,r,o,c){var m=(m=Ie.current)?Ed(m):null;if(!m)throw Error(i(446));switch(n){case"meta":case"title":return null;case"style":return typeof o.precedence=="string"&&typeof o.href=="string"?(r=el(o.href),o=zi(m).hoistableStyles,c=o.get(r),c||(c={type:"style",instance:null,count:0,state:null},o.set(r,c)),c):{type:"void",instance:null,count:0,state:null};case"link":if(o.rel==="stylesheet"&&typeof o.href=="string"&&typeof o.precedence=="string"){n=el(o.href);var g=zi(m).hoistableStyles,E=g.get(n);if(E||(m=m.ownerDocument||m,E={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},g.set(n,E),(g=m.querySelector(Qc(n)))&&!g._p&&(E.instance=g,E.state.loading=5),ri.has(n)||(o={rel:"preload",as:"style",href:o.href,crossOrigin:o.crossOrigin,integrity:o.integrity,media:o.media,hrefLang:o.hrefLang,referrerPolicy:o.referrerPolicy},ri.set(n,o),g||p2(m,n,o,E.state))),r&&c===null)throw Error(i(528,""));return E}if(r&&c!==null)throw Error(i(529,""));return null;case"script":return r=o.async,o=o.src,typeof o=="string"&&r&&typeof r!="function"&&typeof r!="symbol"?(r=tl(o),o=zi(m).hoistableScripts,c=o.get(r),c||(c={type:"script",instance:null,count:0,state:null},o.set(r,c)),c):{type:"void",instance:null,count:0,state:null};default:throw Error(i(444,n))}}function el(n){return'href="'+bn(n)+'"'}function Qc(n){return'link[rel="stylesheet"]['+n+"]"}function nE(n){return b({},n,{"data-precedence":n.precedence,precedence:null})}function p2(n,r,o,c){n.querySelector('link[rel="preload"][as="style"]['+r+"]")?c.loading=1:(r=n.createElement("link"),c.preload=r,r.addEventListener("load",function(){return c.loading|=1}),r.addEventListener("error",function(){return c.loading|=2}),sn(r,"link",o),Mt(r),n.head.appendChild(r))}function tl(n){return'[src="'+bn(n)+'"]'}function Kc(n){return"script[async]"+n}function iE(n,r,o){if(r.count++,r.instance===null)switch(r.type){case"style":var c=n.querySelector('style[data-href~="'+bn(o.href)+'"]');if(c)return r.instance=c,Mt(c),c;var m=b({},o,{"data-href":o.href,"data-precedence":o.precedence,href:null,precedence:null});return c=(n.ownerDocument||n).createElement("style"),Mt(c),sn(c,"style",m),Td(c,o.precedence,n),r.instance=c;case"stylesheet":m=el(o.href);var g=n.querySelector(Qc(m));if(g)return r.state.loading|=4,r.instance=g,Mt(g),g;c=nE(o),(m=ri.get(m))&&fg(c,m),g=(n.ownerDocument||n).createElement("link"),Mt(g);var E=g;return E._p=new Promise(function(S,P){E.onload=S,E.onerror=P}),sn(g,"link",c),r.state.loading|=4,Td(g,o.precedence,n),r.instance=g;case"script":return g=tl(o.src),(m=n.querySelector(Kc(g)))?(r.instance=m,Mt(m),m):(c=o,(m=ri.get(g))&&(c=b({},o),mg(c,m)),n=n.ownerDocument||n,m=n.createElement("script"),Mt(m),sn(m,"link",c),n.head.appendChild(m),r.instance=m);case"void":return null;default:throw Error(i(443,r.type))}else r.type==="stylesheet"&&(r.state.loading&4)===0&&(c=r.instance,r.state.loading|=4,Td(c,o.precedence,n));return r.instance}function Td(n,r,o){for(var c=o.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),m=c.length?c[c.length-1]:null,g=m,E=0;E<c.length;E++){var S=c[E];if(S.dataset.precedence===r)g=S;else if(g!==m)break}g?g.parentNode.insertBefore(n,g.nextSibling):(r=o.nodeType===9?o.head:o,r.insertBefore(n,r.firstChild))}function fg(n,r){n.crossOrigin==null&&(n.crossOrigin=r.crossOrigin),n.referrerPolicy==null&&(n.referrerPolicy=r.referrerPolicy),n.title==null&&(n.title=r.title)}function mg(n,r){n.crossOrigin==null&&(n.crossOrigin=r.crossOrigin),n.referrerPolicy==null&&(n.referrerPolicy=r.referrerPolicy),n.integrity==null&&(n.integrity=r.integrity)}var xd=null;function sE(n,r,o){if(xd===null){var c=new Map,m=xd=new Map;m.set(o,c)}else m=xd,c=m.get(o),c||(c=new Map,m.set(o,c));if(c.has(n))return c;for(c.set(n,null),o=o.getElementsByTagName(n),m=0;m<o.length;m++){var g=o[m];if(!(g[Li]||g[Ot]||n==="link"&&g.getAttribute("rel")==="stylesheet")&&g.namespaceURI!=="http://www.w3.org/2000/svg"){var E=g.getAttribute(r)||"";E=n+E;var S=c.get(E);S?S.push(g):c.set(E,[g])}}return c}function rE(n,r,o){n=n.ownerDocument||n,n.head.insertBefore(o,r==="title"?n.querySelector("head > title"):null)}function g2(n,r,o){if(o===1||r.itemProp!=null)return!1;switch(n){case"meta":case"title":return!0;case"style":if(typeof r.precedence!="string"||typeof r.href!="string"||r.href==="")break;return!0;case"link":if(typeof r.rel!="string"||typeof r.href!="string"||r.href===""||r.onLoad||r.onError)break;return r.rel==="stylesheet"?(n=r.disabled,typeof r.precedence=="string"&&n==null):!0;case"script":if(r.async&&typeof r.async!="function"&&typeof r.async!="symbol"&&!r.onLoad&&!r.onError&&r.src&&typeof r.src=="string")return!0}return!1}function aE(n){return!(n.type==="stylesheet"&&(n.state.loading&3)===0)}function y2(n,r,o,c){if(o.type==="stylesheet"&&(typeof c.media!="string"||matchMedia(c.media).matches!==!1)&&(o.state.loading&4)===0){if(o.instance===null){var m=el(c.href),g=r.querySelector(Qc(m));if(g){r=g._p,r!==null&&typeof r=="object"&&typeof r.then=="function"&&(n.count++,n=Sd.bind(n),r.then(n,n)),o.state.loading|=4,o.instance=g,Mt(g);return}g=r.ownerDocument||r,c=nE(c),(m=ri.get(m))&&fg(c,m),g=g.createElement("link"),Mt(g);var E=g;E._p=new Promise(function(S,P){E.onload=S,E.onerror=P}),sn(g,"link",c),o.instance=g}n.stylesheets===null&&(n.stylesheets=new Map),n.stylesheets.set(o,r),(r=o.state.preload)&&(o.state.loading&3)===0&&(n.count++,o=Sd.bind(n),r.addEventListener("load",o),r.addEventListener("error",o))}}var pg=0;function v2(n,r){return n.stylesheets&&n.count===0&&Ad(n,n.stylesheets),0<n.count||0<n.imgCount?function(o){var c=setTimeout(function(){if(n.stylesheets&&Ad(n,n.stylesheets),n.unsuspend){var g=n.unsuspend;n.unsuspend=null,g()}},6e4+r);0<n.imgBytes&&pg===0&&(pg=62500*JI());var m=setTimeout(function(){if(n.waitingForImages=!1,n.count===0&&(n.stylesheets&&Ad(n,n.stylesheets),n.unsuspend)){var g=n.unsuspend;n.unsuspend=null,g()}},(n.imgBytes>pg?50:800)+r);return n.unsuspend=o,function(){n.unsuspend=null,clearTimeout(c),clearTimeout(m)}}:null}function Sd(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)Ad(this,this.stylesheets);else if(this.unsuspend){var n=this.unsuspend;this.unsuspend=null,n()}}}var wd=null;function Ad(n,r){n.stylesheets=null,n.unsuspend!==null&&(n.count++,wd=new Map,r.forEach(_2,n),wd=null,Sd.call(n))}function _2(n,r){if(!(r.state.loading&4)){var o=wd.get(n);if(o)var c=o.get(null);else{o=new Map,wd.set(n,o);for(var m=n.querySelectorAll("link[data-precedence],style[data-precedence]"),g=0;g<m.length;g++){var E=m[g];(E.nodeName==="LINK"||E.getAttribute("media")!=="not all")&&(o.set(E.dataset.precedence,E),c=E)}c&&o.set(null,c)}m=r.instance,E=m.getAttribute("data-precedence"),g=o.get(E)||c,g===c&&o.set(null,m),o.set(E,m),this.count++,c=Sd.bind(this),m.addEventListener("load",c),m.addEventListener("error",c),g?g.parentNode.insertBefore(m,g.nextSibling):(n=n.nodeType===9?n.head:n,n.insertBefore(m,n.firstChild)),r.state.loading|=4}}var $c={$$typeof:Y,Provider:null,Consumer:null,_currentValue:ye,_currentValue2:ye,_threadCount:0};function b2(n,r,o,c,m,g,E,S,P){this.tag=1,this.containerInfo=n,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=Vi(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Vi(0),this.hiddenUpdates=Vi(null),this.identifierPrefix=c,this.onUncaughtError=m,this.onCaughtError=g,this.onRecoverableError=E,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=P,this.incompleteTransitions=new Map}function oE(n,r,o,c,m,g,E,S,P,$,se,oe){return n=new b2(n,r,o,E,P,$,se,oe,S),r=1,g===!0&&(r|=24),g=Mn(3,null,null,r),n.current=g,g.stateNode=n,r=$m(),r.refCount++,n.pooledCache=r,r.refCount++,g.memoizedState={element:c,isDehydrated:o,cache:r},Jm(g),n}function lE(n){return n?(n=jo,n):jo}function cE(n,r,o,c,m,g){m=lE(m),c.context===null?c.context=m:c.pendingContext=m,c=pr(r),c.payload={element:o},g=g===void 0?null:g,g!==null&&(c.callback=g),o=gr(n,c,r),o!==null&&(An(o,n,r),Ac(o,n,r))}function uE(n,r){if(n=n.memoizedState,n!==null&&n.dehydrated!==null){var o=n.retryLane;n.retryLane=o!==0&&o<r?o:r}}function gg(n,r){uE(n,r),(n=n.alternate)&&uE(n,r)}function hE(n){if(n.tag===13||n.tag===31){var r=Sa(n,67108864);r!==null&&An(r,n,67108864),gg(n,67108864)}}function dE(n){if(n.tag===13||n.tag===31){var r=zn();r=da(r);var o=Sa(n,r);o!==null&&An(o,n,r),gg(n,r)}}var Id=!0;function E2(n,r,o,c){var m=G.T;G.T=null;var g=le.p;try{le.p=2,yg(n,r,o,c)}finally{le.p=g,G.T=m}}function T2(n,r,o,c){var m=G.T;G.T=null;var g=le.p;try{le.p=8,yg(n,r,o,c)}finally{le.p=g,G.T=m}}function yg(n,r,o,c){if(Id){var m=vg(c);if(m===null)ig(n,r,c,Cd,o),mE(n,c);else if(S2(m,n,r,o,c))c.stopPropagation();else if(mE(n,c),r&4&&-1<x2.indexOf(n)){for(;m!==null;){var g=$n(m);if(g!==null)switch(g.tag){case 3:if(g=g.stateNode,g.current.memoizedState.isDehydrated){var E=Oi(g.pendingLanes);if(E!==0){var S=g;for(S.pendingLanes|=2,S.entangledLanes|=2;E;){var P=1<<31-de(E);S.entanglements[1]|=P,E&=~P}Zi(g),(Je&6)===0&&(ud=vt()+500,Fc(0))}}break;case 31:case 13:S=Sa(g,2),S!==null&&An(S,g,2),dd(),gg(g,2)}if(g=vg(c),g===null&&ig(n,r,c,Cd,o),g===m)break;m=g}m!==null&&c.stopPropagation()}else ig(n,r,c,null,o)}}function vg(n){return n=Wn(n),_g(n)}var Cd=null;function _g(n){if(Cd=null,n=Ui(n),n!==null){var r=l(n);if(r===null)n=null;else{var o=r.tag;if(o===13){if(n=u(r),n!==null)return n;n=null}else if(o===31){if(n=f(r),n!==null)return n;n=null}else if(o===3){if(r.stateNode.current.memoizedState.isDehydrated)return r.tag===3?r.stateNode.containerInfo:null;n=null}else r!==n&&(n=null)}}return Cd=n,null}function fE(n){switch(n){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(Kn()){case oa:return 2;case la:return 8;case ki:case mo:return 32;case po:return 268435456;default:return 32}default:return 32}}var bg=!1,Ir=null,Cr=null,Rr=null,Wc=new Map,Yc=new Map,Dr=[],x2="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function mE(n,r){switch(n){case"focusin":case"focusout":Ir=null;break;case"dragenter":case"dragleave":Cr=null;break;case"mouseover":case"mouseout":Rr=null;break;case"pointerover":case"pointerout":Wc.delete(r.pointerId);break;case"gotpointercapture":case"lostpointercapture":Yc.delete(r.pointerId)}}function Xc(n,r,o,c,m,g){return n===null||n.nativeEvent!==g?(n={blockedOn:r,domEventName:o,eventSystemFlags:c,nativeEvent:g,targetContainers:[m]},r!==null&&(r=$n(r),r!==null&&hE(r)),n):(n.eventSystemFlags|=c,r=n.targetContainers,m!==null&&r.indexOf(m)===-1&&r.push(m),n)}function S2(n,r,o,c,m){switch(r){case"focusin":return Ir=Xc(Ir,n,r,o,c,m),!0;case"dragenter":return Cr=Xc(Cr,n,r,o,c,m),!0;case"mouseover":return Rr=Xc(Rr,n,r,o,c,m),!0;case"pointerover":var g=m.pointerId;return Wc.set(g,Xc(Wc.get(g)||null,n,r,o,c,m)),!0;case"gotpointercapture":return g=m.pointerId,Yc.set(g,Xc(Yc.get(g)||null,n,r,o,c,m)),!0}return!1}function pE(n){var r=Ui(n.target);if(r!==null){var o=l(r);if(o!==null){if(r=o.tag,r===13){if(r=u(o),r!==null){n.blockedOn=r,fi(n.priority,function(){dE(o)});return}}else if(r===31){if(r=f(o),r!==null){n.blockedOn=r,fi(n.priority,function(){dE(o)});return}}else if(r===3&&o.stateNode.current.memoizedState.isDehydrated){n.blockedOn=o.tag===3?o.stateNode.containerInfo:null;return}}}n.blockedOn=null}function Rd(n){if(n.blockedOn!==null)return!1;for(var r=n.targetContainers;0<r.length;){var o=vg(n.nativeEvent);if(o===null){o=n.nativeEvent;var c=new o.constructor(o.type,o);uc=c,o.target.dispatchEvent(c),uc=null}else return r=$n(o),r!==null&&hE(r),n.blockedOn=o,!1;r.shift()}return!0}function gE(n,r,o){Rd(n)&&o.delete(r)}function w2(){bg=!1,Ir!==null&&Rd(Ir)&&(Ir=null),Cr!==null&&Rd(Cr)&&(Cr=null),Rr!==null&&Rd(Rr)&&(Rr=null),Wc.forEach(gE),Yc.forEach(gE)}function Dd(n,r){n.blockedOn===r&&(n.blockedOn=null,bg||(bg=!0,s.unstable_scheduleCallback(s.unstable_NormalPriority,w2)))}var Nd=null;function yE(n){Nd!==n&&(Nd=n,s.unstable_scheduleCallback(s.unstable_NormalPriority,function(){Nd===n&&(Nd=null);for(var r=0;r<n.length;r+=3){var o=n[r],c=n[r+1],m=n[r+2];if(typeof c!="function"){if(_g(c||o)===null)continue;break}var g=$n(o);g!==null&&(n.splice(r,3),r-=3,vp(g,{pending:!0,data:m,method:o.method,action:c},c,m))}}))}function nl(n){function r(P){return Dd(P,n)}Ir!==null&&Dd(Ir,n),Cr!==null&&Dd(Cr,n),Rr!==null&&Dd(Rr,n),Wc.forEach(r),Yc.forEach(r);for(var o=0;o<Dr.length;o++){var c=Dr[o];c.blockedOn===n&&(c.blockedOn=null)}for(;0<Dr.length&&(o=Dr[0],o.blockedOn===null);)pE(o),o.blockedOn===null&&Dr.shift();if(o=(n.ownerDocument||n).$$reactFormReplay,o!=null)for(c=0;c<o.length;c+=3){var m=o[c],g=o[c+1],E=m[$t]||null;if(typeof g=="function")E||yE(o);else if(E){var S=null;if(g&&g.hasAttribute("formAction")){if(m=g,E=g[$t]||null)S=E.formAction;else if(_g(m)!==null)continue}else S=E.action;typeof S=="function"?o[c+1]=S:(o.splice(c,3),c-=3),yE(o)}}}function vE(){function n(g){g.canIntercept&&g.info==="react-transition"&&g.intercept({handler:function(){return new Promise(function(E){return m=E})},focusReset:"manual",scroll:"manual"})}function r(){m!==null&&(m(),m=null),c||setTimeout(o,20)}function o(){if(!c&&!navigation.transition){var g=navigation.currentEntry;g&&g.url!=null&&navigation.navigate(g.url,{state:g.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var c=!1,m=null;return navigation.addEventListener("navigate",n),navigation.addEventListener("navigatesuccess",r),navigation.addEventListener("navigateerror",r),setTimeout(o,100),function(){c=!0,navigation.removeEventListener("navigate",n),navigation.removeEventListener("navigatesuccess",r),navigation.removeEventListener("navigateerror",r),m!==null&&(m(),m=null)}}}function Eg(n){this._internalRoot=n}jd.prototype.render=Eg.prototype.render=function(n){var r=this._internalRoot;if(r===null)throw Error(i(409));var o=r.current,c=zn();cE(o,c,n,r,null,null)},jd.prototype.unmount=Eg.prototype.unmount=function(){var n=this._internalRoot;if(n!==null){this._internalRoot=null;var r=n.containerInfo;cE(n.current,2,null,n,null,null),dd(),r[Pi]=null}};function jd(n){this._internalRoot=n}jd.prototype.unstable_scheduleHydration=function(n){if(n){var r=dh();n={blockedOn:null,target:n,priority:r};for(var o=0;o<Dr.length&&r!==0&&r<Dr[o].priority;o++);Dr.splice(o,0,n),o===0&&pE(n)}};var _E=e.version;if(_E!=="19.2.4")throw Error(i(527,_E,"19.2.4"));le.findDOMNode=function(n){var r=n._reactInternals;if(r===void 0)throw typeof n.render=="function"?Error(i(188)):(n=Object.keys(n).join(","),Error(i(268,n)));return n=y(r),n=n!==null?_(n):null,n=n===null?null:n.stateNode,n};var A2={bundleType:0,version:"19.2.4",rendererPackageName:"react-dom",currentDispatcherRef:G,reconcilerVersion:"19.2.4"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var kd=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!kd.isDisabled&&kd.supportsFiber)try{Dn=kd.inject(A2),qt=kd}catch{}}return Zc.createRoot=function(n,r){if(!a(n))throw Error(i(299));var o=!1,c="",m=A0,g=I0,E=C0;return r!=null&&(r.unstable_strictMode===!0&&(o=!0),r.identifierPrefix!==void 0&&(c=r.identifierPrefix),r.onUncaughtError!==void 0&&(m=r.onUncaughtError),r.onCaughtError!==void 0&&(g=r.onCaughtError),r.onRecoverableError!==void 0&&(E=r.onRecoverableError)),r=oE(n,1,!1,null,null,o,c,null,m,g,E,vE),n[Pi]=r.current,ng(n),new Eg(r)},Zc.hydrateRoot=function(n,r,o){if(!a(n))throw Error(i(299));var c=!1,m="",g=A0,E=I0,S=C0,P=null;return o!=null&&(o.unstable_strictMode===!0&&(c=!0),o.identifierPrefix!==void 0&&(m=o.identifierPrefix),o.onUncaughtError!==void 0&&(g=o.onUncaughtError),o.onCaughtError!==void 0&&(E=o.onCaughtError),o.onRecoverableError!==void 0&&(S=o.onRecoverableError),o.formState!==void 0&&(P=o.formState)),r=oE(n,1,!0,r,o??null,c,m,P,g,E,S,vE),r.context=lE(null),o=r.current,c=zn(),c=da(c),m=pr(c),m.callback=null,gr(o,m,c),o=c,r.current.lanes=o,ua(r,o),Zi(r),n[Pi]=r.current,ng(n),new jd(r)},Zc.version="19.2.4",Zc}var RE;function P2(){if(RE)return Sg.exports;RE=1;function s(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(s)}catch(e){console.error(e)}}return s(),Sg.exports=V2(),Sg.exports}var L2=P2();var DE="popstate";function NE(s){return typeof s=="object"&&s!=null&&"pathname"in s&&"search"in s&&"hash"in s&&"state"in s&&"key"in s}function U2(s={}){function e(i,a){let l=a.state?.masked,{pathname:u,search:f,hash:p}=l||i.location;return Xg("",{pathname:u,search:f,hash:p},a.state&&a.state.usr||null,a.state&&a.state.key||"default",l?{pathname:i.location.pathname,search:i.location.search,hash:i.location.hash}:void 0)}function t(i,a){return typeof a=="string"?a:wu(a)}return B2(e,t,null,s)}function Tt(s,e){if(s===!1||s===null||typeof s>"u")throw new Error(e)}function oi(s,e){if(!s){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function z2(){return Math.random().toString(36).substring(2,10)}function jE(s,e){return{usr:s.state,key:s.key,idx:e,masked:s.unstable_mask?{pathname:s.pathname,search:s.search,hash:s.hash}:void 0}}function Xg(s,e,t=null,i,a){return{pathname:typeof s=="string"?s:s.pathname,search:"",hash:"",...typeof e=="string"?Fl(e):e,state:t,key:e&&e.key||i||z2(),unstable_mask:a}}function wu({pathname:s="/",search:e="",hash:t=""}){return e&&e!=="?"&&(s+=e.charAt(0)==="?"?e:"?"+e),t&&t!=="#"&&(s+=t.charAt(0)==="#"?t:"#"+t),s}function Fl(s){let e={};if(s){let t=s.indexOf("#");t>=0&&(e.hash=s.substring(t),s=s.substring(0,t));let i=s.indexOf("?");i>=0&&(e.search=s.substring(i),s=s.substring(0,i)),s&&(e.pathname=s)}return e}function B2(s,e,t,i={}){let{window:a=document.defaultView,v5Compat:l=!1}=i,u=a.history,f="POP",p=null,y=_();y==null&&(y=0,u.replaceState({...u.state,idx:y},""));function _(){return(u.state||{idx:null}).idx}function b(){f="POP";let V=_(),ee=V==null?null:V-y;y=V,p&&p({action:f,location:j.location,delta:ee})}function x(V,ee){f="PUSH";let ne=NE(V)?V:Xg(j.location,V,ee);y=_()+1;let Y=jE(ne,y),ie=j.createHref(ne.unstable_mask||ne);try{u.pushState(Y,"",ie)}catch(F){if(F instanceof DOMException&&F.name==="DataCloneError")throw F;a.location.assign(ie)}l&&p&&p({action:f,location:j.location,delta:1})}function k(V,ee){f="REPLACE";let ne=NE(V)?V:Xg(j.location,V,ee);y=_();let Y=jE(ne,y),ie=j.createHref(ne.unstable_mask||ne);u.replaceState(Y,"",ie),l&&p&&p({action:f,location:j.location,delta:0})}function M(V){return F2(V)}let j={get action(){return f},get location(){return s(a,u)},listen(V){if(p)throw new Error("A history only accepts one active listener");return a.addEventListener(DE,b),p=V,()=>{a.removeEventListener(DE,b),p=null}},createHref(V){return e(a,V)},createURL:M,encodeLocation(V){let ee=M(V);return{pathname:ee.pathname,search:ee.search,hash:ee.hash}},push:x,replace:k,go(V){return u.go(V)}};return j}function F2(s,e=!1){let t="http://localhost";typeof window<"u"&&(t=window.location.origin!=="null"?window.location.origin:window.location.href),Tt(t,"No window.location.(origin|href) available to create URL");let i=typeof s=="string"?s:wu(s);return i=i.replace(/ $/,"%20"),!e&&i.startsWith("//")&&(i=t+i),new URL(i,t)}function Gx(s,e,t="/"){return q2(s,e,t,!1)}function q2(s,e,t,i){let a=typeof e=="string"?Fl(e):e,l=qs(a.pathname||"/",t);if(l==null)return null;let u=Qx(s);H2(u);let f=null;for(let p=0;f==null&&p<u.length;++p){let y=tC(l);f=Z2(u[p],y,i)}return f}function Qx(s,e=[],t=[],i="",a=!1){let l=(u,f,p=a,y)=>{let _={relativePath:y===void 0?u.path||"":y,caseSensitive:u.caseSensitive===!0,childrenIndex:f,route:u};if(_.relativePath.startsWith("/")){if(!_.relativePath.startsWith(i)&&p)return;Tt(_.relativePath.startsWith(i),`Absolute route path "${_.relativePath}" nested under path "${i}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),_.relativePath=_.relativePath.slice(i.length)}let b=ss([i,_.relativePath]),x=t.concat(_);u.children&&u.children.length>0&&(Tt(u.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${b}".`),Qx(u.children,e,x,b,p)),!(u.path==null&&!u.index)&&e.push({path:b,score:X2(b,u.index),routesMeta:x})};return s.forEach((u,f)=>{if(u.path===""||!u.path?.includes("?"))l(u,f);else for(let p of Kx(u.path))l(u,f,!0,p)}),e}function Kx(s){let e=s.split("/");if(e.length===0)return[];let[t,...i]=e,a=t.endsWith("?"),l=t.replace(/\?$/,"");if(i.length===0)return a?[l,""]:[l];let u=Kx(i.join("/")),f=[];return f.push(...u.map(p=>p===""?l:[l,p].join("/"))),a&&f.push(...u),f.map(p=>s.startsWith("/")&&p===""?"/":p)}function H2(s){s.sort((e,t)=>e.score!==t.score?t.score-e.score:J2(e.routesMeta.map(i=>i.childrenIndex),t.routesMeta.map(i=>i.childrenIndex)))}var G2=/^:[\w-]+$/,Q2=3,K2=2,$2=1,W2=10,Y2=-2,kE=s=>s==="*";function X2(s,e){let t=s.split("/"),i=t.length;return t.some(kE)&&(i+=Y2),e&&(i+=K2),t.filter(a=>!kE(a)).reduce((a,l)=>a+(G2.test(l)?Q2:l===""?$2:W2),i)}function J2(s,e){return s.length===e.length&&s.slice(0,-1).every((i,a)=>i===e[a])?s[s.length-1]-e[e.length-1]:0}function Z2(s,e,t=!1){let{routesMeta:i}=s,a={},l="/",u=[];for(let f=0;f<i.length;++f){let p=i[f],y=f===i.length-1,_=l==="/"?e:e.slice(l.length)||"/",b=pf({path:p.relativePath,caseSensitive:p.caseSensitive,end:y},_),x=p.route;if(!b&&y&&t&&!i[i.length-1].route.index&&(b=pf({path:p.relativePath,caseSensitive:p.caseSensitive,end:!1},_)),!b)return null;Object.assign(a,b.params),u.push({params:a,pathname:ss([l,b.pathname]),pathnameBase:rC(ss([l,b.pathnameBase])),route:x}),b.pathnameBase!=="/"&&(l=ss([l,b.pathnameBase]))}return u}function pf(s,e){typeof s=="string"&&(s={path:s,caseSensitive:!1,end:!0});let[t,i]=eC(s.path,s.caseSensitive,s.end),a=e.match(t);if(!a)return null;let l=a[0],u=l.replace(/(.)\/+$/,"$1"),f=a.slice(1);return{params:i.reduce((y,{paramName:_,isOptional:b},x)=>{if(_==="*"){let M=f[x]||"";u=l.slice(0,l.length-M.length).replace(/(.)\/+$/,"$1")}const k=f[x];return b&&!k?y[_]=void 0:y[_]=(k||"").replace(/%2F/g,"/"),y},{}),pathname:l,pathnameBase:u,pattern:s}}function eC(s,e=!1,t=!0){oi(s==="*"||!s.endsWith("*")||s.endsWith("/*"),`Route path "${s}" will be treated as if it were "${s.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${s.replace(/\*$/,"/*")}".`);let i=[],a="^"+s.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(u,f,p,y,_)=>{if(i.push({paramName:f,isOptional:p!=null}),p){let b=_.charAt(y+u.length);return b&&b!=="/"?"/([^\\/]*)":"(?:/([^\\/]*))?"}return"/([^\\/]+)"}).replace(/\/([\w-]+)\?(\/|$)/g,"(/$1)?$2");return s.endsWith("*")?(i.push({paramName:"*"}),a+=s==="*"||s==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):t?a+="\\/*$":s!==""&&s!=="/"&&(a+="(?:(?=\\/|$))"),[new RegExp(a,e?void 0:"i"),i]}function tC(s){try{return s.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return oi(!1,`The URL path "${s}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${e}).`),s}}function qs(s,e){if(e==="/")return s;if(!s.toLowerCase().startsWith(e.toLowerCase()))return null;let t=e.endsWith("/")?e.length-1:e.length,i=s.charAt(t);return i&&i!=="/"?null:s.slice(t)||"/"}var nC=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i;function iC(s,e="/"){let{pathname:t,search:i="",hash:a=""}=typeof s=="string"?Fl(s):s,l;return t?(t=t.replace(/\/\/+/g,"/"),t.startsWith("/")?l=OE(t.substring(1),"/"):l=OE(t,e)):l=e,{pathname:l,search:aC(i),hash:oC(a)}}function OE(s,e){let t=e.replace(/\/+$/,"").split("/");return s.split("/").forEach(a=>{a===".."?t.length>1&&t.pop():a!=="."&&t.push(a)}),t.length>1?t.join("/"):"/"}function Cg(s,e,t,i){return`Cannot include a '${s}' character in a manually specified \`to.${e}\` field [${JSON.stringify(i)}].  Please separate it out to the \`to.${t}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function sC(s){return s.filter((e,t)=>t===0||e.route.path&&e.route.path.length>0)}function My(s){let e=sC(s);return e.map((t,i)=>i===e.length-1?t.pathname:t.pathnameBase)}function Qf(s,e,t,i=!1){let a;typeof s=="string"?a=Fl(s):(a={...s},Tt(!a.pathname||!a.pathname.includes("?"),Cg("?","pathname","search",a)),Tt(!a.pathname||!a.pathname.includes("#"),Cg("#","pathname","hash",a)),Tt(!a.search||!a.search.includes("#"),Cg("#","search","hash",a)));let l=s===""||a.pathname==="",u=l?"/":a.pathname,f;if(u==null)f=t;else{let b=e.length-1;if(!i&&u.startsWith("..")){let x=u.split("/");for(;x[0]==="..";)x.shift(),b-=1;a.pathname=x.join("/")}f=b>=0?e[b]:"/"}let p=iC(a,f),y=u&&u!=="/"&&u.endsWith("/"),_=(l||u===".")&&t.endsWith("/");return!p.pathname.endsWith("/")&&(y||_)&&(p.pathname+="/"),p}var ss=s=>s.join("/").replace(/\/\/+/g,"/"),rC=s=>s.replace(/\/+$/,"").replace(/^\/*/,"/"),aC=s=>!s||s==="?"?"":s.startsWith("?")?s:"?"+s,oC=s=>!s||s==="#"?"":s.startsWith("#")?s:"#"+s,lC=class{constructor(s,e,t,i=!1){this.status=s,this.statusText=e||"",this.internal=i,t instanceof Error?(this.data=t.toString(),this.error=t):this.data=t}};function cC(s){return s!=null&&typeof s.status=="number"&&typeof s.statusText=="string"&&typeof s.internal=="boolean"&&"data"in s}function uC(s){return s.map(e=>e.route.path).filter(Boolean).join("/").replace(/\/\/*/g,"/")||"/"}var $x=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";function Wx(s,e){let t=s;if(typeof t!="string"||!nC.test(t))return{absoluteURL:void 0,isExternal:!1,to:t};let i=t,a=!1;if($x)try{let l=new URL(window.location.href),u=t.startsWith("//")?new URL(l.protocol+t):new URL(t),f=qs(u.pathname,e);u.origin===l.origin&&f!=null?t=f+u.search+u.hash:a=!0}catch{oi(!1,`<Link to="${t}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}return{absoluteURL:i,isExternal:a,to:t}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");var Yx=["POST","PUT","PATCH","DELETE"];new Set(Yx);var hC=["GET",...Yx];new Set(hC);var ql=N.createContext(null);ql.displayName="DataRouter";var Kf=N.createContext(null);Kf.displayName="DataRouterState";var dC=N.createContext(!1),Xx=N.createContext({isTransitioning:!1});Xx.displayName="ViewTransition";var fC=N.createContext(new Map);fC.displayName="Fetchers";var mC=N.createContext(null);mC.displayName="Await";var Qn=N.createContext(null);Qn.displayName="Navigation";var Bu=N.createContext(null);Bu.displayName="Location";var ci=N.createContext({outlet:null,matches:[],isDataRoute:!1});ci.displayName="Route";var Vy=N.createContext(null);Vy.displayName="RouteError";var Jx="REACT_ROUTER_ERROR",pC="REDIRECT",gC="ROUTE_ERROR_RESPONSE";function yC(s){if(s.startsWith(`${Jx}:${pC}:{`))try{let e=JSON.parse(s.slice(28));if(typeof e=="object"&&e&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.location=="string"&&typeof e.reloadDocument=="boolean"&&typeof e.replace=="boolean")return e}catch{}}function vC(s){if(s.startsWith(`${Jx}:${gC}:{`))try{let e=JSON.parse(s.slice(40));if(typeof e=="object"&&e&&typeof e.status=="number"&&typeof e.statusText=="string")return new lC(e.status,e.statusText,e.data)}catch{}}function _C(s,{relative:e}={}){Tt(Hl(),"useHref() may be used only in the context of a <Router> component.");let{basename:t,navigator:i}=N.useContext(Qn),{hash:a,pathname:l,search:u}=Fu(s,{relative:e}),f=l;return t!=="/"&&(f=l==="/"?t:ss([t,l])),i.createHref({pathname:f,search:u,hash:a})}function Hl(){return N.useContext(Bu)!=null}function ui(){return Tt(Hl(),"useLocation() may be used only in the context of a <Router> component."),N.useContext(Bu).location}var Zx="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function e1(s){N.useContext(Qn).static||N.useLayoutEffect(s)}function an(){let{isDataRoute:s}=N.useContext(ci);return s?MC():bC()}function bC(){Tt(Hl(),"useNavigate() may be used only in the context of a <Router> component.");let s=N.useContext(ql),{basename:e,navigator:t}=N.useContext(Qn),{matches:i}=N.useContext(ci),{pathname:a}=ui(),l=JSON.stringify(My(i)),u=N.useRef(!1);return e1(()=>{u.current=!0}),N.useCallback((p,y={})=>{if(oi(u.current,Zx),!u.current)return;if(typeof p=="number"){t.go(p);return}let _=Qf(p,JSON.parse(l),a,y.relative==="path");s==null&&e!=="/"&&(_.pathname=_.pathname==="/"?e:ss([e,_.pathname])),(y.replace?t.replace:t.push)(_,y.state,y)},[e,t,l,a,s])}var EC=N.createContext(null);function TC(s){let e=N.useContext(ci).outlet;return N.useMemo(()=>e&&N.createElement(EC.Provider,{value:s},e),[e,s])}function xC(){let{matches:s}=N.useContext(ci),e=s[s.length-1];return e?e.params:{}}function Fu(s,{relative:e}={}){let{matches:t}=N.useContext(ci),{pathname:i}=ui(),a=JSON.stringify(My(t));return N.useMemo(()=>Qf(s,JSON.parse(a),i,e==="path"),[s,a,i,e])}function SC(s,e){return t1(s,e)}function t1(s,e,t){Tt(Hl(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:i}=N.useContext(Qn),{matches:a}=N.useContext(ci),l=a[a.length-1],u=l?l.params:{},f=l?l.pathname:"/",p=l?l.pathnameBase:"/",y=l&&l.route;{let V=y&&y.path||"";i1(f,!y||V.endsWith("*")||V.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${f}" (under <Route path="${V}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${V}"> to <Route path="${V==="/"?"*":`${V}/*`}">.`)}let _=ui(),b;if(e){let V=typeof e=="string"?Fl(e):e;Tt(p==="/"||V.pathname?.startsWith(p),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${p}" but pathname "${V.pathname}" was given in the \`location\` prop.`),b=V}else b=_;let x=b.pathname||"/",k=x;if(p!=="/"){let V=p.replace(/^\//,"").split("/");k="/"+x.replace(/^\//,"").split("/").slice(V.length).join("/")}let M=Gx(s,{pathname:k});oi(y||M!=null,`No routes matched location "${b.pathname}${b.search}${b.hash}" `),oi(M==null||M[M.length-1].route.element!==void 0||M[M.length-1].route.Component!==void 0||M[M.length-1].route.lazy!==void 0,`Matched leaf route at location "${b.pathname}${b.search}${b.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`);let j=RC(M&&M.map(V=>Object.assign({},V,{params:Object.assign({},u,V.params),pathname:ss([p,i.encodeLocation?i.encodeLocation(V.pathname.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:V.pathname]),pathnameBase:V.pathnameBase==="/"?p:ss([p,i.encodeLocation?i.encodeLocation(V.pathnameBase.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:V.pathnameBase])})),a,t);return e&&j?N.createElement(Bu.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",unstable_mask:void 0,...b},navigationType:"POP"}},j):j}function wC(){let s=OC(),e=cC(s)?`${s.status} ${s.statusText}`:s instanceof Error?s.message:JSON.stringify(s),t=s instanceof Error?s.stack:null,i="rgba(200,200,200, 0.5)",a={padding:"0.5rem",backgroundColor:i},l={padding:"2px 4px",backgroundColor:i},u=null;return console.error("Error handled by React Router default ErrorBoundary:",s),u=N.createElement(N.Fragment,null,N.createElement("p",null," Hey developer "),N.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",N.createElement("code",{style:l},"ErrorBoundary")," or"," ",N.createElement("code",{style:l},"errorElement")," prop on your route.")),N.createElement(N.Fragment,null,N.createElement("h2",null,"Unexpected Application Error!"),N.createElement("h3",{style:{fontStyle:"italic"}},e),t?N.createElement("pre",{style:a},t):null,u)}var AC=N.createElement(wC,null),n1=class extends N.Component{constructor(s){super(s),this.state={location:s.location,revalidation:s.revalidation,error:s.error}}static getDerivedStateFromError(s){return{error:s}}static getDerivedStateFromProps(s,e){return e.location!==s.location||e.revalidation!=="idle"&&s.revalidation==="idle"?{error:s.error,location:s.location,revalidation:s.revalidation}:{error:s.error!==void 0?s.error:e.error,location:e.location,revalidation:s.revalidation||e.revalidation}}componentDidCatch(s,e){this.props.onError?this.props.onError(s,e):console.error("React Router caught the following error during render",s)}render(){let s=this.state.error;if(this.context&&typeof s=="object"&&s&&"digest"in s&&typeof s.digest=="string"){const t=vC(s.digest);t&&(s=t)}let e=s!==void 0?N.createElement(ci.Provider,{value:this.props.routeContext},N.createElement(Vy.Provider,{value:s,children:this.props.component})):this.props.children;return this.context?N.createElement(IC,{error:s},e):e}};n1.contextType=dC;var Rg=new WeakMap;function IC({children:s,error:e}){let{basename:t}=N.useContext(Qn);if(typeof e=="object"&&e&&"digest"in e&&typeof e.digest=="string"){let i=yC(e.digest);if(i){let a=Rg.get(e);if(a)throw a;let l=Wx(i.location,t);if($x&&!Rg.get(e))if(l.isExternal||i.reloadDocument)window.location.href=l.absoluteURL||l.to;else{const u=Promise.resolve().then(()=>window.__reactRouterDataRouter.navigate(l.to,{replace:i.replace}));throw Rg.set(e,u),u}return N.createElement("meta",{httpEquiv:"refresh",content:`0;url=${l.absoluteURL||l.to}`})}}return s}function CC({routeContext:s,match:e,children:t}){let i=N.useContext(ql);return i&&i.static&&i.staticContext&&(e.route.errorElement||e.route.ErrorBoundary)&&(i.staticContext._deepestRenderedBoundaryId=e.route.id),N.createElement(ci.Provider,{value:s},t)}function RC(s,e=[],t){let i=t?.state;if(s==null){if(!i)return null;if(i.errors)s=i.matches;else if(e.length===0&&!i.initialized&&i.matches.length>0)s=i.matches;else return null}let a=s,l=i?.errors;if(l!=null){let _=a.findIndex(b=>b.route.id&&l?.[b.route.id]!==void 0);Tt(_>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(l).join(",")}`),a=a.slice(0,Math.min(a.length,_+1))}let u=!1,f=-1;if(t&&i){u=i.renderFallback;for(let _=0;_<a.length;_++){let b=a[_];if((b.route.HydrateFallback||b.route.hydrateFallbackElement)&&(f=_),b.route.id){let{loaderData:x,errors:k}=i,M=b.route.loader&&!x.hasOwnProperty(b.route.id)&&(!k||k[b.route.id]===void 0);if(b.route.lazy||M){t.isStatic&&(u=!0),f>=0?a=a.slice(0,f+1):a=[a[0]];break}}}}let p=t?.onError,y=i&&p?(_,b)=>{p(_,{location:i.location,params:i.matches?.[0]?.params??{},unstable_pattern:uC(i.matches),errorInfo:b})}:void 0;return a.reduceRight((_,b,x)=>{let k,M=!1,j=null,V=null;i&&(k=l&&b.route.id?l[b.route.id]:void 0,j=b.route.errorElement||AC,u&&(f<0&&x===0?(i1("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),M=!0,V=null):f===x&&(M=!0,V=b.route.hydrateFallbackElement||null)));let ee=e.concat(a.slice(0,x+1)),ne=()=>{let Y;return k?Y=j:M?Y=V:b.route.Component?Y=N.createElement(b.route.Component,null):b.route.element?Y=b.route.element:Y=_,N.createElement(CC,{match:b,routeContext:{outlet:_,matches:ee,isDataRoute:i!=null},children:Y})};return i&&(b.route.ErrorBoundary||b.route.errorElement||x===0)?N.createElement(n1,{location:i.location,revalidation:i.revalidation,component:j,error:k,children:ne(),routeContext:{outlet:null,matches:ee,isDataRoute:!0},onError:y}):ne()},null)}function Py(s){return`${s} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function DC(s){let e=N.useContext(ql);return Tt(e,Py(s)),e}function NC(s){let e=N.useContext(Kf);return Tt(e,Py(s)),e}function jC(s){let e=N.useContext(ci);return Tt(e,Py(s)),e}function Ly(s){let e=jC(s),t=e.matches[e.matches.length-1];return Tt(t.route.id,`${s} can only be used on routes that contain a unique "id"`),t.route.id}function kC(){return Ly("useRouteId")}function OC(){let s=N.useContext(Vy),e=NC("useRouteError"),t=Ly("useRouteError");return s!==void 0?s:e.errors?.[t]}function MC(){let{router:s}=DC("useNavigate"),e=Ly("useNavigate"),t=N.useRef(!1);return e1(()=>{t.current=!0}),N.useCallback(async(a,l={})=>{oi(t.current,Zx),t.current&&(typeof a=="number"?await s.navigate(a):await s.navigate(a,{fromRouteId:e,...l}))},[s,e])}var ME={};function i1(s,e,t){!e&&!ME[s]&&(ME[s]=!0,oi(!1,t))}N.memo(VC);function VC({routes:s,future:e,state:t,isStatic:i,onError:a}){return t1(s,void 0,{state:t,isStatic:i,onError:a})}function PC({to:s,replace:e,state:t,relative:i}){Tt(Hl(),"<Navigate> may be used only in the context of a <Router> component.");let{static:a}=N.useContext(Qn);oi(!a,"<Navigate> must not be used on the initial render in a <StaticRouter>. This is a no-op, but you should modify your code so the <Navigate> is only ever rendered in response to some user interaction or state change.");let{matches:l}=N.useContext(ci),{pathname:u}=ui(),f=an(),p=Qf(s,My(l),u,i==="path"),y=JSON.stringify(p);return N.useEffect(()=>{f(JSON.parse(y),{replace:e,state:t,relative:i})},[f,y,i,e,t]),null}function LC(s){return TC(s.context)}function cn(s){Tt(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function UC({basename:s="/",children:e=null,location:t,navigationType:i="POP",navigator:a,static:l=!1,unstable_useTransitions:u}){Tt(!Hl(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let f=s.replace(/^\/*/,"/"),p=N.useMemo(()=>({basename:f,navigator:a,static:l,unstable_useTransitions:u,future:{}}),[f,a,l,u]);typeof t=="string"&&(t=Fl(t));let{pathname:y="/",search:_="",hash:b="",state:x=null,key:k="default",unstable_mask:M}=t,j=N.useMemo(()=>{let V=qs(y,f);return V==null?null:{location:{pathname:V,search:_,hash:b,state:x,key:k,unstable_mask:M},navigationType:i}},[f,y,_,b,x,k,i,M]);return oi(j!=null,`<Router basename="${f}"> is not able to match the URL "${y}${_}${b}" because it does not start with the basename, so the <Router> won't render anything.`),j==null?null:N.createElement(Qn.Provider,{value:p},N.createElement(Bu.Provider,{children:e,value:j}))}function zC({children:s,location:e}){return SC(Jg(s),e)}function Jg(s,e=[]){let t=[];return N.Children.forEach(s,(i,a)=>{if(!N.isValidElement(i))return;let l=[...e,a];if(i.type===N.Fragment){t.push.apply(t,Jg(i.props.children,l));return}Tt(i.type===cn,`[${typeof i.type=="string"?i.type:i.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),Tt(!i.props.index||!i.props.children,"An index route cannot have child routes.");let u={id:i.props.id||l.join("-"),caseSensitive:i.props.caseSensitive,element:i.props.element,Component:i.props.Component,index:i.props.index,path:i.props.path,middleware:i.props.middleware,loader:i.props.loader,action:i.props.action,hydrateFallbackElement:i.props.hydrateFallbackElement,HydrateFallback:i.props.HydrateFallback,errorElement:i.props.errorElement,ErrorBoundary:i.props.ErrorBoundary,hasErrorBoundary:i.props.hasErrorBoundary===!0||i.props.ErrorBoundary!=null||i.props.errorElement!=null,shouldRevalidate:i.props.shouldRevalidate,handle:i.props.handle,lazy:i.props.lazy};i.props.children&&(u.children=Jg(i.props.children,l)),t.push(u)}),t}var Wd="get",Yd="application/x-www-form-urlencoded";function $f(s){return typeof HTMLElement<"u"&&s instanceof HTMLElement}function BC(s){return $f(s)&&s.tagName.toLowerCase()==="button"}function FC(s){return $f(s)&&s.tagName.toLowerCase()==="form"}function qC(s){return $f(s)&&s.tagName.toLowerCase()==="input"}function HC(s){return!!(s.metaKey||s.altKey||s.ctrlKey||s.shiftKey)}function GC(s,e){return s.button===0&&(!e||e==="_self")&&!HC(s)}function Zg(s=""){return new URLSearchParams(typeof s=="string"||Array.isArray(s)||s instanceof URLSearchParams?s:Object.keys(s).reduce((e,t)=>{let i=s[t];return e.concat(Array.isArray(i)?i.map(a=>[t,a]):[[t,i]])},[]))}function QC(s,e){let t=Zg(s);return e&&e.forEach((i,a)=>{t.has(a)||e.getAll(a).forEach(l=>{t.append(a,l)})}),t}var Md=null;function KC(){if(Md===null)try{new FormData(document.createElement("form"),0),Md=!1}catch{Md=!0}return Md}var $C=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function Dg(s){return s!=null&&!$C.has(s)?(oi(!1,`"${s}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${Yd}"`),null):s}function WC(s,e){let t,i,a,l,u;if(FC(s)){let f=s.getAttribute("action");i=f?qs(f,e):null,t=s.getAttribute("method")||Wd,a=Dg(s.getAttribute("enctype"))||Yd,l=new FormData(s)}else if(BC(s)||qC(s)&&(s.type==="submit"||s.type==="image")){let f=s.form;if(f==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let p=s.getAttribute("formaction")||f.getAttribute("action");if(i=p?qs(p,e):null,t=s.getAttribute("formmethod")||f.getAttribute("method")||Wd,a=Dg(s.getAttribute("formenctype"))||Dg(f.getAttribute("enctype"))||Yd,l=new FormData(f,s),!KC()){let{name:y,type:_,value:b}=s;if(_==="image"){let x=y?`${y}.`:"";l.append(`${x}x`,"0"),l.append(`${x}y`,"0")}else y&&l.append(y,b)}}else{if($f(s))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');t=Wd,i=null,a=Yd,u=s}return l&&a==="text/plain"&&(u=l,l=void 0),{action:i,method:t.toLowerCase(),encType:a,formData:l,body:u}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");function Uy(s,e){if(s===!1||s===null||typeof s>"u")throw new Error(e)}function YC(s,e,t,i){let a=typeof s=="string"?new URL(s,typeof window>"u"?"server://singlefetch/":window.location.origin):s;return t?a.pathname.endsWith("/")?a.pathname=`${a.pathname}_.${i}`:a.pathname=`${a.pathname}.${i}`:a.pathname==="/"?a.pathname=`_root.${i}`:e&&qs(a.pathname,e)==="/"?a.pathname=`${e.replace(/\/$/,"")}/_root.${i}`:a.pathname=`${a.pathname.replace(/\/$/,"")}.${i}`,a}async function XC(s,e){if(s.id in e)return e[s.id];try{let t=await import(s.module);return e[s.id]=t,t}catch(t){return console.error(`Error loading route module \`${s.module}\`, reloading page...`),console.error(t),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function JC(s){return s==null?!1:s.href==null?s.rel==="preload"&&typeof s.imageSrcSet=="string"&&typeof s.imageSizes=="string":typeof s.rel=="string"&&typeof s.href=="string"}async function ZC(s,e,t){let i=await Promise.all(s.map(async a=>{let l=e.routes[a.route.id];if(l){let u=await XC(l,t);return u.links?u.links():[]}return[]}));return iR(i.flat(1).filter(JC).filter(a=>a.rel==="stylesheet"||a.rel==="preload").map(a=>a.rel==="stylesheet"?{...a,rel:"prefetch",as:"style"}:{...a,rel:"prefetch"}))}function VE(s,e,t,i,a,l){let u=(p,y)=>t[y]?p.route.id!==t[y].route.id:!0,f=(p,y)=>t[y].pathname!==p.pathname||t[y].route.path?.endsWith("*")&&t[y].params["*"]!==p.params["*"];return l==="assets"?e.filter((p,y)=>u(p,y)||f(p,y)):l==="data"?e.filter((p,y)=>{let _=i.routes[p.route.id];if(!_||!_.hasLoader)return!1;if(u(p,y)||f(p,y))return!0;if(p.route.shouldRevalidate){let b=p.route.shouldRevalidate({currentUrl:new URL(a.pathname+a.search+a.hash,window.origin),currentParams:t[0]?.params||{},nextUrl:new URL(s,window.origin),nextParams:p.params,defaultShouldRevalidate:!0});if(typeof b=="boolean")return b}return!0}):[]}function eR(s,e,{includeHydrateFallback:t}={}){return tR(s.map(i=>{let a=e.routes[i.route.id];if(!a)return[];let l=[a.module];return a.clientActionModule&&(l=l.concat(a.clientActionModule)),a.clientLoaderModule&&(l=l.concat(a.clientLoaderModule)),t&&a.hydrateFallbackModule&&(l=l.concat(a.hydrateFallbackModule)),a.imports&&(l=l.concat(a.imports)),l}).flat(1))}function tR(s){return[...new Set(s)]}function nR(s){let e={},t=Object.keys(s).sort();for(let i of t)e[i]=s[i];return e}function iR(s,e){let t=new Set;return new Set(e),s.reduce((i,a)=>{let l=JSON.stringify(nR(a));return t.has(l)||(t.add(l),i.push({key:l,link:a})),i},[])}function s1(){let s=N.useContext(ql);return Uy(s,"You must render this element inside a <DataRouterContext.Provider> element"),s}function sR(){let s=N.useContext(Kf);return Uy(s,"You must render this element inside a <DataRouterStateContext.Provider> element"),s}var zy=N.createContext(void 0);zy.displayName="FrameworkContext";function r1(){let s=N.useContext(zy);return Uy(s,"You must render this element inside a <HydratedRouter> element"),s}function rR(s,e){let t=N.useContext(zy),[i,a]=N.useState(!1),[l,u]=N.useState(!1),{onFocus:f,onBlur:p,onMouseEnter:y,onMouseLeave:_,onTouchStart:b}=e,x=N.useRef(null);N.useEffect(()=>{if(s==="render"&&u(!0),s==="viewport"){let j=ee=>{ee.forEach(ne=>{u(ne.isIntersecting)})},V=new IntersectionObserver(j,{threshold:.5});return x.current&&V.observe(x.current),()=>{V.disconnect()}}},[s]),N.useEffect(()=>{if(i){let j=setTimeout(()=>{u(!0)},100);return()=>{clearTimeout(j)}}},[i]);let k=()=>{a(!0)},M=()=>{a(!1),u(!1)};return t?s!=="intent"?[l,x,{}]:[l,x,{onFocus:eu(f,k),onBlur:eu(p,M),onMouseEnter:eu(y,k),onMouseLeave:eu(_,M),onTouchStart:eu(b,k)}]:[!1,x,{}]}function eu(s,e){return t=>{s&&s(t),t.defaultPrevented||e(t)}}function aR({page:s,...e}){let{router:t}=s1(),i=N.useMemo(()=>Gx(t.routes,s,t.basename),[t.routes,s,t.basename]);return i?N.createElement(lR,{page:s,matches:i,...e}):null}function oR(s){let{manifest:e,routeModules:t}=r1(),[i,a]=N.useState([]);return N.useEffect(()=>{let l=!1;return ZC(s,e,t).then(u=>{l||a(u)}),()=>{l=!0}},[s,e,t]),i}function lR({page:s,matches:e,...t}){let i=ui(),{future:a,manifest:l,routeModules:u}=r1(),{basename:f}=s1(),{loaderData:p,matches:y}=sR(),_=N.useMemo(()=>VE(s,e,y,l,i,"data"),[s,e,y,l,i]),b=N.useMemo(()=>VE(s,e,y,l,i,"assets"),[s,e,y,l,i]),x=N.useMemo(()=>{if(s===i.pathname+i.search+i.hash)return[];let j=new Set,V=!1;if(e.forEach(ne=>{let Y=l.routes[ne.route.id];!Y||!Y.hasLoader||(!_.some(ie=>ie.route.id===ne.route.id)&&ne.route.id in p&&u[ne.route.id]?.shouldRevalidate||Y.hasClientLoader?V=!0:j.add(ne.route.id))}),j.size===0)return[];let ee=YC(s,f,a.unstable_trailingSlashAwareDataRequests,"data");return V&&j.size>0&&ee.searchParams.set("_routes",e.filter(ne=>j.has(ne.route.id)).map(ne=>ne.route.id).join(",")),[ee.pathname+ee.search]},[f,a.unstable_trailingSlashAwareDataRequests,p,i,l,_,e,s,u]),k=N.useMemo(()=>eR(b,l),[b,l]),M=oR(b);return N.createElement(N.Fragment,null,x.map(j=>N.createElement("link",{key:j,rel:"prefetch",as:"fetch",href:j,...t})),k.map(j=>N.createElement("link",{key:j,rel:"modulepreload",href:j,...t})),M.map(({key:j,link:V})=>N.createElement("link",{key:j,nonce:t.nonce,...V,crossOrigin:V.crossOrigin??t.crossOrigin})))}function cR(...s){return e=>{s.forEach(t=>{typeof t=="function"?t(e):t!=null&&(t.current=e)})}}var uR=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{uR&&(window.__reactRouterVersion="7.13.1")}catch{}function hR({basename:s,children:e,unstable_useTransitions:t,window:i}){let a=N.useRef();a.current==null&&(a.current=U2({window:i,v5Compat:!0}));let l=a.current,[u,f]=N.useState({action:l.action,location:l.location}),p=N.useCallback(y=>{t===!1?f(y):N.startTransition(()=>f(y))},[t]);return N.useLayoutEffect(()=>l.listen(p),[l,p]),N.createElement(UC,{basename:s,children:e,location:u.location,navigationType:u.action,navigator:l,unstable_useTransitions:t})}var a1=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,o1=N.forwardRef(function({onClick:e,discover:t="render",prefetch:i="none",relative:a,reloadDocument:l,replace:u,unstable_mask:f,state:p,target:y,to:_,preventScrollReset:b,viewTransition:x,unstable_defaultShouldRevalidate:k,...M},j){let{basename:V,navigator:ee,unstable_useTransitions:ne}=N.useContext(Qn),Y=typeof _=="string"&&a1.test(_),ie=Wx(_,V);_=ie.to;let F=_C(_,{relative:a}),J=ui(),C=null;if(f){let pe=Qf(f,[],J.unstable_mask?J.unstable_mask.pathname:"/",!0);V!=="/"&&(pe.pathname=pe.pathname==="/"?V:ss([V,pe.pathname])),C=ee.createHref(pe)}let[R,w,I]=rR(i,M),D=mR(_,{replace:u,unstable_mask:f,state:p,target:y,preventScrollReset:b,relative:a,viewTransition:x,unstable_defaultShouldRevalidate:k,unstable_useTransitions:ne});function L(pe){e&&e(pe),pe.defaultPrevented||D(pe)}let O=!(ie.isExternal||l),Se=N.createElement("a",{...M,...I,href:(O?C:void 0)||ie.absoluteURL||F,onClick:O?L:e,ref:cR(j,w),target:y,"data-discover":!Y&&t==="render"?"true":void 0});return R&&!Y?N.createElement(N.Fragment,null,Se,N.createElement(aR,{page:F})):Se});o1.displayName="Link";var l1=N.forwardRef(function({"aria-current":e="page",caseSensitive:t=!1,className:i="",end:a=!1,style:l,to:u,viewTransition:f,children:p,...y},_){let b=Fu(u,{relative:y.relative}),x=ui(),k=N.useContext(Kf),{navigator:M,basename:j}=N.useContext(Qn),V=k!=null&&_R(b)&&f===!0,ee=M.encodeLocation?M.encodeLocation(b).pathname:b.pathname,ne=x.pathname,Y=k&&k.navigation&&k.navigation.location?k.navigation.location.pathname:null;t||(ne=ne.toLowerCase(),Y=Y?Y.toLowerCase():null,ee=ee.toLowerCase()),Y&&j&&(Y=qs(Y,j)||Y);const ie=ee!=="/"&&ee.endsWith("/")?ee.length-1:ee.length;let F=ne===ee||!a&&ne.startsWith(ee)&&ne.charAt(ie)==="/",J=Y!=null&&(Y===ee||!a&&Y.startsWith(ee)&&Y.charAt(ee.length)==="/"),C={isActive:F,isPending:J,isTransitioning:V},R=F?e:void 0,w;typeof i=="function"?w=i(C):w=[i,F?"active":null,J?"pending":null,V?"transitioning":null].filter(Boolean).join(" ");let I=typeof l=="function"?l(C):l;return N.createElement(o1,{...y,"aria-current":R,className:w,ref:_,style:I,to:u,viewTransition:f},typeof p=="function"?p(C):p)});l1.displayName="NavLink";var dR=N.forwardRef(({discover:s="render",fetcherKey:e,navigate:t,reloadDocument:i,replace:a,state:l,method:u=Wd,action:f,onSubmit:p,relative:y,preventScrollReset:_,viewTransition:b,unstable_defaultShouldRevalidate:x,...k},M)=>{let{unstable_useTransitions:j}=N.useContext(Qn),V=yR(),ee=vR(f,{relative:y}),ne=u.toLowerCase()==="get"?"get":"post",Y=typeof f=="string"&&a1.test(f),ie=F=>{if(p&&p(F),F.defaultPrevented)return;F.preventDefault();let J=F.nativeEvent.submitter,C=J?.getAttribute("formmethod")||u,R=()=>V(J||F.currentTarget,{fetcherKey:e,method:C,navigate:t,replace:a,state:l,relative:y,preventScrollReset:_,viewTransition:b,unstable_defaultShouldRevalidate:x});j&&t!==!1?N.startTransition(()=>R()):R()};return N.createElement("form",{ref:M,method:ne,action:ee,onSubmit:i?p:ie,...k,"data-discover":!Y&&s==="render"?"true":void 0})});dR.displayName="Form";function fR(s){return`${s} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function c1(s){let e=N.useContext(ql);return Tt(e,fR(s)),e}function mR(s,{target:e,replace:t,unstable_mask:i,state:a,preventScrollReset:l,relative:u,viewTransition:f,unstable_defaultShouldRevalidate:p,unstable_useTransitions:y}={}){let _=an(),b=ui(),x=Fu(s,{relative:u});return N.useCallback(k=>{if(GC(k,e)){k.preventDefault();let M=t!==void 0?t:wu(b)===wu(x),j=()=>_(s,{replace:M,unstable_mask:i,state:a,preventScrollReset:l,relative:u,viewTransition:f,unstable_defaultShouldRevalidate:p});y?N.startTransition(()=>j()):j()}},[b,_,x,t,i,a,e,s,l,u,f,p,y])}function u1(s){oi(typeof URLSearchParams<"u","You cannot use the `useSearchParams` hook in a browser that does not support the URLSearchParams API. If you need to support Internet Explorer 11, we recommend you load a polyfill such as https://github.com/ungap/url-search-params.");let e=N.useRef(Zg(s)),t=N.useRef(!1),i=ui(),a=N.useMemo(()=>QC(i.search,t.current?null:e.current),[i.search]),l=an(),u=N.useCallback((f,p)=>{const y=Zg(typeof f=="function"?f(new URLSearchParams(a)):f);t.current=!0,l("?"+y,p)},[l,a]);return[a,u]}var pR=0,gR=()=>`__${String(++pR)}__`;function yR(){let{router:s}=c1("useSubmit"),{basename:e}=N.useContext(Qn),t=kC(),i=s.fetch,a=s.navigate;return N.useCallback(async(l,u={})=>{let{action:f,method:p,encType:y,formData:_,body:b}=WC(l,e);if(u.navigate===!1){let x=u.fetcherKey||gR();await i(x,t,u.action||f,{unstable_defaultShouldRevalidate:u.unstable_defaultShouldRevalidate,preventScrollReset:u.preventScrollReset,formData:_,body:b,formMethod:u.method||p,formEncType:u.encType||y,flushSync:u.flushSync})}else await a(u.action||f,{unstable_defaultShouldRevalidate:u.unstable_defaultShouldRevalidate,preventScrollReset:u.preventScrollReset,formData:_,body:b,formMethod:u.method||p,formEncType:u.encType||y,replace:u.replace,state:u.state,fromRouteId:t,flushSync:u.flushSync,viewTransition:u.viewTransition})},[i,a,e,t])}function vR(s,{relative:e}={}){let{basename:t}=N.useContext(Qn),i=N.useContext(ci);Tt(i,"useFormAction must be used inside a RouteContext");let[a]=i.matches.slice(-1),l={...Fu(s||".",{relative:e})},u=ui();if(s==null){l.search=u.search;let f=new URLSearchParams(l.search),p=f.getAll("index");if(p.some(_=>_==="")){f.delete("index"),p.filter(b=>b).forEach(b=>f.append("index",b));let _=f.toString();l.search=_?`?${_}`:""}}return(!s||s===".")&&a.route.index&&(l.search=l.search?l.search.replace(/^\?/,"?index&"):"?index"),t!=="/"&&(l.pathname=l.pathname==="/"?t:ss([t,l.pathname])),wu(l)}function _R(s,{relative:e}={}){let t=N.useContext(Xx);Tt(t!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:i}=c1("useViewTransitionState"),a=Fu(s,{relative:e});if(!t.isTransitioning)return!1;let l=qs(t.currentLocation.pathname,i)||t.currentLocation.pathname,u=qs(t.nextLocation.pathname,i)||t.nextLocation.pathname;return pf(a.pathname,u)!=null||pf(a.pathname,l)!=null}function Xd({isOpen:s,onClose:e,title:t,children:i,size:a="md",showClose:l=!0}){const u=N.useCallback(f=>{f.key==="Escape"&&e?.()},[e]);return N.useEffect(()=>(s&&(document.addEventListener("keydown",u),document.body.style.overflow="hidden"),()=>{document.removeEventListener("keydown",u),document.body.style.overflow=""}),[s,u]),s?d.jsxs("div",{className:"np-modal-backdrop",children:[d.jsx("div",{className:"np-modal-overlay",onClick:e}),d.jsxs("div",{className:`np-modal np-modal-${a}`,children:[(t||l)&&d.jsxs("div",{className:"np-modal-header",children:[t&&d.jsx("h2",{className:"np-modal-title",children:t}),l&&d.jsx("button",{onClick:e,className:"np-modal-close",children:d.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:d.jsx("path",{d:"M18 6L6 18M6 6l12 12"})})})]}),d.jsx("div",{className:"np-modal-body",children:i})]})]}):null}const PE=s=>{let e;const t=new Set,i=(y,_)=>{const b=typeof y=="function"?y(e):y;if(!Object.is(b,e)){const x=e;e=_??(typeof b!="object"||b===null)?b:Object.assign({},e,b),t.forEach(k=>k(e,x))}},a=()=>e,f={setState:i,getState:a,getInitialState:()=>p,subscribe:y=>(t.add(y),()=>t.delete(y))},p=e=s(i,a,f);return f},bR=(s=>s?PE(s):PE),ER=s=>s;function TR(s,e=ER){const t=Od.useSyncExternalStore(s.subscribe,Od.useCallback(()=>e(s.getState()),[s,e]),Od.useCallback(()=>e(s.getInitialState()),[s,e]));return Od.useDebugValue(t),t}const LE=s=>{const e=bR(s),t=i=>TR(e,i);return Object.assign(t,e),t},Wf=(s=>s?LE(s):LE),Gl=Wf(s=>({isOnline:navigator.onLine,sidebarCollapsed:!1,accentColor:"#6C63FF",fontSize:"medium",toasts:[],setIsOnline:e=>s({isOnline:e}),toggleSidebar:()=>s(e=>({sidebarCollapsed:!e.sidebarCollapsed})),setSidebarCollapsed:e=>s({sidebarCollapsed:e}),setAccentColor:e=>{document.documentElement.style.setProperty("--primary",e),s({accentColor:e})},setFontSize:e=>{document.documentElement.setAttribute("data-font-size",e),s({fontSize:e})},addToast:e=>s(t=>({toasts:[...t.toasts,{id:Date.now(),...e}]})),removeToast:e=>s(t=>({toasts:t.toasts.filter(i=>i.id!==e)}))}));function xR({toast:s,onRemove:e}){N.useEffect(()=>{const a=setTimeout(()=>e(s.id),s.duration||4e3);return()=>clearTimeout(a)},[s,e]);const t=`np-toast-${s.type||"info"}`,i={success:d.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"#00D9A3",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[d.jsx("path",{d:"M22 11.08V12a10 10 0 11-5.93-9.14"}),d.jsx("polyline",{points:"22 4 12 14.01 9 11.01"})]}),error:d.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"#FF6B6B",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[d.jsx("circle",{cx:"12",cy:"12",r:"10"}),d.jsx("line",{x1:"15",y1:"9",x2:"9",y2:"15"}),d.jsx("line",{x1:"9",y1:"9",x2:"15",y2:"15"})]}),warning:d.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"#FFB347",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[d.jsx("path",{d:"M10.29 3.86L1.82 18a2 2 0 001.71 3h16.94a2 2 0 001.71-3L13.71 3.86a2 2 0 00-3.42 0z"}),d.jsx("line",{x1:"12",y1:"9",x2:"12",y2:"13"}),d.jsx("line",{x1:"12",y1:"17",x2:"12.01",y2:"17"})]}),info:d.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"#6C63FF",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[d.jsx("circle",{cx:"12",cy:"12",r:"10"}),d.jsx("line",{x1:"12",y1:"16",x2:"12",y2:"12"}),d.jsx("line",{x1:"12",y1:"8",x2:"12.01",y2:"8"})]})};return d.jsxs("div",{className:`np-toast ${t}`,children:[d.jsx("div",{style:{flexShrink:0,marginTop:2},children:i[s.type]||i.info}),d.jsxs("div",{style:{flex:1,minWidth:0},children:[s.title&&d.jsx("p",{className:"np-toast-title",children:s.title}),d.jsx("p",{className:"np-toast-message",children:s.message})]}),d.jsx("button",{onClick:()=>e(s.id),style:{flexShrink:0,padding:4,borderRadius:6,color:"var(--muted)",transition:"color 0.15s"},children:d.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:d.jsx("path",{d:"M18 6L6 18M6 6l12 12"})})})]})}function SR(){const{toasts:s,removeToast:e}=Gl();return s.length===0?null:d.jsx("div",{className:"np-toast-container",children:s.map(t=>d.jsx(xR,{toast:t,onRemove:e},t.id))})}function wR(){return d.jsx("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",minHeight:"60vh"},children:d.jsxs("div",{style:{textAlign:"center"},children:[d.jsxs("div",{style:{position:"relative",width:48,height:48,margin:"0 auto 16px"},children:[d.jsx("div",{style:{position:"absolute",inset:0,borderRadius:"50%",border:"3px solid rgba(255,255,255,0.08)",borderTopColor:"var(--primary)",animation:"spin 0.8s linear infinite"}}),d.jsx("div",{style:{position:"absolute",inset:4,borderRadius:"50%",border:"3px solid transparent",borderBottomColor:"var(--secondary)",animation:"spin 1.2s linear infinite reverse"}})]}),d.jsx("p",{style:{fontSize:"0.85rem",color:"var(--muted)"},children:"Loading..."})]})})}function h1({progress:s=0,size:e=120,strokeWidth:t=8,color:i="var(--primary)",trackColor:a="var(--border)",animated:l=!0,children:u,className:f=""}){const[p,y]=N.useState(0),_=(e-t)/2,b=2*Math.PI*_,x=b-p/100*b;return N.useEffect(()=>{if(l){const k=setTimeout(()=>{y(Math.min(100,Math.max(0,s)))},100);return()=>clearTimeout(k)}else y(s)},[s,l]),d.jsxs("div",{className:`relative inline-flex items-center justify-center ${f}`,children:[d.jsxs("svg",{width:e,height:e,className:"-rotate-90",children:[d.jsx("circle",{cx:e/2,cy:e/2,r:_,fill:"none",stroke:a,strokeWidth:t}),d.jsx("circle",{cx:e/2,cy:e/2,r:_,fill:"none",stroke:i,strokeWidth:t,strokeLinecap:"round",strokeDasharray:b,strokeDashoffset:x,style:{transition:l?"stroke-dashoffset 1s cubic-bezier(0.4, 0, 0.2, 1)":"none",filter:`drop-shadow(0 0 6px ${i})`}})]}),u&&d.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:u})]})}const AR=()=>{};var UE={};const d1=function(s){const e=[];let t=0;for(let i=0;i<s.length;i++){let a=s.charCodeAt(i);a<128?e[t++]=a:a<2048?(e[t++]=a>>6|192,e[t++]=a&63|128):(a&64512)===55296&&i+1<s.length&&(s.charCodeAt(i+1)&64512)===56320?(a=65536+((a&1023)<<10)+(s.charCodeAt(++i)&1023),e[t++]=a>>18|240,e[t++]=a>>12&63|128,e[t++]=a>>6&63|128,e[t++]=a&63|128):(e[t++]=a>>12|224,e[t++]=a>>6&63|128,e[t++]=a&63|128)}return e},IR=function(s){const e=[];let t=0,i=0;for(;t<s.length;){const a=s[t++];if(a<128)e[i++]=String.fromCharCode(a);else if(a>191&&a<224){const l=s[t++];e[i++]=String.fromCharCode((a&31)<<6|l&63)}else if(a>239&&a<365){const l=s[t++],u=s[t++],f=s[t++],p=((a&7)<<18|(l&63)<<12|(u&63)<<6|f&63)-65536;e[i++]=String.fromCharCode(55296+(p>>10)),e[i++]=String.fromCharCode(56320+(p&1023))}else{const l=s[t++],u=s[t++];e[i++]=String.fromCharCode((a&15)<<12|(l&63)<<6|u&63)}}return e.join("")},f1={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(s,e){if(!Array.isArray(s))throw Error("encodeByteArray takes an array as a parameter");this.init_();const t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,i=[];for(let a=0;a<s.length;a+=3){const l=s[a],u=a+1<s.length,f=u?s[a+1]:0,p=a+2<s.length,y=p?s[a+2]:0,_=l>>2,b=(l&3)<<4|f>>4;let x=(f&15)<<2|y>>6,k=y&63;p||(k=64,u||(x=64)),i.push(t[_],t[b],t[x],t[k])}return i.join("")},encodeString(s,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(s):this.encodeByteArray(d1(s),e)},decodeString(s,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(s):IR(this.decodeStringToByteArray(s,e))},decodeStringToByteArray(s,e){this.init_();const t=e?this.charToByteMapWebSafe_:this.charToByteMap_,i=[];for(let a=0;a<s.length;){const l=t[s.charAt(a++)],f=a<s.length?t[s.charAt(a)]:0;++a;const y=a<s.length?t[s.charAt(a)]:64;++a;const b=a<s.length?t[s.charAt(a)]:64;if(++a,l==null||f==null||y==null||b==null)throw new CR;const x=l<<2|f>>4;if(i.push(x),y!==64){const k=f<<4&240|y>>2;if(i.push(k),b!==64){const M=y<<6&192|b;i.push(M)}}}return i},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let s=0;s<this.ENCODED_VALS.length;s++)this.byteToCharMap_[s]=this.ENCODED_VALS.charAt(s),this.charToByteMap_[this.byteToCharMap_[s]]=s,this.byteToCharMapWebSafe_[s]=this.ENCODED_VALS_WEBSAFE.charAt(s),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[s]]=s,s>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(s)]=s,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(s)]=s)}}};class CR extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const RR=function(s){const e=d1(s);return f1.encodeByteArray(e,!0)},gf=function(s){return RR(s).replace(/\./g,"")},m1=function(s){try{return f1.decodeString(s,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};function p1(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}const DR=()=>p1().__FIREBASE_DEFAULTS__,NR=()=>{if(typeof process>"u"||typeof UE>"u")return;const s=UE.__FIREBASE_DEFAULTS__;if(s)return JSON.parse(s)},jR=()=>{if(typeof document>"u")return;let s;try{s=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=s&&m1(s[1]);return e&&JSON.parse(e)},Yf=()=>{try{return AR()||DR()||NR()||jR()}catch(s){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${s}`);return}},g1=s=>Yf()?.emulatorHosts?.[s],kR=s=>{const e=g1(s);if(!e)return;const t=e.lastIndexOf(":");if(t<=0||t+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const i=parseInt(e.substring(t+1),10);return e[0]==="["?[e.substring(1,t-1),i]:[e.substring(0,t),i]},y1=()=>Yf()?.config,v1=s=>Yf()?.[`_${s}`];class OR{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,i)=>{t?this.reject(t):this.resolve(i),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,i))}}}function lo(s){try{return(s.startsWith("http://")||s.startsWith("https://")?new URL(s).hostname:s).endsWith(".cloudworkstations.dev")}catch{return!1}}async function By(s){return(await fetch(s,{credentials:"include"})).ok}function MR(s,e){if(s.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const t={alg:"none",type:"JWT"},i=e||"demo-project",a=s.iat||0,l=s.sub||s.user_id;if(!l)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const u={iss:`https://securetoken.google.com/${i}`,aud:i,iat:a,exp:a+3600,auth_time:a,sub:l,user_id:l,firebase:{sign_in_provider:"custom",identities:{}},...s};return[gf(JSON.stringify(t)),gf(JSON.stringify(u)),""].join(".")}const mu={};function VR(){const s={prod:[],emulator:[]};for(const e of Object.keys(mu))mu[e]?s.emulator.push(e):s.prod.push(e);return s}function PR(s){let e=document.getElementById(s),t=!1;return e||(e=document.createElement("div"),e.setAttribute("id",s),t=!0),{created:t,element:e}}let zE=!1;function _1(s,e){if(typeof window>"u"||typeof document>"u"||!lo(window.location.host)||mu[s]===e||mu[s]||zE)return;mu[s]=e;function t(x){return`__firebase__banner__${x}`}const i="__firebase__banner",l=VR().prod.length>0;function u(){const x=document.getElementById(i);x&&x.remove()}function f(x){x.style.display="flex",x.style.background="#7faaf0",x.style.position="fixed",x.style.bottom="5px",x.style.left="5px",x.style.padding=".5em",x.style.borderRadius="5px",x.style.alignItems="center"}function p(x,k){x.setAttribute("width","24"),x.setAttribute("id",k),x.setAttribute("height","24"),x.setAttribute("viewBox","0 0 24 24"),x.setAttribute("fill","none"),x.style.marginLeft="-6px"}function y(){const x=document.createElement("span");return x.style.cursor="pointer",x.style.marginLeft="16px",x.style.fontSize="24px",x.innerHTML=" &times;",x.onclick=()=>{zE=!0,u()},x}function _(x,k){x.setAttribute("id",k),x.innerText="Learn more",x.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",x.setAttribute("target","__blank"),x.style.paddingLeft="5px",x.style.textDecoration="underline"}function b(){const x=PR(i),k=t("text"),M=document.getElementById(k)||document.createElement("span"),j=t("learnmore"),V=document.getElementById(j)||document.createElement("a"),ee=t("preprendIcon"),ne=document.getElementById(ee)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(x.created){const Y=x.element;f(Y),_(V,j);const ie=y();p(ne,ee),Y.append(ne,M,V,ie),document.body.appendChild(Y)}l?(M.innerText="Preview backend disconnected.",ne.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(ne.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,M.innerText="Preview backend running in this workspace."),M.setAttribute("id",k)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",b):b()}function Qt(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function LR(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Qt())}function b1(){const s=Yf()?.forceEnvironment;if(s==="node")return!0;if(s==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function UR(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function zR(){const s=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof s=="object"&&s.id!==void 0}function BR(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function FR(){const s=Qt();return s.indexOf("MSIE ")>=0||s.indexOf("Trident/")>=0}function E1(){return!b1()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function T1(){return!b1()&&!!navigator.userAgent&&(navigator.userAgent.includes("Safari")||navigator.userAgent.includes("WebKit"))&&!navigator.userAgent.includes("Chrome")}function x1(){try{return typeof indexedDB=="object"}catch{return!1}}function qR(){return new Promise((s,e)=>{try{let t=!0;const i="validate-browser-context-for-indexeddb-analytics-module",a=self.indexedDB.open(i);a.onsuccess=()=>{a.result.close(),t||self.indexedDB.deleteDatabase(i),s(!0)},a.onupgradeneeded=()=>{t=!1},a.onerror=()=>{e(a.error?.message||"")}}catch(t){e(t)}})}const HR="FirebaseError";class ds extends Error{constructor(e,t,i){super(t),this.code=e,this.customData=i,this.name=HR,Object.setPrototypeOf(this,ds.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,qu.prototype.create)}}class qu{constructor(e,t,i){this.service=e,this.serviceName=t,this.errors=i}create(e,...t){const i=t[0]||{},a=`${this.service}/${e}`,l=this.errors[e],u=l?GR(l,i):"Error",f=`${this.serviceName}: ${u} (${a}).`;return new ds(a,f,i)}}function GR(s,e){return s.replace(QR,(t,i)=>{const a=e[i];return a!=null?String(a):`<${i}?>`})}const QR=/\{\$([^}]+)}/g;function KR(s){for(const e in s)if(Object.prototype.hasOwnProperty.call(s,e))return!1;return!0}function Ya(s,e){if(s===e)return!0;const t=Object.keys(s),i=Object.keys(e);for(const a of t){if(!i.includes(a))return!1;const l=s[a],u=e[a];if(BE(l)&&BE(u)){if(!Ya(l,u))return!1}else if(l!==u)return!1}for(const a of i)if(!t.includes(a))return!1;return!0}function BE(s){return s!==null&&typeof s=="object"}function Hu(s){const e=[];for(const[t,i]of Object.entries(s))Array.isArray(i)?i.forEach(a=>{e.push(encodeURIComponent(t)+"="+encodeURIComponent(a))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(i));return e.length?"&"+e.join("&"):""}function ou(s){const e={};return s.replace(/^\?/,"").split("&").forEach(i=>{if(i){const[a,l]=i.split("=");e[decodeURIComponent(a)]=decodeURIComponent(l)}}),e}function lu(s){const e=s.indexOf("?");if(!e)return"";const t=s.indexOf("#",e);return s.substring(e,t>0?t:void 0)}function $R(s,e){const t=new WR(s,e);return t.subscribe.bind(t)}class WR{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(i=>{this.error(i)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,i){let a;if(e===void 0&&t===void 0&&i===void 0)throw new Error("Missing Observer.");YR(e,["next","error","complete"])?a=e:a={next:e,error:t,complete:i},a.next===void 0&&(a.next=Ng),a.error===void 0&&(a.error=Ng),a.complete===void 0&&(a.complete=Ng);const l=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?a.error(this.finalError):a.complete()}catch{}}),this.observers.push(a),l}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{t(this.observers[e])}catch(i){typeof console<"u"&&console.error&&console.error(i)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function YR(s,e){if(typeof s!="object"||s===null)return!1;for(const t of e)if(t in s&&typeof s[t]=="function")return!0;return!1}function Ng(){}function It(s){return s&&s._delegate?s._delegate:s}class $r{constructor(e,t,i){this.name=e,this.instanceFactory=t,this.type=i,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}const La="[DEFAULT]";class XR{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const i=new OR;if(this.instancesDeferred.set(t,i),this.isInitialized(t)||this.shouldAutoInitialize())try{const a=this.getOrInitializeService({instanceIdentifier:t});a&&i.resolve(a)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){const t=this.normalizeInstanceIdentifier(e?.identifier),i=e?.optional??!1;if(this.isInitialized(t)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:t})}catch(a){if(i)return null;throw a}else{if(i)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(ZR(e))try{this.getOrInitializeService({instanceIdentifier:La})}catch{}for(const[t,i]of this.instancesDeferred.entries()){const a=this.normalizeInstanceIdentifier(t);try{const l=this.getOrInitializeService({instanceIdentifier:a});i.resolve(l)}catch{}}}}clearInstance(e=La){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=La){return this.instances.has(e)}getOptions(e=La){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:t={}}=e,i=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(i))throw Error(`${this.name}(${i}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const a=this.getOrInitializeService({instanceIdentifier:i,options:t});for(const[l,u]of this.instancesDeferred.entries()){const f=this.normalizeInstanceIdentifier(l);i===f&&u.resolve(a)}return a}onInit(e,t){const i=this.normalizeInstanceIdentifier(t),a=this.onInitCallbacks.get(i)??new Set;a.add(e),this.onInitCallbacks.set(i,a);const l=this.instances.get(i);return l&&e(l,i),()=>{a.delete(e)}}invokeOnInitCallbacks(e,t){const i=this.onInitCallbacks.get(t);if(i)for(const a of i)try{a(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let i=this.instances.get(e);if(!i&&this.component&&(i=this.component.instanceFactory(this.container,{instanceIdentifier:JR(e),options:t}),this.instances.set(e,i),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(i,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,i)}catch{}return i||null}normalizeInstanceIdentifier(e=La){return this.component?this.component.multipleInstances?e:La:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function JR(s){return s===La?void 0:s}function ZR(s){return s.instantiationMode==="EAGER"}class eD{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new XR(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}var Fe;(function(s){s[s.DEBUG=0]="DEBUG",s[s.VERBOSE=1]="VERBOSE",s[s.INFO=2]="INFO",s[s.WARN=3]="WARN",s[s.ERROR=4]="ERROR",s[s.SILENT=5]="SILENT"})(Fe||(Fe={}));const tD={debug:Fe.DEBUG,verbose:Fe.VERBOSE,info:Fe.INFO,warn:Fe.WARN,error:Fe.ERROR,silent:Fe.SILENT},nD=Fe.INFO,iD={[Fe.DEBUG]:"log",[Fe.VERBOSE]:"log",[Fe.INFO]:"info",[Fe.WARN]:"warn",[Fe.ERROR]:"error"},sD=(s,e,...t)=>{if(e<s.logLevel)return;const i=new Date().toISOString(),a=iD[e];if(a)console[a](`[${i}]  ${s.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class Fy{constructor(e){this.name=e,this._logLevel=nD,this._logHandler=sD,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in Fe))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?tD[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,Fe.DEBUG,...e),this._logHandler(this,Fe.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,Fe.VERBOSE,...e),this._logHandler(this,Fe.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,Fe.INFO,...e),this._logHandler(this,Fe.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,Fe.WARN,...e),this._logHandler(this,Fe.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,Fe.ERROR,...e),this._logHandler(this,Fe.ERROR,...e)}}const rD=(s,e)=>e.some(t=>s instanceof t);let FE,qE;function aD(){return FE||(FE=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function oD(){return qE||(qE=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const S1=new WeakMap,ey=new WeakMap,w1=new WeakMap,jg=new WeakMap,qy=new WeakMap;function lD(s){const e=new Promise((t,i)=>{const a=()=>{s.removeEventListener("success",l),s.removeEventListener("error",u)},l=()=>{t(qr(s.result)),a()},u=()=>{i(s.error),a()};s.addEventListener("success",l),s.addEventListener("error",u)});return e.then(t=>{t instanceof IDBCursor&&S1.set(t,s)}).catch(()=>{}),qy.set(e,s),e}function cD(s){if(ey.has(s))return;const e=new Promise((t,i)=>{const a=()=>{s.removeEventListener("complete",l),s.removeEventListener("error",u),s.removeEventListener("abort",u)},l=()=>{t(),a()},u=()=>{i(s.error||new DOMException("AbortError","AbortError")),a()};s.addEventListener("complete",l),s.addEventListener("error",u),s.addEventListener("abort",u)});ey.set(s,e)}let ty={get(s,e,t){if(s instanceof IDBTransaction){if(e==="done")return ey.get(s);if(e==="objectStoreNames")return s.objectStoreNames||w1.get(s);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return qr(s[e])},set(s,e,t){return s[e]=t,!0},has(s,e){return s instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in s}};function uD(s){ty=s(ty)}function hD(s){return s===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){const i=s.call(kg(this),e,...t);return w1.set(i,e.sort?e.sort():[e]),qr(i)}:oD().includes(s)?function(...e){return s.apply(kg(this),e),qr(S1.get(this))}:function(...e){return qr(s.apply(kg(this),e))}}function dD(s){return typeof s=="function"?hD(s):(s instanceof IDBTransaction&&cD(s),rD(s,aD())?new Proxy(s,ty):s)}function qr(s){if(s instanceof IDBRequest)return lD(s);if(jg.has(s))return jg.get(s);const e=dD(s);return e!==s&&(jg.set(s,e),qy.set(e,s)),e}const kg=s=>qy.get(s);function fD(s,e,{blocked:t,upgrade:i,blocking:a,terminated:l}={}){const u=indexedDB.open(s,e),f=qr(u);return i&&u.addEventListener("upgradeneeded",p=>{i(qr(u.result),p.oldVersion,p.newVersion,qr(u.transaction),p)}),t&&u.addEventListener("blocked",p=>t(p.oldVersion,p.newVersion,p)),f.then(p=>{l&&p.addEventListener("close",()=>l()),a&&p.addEventListener("versionchange",y=>a(y.oldVersion,y.newVersion,y))}).catch(()=>{}),f}const mD=["get","getKey","getAll","getAllKeys","count"],pD=["put","add","delete","clear"],Og=new Map;function HE(s,e){if(!(s instanceof IDBDatabase&&!(e in s)&&typeof e=="string"))return;if(Og.get(e))return Og.get(e);const t=e.replace(/FromIndex$/,""),i=e!==t,a=pD.includes(t);if(!(t in(i?IDBIndex:IDBObjectStore).prototype)||!(a||mD.includes(t)))return;const l=async function(u,...f){const p=this.transaction(u,a?"readwrite":"readonly");let y=p.store;return i&&(y=y.index(f.shift())),(await Promise.all([y[t](...f),a&&p.done]))[0]};return Og.set(e,l),l}uD(s=>({...s,get:(e,t,i)=>HE(e,t)||s.get(e,t,i),has:(e,t)=>!!HE(e,t)||s.has(e,t)}));class gD{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(yD(t)){const i=t.getImmediate();return`${i.library}/${i.version}`}else return null}).filter(t=>t).join(" ")}}function yD(s){return s.getComponent()?.type==="VERSION"}const ny="@firebase/app",GE="0.14.8";const Hs=new Fy("@firebase/app"),vD="@firebase/app-compat",_D="@firebase/analytics-compat",bD="@firebase/analytics",ED="@firebase/app-check-compat",TD="@firebase/app-check",xD="@firebase/auth",SD="@firebase/auth-compat",wD="@firebase/database",AD="@firebase/data-connect",ID="@firebase/database-compat",CD="@firebase/functions",RD="@firebase/functions-compat",DD="@firebase/installations",ND="@firebase/installations-compat",jD="@firebase/messaging",kD="@firebase/messaging-compat",OD="@firebase/performance",MD="@firebase/performance-compat",VD="@firebase/remote-config",PD="@firebase/remote-config-compat",LD="@firebase/storage",UD="@firebase/storage-compat",zD="@firebase/firestore",BD="@firebase/ai",FD="@firebase/firestore-compat",qD="firebase",HD="12.9.0";const iy="[DEFAULT]",GD={[ny]:"fire-core",[vD]:"fire-core-compat",[bD]:"fire-analytics",[_D]:"fire-analytics-compat",[TD]:"fire-app-check",[ED]:"fire-app-check-compat",[xD]:"fire-auth",[SD]:"fire-auth-compat",[wD]:"fire-rtdb",[AD]:"fire-data-connect",[ID]:"fire-rtdb-compat",[CD]:"fire-fn",[RD]:"fire-fn-compat",[DD]:"fire-iid",[ND]:"fire-iid-compat",[jD]:"fire-fcm",[kD]:"fire-fcm-compat",[OD]:"fire-perf",[MD]:"fire-perf-compat",[VD]:"fire-rc",[PD]:"fire-rc-compat",[LD]:"fire-gcs",[UD]:"fire-gcs-compat",[zD]:"fire-fst",[FD]:"fire-fst-compat",[BD]:"fire-vertex","fire-js":"fire-js",[qD]:"fire-js-all"};const yf=new Map,QD=new Map,sy=new Map;function QE(s,e){try{s.container.addComponent(e)}catch(t){Hs.debug(`Component ${e.name} failed to register with FirebaseApp ${s.name}`,t)}}function Xa(s){const e=s.name;if(sy.has(e))return Hs.debug(`There were multiple attempts to register component ${e}.`),!1;sy.set(e,s);for(const t of yf.values())QE(t,s);for(const t of QD.values())QE(t,s);return!0}function Xf(s,e){const t=s.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),s.container.getProvider(e)}function Fn(s){return s==null?!1:s.settings!==void 0}const KD={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},Hr=new qu("app","Firebase",KD);class $D{constructor(e,t,i){this._isDeleted=!1,this._options={...e},this._config={...t},this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=i,this.container.addComponent(new $r("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Hr.create("app-deleted",{appName:this._name})}}const co=HD;function A1(s,e={}){let t=s;typeof e!="object"&&(e={name:e});const i={name:iy,automaticDataCollectionEnabled:!0,...e},a=i.name;if(typeof a!="string"||!a)throw Hr.create("bad-app-name",{appName:String(a)});if(t||(t=y1()),!t)throw Hr.create("no-options");const l=yf.get(a);if(l){if(Ya(t,l.options)&&Ya(i,l.config))return l;throw Hr.create("duplicate-app",{appName:a})}const u=new eD(a);for(const p of sy.values())u.addComponent(p);const f=new $D(t,i,u);return yf.set(a,f),f}function I1(s=iy){const e=yf.get(s);if(!e&&s===iy&&y1())return A1();if(!e)throw Hr.create("no-app",{appName:s});return e}function rs(s,e,t){let i=GD[s]??s;t&&(i+=`-${t}`);const a=i.match(/\s|\//),l=e.match(/\s|\//);if(a||l){const u=[`Unable to register library "${i}" with version "${e}":`];a&&u.push(`library name "${i}" contains illegal characters (whitespace or "/")`),a&&l&&u.push("and"),l&&u.push(`version name "${e}" contains illegal characters (whitespace or "/")`),Hs.warn(u.join(" "));return}Xa(new $r(`${i}-version`,()=>({library:i,version:e}),"VERSION"))}const WD="firebase-heartbeat-database",YD=1,Au="firebase-heartbeat-store";let Mg=null;function C1(){return Mg||(Mg=fD(WD,YD,{upgrade:(s,e)=>{switch(e){case 0:try{s.createObjectStore(Au)}catch(t){console.warn(t)}}}}).catch(s=>{throw Hr.create("idb-open",{originalErrorMessage:s.message})})),Mg}async function XD(s){try{const t=(await C1()).transaction(Au),i=await t.objectStore(Au).get(R1(s));return await t.done,i}catch(e){if(e instanceof ds)Hs.warn(e.message);else{const t=Hr.create("idb-get",{originalErrorMessage:e?.message});Hs.warn(t.message)}}}async function KE(s,e){try{const i=(await C1()).transaction(Au,"readwrite");await i.objectStore(Au).put(e,R1(s)),await i.done}catch(t){if(t instanceof ds)Hs.warn(t.message);else{const i=Hr.create("idb-set",{originalErrorMessage:t?.message});Hs.warn(i.message)}}}function R1(s){return`${s.name}!${s.options.appId}`}const JD=1024,ZD=30;class eN{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new nN(t),this._heartbeatsCachePromise=this._storage.read().then(i=>(this._heartbeatsCache=i,i))}async triggerHeartbeat(){try{const t=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),i=$E();if(this._heartbeatsCache?.heartbeats==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null)||this._heartbeatsCache.lastSentHeartbeatDate===i||this._heartbeatsCache.heartbeats.some(a=>a.date===i))return;if(this._heartbeatsCache.heartbeats.push({date:i,agent:t}),this._heartbeatsCache.heartbeats.length>ZD){const a=iN(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(a,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(e){Hs.warn(e)}}async getHeartbeatsHeader(){try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null||this._heartbeatsCache.heartbeats.length===0)return"";const e=$E(),{heartbeatsToSend:t,unsentEntries:i}=tN(this._heartbeatsCache.heartbeats),a=gf(JSON.stringify({version:2,heartbeats:t}));return this._heartbeatsCache.lastSentHeartbeatDate=e,i.length>0?(this._heartbeatsCache.heartbeats=i,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),a}catch(e){return Hs.warn(e),""}}}function $E(){return new Date().toISOString().substring(0,10)}function tN(s,e=JD){const t=[];let i=s.slice();for(const a of s){const l=t.find(u=>u.agent===a.agent);if(l){if(l.dates.push(a.date),WE(t)>e){l.dates.pop();break}}else if(t.push({agent:a.agent,dates:[a.date]}),WE(t)>e){t.pop();break}i=i.slice(1)}return{heartbeatsToSend:t,unsentEntries:i}}class nN{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return x1()?qR().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const t=await XD(this.app);return t?.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){const i=await this.read();return KE(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??i.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){const i=await this.read();return KE(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??i.lastSentHeartbeatDate,heartbeats:[...i.heartbeats,...e.heartbeats]})}else return}}function WE(s){return gf(JSON.stringify({version:2,heartbeats:s})).length}function iN(s){if(s.length===0)return-1;let e=0,t=s[0].date;for(let i=1;i<s.length;i++)s[i].date<t&&(t=s[i].date,e=i);return e}function sN(s){Xa(new $r("platform-logger",e=>new gD(e),"PRIVATE")),Xa(new $r("heartbeat",e=>new eN(e),"PRIVATE")),rs(ny,GE,s),rs(ny,GE,"esm2020"),rs("fire-js","")}sN("");function D1(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const rN=D1,N1=new qu("auth","Firebase",D1());const vf=new Fy("@firebase/auth");function aN(s,...e){vf.logLevel<=Fe.WARN&&vf.warn(`Auth (${co}): ${s}`,...e)}function Jd(s,...e){vf.logLevel<=Fe.ERROR&&vf.error(`Auth (${co}): ${s}`,...e)}function Ii(s,...e){throw Hy(s,...e)}function as(s,...e){return Hy(s,...e)}function j1(s,e,t){const i={...rN(),[e]:t};return new qu("auth","Firebase",i).create(e,{appName:s.name})}function Bs(s){return j1(s,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function Hy(s,...e){if(typeof s!="string"){const t=e[0],i=[...e.slice(1)];return i[0]&&(i[0].appName=s.name),s._errorFactory.create(t,...i)}return N1.create(s,...e)}function Re(s,e,...t){if(!s)throw Hy(e,...t)}function Ls(s){const e="INTERNAL ASSERTION FAILED: "+s;throw Jd(e),new Error(e)}function Gs(s,e){s||Ls(e)}function ry(){return typeof self<"u"&&self.location?.href||""}function oN(){return YE()==="http:"||YE()==="https:"}function YE(){return typeof self<"u"&&self.location?.protocol||null}function lN(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(oN()||zR()||"connection"in navigator)?navigator.onLine:!0}function cN(){if(typeof navigator>"u")return null;const s=navigator;return s.languages&&s.languages[0]||s.language||null}class Gu{constructor(e,t){this.shortDelay=e,this.longDelay=t,Gs(t>e,"Short delay should be less than long delay!"),this.isMobile=LR()||BR()}get(){return lN()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}function Gy(s,e){Gs(s.emulator,"Emulator should always be set here");const{url:t}=s.emulator;return e?`${t}${e.startsWith("/")?e.slice(1):e}`:t}class k1{static initialize(e,t,i){this.fetchImpl=e,t&&(this.headersImpl=t),i&&(this.responseImpl=i)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;Ls("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;Ls("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;Ls("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}const uN={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};const hN=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],dN=new Gu(3e4,6e4);function $s(s,e){return s.tenantId&&!e.tenantId?{...e,tenantId:s.tenantId}:e}async function fs(s,e,t,i,a={}){return O1(s,a,async()=>{let l={},u={};i&&(e==="GET"?u=i:l={body:JSON.stringify(i)});const f=Hu({key:s.config.apiKey,...u}).slice(1),p=await s._getAdditionalHeaders();p["Content-Type"]="application/json",s.languageCode&&(p["X-Firebase-Locale"]=s.languageCode);const y={method:e,headers:p,...l};return UR()||(y.referrerPolicy="no-referrer"),s.emulatorConfig&&lo(s.emulatorConfig.host)&&(y.credentials="include"),k1.fetch()(await M1(s,s.config.apiHost,t,f),y)})}async function O1(s,e,t){s._canInitEmulator=!1;const i={...uN,...e};try{const a=new mN(s),l=await Promise.race([t(),a.promise]);a.clearNetworkTimeout();const u=await l.json();if("needConfirmation"in u)throw Vd(s,"account-exists-with-different-credential",u);if(l.ok&&!("errorMessage"in u))return u;{const f=l.ok?u.errorMessage:u.error.message,[p,y]=f.split(" : ");if(p==="FEDERATED_USER_ID_ALREADY_LINKED")throw Vd(s,"credential-already-in-use",u);if(p==="EMAIL_EXISTS")throw Vd(s,"email-already-in-use",u);if(p==="USER_DISABLED")throw Vd(s,"user-disabled",u);const _=i[p]||p.toLowerCase().replace(/[_\s]+/g,"-");if(y)throw j1(s,_,y);Ii(s,_)}}catch(a){if(a instanceof ds)throw a;Ii(s,"network-request-failed",{message:String(a)})}}async function Qu(s,e,t,i,a={}){const l=await fs(s,e,t,i,a);return"mfaPendingCredential"in l&&Ii(s,"multi-factor-auth-required",{_serverResponse:l}),l}async function M1(s,e,t,i){const a=`${e}${t}?${i}`,l=s,u=l.config.emulator?Gy(s.config,a):`${s.config.apiScheme}://${a}`;return hN.includes(t)&&(await l._persistenceManagerAvailable,l._getPersistenceType()==="COOKIE")?l._getPersistence()._getFinalTarget(u).toString():u}function fN(s){switch(s){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class mN{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((t,i)=>{this.timer=setTimeout(()=>i(as(this.auth,"network-request-failed")),dN.get())})}}function Vd(s,e,t){const i={appName:s.name};t.email&&(i.email=t.email),t.phoneNumber&&(i.phoneNumber=t.phoneNumber);const a=as(s,e,i);return a.customData._tokenResponse=t,a}function XE(s){return s!==void 0&&s.enterprise!==void 0}class pN{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const t of this.recaptchaEnforcementState)if(t.provider&&t.provider===e)return fN(t.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}isAnyProviderEnabled(){return this.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")||this.isProviderEnabled("PHONE_PROVIDER")}}async function gN(s,e){return fs(s,"GET","/v2/recaptchaConfig",$s(s,e))}async function yN(s,e){return fs(s,"POST","/v1/accounts:delete",e)}async function _f(s,e){return fs(s,"POST","/v1/accounts:lookup",e)}function pu(s){if(s)try{const e=new Date(Number(s));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function vN(s,e=!1){const t=It(s),i=await t.getIdToken(e),a=Qy(i);Re(a&&a.exp&&a.auth_time&&a.iat,t.auth,"internal-error");const l=typeof a.firebase=="object"?a.firebase:void 0,u=l?.sign_in_provider;return{claims:a,token:i,authTime:pu(Vg(a.auth_time)),issuedAtTime:pu(Vg(a.iat)),expirationTime:pu(Vg(a.exp)),signInProvider:u||null,signInSecondFactor:l?.sign_in_second_factor||null}}function Vg(s){return Number(s)*1e3}function Qy(s){const[e,t,i]=s.split(".");if(e===void 0||t===void 0||i===void 0)return Jd("JWT malformed, contained fewer than 3 sections"),null;try{const a=m1(t);return a?JSON.parse(a):(Jd("Failed to decode base64 JWT payload"),null)}catch(a){return Jd("Caught error parsing JWT payload as JSON",a?.toString()),null}}function JE(s){const e=Qy(s);return Re(e,"internal-error"),Re(typeof e.exp<"u","internal-error"),Re(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}async function Tl(s,e,t=!1){if(t)return e;try{return await e}catch(i){throw i instanceof ds&&_N(i)&&s.auth.currentUser===s&&await s.auth.signOut(),i}}function _N({code:s}){return s==="auth/user-disabled"||s==="auth/user-token-expired"}class bN{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){if(e){const t=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),t}else{this.errorBackoff=3e4;const i=(this.user.stsTokenManager.expirationTime??0)-Date.now()-3e5;return Math.max(0,i)}}schedule(e=!1){if(!this.isRunning)return;const t=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},t)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){e?.code==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}class ay{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=pu(this.lastLoginAt),this.creationTime=pu(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}async function bf(s){const e=s.auth,t=await s.getIdToken(),i=await Tl(s,_f(e,{idToken:t}));Re(i?.users.length,e,"internal-error");const a=i.users[0];s._notifyReloadListener(a);const l=a.providerUserInfo?.length?V1(a.providerUserInfo):[],u=TN(s.providerData,l),f=s.isAnonymous,p=!(s.email&&a.passwordHash)&&!u?.length,y=f?p:!1,_={uid:a.localId,displayName:a.displayName||null,photoURL:a.photoUrl||null,email:a.email||null,emailVerified:a.emailVerified||!1,phoneNumber:a.phoneNumber||null,tenantId:a.tenantId||null,providerData:u,metadata:new ay(a.createdAt,a.lastLoginAt),isAnonymous:y};Object.assign(s,_)}async function EN(s){const e=It(s);await bf(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function TN(s,e){return[...s.filter(i=>!e.some(a=>a.providerId===i.providerId)),...e]}function V1(s){return s.map(({providerId:e,...t})=>({providerId:e,uid:t.rawId||"",displayName:t.displayName||null,email:t.email||null,phoneNumber:t.phoneNumber||null,photoURL:t.photoUrl||null}))}async function xN(s,e){const t=await O1(s,{},async()=>{const i=Hu({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:a,apiKey:l}=s.config,u=await M1(s,a,"/v1/token",`key=${l}`),f=await s._getAdditionalHeaders();f["Content-Type"]="application/x-www-form-urlencoded";const p={method:"POST",headers:f,body:i};return s.emulatorConfig&&lo(s.emulatorConfig.host)&&(p.credentials="include"),k1.fetch()(u,p)});return{accessToken:t.access_token,expiresIn:t.expires_in,refreshToken:t.refresh_token}}async function SN(s,e){return fs(s,"POST","/v2/accounts:revokeToken",$s(s,e))}class gl{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){Re(e.idToken,"internal-error"),Re(typeof e.idToken<"u","internal-error"),Re(typeof e.refreshToken<"u","internal-error");const t="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):JE(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){Re(e.length!==0,"internal-error");const t=JE(e);this.updateTokensAndExpiration(e,null,t)}async getToken(e,t=!1){return!t&&this.accessToken&&!this.isExpired?this.accessToken:(Re(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){const{accessToken:i,refreshToken:a,expiresIn:l}=await xN(e,t);this.updateTokensAndExpiration(i,a,Number(l))}updateTokensAndExpiration(e,t,i){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+i*1e3}static fromJSON(e,t){const{refreshToken:i,accessToken:a,expirationTime:l}=t,u=new gl;return i&&(Re(typeof i=="string","internal-error",{appName:e}),u.refreshToken=i),a&&(Re(typeof a=="string","internal-error",{appName:e}),u.accessToken=a),l&&(Re(typeof l=="number","internal-error",{appName:e}),u.expirationTime=l),u}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new gl,this.toJSON())}_performRefresh(){return Ls("not implemented")}}function jr(s,e){Re(typeof s=="string"||typeof s>"u","internal-error",{appName:e})}class Si{constructor({uid:e,auth:t,stsTokenManager:i,...a}){this.providerId="firebase",this.proactiveRefresh=new bN(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=t,this.stsTokenManager=i,this.accessToken=i.accessToken,this.displayName=a.displayName||null,this.email=a.email||null,this.emailVerified=a.emailVerified||!1,this.phoneNumber=a.phoneNumber||null,this.photoURL=a.photoURL||null,this.isAnonymous=a.isAnonymous||!1,this.tenantId=a.tenantId||null,this.providerData=a.providerData?[...a.providerData]:[],this.metadata=new ay(a.createdAt||void 0,a.lastLoginAt||void 0)}async getIdToken(e){const t=await Tl(this,this.stsTokenManager.getToken(this.auth,e));return Re(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return vN(this,e)}reload(){return EN(this)}_assign(e){this!==e&&(Re(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(t=>({...t})),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const t=new Si({...this,auth:e,stsTokenManager:this.stsTokenManager._clone()});return t.metadata._copy(this.metadata),t}_onReload(e){Re(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,t=!1){let i=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),i=!0),t&&await bf(this),await this.auth._persistUserIfCurrent(this),i&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(Fn(this.auth.app))return Promise.reject(Bs(this.auth));const e=await this.getIdToken();return await Tl(this,yN(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return{uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>({...e})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId,...this.metadata.toJSON(),apiKey:this.auth.config.apiKey,appName:this.auth.name}}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){const i=t.displayName??void 0,a=t.email??void 0,l=t.phoneNumber??void 0,u=t.photoURL??void 0,f=t.tenantId??void 0,p=t._redirectEventId??void 0,y=t.createdAt??void 0,_=t.lastLoginAt??void 0,{uid:b,emailVerified:x,isAnonymous:k,providerData:M,stsTokenManager:j}=t;Re(b&&j,e,"internal-error");const V=gl.fromJSON(this.name,j);Re(typeof b=="string",e,"internal-error"),jr(i,e.name),jr(a,e.name),Re(typeof x=="boolean",e,"internal-error"),Re(typeof k=="boolean",e,"internal-error"),jr(l,e.name),jr(u,e.name),jr(f,e.name),jr(p,e.name),jr(y,e.name),jr(_,e.name);const ee=new Si({uid:b,auth:e,email:a,emailVerified:x,displayName:i,isAnonymous:k,photoURL:u,phoneNumber:l,tenantId:f,stsTokenManager:V,createdAt:y,lastLoginAt:_});return M&&Array.isArray(M)&&(ee.providerData=M.map(ne=>({...ne}))),p&&(ee._redirectEventId=p),ee}static async _fromIdTokenResponse(e,t,i=!1){const a=new gl;a.updateFromServerResponse(t);const l=new Si({uid:t.localId,auth:e,stsTokenManager:a,isAnonymous:i});return await bf(l),l}static async _fromGetAccountInfoResponse(e,t,i){const a=t.users[0];Re(a.localId!==void 0,"internal-error");const l=a.providerUserInfo!==void 0?V1(a.providerUserInfo):[],u=!(a.email&&a.passwordHash)&&!l?.length,f=new gl;f.updateFromIdToken(i);const p=new Si({uid:a.localId,auth:e,stsTokenManager:f,isAnonymous:u}),y={uid:a.localId,displayName:a.displayName||null,photoURL:a.photoUrl||null,email:a.email||null,emailVerified:a.emailVerified||!1,phoneNumber:a.phoneNumber||null,tenantId:a.tenantId||null,providerData:l,metadata:new ay(a.createdAt,a.lastLoginAt),isAnonymous:!(a.email&&a.passwordHash)&&!l?.length};return Object.assign(p,y),p}}const ZE=new Map;function Us(s){Gs(s instanceof Function,"Expected a class definition");let e=ZE.get(s);return e?(Gs(e instanceof s,"Instance stored in cache mismatched with class"),e):(e=new s,ZE.set(s,e),e)}class P1{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,t){this.storage[e]=t}async _get(e){const t=this.storage[e];return t===void 0?null:t}async _remove(e){delete this.storage[e]}_addListener(e,t){}_removeListener(e,t){}}P1.type="NONE";const eT=P1;function Zd(s,e,t){return`firebase:${s}:${e}:${t}`}class yl{constructor(e,t,i){this.persistence=e,this.auth=t,this.userKey=i;const{config:a,name:l}=this.auth;this.fullUserKey=Zd(this.userKey,a.apiKey,l),this.fullPersistenceKey=Zd("persistence",a.apiKey,l),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const t=await _f(this.auth,{idToken:e}).catch(()=>{});return t?Si._fromGetAccountInfoResponse(this.auth,t,e):null}return Si._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const t=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,t)return this.setCurrentUser(t)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t,i="authUser"){if(!t.length)return new yl(Us(eT),e,i);const a=(await Promise.all(t.map(async y=>{if(await y._isAvailable())return y}))).filter(y=>y);let l=a[0]||Us(eT);const u=Zd(i,e.config.apiKey,e.name);let f=null;for(const y of t)try{const _=await y._get(u);if(_){let b;if(typeof _=="string"){const x=await _f(e,{idToken:_}).catch(()=>{});if(!x)break;b=await Si._fromGetAccountInfoResponse(e,x,_)}else b=Si._fromJSON(e,_);y!==l&&(f=b),l=y;break}}catch{}const p=a.filter(y=>y._shouldAllowMigration);return!l._shouldAllowMigration||!p.length?new yl(l,e,i):(l=p[0],f&&await l._set(u,f.toJSON()),await Promise.all(t.map(async y=>{if(y!==l)try{await y._remove(u)}catch{}})),new yl(l,e,i))}}function tT(s){const e=s.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(B1(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(L1(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(q1(e))return"Blackberry";if(H1(e))return"Webos";if(U1(e))return"Safari";if((e.includes("chrome/")||z1(e))&&!e.includes("edge/"))return"Chrome";if(F1(e))return"Android";{const t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,i=s.match(t);if(i?.length===2)return i[1]}return"Other"}function L1(s=Qt()){return/firefox\//i.test(s)}function U1(s=Qt()){const e=s.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function z1(s=Qt()){return/crios\//i.test(s)}function B1(s=Qt()){return/iemobile/i.test(s)}function F1(s=Qt()){return/android/i.test(s)}function q1(s=Qt()){return/blackberry/i.test(s)}function H1(s=Qt()){return/webos/i.test(s)}function Ky(s=Qt()){return/iphone|ipad|ipod/i.test(s)||/macintosh/i.test(s)&&/mobile/i.test(s)}function wN(s=Qt()){return Ky(s)&&!!window.navigator?.standalone}function AN(){return FR()&&document.documentMode===10}function G1(s=Qt()){return Ky(s)||F1(s)||H1(s)||q1(s)||/windows phone/i.test(s)||B1(s)}function Q1(s,e=[]){let t;switch(s){case"Browser":t=tT(Qt());break;case"Worker":t=`${tT(Qt())}-${s}`;break;default:t=s}const i=e.length?e.join(","):"FirebaseCore-web";return`${t}/JsCore/${co}/${i}`}class IN{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){const i=l=>new Promise((u,f)=>{try{const p=e(l);u(p)}catch(p){f(p)}});i.onAbort=t,this.queue.push(i);const a=this.queue.length-1;return()=>{this.queue[a]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const t=[];try{for(const i of this.queue)await i(e),i.onAbort&&t.push(i.onAbort)}catch(i){t.reverse();for(const a of t)try{a()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:i?.message})}}}async function CN(s,e={}){return fs(s,"GET","/v2/passwordPolicy",$s(s,e))}const RN=6;class DN{constructor(e){const t=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=t.minPasswordLength??RN,t.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=t.maxPasswordLength),t.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=t.containsLowercaseCharacter),t.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=t.containsUppercaseCharacter),t.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=t.containsNumericCharacter),t.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=t.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=e.allowedNonAlphanumericCharacters?.join("")??"",this.forceUpgradeOnSignin=e.forceUpgradeOnSignin??!1,this.schemaVersion=e.schemaVersion}validatePassword(e){const t={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,t),this.validatePasswordCharacterOptions(e,t),t.isValid&&(t.isValid=t.meetsMinPasswordLength??!0),t.isValid&&(t.isValid=t.meetsMaxPasswordLength??!0),t.isValid&&(t.isValid=t.containsLowercaseLetter??!0),t.isValid&&(t.isValid=t.containsUppercaseLetter??!0),t.isValid&&(t.isValid=t.containsNumericCharacter??!0),t.isValid&&(t.isValid=t.containsNonAlphanumericCharacter??!0),t}validatePasswordLengthOptions(e,t){const i=this.customStrengthOptions.minPasswordLength,a=this.customStrengthOptions.maxPasswordLength;i&&(t.meetsMinPasswordLength=e.length>=i),a&&(t.meetsMaxPasswordLength=e.length<=a)}validatePasswordCharacterOptions(e,t){this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);let i;for(let a=0;a<e.length;a++)i=e.charAt(a),this.updatePasswordCharacterOptionsStatuses(t,i>="a"&&i<="z",i>="A"&&i<="Z",i>="0"&&i<="9",this.allowedNonAlphanumericCharacters.includes(i))}updatePasswordCharacterOptionsStatuses(e,t,i,a,l){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=i)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=a)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=l))}}class NN{constructor(e,t,i,a){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=i,this.config=a,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new nT(this),this.idTokenSubscription=new nT(this),this.beforeStateQueue=new IN(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=N1,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=a.sdkClientVersion,this._persistenceManagerAvailable=new Promise(l=>this._resolvePersistenceManagerAvailable=l)}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=Us(t)),this._initializationPromise=this.queue(async()=>{if(!this._deleted&&(this.persistenceManager=await yl.create(this,e),this._resolvePersistenceManagerAvailable?.(),!this._deleted)){if(this._popupRedirectResolver?._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(t),this.lastNotifiedUid=this.currentUser?.uid||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const t=await _f(this,{idToken:e}),i=await Si._fromGetAccountInfoResponse(this,t,e);await this.directlySetCurrentUser(i)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){if(Fn(this.app)){const l=this.app.settings.authIdToken;return l?new Promise(u=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(l).then(u,u))}):this.directlySetCurrentUser(null)}const t=await this.assertedPersistence.getCurrentUser();let i=t,a=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const l=this.redirectUser?._redirectEventId,u=i?._redirectEventId,f=await this.tryRedirectSignIn(e);(!l||l===u)&&f?.user&&(i=f.user,a=!0)}if(!i)return this.directlySetCurrentUser(null);if(!i._redirectEventId){if(a)try{await this.beforeStateQueue.runMiddleware(i)}catch(l){i=t,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(l))}return i?this.reloadAndSetCurrentUserOrClear(i):this.directlySetCurrentUser(null)}return Re(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===i._redirectEventId?this.directlySetCurrentUser(i):this.reloadAndSetCurrentUserOrClear(i)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await bf(e)}catch(t){if(t?.code!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=cN()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(Fn(this.app))return Promise.reject(Bs(this));const t=e?It(e):null;return t&&Re(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e,t=!1){if(!this._deleted)return e&&Re(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return Fn(this.app)?Promise.reject(Bs(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return Fn(this.app)?Promise.reject(Bs(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(Us(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await CN(this),t=new DN(e);this.tenantId===null?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new qu("auth","Firebase",e())}onAuthStateChanged(e,t,i){return this.registerStateListener(this.authStateSubscription,e,t,i)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,i){return this.registerStateListener(this.idTokenSubscription,e,t,i)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{const i=this.onAuthStateChanged(()=>{i(),e()},t)}})}async revokeAccessToken(e){if(this.currentUser){const t=await this.currentUser.getIdToken(),i={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:t};this.tenantId!=null&&(i.tenantId=this.tenantId),await SN(this,i)}}toJSON(){return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:this._currentUser?.toJSON()}}async _setRedirectUser(e,t){const i=await this.getOrInitRedirectPersistenceManager(t);return e===null?i.removeCurrentUser():i.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const t=e&&Us(e)||this._popupRedirectResolver;Re(t,this,"argument-error"),this.redirectPersistenceManager=await yl.create(this,[Us(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){return this._isInitialized&&await this.queue(async()=>{}),this._currentUser?._redirectEventId===e?this._currentUser:this.redirectUser?._redirectEventId===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const e=this.currentUser?.uid??null;this.lastNotifiedUid!==e&&(this.lastNotifiedUid=e,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,i,a){if(this._deleted)return()=>{};const l=typeof t=="function"?t:t.next.bind(t);let u=!1;const f=this._isInitialized?Promise.resolve():this._initializationPromise;if(Re(f,this,"internal-error"),f.then(()=>{u||l(this.currentUser)}),typeof t=="function"){const p=e.addObserver(t,i,a);return()=>{u=!0,p()}}else{const p=e.addObserver(t);return()=>{u=!0,p()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return Re(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=Q1(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){const e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId);const t=await this.heartbeatServiceProvider.getImmediate({optional:!0})?.getHeartbeatsHeader();t&&(e["X-Firebase-Client"]=t);const i=await this._getAppCheckToken();return i&&(e["X-Firebase-AppCheck"]=i),e}async _getAppCheckToken(){if(Fn(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=await this.appCheckServiceProvider.getImmediate({optional:!0})?.getToken();return e?.error&&aN(`Error while retrieving App Check token: ${e.error}`),e?.token}}function Zr(s){return It(s)}class nT{constructor(e){this.auth=e,this.observer=null,this.addObserver=$R(t=>this.observer=t)}get next(){return Re(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}let Jf={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function jN(s){Jf=s}function K1(s){return Jf.loadJS(s)}function kN(){return Jf.recaptchaEnterpriseScript}function ON(){return Jf.gapiScript}function MN(s){return`__${s}${Math.floor(Math.random()*1e6)}`}class VN{constructor(){this.enterprise=new PN}ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}class PN{ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}const LN="recaptcha-enterprise",$1="NO_RECAPTCHA";class UN{constructor(e){this.type=LN,this.auth=Zr(e)}async verify(e="verify",t=!1){async function i(l){if(!t){if(l.tenantId==null&&l._agentRecaptchaConfig!=null)return l._agentRecaptchaConfig.siteKey;if(l.tenantId!=null&&l._tenantRecaptchaConfigs[l.tenantId]!==void 0)return l._tenantRecaptchaConfigs[l.tenantId].siteKey}return new Promise(async(u,f)=>{gN(l,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(p=>{if(p.recaptchaKey===void 0)f(new Error("recaptcha Enterprise site key undefined"));else{const y=new pN(p);return l.tenantId==null?l._agentRecaptchaConfig=y:l._tenantRecaptchaConfigs[l.tenantId]=y,u(y.siteKey)}}).catch(p=>{f(p)})})}function a(l,u,f){const p=window.grecaptcha;XE(p)?p.enterprise.ready(()=>{p.enterprise.execute(l,{action:e}).then(y=>{u(y)}).catch(()=>{u($1)})}):f(Error("No reCAPTCHA enterprise script loaded."))}return this.auth.settings.appVerificationDisabledForTesting?new VN().execute("siteKey",{action:"verify"}):new Promise((l,u)=>{i(this.auth).then(f=>{if(!t&&XE(window.grecaptcha))a(f,l,u);else{if(typeof window>"u"){u(new Error("RecaptchaVerifier is only supported in browser"));return}let p=kN();p.length!==0&&(p+=f),K1(p).then(()=>{a(f,l,u)}).catch(y=>{u(y)})}}).catch(f=>{u(f)})})}}async function iT(s,e,t,i=!1,a=!1){const l=new UN(s);let u;if(a)u=$1;else try{u=await l.verify(t)}catch{u=await l.verify(t,!0)}const f={...e};if(t==="mfaSmsEnrollment"||t==="mfaSmsSignIn"){if("phoneEnrollmentInfo"in f){const p=f.phoneEnrollmentInfo.phoneNumber,y=f.phoneEnrollmentInfo.recaptchaToken;Object.assign(f,{phoneEnrollmentInfo:{phoneNumber:p,recaptchaToken:y,captchaResponse:u,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}else if("phoneSignInInfo"in f){const p=f.phoneSignInInfo.recaptchaToken;Object.assign(f,{phoneSignInInfo:{recaptchaToken:p,captchaResponse:u,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}return f}return i?Object.assign(f,{captchaResp:u}):Object.assign(f,{captchaResponse:u}),Object.assign(f,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(f,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),f}async function Ef(s,e,t,i,a){if(s._getRecaptchaConfig()?.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const l=await iT(s,e,t,t==="getOobCode");return i(s,l)}else return i(s,e).catch(async l=>{if(l.code==="auth/missing-recaptcha-token"){console.log(`${t} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const u=await iT(s,e,t,t==="getOobCode");return i(s,u)}else return Promise.reject(l)})}function zN(s,e){const t=Xf(s,"auth");if(t.isInitialized()){const a=t.getImmediate(),l=t.getOptions();if(Ya(l,e??{}))return a;Ii(a,"already-initialized")}return t.initialize({options:e})}function BN(s,e){const t=e?.persistence||[],i=(Array.isArray(t)?t:[t]).map(Us);e?.errorMap&&s._updateErrorMap(e.errorMap),s._initializeWithPersistence(i,e?.popupRedirectResolver)}function FN(s,e,t){const i=Zr(s);Re(/^https?:\/\//.test(e),i,"invalid-emulator-scheme");const a=!1,l=W1(e),{host:u,port:f}=qN(e),p=f===null?"":`:${f}`,y={url:`${l}//${u}${p}/`},_=Object.freeze({host:u,port:f,protocol:l.replace(":",""),options:Object.freeze({disableWarnings:a})});if(!i._canInitEmulator){Re(i.config.emulator&&i.emulatorConfig,i,"emulator-config-failed"),Re(Ya(y,i.config.emulator)&&Ya(_,i.emulatorConfig),i,"emulator-config-failed");return}i.config.emulator=y,i.emulatorConfig=_,i.settings.appVerificationDisabledForTesting=!0,lo(u)?(By(`${l}//${u}${p}`),_1("Auth",!0)):HN()}function W1(s){const e=s.indexOf(":");return e<0?"":s.substr(0,e+1)}function qN(s){const e=W1(s),t=/(\/\/)?([^?#/]+)/.exec(s.substr(e.length));if(!t)return{host:"",port:null};const i=t[2].split("@").pop()||"",a=/^(\[[^\]]+\])(:|$)/.exec(i);if(a){const l=a[1];return{host:l,port:sT(i.substr(l.length+1))}}else{const[l,u]=i.split(":");return{host:l,port:sT(u)}}}function sT(s){if(!s)return null;const e=Number(s);return isNaN(e)?null:e}function HN(){function s(){const e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",s):s())}class $y{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return Ls("not implemented")}_getIdTokenResponse(e){return Ls("not implemented")}_linkToIdToken(e,t){return Ls("not implemented")}_getReauthenticationResolver(e){return Ls("not implemented")}}async function GN(s,e){return fs(s,"POST","/v1/accounts:signUp",e)}async function QN(s,e){return Qu(s,"POST","/v1/accounts:signInWithPassword",$s(s,e))}async function KN(s,e){return fs(s,"POST","/v1/accounts:sendOobCode",$s(s,e))}async function $N(s,e){return KN(s,e)}async function WN(s,e){return Qu(s,"POST","/v1/accounts:signInWithEmailLink",$s(s,e))}async function YN(s,e){return Qu(s,"POST","/v1/accounts:signInWithEmailLink",$s(s,e))}class Iu extends $y{constructor(e,t,i,a=null){super("password",i),this._email=e,this._password=t,this._tenantId=a}static _fromEmailAndPassword(e,t){return new Iu(e,t,"password")}static _fromEmailAndCode(e,t,i=null){return new Iu(e,t,"emailLink",i)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e;if(t?.email&&t?.password){if(t.signInMethod==="password")return this._fromEmailAndPassword(t.email,t.password);if(t.signInMethod==="emailLink")return this._fromEmailAndCode(t.email,t.password,t.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const t={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return Ef(e,t,"signInWithPassword",QN);case"emailLink":return WN(e,{email:this._email,oobCode:this._password});default:Ii(e,"internal-error")}}async _linkToIdToken(e,t){switch(this.signInMethod){case"password":const i={idToken:t,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return Ef(e,i,"signUpPassword",GN);case"emailLink":return YN(e,{idToken:t,email:this._email,oobCode:this._password});default:Ii(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}async function vl(s,e){return Qu(s,"POST","/v1/accounts:signInWithIdp",$s(s,e))}const XN="http://localhost";class Ja extends $y{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const t=new Ja(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):Ii("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e,{providerId:i,signInMethod:a,...l}=t;if(!i||!a)return null;const u=new Ja(i,a);return u.idToken=l.idToken||void 0,u.accessToken=l.accessToken||void 0,u.secret=l.secret,u.nonce=l.nonce,u.pendingToken=l.pendingToken||null,u}_getIdTokenResponse(e){const t=this.buildRequest();return vl(e,t)}_linkToIdToken(e,t){const i=this.buildRequest();return i.idToken=t,vl(e,i)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,vl(e,t)}buildRequest(){const e={requestUri:XN,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=Hu(t)}return e}}function JN(s){switch(s){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function ZN(s){const e=ou(lu(s)).link,t=e?ou(lu(e)).deep_link_id:null,i=ou(lu(s)).deep_link_id;return(i?ou(lu(i)).link:null)||i||t||e||s}class Wy{constructor(e){const t=ou(lu(e)),i=t.apiKey??null,a=t.oobCode??null,l=JN(t.mode??null);Re(i&&a&&l,"argument-error"),this.apiKey=i,this.operation=l,this.code=a,this.continueUrl=t.continueUrl??null,this.languageCode=t.lang??null,this.tenantId=t.tenantId??null}static parseLink(e){const t=ZN(e);try{return new Wy(t)}catch{return null}}}class Ql{constructor(){this.providerId=Ql.PROVIDER_ID}static credential(e,t){return Iu._fromEmailAndPassword(e,t)}static credentialWithLink(e,t){const i=Wy.parseLink(t);return Re(i,"argument-error"),Iu._fromEmailAndCode(e,i.code,i.tenantId)}}Ql.PROVIDER_ID="password";Ql.EMAIL_PASSWORD_SIGN_IN_METHOD="password";Ql.EMAIL_LINK_SIGN_IN_METHOD="emailLink";class Y1{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}class Ku extends Y1{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}class Pr extends Ku{constructor(){super("facebook.com")}static credential(e){return Ja._fromParams({providerId:Pr.PROVIDER_ID,signInMethod:Pr.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Pr.credentialFromTaggedObject(e)}static credentialFromError(e){return Pr.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Pr.credential(e.oauthAccessToken)}catch{return null}}}Pr.FACEBOOK_SIGN_IN_METHOD="facebook.com";Pr.PROVIDER_ID="facebook.com";class Lr extends Ku{constructor(){super("google.com"),this.addScope("profile")}static credential(e,t){return Ja._fromParams({providerId:Lr.PROVIDER_ID,signInMethod:Lr.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}static credentialFromResult(e){return Lr.credentialFromTaggedObject(e)}static credentialFromError(e){return Lr.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:i}=e;if(!t&&!i)return null;try{return Lr.credential(t,i)}catch{return null}}}Lr.GOOGLE_SIGN_IN_METHOD="google.com";Lr.PROVIDER_ID="google.com";class Ur extends Ku{constructor(){super("github.com")}static credential(e){return Ja._fromParams({providerId:Ur.PROVIDER_ID,signInMethod:Ur.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Ur.credentialFromTaggedObject(e)}static credentialFromError(e){return Ur.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Ur.credential(e.oauthAccessToken)}catch{return null}}}Ur.GITHUB_SIGN_IN_METHOD="github.com";Ur.PROVIDER_ID="github.com";class zr extends Ku{constructor(){super("twitter.com")}static credential(e,t){return Ja._fromParams({providerId:zr.PROVIDER_ID,signInMethod:zr.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}static credentialFromResult(e){return zr.credentialFromTaggedObject(e)}static credentialFromError(e){return zr.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:t,oauthTokenSecret:i}=e;if(!t||!i)return null;try{return zr.credential(t,i)}catch{return null}}}zr.TWITTER_SIGN_IN_METHOD="twitter.com";zr.PROVIDER_ID="twitter.com";async function ej(s,e){return Qu(s,"POST","/v1/accounts:signUp",$s(s,e))}class Za{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,i,a=!1){const l=await Si._fromIdTokenResponse(e,i,a),u=rT(i);return new Za({user:l,providerId:u,_tokenResponse:i,operationType:t})}static async _forOperation(e,t,i){await e._updateTokensIfNecessary(i,!0);const a=rT(i);return new Za({user:e,providerId:a,_tokenResponse:i,operationType:t})}}function rT(s){return s.providerId?s.providerId:"phoneNumber"in s?"phone":null}class Tf extends ds{constructor(e,t,i,a){super(t.code,t.message),this.operationType=i,this.user=a,Object.setPrototypeOf(this,Tf.prototype),this.customData={appName:e.name,tenantId:e.tenantId??void 0,_serverResponse:t.customData._serverResponse,operationType:i}}static _fromErrorAndOperation(e,t,i,a){return new Tf(e,t,i,a)}}function X1(s,e,t,i){return(e==="reauthenticate"?t._getReauthenticationResolver(s):t._getIdTokenResponse(s)).catch(l=>{throw l.code==="auth/multi-factor-auth-required"?Tf._fromErrorAndOperation(s,l,e,i):l})}async function tj(s,e,t=!1){const i=await Tl(s,e._linkToIdToken(s.auth,await s.getIdToken()),t);return Za._forOperation(s,"link",i)}async function nj(s,e,t=!1){const{auth:i}=s;if(Fn(i.app))return Promise.reject(Bs(i));const a="reauthenticate";try{const l=await Tl(s,X1(i,a,e,s),t);Re(l.idToken,i,"internal-error");const u=Qy(l.idToken);Re(u,i,"internal-error");const{sub:f}=u;return Re(s.uid===f,i,"user-mismatch"),Za._forOperation(s,a,l)}catch(l){throw l?.code==="auth/user-not-found"&&Ii(i,"user-mismatch"),l}}async function J1(s,e,t=!1){if(Fn(s.app))return Promise.reject(Bs(s));const i="signIn",a=await X1(s,i,e),l=await Za._fromIdTokenResponse(s,i,a);return t||await s._updateCurrentUser(l.user),l}async function ij(s,e){return J1(Zr(s),e)}async function Z1(s){const e=Zr(s);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}async function sj(s,e,t){const i=Zr(s);await Ef(i,{requestType:"PASSWORD_RESET",email:e,clientType:"CLIENT_TYPE_WEB"},"getOobCode",$N)}async function rj(s,e,t){if(Fn(s.app))return Promise.reject(Bs(s));const i=Zr(s),u=await Ef(i,{returnSecureToken:!0,email:e,password:t,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",ej).catch(p=>{throw p.code==="auth/password-does-not-meet-requirements"&&Z1(s),p}),f=await Za._fromIdTokenResponse(i,"signIn",u);return await i._updateCurrentUser(f.user),f}function aj(s,e,t){return Fn(s.app)?Promise.reject(Bs(s)):ij(It(s),Ql.credential(e,t)).catch(async i=>{throw i.code==="auth/password-does-not-meet-requirements"&&Z1(s),i})}async function oj(s,e){return fs(s,"POST","/v1/accounts:update",e)}async function lj(s,{displayName:e,photoURL:t}){if(e===void 0&&t===void 0)return;const i=It(s),l={idToken:await i.getIdToken(),displayName:e,photoUrl:t,returnSecureToken:!0},u=await Tl(i,oj(i.auth,l));i.displayName=u.displayName||null,i.photoURL=u.photoUrl||null;const f=i.providerData.find(({providerId:p})=>p==="password");f&&(f.displayName=i.displayName,f.photoURL=i.photoURL),await i._updateTokensIfNecessary(u)}function cj(s,e,t,i){return It(s).onIdTokenChanged(e,t,i)}function uj(s,e,t){return It(s).beforeAuthStateChanged(e,t)}function hj(s,e,t,i){return It(s).onAuthStateChanged(e,t,i)}function dj(s){return It(s).signOut()}const xf="__sak";class eS{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(xf,"1"),this.storage.removeItem(xf),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){const t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}const fj=1e3,mj=10;class tS extends eS{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,t)=>this.onStorageEvent(e,t),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=G1(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const t of Object.keys(this.listeners)){const i=this.storage.getItem(t),a=this.localCache[t];i!==a&&e(t,a,i)}}onStorageEvent(e,t=!1){if(!e.key){this.forAllChangedKeys((u,f,p)=>{this.notifyListeners(u,p)});return}const i=e.key;t?this.detachListener():this.stopPolling();const a=()=>{const u=this.storage.getItem(i);!t&&this.localCache[i]===u||this.notifyListeners(i,u)},l=this.storage.getItem(i);AN()&&l!==e.newValue&&e.newValue!==e.oldValue?setTimeout(a,mj):a()}notifyListeners(e,t){this.localCache[e]=t;const i=this.listeners[e];if(i)for(const a of Array.from(i))a(t&&JSON.parse(t))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,t,i)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:t,newValue:i}),!0)})},fj)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,t){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,t){await super._set(e,t),this.localCache[e]=JSON.stringify(t)}async _get(e){const t=await super._get(e);return this.localCache[e]=JSON.stringify(t),t}async _remove(e){await super._remove(e),delete this.localCache[e]}}tS.type="LOCAL";const pj=tS;class nS extends eS{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,t){}_removeListener(e,t){}}nS.type="SESSION";const iS=nS;function gj(s){return Promise.all(s.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(t){return{fulfilled:!1,reason:t}}}))}class Zf{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const t=this.receivers.find(a=>a.isListeningto(e));if(t)return t;const i=new Zf(e);return this.receivers.push(i),i}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const t=e,{eventId:i,eventType:a,data:l}=t.data,u=this.handlersMap[a];if(!u?.size)return;t.ports[0].postMessage({status:"ack",eventId:i,eventType:a});const f=Array.from(u).map(async y=>y(t.origin,l)),p=await gj(f);t.ports[0].postMessage({status:"done",eventId:i,eventType:a,response:p})}_subscribe(e,t){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),(!t||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}Zf.receivers=[];function Yy(s="",e=10){let t="";for(let i=0;i<e;i++)t+=Math.floor(Math.random()*10);return s+t}class yj{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t,i=50){const a=typeof MessageChannel<"u"?new MessageChannel:null;if(!a)throw new Error("connection_unavailable");let l,u;return new Promise((f,p)=>{const y=Yy("",20);a.port1.start();const _=setTimeout(()=>{p(new Error("unsupported_event"))},i);u={messageChannel:a,onMessage(b){const x=b;if(x.data.eventId===y)switch(x.data.status){case"ack":clearTimeout(_),l=setTimeout(()=>{p(new Error("timeout"))},3e3);break;case"done":clearTimeout(l),f(x.data.response);break;default:clearTimeout(_),clearTimeout(l),p(new Error("invalid_response"));break}}},this.handlers.add(u),a.port1.addEventListener("message",u.onMessage),this.target.postMessage({eventType:e,eventId:y,data:t},[a.port2])}).finally(()=>{u&&this.removeMessageHandler(u)})}}function os(){return window}function vj(s){os().location.href=s}function sS(){return typeof os().WorkerGlobalScope<"u"&&typeof os().importScripts=="function"}async function _j(){if(!navigator?.serviceWorker)return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function bj(){return navigator?.serviceWorker?.controller||null}function Ej(){return sS()?self:null}const rS="firebaseLocalStorageDb",Tj=1,Sf="firebaseLocalStorage",aS="fbase_key";class $u{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}}function em(s,e){return s.transaction([Sf],e?"readwrite":"readonly").objectStore(Sf)}function xj(){const s=indexedDB.deleteDatabase(rS);return new $u(s).toPromise()}function oy(){const s=indexedDB.open(rS,Tj);return new Promise((e,t)=>{s.addEventListener("error",()=>{t(s.error)}),s.addEventListener("upgradeneeded",()=>{const i=s.result;try{i.createObjectStore(Sf,{keyPath:aS})}catch(a){t(a)}}),s.addEventListener("success",async()=>{const i=s.result;i.objectStoreNames.contains(Sf)?e(i):(i.close(),await xj(),e(await oy()))})})}async function aT(s,e,t){const i=em(s,!0).put({[aS]:e,value:t});return new $u(i).toPromise()}async function Sj(s,e){const t=em(s,!1).get(e),i=await new $u(t).toPromise();return i===void 0?null:i.value}function oT(s,e){const t=em(s,!0).delete(e);return new $u(t).toPromise()}const wj=800,Aj=3;class oS{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await oy(),this.db)}async _withRetries(e){let t=0;for(;;)try{const i=await this._openDb();return await e(i)}catch(i){if(t++>Aj)throw i;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return sS()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=Zf._getInstance(Ej()),this.receiver._subscribe("keyChanged",async(e,t)=>({keyProcessed:(await this._poll()).includes(t.key)})),this.receiver._subscribe("ping",async(e,t)=>["keyChanged"])}async initializeSender(){if(this.activeServiceWorker=await _j(),!this.activeServiceWorker)return;this.sender=new yj(this.activeServiceWorker);const e=await this.sender._send("ping",{},800);e&&e[0]?.fulfilled&&e[0]?.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||bj()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await oy();return await aT(e,xf,"1"),await oT(e,xf),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,t){return this._withPendingWrite(async()=>(await this._withRetries(i=>aT(i,e,t)),this.localCache[e]=t,this.notifyServiceWorker(e)))}async _get(e){const t=await this._withRetries(i=>Sj(i,e));return this.localCache[e]=t,t}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(t=>oT(t,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(a=>{const l=em(a,!1).getAll();return new $u(l).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const t=[],i=new Set;if(e.length!==0)for(const{fbase_key:a,value:l}of e)i.add(a),JSON.stringify(this.localCache[a])!==JSON.stringify(l)&&(this.notifyListeners(a,l),t.push(a));for(const a of Object.keys(this.localCache))this.localCache[a]&&!i.has(a)&&(this.notifyListeners(a,null),t.push(a));return t}notifyListeners(e,t){this.localCache[e]=t;const i=this.listeners[e];if(i)for(const a of Array.from(i))a(t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),wj)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,t){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}oS.type="LOCAL";const Ij=oS;new Gu(3e4,6e4);function Cj(s,e){return e?Us(e):(Re(s._popupRedirectResolver,s,"argument-error"),s._popupRedirectResolver)}class Xy extends $y{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return vl(e,this._buildIdpRequest())}_linkToIdToken(e,t){return vl(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return vl(e,this._buildIdpRequest())}_buildIdpRequest(e){const t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function Rj(s){return J1(s.auth,new Xy(s),s.bypassAuthState)}function Dj(s){const{auth:e,user:t}=s;return Re(t,e,"internal-error"),nj(t,new Xy(s),s.bypassAuthState)}async function Nj(s){const{auth:e,user:t}=s;return Re(t,e,"internal-error"),tj(t,new Xy(s),s.bypassAuthState)}class lS{constructor(e,t,i,a,l=!1){this.auth=e,this.resolver=i,this.user=a,this.bypassAuthState=l,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise(async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(i){this.reject(i)}})}async onAuthEvent(e){const{urlResponse:t,sessionId:i,postBody:a,tenantId:l,error:u,type:f}=e;if(u){this.reject(u);return}const p={auth:this.auth,requestUri:t,sessionId:i,tenantId:l||void 0,postBody:a||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(f)(p))}catch(y){this.reject(y)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return Rj;case"linkViaPopup":case"linkViaRedirect":return Nj;case"reauthViaPopup":case"reauthViaRedirect":return Dj;default:Ii(this.auth,"internal-error")}}resolve(e){Gs(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){Gs(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}const jj=new Gu(2e3,1e4);class pl extends lS{constructor(e,t,i,a,l){super(e,t,a,l),this.provider=i,this.authWindow=null,this.pollId=null,pl.currentPopupAction&&pl.currentPopupAction.cancel(),pl.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return Re(e,this.auth,"internal-error"),e}async onExecution(){Gs(this.filter.length===1,"Popup operations only handle one event");const e=Yy();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(t=>{this.reject(t)}),this.resolver._isIframeWebStorageSupported(this.auth,t=>{t||this.reject(as(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){return this.authWindow?.associatedEvent||null}cancel(){this.reject(as(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,pl.currentPopupAction=null}pollUserCancellation(){const e=()=>{if(this.authWindow?.window?.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(as(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,jj.get())};e()}}pl.currentPopupAction=null;const kj="pendingRedirect",ef=new Map;class Oj extends lS{constructor(e,t,i=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,i),this.eventId=null}async execute(){let e=ef.get(this.auth._key());if(!e){try{const i=await Mj(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(i)}catch(t){e=()=>Promise.reject(t)}ef.set(this.auth._key(),e)}return this.bypassAuthState||ef.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function Mj(s,e){const t=Lj(e),i=Pj(s);if(!await i._isAvailable())return!1;const a=await i._get(t)==="true";return await i._remove(t),a}function Vj(s,e){ef.set(s._key(),e)}function Pj(s){return Us(s._redirectPersistence)}function Lj(s){return Zd(kj,s.config.apiKey,s.name)}async function Uj(s,e,t=!1){if(Fn(s.app))return Promise.reject(Bs(s));const i=Zr(s),a=Cj(i,e),u=await new Oj(i,a,t).execute();return u&&!t&&(delete u.user._redirectEventId,await i._persistUserIfCurrent(u.user),await i._setRedirectUser(null,e)),u}const zj=600*1e3;class Bj{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(i=>{this.isEventForConsumer(e,i)&&(t=!0,this.sendToConsumer(e,i),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!Fj(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){if(e.error&&!cS(e)){const i=e.error.code?.split("auth/")[1]||"internal-error";t.onError(as(this.auth,i))}else t.onAuthEvent(e)}isEventForConsumer(e,t){const i=t.eventId===null||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&i}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=zj&&this.cachedEventUids.clear(),this.cachedEventUids.has(lT(e))}saveEventToCache(e){this.cachedEventUids.add(lT(e)),this.lastProcessedEventTime=Date.now()}}function lT(s){return[s.type,s.eventId,s.sessionId,s.tenantId].filter(e=>e).join("-")}function cS({type:s,error:e}){return s==="unknown"&&e?.code==="auth/no-auth-event"}function Fj(s){switch(s.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return cS(s);default:return!1}}async function qj(s,e={}){return fs(s,"GET","/v1/projects",e)}const Hj=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,Gj=/^https?/;async function Qj(s){if(s.config.emulator)return;const{authorizedDomains:e}=await qj(s);for(const t of e)try{if(Kj(t))return}catch{}Ii(s,"unauthorized-domain")}function Kj(s){const e=ry(),{protocol:t,hostname:i}=new URL(e);if(s.startsWith("chrome-extension://")){const u=new URL(s);return u.hostname===""&&i===""?t==="chrome-extension:"&&s.replace("chrome-extension://","")===e.replace("chrome-extension://",""):t==="chrome-extension:"&&u.hostname===i}if(!Gj.test(t))return!1;if(Hj.test(s))return i===s;const a=s.replace(/\./g,"\\.");return new RegExp("^(.+\\."+a+"|"+a+")$","i").test(i)}const $j=new Gu(3e4,6e4);function cT(){const s=os().___jsl;if(s?.H){for(const e of Object.keys(s.H))if(s.H[e].r=s.H[e].r||[],s.H[e].L=s.H[e].L||[],s.H[e].r=[...s.H[e].L],s.CP)for(let t=0;t<s.CP.length;t++)s.CP[t]=null}}function Wj(s){return new Promise((e,t)=>{function i(){cT(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{cT(),t(as(s,"network-request-failed"))},timeout:$j.get()})}if(os().gapi?.iframes?.Iframe)e(gapi.iframes.getContext());else if(os().gapi?.load)i();else{const a=MN("iframefcb");return os()[a]=()=>{gapi.load?i():t(as(s,"network-request-failed"))},K1(`${ON()}?onload=${a}`).catch(l=>t(l))}}).catch(e=>{throw tf=null,e})}let tf=null;function Yj(s){return tf=tf||Wj(s),tf}const Xj=new Gu(5e3,15e3),Jj="__/auth/iframe",Zj="emulator/auth/iframe",ek={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},tk=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function nk(s){const e=s.config;Re(e.authDomain,s,"auth-domain-config-required");const t=e.emulator?Gy(e,Zj):`https://${s.config.authDomain}/${Jj}`,i={apiKey:e.apiKey,appName:s.name,v:co},a=tk.get(s.config.apiHost);a&&(i.eid=a);const l=s._getFrameworks();return l.length&&(i.fw=l.join(",")),`${t}?${Hu(i).slice(1)}`}async function ik(s){const e=await Yj(s),t=os().gapi;return Re(t,s,"internal-error"),e.open({where:document.body,url:nk(s),messageHandlersFilter:t.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:ek,dontclear:!0},i=>new Promise(async(a,l)=>{await i.restyle({setHideOnLeave:!1});const u=as(s,"network-request-failed"),f=os().setTimeout(()=>{l(u)},Xj.get());function p(){os().clearTimeout(f),a(i)}i.ping(p).then(p,()=>{l(u)})}))}const sk={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},rk=500,ak=600,ok="_blank",lk="http://localhost";class uT{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function ck(s,e,t,i=rk,a=ak){const l=Math.max((window.screen.availHeight-a)/2,0).toString(),u=Math.max((window.screen.availWidth-i)/2,0).toString();let f="";const p={...sk,width:i.toString(),height:a.toString(),top:l,left:u},y=Qt().toLowerCase();t&&(f=z1(y)?ok:t),L1(y)&&(e=e||lk,p.scrollbars="yes");const _=Object.entries(p).reduce((x,[k,M])=>`${x}${k}=${M},`,"");if(wN(y)&&f!=="_self")return uk(e||"",f),new uT(null);const b=window.open(e||"",f,_);Re(b,s,"popup-blocked");try{b.focus()}catch{}return new uT(b)}function uk(s,e){const t=document.createElement("a");t.href=s,t.target=e;const i=document.createEvent("MouseEvent");i.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),t.dispatchEvent(i)}const hk="__/auth/handler",dk="emulator/auth/handler",fk=encodeURIComponent("fac");async function hT(s,e,t,i,a,l){Re(s.config.authDomain,s,"auth-domain-config-required"),Re(s.config.apiKey,s,"invalid-api-key");const u={apiKey:s.config.apiKey,appName:s.name,authType:t,redirectUrl:i,v:co,eventId:a};if(e instanceof Y1){e.setDefaultLanguage(s.languageCode),u.providerId=e.providerId||"",KR(e.getCustomParameters())||(u.customParameters=JSON.stringify(e.getCustomParameters()));for(const[_,b]of Object.entries({}))u[_]=b}if(e instanceof Ku){const _=e.getScopes().filter(b=>b!=="");_.length>0&&(u.scopes=_.join(","))}s.tenantId&&(u.tid=s.tenantId);const f=u;for(const _ of Object.keys(f))f[_]===void 0&&delete f[_];const p=await s._getAppCheckToken(),y=p?`#${fk}=${encodeURIComponent(p)}`:"";return`${mk(s)}?${Hu(f).slice(1)}${y}`}function mk({config:s}){return s.emulator?Gy(s,dk):`https://${s.authDomain}/${hk}`}const Pg="webStorageSupport";class pk{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=iS,this._completeRedirectFn=Uj,this._overrideRedirectResult=Vj}async _openPopup(e,t,i,a){Gs(this.eventManagers[e._key()]?.manager,"_initialize() not called before _openPopup()");const l=await hT(e,t,i,ry(),a);return ck(e,l,Yy())}async _openRedirect(e,t,i,a){await this._originValidation(e);const l=await hT(e,t,i,ry(),a);return vj(l),new Promise(()=>{})}_initialize(e){const t=e._key();if(this.eventManagers[t]){const{manager:a,promise:l}=this.eventManagers[t];return a?Promise.resolve(a):(Gs(l,"If manager is not set, promise should be"),l)}const i=this.initAndGetManager(e);return this.eventManagers[t]={promise:i},i.catch(()=>{delete this.eventManagers[t]}),i}async initAndGetManager(e){const t=await ik(e),i=new Bj(e);return t.register("authEvent",a=>(Re(a?.authEvent,e,"invalid-auth-event"),{status:i.onEvent(a.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:i},this.iframes[e._key()]=t,i}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(Pg,{type:Pg},a=>{const l=a?.[0]?.[Pg];l!==void 0&&t(!!l),Ii(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=Qj(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return G1()||U1()||Ky()}}const gk=pk;var dT="@firebase/auth",fT="1.12.0";class yk{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){return this.assertAuthConfigured(),this.auth.currentUser?.uid||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const t=this.auth.onIdTokenChanged(i=>{e(i?.stsTokenManager.accessToken||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){Re(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}function vk(s){switch(s){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function _k(s){Xa(new $r("auth",(e,{options:t})=>{const i=e.getProvider("app").getImmediate(),a=e.getProvider("heartbeat"),l=e.getProvider("app-check-internal"),{apiKey:u,authDomain:f}=i.options;Re(u&&!u.includes(":"),"invalid-api-key",{appName:i.name});const p={apiKey:u,authDomain:f,clientPlatform:s,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:Q1(s)},y=new NN(i,a,l,p);return BN(y,t),y},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,i)=>{e.getProvider("auth-internal").initialize()})),Xa(new $r("auth-internal",e=>{const t=Zr(e.getProvider("auth").getImmediate());return(i=>new yk(i))(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),rs(dT,fT,vk(s)),rs(dT,fT,"esm2020")}const bk=300,Ek=v1("authIdTokenMaxAge")||bk;let mT=null;const Tk=s=>async e=>{const t=e&&await e.getIdTokenResult(),i=t&&(new Date().getTime()-Date.parse(t.issuedAtTime))/1e3;if(i&&i>Ek)return;const a=t?.token;mT!==a&&(mT=a,await fetch(s,{method:a?"POST":"DELETE",headers:a?{Authorization:`Bearer ${a}`}:{}}))};function xk(s=I1()){const e=Xf(s,"auth");if(e.isInitialized())return e.getImmediate();const t=zN(s,{popupRedirectResolver:gk,persistence:[Ij,pj,iS]}),i=v1("authTokenSyncURL");if(i&&typeof isSecureContext=="boolean"&&isSecureContext){const l=new URL(i,location.origin);if(location.origin===l.origin){const u=Tk(l.toString());uj(t,u,()=>u(t.currentUser)),cj(t,f=>u(f))}}const a=g1("auth");return a&&FN(t,`http://${a}`),t}function Sk(){return document.getElementsByTagName("head")?.[0]??document}jN({loadJS(s){return new Promise((e,t)=>{const i=document.createElement("script");i.setAttribute("src",s),i.onload=e,i.onerror=a=>{const l=as("internal-error");l.customData=a,t(l)},i.type="text/javascript",i.charset="UTF-8",Sk().appendChild(i)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});_k("Browser");var wk="firebase",Ak="12.9.0";rs(wk,Ak,"app");var pT=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};var Gr,uS;(function(){var s;function e(C,R){function w(){}w.prototype=R.prototype,C.F=R.prototype,C.prototype=new w,C.prototype.constructor=C,C.D=function(I,D,L){for(var O=Array(arguments.length-2),Se=2;Se<arguments.length;Se++)O[Se-2]=arguments[Se];return R.prototype[D].apply(I,O)}}function t(){this.blockSize=-1}function i(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.C=Array(this.blockSize),this.o=this.h=0,this.u()}e(i,t),i.prototype.u=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function a(C,R,w){w||(w=0);const I=Array(16);if(typeof R=="string")for(var D=0;D<16;++D)I[D]=R.charCodeAt(w++)|R.charCodeAt(w++)<<8|R.charCodeAt(w++)<<16|R.charCodeAt(w++)<<24;else for(D=0;D<16;++D)I[D]=R[w++]|R[w++]<<8|R[w++]<<16|R[w++]<<24;R=C.g[0],w=C.g[1],D=C.g[2];let L=C.g[3],O;O=R+(L^w&(D^L))+I[0]+3614090360&4294967295,R=w+(O<<7&4294967295|O>>>25),O=L+(D^R&(w^D))+I[1]+3905402710&4294967295,L=R+(O<<12&4294967295|O>>>20),O=D+(w^L&(R^w))+I[2]+606105819&4294967295,D=L+(O<<17&4294967295|O>>>15),O=w+(R^D&(L^R))+I[3]+3250441966&4294967295,w=D+(O<<22&4294967295|O>>>10),O=R+(L^w&(D^L))+I[4]+4118548399&4294967295,R=w+(O<<7&4294967295|O>>>25),O=L+(D^R&(w^D))+I[5]+1200080426&4294967295,L=R+(O<<12&4294967295|O>>>20),O=D+(w^L&(R^w))+I[6]+2821735955&4294967295,D=L+(O<<17&4294967295|O>>>15),O=w+(R^D&(L^R))+I[7]+4249261313&4294967295,w=D+(O<<22&4294967295|O>>>10),O=R+(L^w&(D^L))+I[8]+1770035416&4294967295,R=w+(O<<7&4294967295|O>>>25),O=L+(D^R&(w^D))+I[9]+2336552879&4294967295,L=R+(O<<12&4294967295|O>>>20),O=D+(w^L&(R^w))+I[10]+4294925233&4294967295,D=L+(O<<17&4294967295|O>>>15),O=w+(R^D&(L^R))+I[11]+2304563134&4294967295,w=D+(O<<22&4294967295|O>>>10),O=R+(L^w&(D^L))+I[12]+1804603682&4294967295,R=w+(O<<7&4294967295|O>>>25),O=L+(D^R&(w^D))+I[13]+4254626195&4294967295,L=R+(O<<12&4294967295|O>>>20),O=D+(w^L&(R^w))+I[14]+2792965006&4294967295,D=L+(O<<17&4294967295|O>>>15),O=w+(R^D&(L^R))+I[15]+1236535329&4294967295,w=D+(O<<22&4294967295|O>>>10),O=R+(D^L&(w^D))+I[1]+4129170786&4294967295,R=w+(O<<5&4294967295|O>>>27),O=L+(w^D&(R^w))+I[6]+3225465664&4294967295,L=R+(O<<9&4294967295|O>>>23),O=D+(R^w&(L^R))+I[11]+643717713&4294967295,D=L+(O<<14&4294967295|O>>>18),O=w+(L^R&(D^L))+I[0]+3921069994&4294967295,w=D+(O<<20&4294967295|O>>>12),O=R+(D^L&(w^D))+I[5]+3593408605&4294967295,R=w+(O<<5&4294967295|O>>>27),O=L+(w^D&(R^w))+I[10]+38016083&4294967295,L=R+(O<<9&4294967295|O>>>23),O=D+(R^w&(L^R))+I[15]+3634488961&4294967295,D=L+(O<<14&4294967295|O>>>18),O=w+(L^R&(D^L))+I[4]+3889429448&4294967295,w=D+(O<<20&4294967295|O>>>12),O=R+(D^L&(w^D))+I[9]+568446438&4294967295,R=w+(O<<5&4294967295|O>>>27),O=L+(w^D&(R^w))+I[14]+3275163606&4294967295,L=R+(O<<9&4294967295|O>>>23),O=D+(R^w&(L^R))+I[3]+4107603335&4294967295,D=L+(O<<14&4294967295|O>>>18),O=w+(L^R&(D^L))+I[8]+1163531501&4294967295,w=D+(O<<20&4294967295|O>>>12),O=R+(D^L&(w^D))+I[13]+2850285829&4294967295,R=w+(O<<5&4294967295|O>>>27),O=L+(w^D&(R^w))+I[2]+4243563512&4294967295,L=R+(O<<9&4294967295|O>>>23),O=D+(R^w&(L^R))+I[7]+1735328473&4294967295,D=L+(O<<14&4294967295|O>>>18),O=w+(L^R&(D^L))+I[12]+2368359562&4294967295,w=D+(O<<20&4294967295|O>>>12),O=R+(w^D^L)+I[5]+4294588738&4294967295,R=w+(O<<4&4294967295|O>>>28),O=L+(R^w^D)+I[8]+2272392833&4294967295,L=R+(O<<11&4294967295|O>>>21),O=D+(L^R^w)+I[11]+1839030562&4294967295,D=L+(O<<16&4294967295|O>>>16),O=w+(D^L^R)+I[14]+4259657740&4294967295,w=D+(O<<23&4294967295|O>>>9),O=R+(w^D^L)+I[1]+2763975236&4294967295,R=w+(O<<4&4294967295|O>>>28),O=L+(R^w^D)+I[4]+1272893353&4294967295,L=R+(O<<11&4294967295|O>>>21),O=D+(L^R^w)+I[7]+4139469664&4294967295,D=L+(O<<16&4294967295|O>>>16),O=w+(D^L^R)+I[10]+3200236656&4294967295,w=D+(O<<23&4294967295|O>>>9),O=R+(w^D^L)+I[13]+681279174&4294967295,R=w+(O<<4&4294967295|O>>>28),O=L+(R^w^D)+I[0]+3936430074&4294967295,L=R+(O<<11&4294967295|O>>>21),O=D+(L^R^w)+I[3]+3572445317&4294967295,D=L+(O<<16&4294967295|O>>>16),O=w+(D^L^R)+I[6]+76029189&4294967295,w=D+(O<<23&4294967295|O>>>9),O=R+(w^D^L)+I[9]+3654602809&4294967295,R=w+(O<<4&4294967295|O>>>28),O=L+(R^w^D)+I[12]+3873151461&4294967295,L=R+(O<<11&4294967295|O>>>21),O=D+(L^R^w)+I[15]+530742520&4294967295,D=L+(O<<16&4294967295|O>>>16),O=w+(D^L^R)+I[2]+3299628645&4294967295,w=D+(O<<23&4294967295|O>>>9),O=R+(D^(w|~L))+I[0]+4096336452&4294967295,R=w+(O<<6&4294967295|O>>>26),O=L+(w^(R|~D))+I[7]+1126891415&4294967295,L=R+(O<<10&4294967295|O>>>22),O=D+(R^(L|~w))+I[14]+2878612391&4294967295,D=L+(O<<15&4294967295|O>>>17),O=w+(L^(D|~R))+I[5]+4237533241&4294967295,w=D+(O<<21&4294967295|O>>>11),O=R+(D^(w|~L))+I[12]+1700485571&4294967295,R=w+(O<<6&4294967295|O>>>26),O=L+(w^(R|~D))+I[3]+2399980690&4294967295,L=R+(O<<10&4294967295|O>>>22),O=D+(R^(L|~w))+I[10]+4293915773&4294967295,D=L+(O<<15&4294967295|O>>>17),O=w+(L^(D|~R))+I[1]+2240044497&4294967295,w=D+(O<<21&4294967295|O>>>11),O=R+(D^(w|~L))+I[8]+1873313359&4294967295,R=w+(O<<6&4294967295|O>>>26),O=L+(w^(R|~D))+I[15]+4264355552&4294967295,L=R+(O<<10&4294967295|O>>>22),O=D+(R^(L|~w))+I[6]+2734768916&4294967295,D=L+(O<<15&4294967295|O>>>17),O=w+(L^(D|~R))+I[13]+1309151649&4294967295,w=D+(O<<21&4294967295|O>>>11),O=R+(D^(w|~L))+I[4]+4149444226&4294967295,R=w+(O<<6&4294967295|O>>>26),O=L+(w^(R|~D))+I[11]+3174756917&4294967295,L=R+(O<<10&4294967295|O>>>22),O=D+(R^(L|~w))+I[2]+718787259&4294967295,D=L+(O<<15&4294967295|O>>>17),O=w+(L^(D|~R))+I[9]+3951481745&4294967295,C.g[0]=C.g[0]+R&4294967295,C.g[1]=C.g[1]+(D+(O<<21&4294967295|O>>>11))&4294967295,C.g[2]=C.g[2]+D&4294967295,C.g[3]=C.g[3]+L&4294967295}i.prototype.v=function(C,R){R===void 0&&(R=C.length);const w=R-this.blockSize,I=this.C;let D=this.h,L=0;for(;L<R;){if(D==0)for(;L<=w;)a(this,C,L),L+=this.blockSize;if(typeof C=="string"){for(;L<R;)if(I[D++]=C.charCodeAt(L++),D==this.blockSize){a(this,I),D=0;break}}else for(;L<R;)if(I[D++]=C[L++],D==this.blockSize){a(this,I),D=0;break}}this.h=D,this.o+=R},i.prototype.A=function(){var C=Array((this.h<56?this.blockSize:this.blockSize*2)-this.h);C[0]=128;for(var R=1;R<C.length-8;++R)C[R]=0;R=this.o*8;for(var w=C.length-8;w<C.length;++w)C[w]=R&255,R/=256;for(this.v(C),C=Array(16),R=0,w=0;w<4;++w)for(let I=0;I<32;I+=8)C[R++]=this.g[w]>>>I&255;return C};function l(C,R){var w=f;return Object.prototype.hasOwnProperty.call(w,C)?w[C]:w[C]=R(C)}function u(C,R){this.h=R;const w=[];let I=!0;for(let D=C.length-1;D>=0;D--){const L=C[D]|0;I&&L==R||(w[D]=L,I=!1)}this.g=w}var f={};function p(C){return-128<=C&&C<128?l(C,function(R){return new u([R|0],R<0?-1:0)}):new u([C|0],C<0?-1:0)}function y(C){if(isNaN(C)||!isFinite(C))return b;if(C<0)return V(y(-C));const R=[];let w=1;for(let I=0;C>=w;I++)R[I]=C/w|0,w*=4294967296;return new u(R,0)}function _(C,R){if(C.length==0)throw Error("number format error: empty string");if(R=R||10,R<2||36<R)throw Error("radix out of range: "+R);if(C.charAt(0)=="-")return V(_(C.substring(1),R));if(C.indexOf("-")>=0)throw Error('number format error: interior "-" character');const w=y(Math.pow(R,8));let I=b;for(let L=0;L<C.length;L+=8){var D=Math.min(8,C.length-L);const O=parseInt(C.substring(L,L+D),R);D<8?(D=y(Math.pow(R,D)),I=I.j(D).add(y(O))):(I=I.j(w),I=I.add(y(O)))}return I}var b=p(0),x=p(1),k=p(16777216);s=u.prototype,s.m=function(){if(j(this))return-V(this).m();let C=0,R=1;for(let w=0;w<this.g.length;w++){const I=this.i(w);C+=(I>=0?I:4294967296+I)*R,R*=4294967296}return C},s.toString=function(C){if(C=C||10,C<2||36<C)throw Error("radix out of range: "+C);if(M(this))return"0";if(j(this))return"-"+V(this).toString(C);const R=y(Math.pow(C,6));var w=this;let I="";for(;;){const D=ie(w,R).g;w=ee(w,D.j(R));let L=((w.g.length>0?w.g[0]:w.h)>>>0).toString(C);if(w=D,M(w))return L+I;for(;L.length<6;)L="0"+L;I=L+I}},s.i=function(C){return C<0?0:C<this.g.length?this.g[C]:this.h};function M(C){if(C.h!=0)return!1;for(let R=0;R<C.g.length;R++)if(C.g[R]!=0)return!1;return!0}function j(C){return C.h==-1}s.l=function(C){return C=ee(this,C),j(C)?-1:M(C)?0:1};function V(C){const R=C.g.length,w=[];for(let I=0;I<R;I++)w[I]=~C.g[I];return new u(w,~C.h).add(x)}s.abs=function(){return j(this)?V(this):this},s.add=function(C){const R=Math.max(this.g.length,C.g.length),w=[];let I=0;for(let D=0;D<=R;D++){let L=I+(this.i(D)&65535)+(C.i(D)&65535),O=(L>>>16)+(this.i(D)>>>16)+(C.i(D)>>>16);I=O>>>16,L&=65535,O&=65535,w[D]=O<<16|L}return new u(w,w[w.length-1]&-2147483648?-1:0)};function ee(C,R){return C.add(V(R))}s.j=function(C){if(M(this)||M(C))return b;if(j(this))return j(C)?V(this).j(V(C)):V(V(this).j(C));if(j(C))return V(this.j(V(C)));if(this.l(k)<0&&C.l(k)<0)return y(this.m()*C.m());const R=this.g.length+C.g.length,w=[];for(var I=0;I<2*R;I++)w[I]=0;for(I=0;I<this.g.length;I++)for(let D=0;D<C.g.length;D++){const L=this.i(I)>>>16,O=this.i(I)&65535,Se=C.i(D)>>>16,pe=C.i(D)&65535;w[2*I+2*D]+=O*pe,ne(w,2*I+2*D),w[2*I+2*D+1]+=L*pe,ne(w,2*I+2*D+1),w[2*I+2*D+1]+=O*Se,ne(w,2*I+2*D+1),w[2*I+2*D+2]+=L*Se,ne(w,2*I+2*D+2)}for(C=0;C<R;C++)w[C]=w[2*C+1]<<16|w[2*C];for(C=R;C<2*R;C++)w[C]=0;return new u(w,0)};function ne(C,R){for(;(C[R]&65535)!=C[R];)C[R+1]+=C[R]>>>16,C[R]&=65535,R++}function Y(C,R){this.g=C,this.h=R}function ie(C,R){if(M(R))throw Error("division by zero");if(M(C))return new Y(b,b);if(j(C))return R=ie(V(C),R),new Y(V(R.g),V(R.h));if(j(R))return R=ie(C,V(R)),new Y(V(R.g),R.h);if(C.g.length>30){if(j(C)||j(R))throw Error("slowDivide_ only works with positive integers.");for(var w=x,I=R;I.l(C)<=0;)w=F(w),I=F(I);var D=J(w,1),L=J(I,1);for(I=J(I,2),w=J(w,2);!M(I);){var O=L.add(I);O.l(C)<=0&&(D=D.add(w),L=O),I=J(I,1),w=J(w,1)}return R=ee(C,D.j(R)),new Y(D,R)}for(D=b;C.l(R)>=0;){for(w=Math.max(1,Math.floor(C.m()/R.m())),I=Math.ceil(Math.log(w)/Math.LN2),I=I<=48?1:Math.pow(2,I-48),L=y(w),O=L.j(R);j(O)||O.l(C)>0;)w-=I,L=y(w),O=L.j(R);M(L)&&(L=x),D=D.add(L),C=ee(C,O)}return new Y(D,C)}s.B=function(C){return ie(this,C).h},s.and=function(C){const R=Math.max(this.g.length,C.g.length),w=[];for(let I=0;I<R;I++)w[I]=this.i(I)&C.i(I);return new u(w,this.h&C.h)},s.or=function(C){const R=Math.max(this.g.length,C.g.length),w=[];for(let I=0;I<R;I++)w[I]=this.i(I)|C.i(I);return new u(w,this.h|C.h)},s.xor=function(C){const R=Math.max(this.g.length,C.g.length),w=[];for(let I=0;I<R;I++)w[I]=this.i(I)^C.i(I);return new u(w,this.h^C.h)};function F(C){const R=C.g.length+1,w=[];for(let I=0;I<R;I++)w[I]=C.i(I)<<1|C.i(I-1)>>>31;return new u(w,C.h)}function J(C,R){const w=R>>5;R%=32;const I=C.g.length-w,D=[];for(let L=0;L<I;L++)D[L]=R>0?C.i(L+w)>>>R|C.i(L+w+1)<<32-R:C.i(L+w);return new u(D,C.h)}i.prototype.digest=i.prototype.A,i.prototype.reset=i.prototype.u,i.prototype.update=i.prototype.v,uS=i,u.prototype.add=u.prototype.add,u.prototype.multiply=u.prototype.j,u.prototype.modulo=u.prototype.B,u.prototype.compare=u.prototype.l,u.prototype.toNumber=u.prototype.m,u.prototype.toString=u.prototype.toString,u.prototype.getBits=u.prototype.i,u.fromNumber=y,u.fromString=_,Gr=u}).apply(typeof pT<"u"?pT:typeof self<"u"?self:typeof window<"u"?window:{});var Pd=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};var hS,cu,dS,nf,ly,fS,mS,pS;(function(){var s,e=Object.defineProperty;function t(h){h=[typeof globalThis=="object"&&globalThis,h,typeof window=="object"&&window,typeof self=="object"&&self,typeof Pd=="object"&&Pd];for(var v=0;v<h.length;++v){var T=h[v];if(T&&T.Math==Math)return T}throw Error("Cannot find global object")}var i=t(this);function a(h,v){if(v)e:{var T=i;h=h.split(".");for(var A=0;A<h.length-1;A++){var Q=h[A];if(!(Q in T))break e;T=T[Q]}h=h[h.length-1],A=T[h],v=v(A),v!=A&&v!=null&&e(T,h,{configurable:!0,writable:!0,value:v})}}a("Symbol.dispose",function(h){return h||Symbol("Symbol.dispose")}),a("Array.prototype.values",function(h){return h||function(){return this[Symbol.iterator]()}}),a("Object.entries",function(h){return h||function(v){var T=[],A;for(A in v)Object.prototype.hasOwnProperty.call(v,A)&&T.push([A,v[A]]);return T}});var l=l||{},u=this||self;function f(h){var v=typeof h;return v=="object"&&h!=null||v=="function"}function p(h,v,T){return h.call.apply(h.bind,arguments)}function y(h,v,T){return y=p,y.apply(null,arguments)}function _(h,v){var T=Array.prototype.slice.call(arguments,1);return function(){var A=T.slice();return A.push.apply(A,arguments),h.apply(this,A)}}function b(h,v){function T(){}T.prototype=v.prototype,h.Z=v.prototype,h.prototype=new T,h.prototype.constructor=h,h.Ob=function(A,Q,X){for(var fe=Array(arguments.length-2),ke=2;ke<arguments.length;ke++)fe[ke-2]=arguments[ke];return v.prototype[Q].apply(A,fe)}}var x=typeof AsyncContext<"u"&&typeof AsyncContext.Snapshot=="function"?h=>h&&AsyncContext.Snapshot.wrap(h):h=>h;function k(h){const v=h.length;if(v>0){const T=Array(v);for(let A=0;A<v;A++)T[A]=h[A];return T}return[]}function M(h,v){for(let A=1;A<arguments.length;A++){const Q=arguments[A];var T=typeof Q;if(T=T!="object"?T:Q?Array.isArray(Q)?"array":T:"null",T=="array"||T=="object"&&typeof Q.length=="number"){T=h.length||0;const X=Q.length||0;h.length=T+X;for(let fe=0;fe<X;fe++)h[T+fe]=Q[fe]}else h.push(Q)}}class j{constructor(v,T){this.i=v,this.j=T,this.h=0,this.g=null}get(){let v;return this.h>0?(this.h--,v=this.g,this.g=v.next,v.next=null):v=this.i(),v}}function V(h){u.setTimeout(()=>{throw h},0)}function ee(){var h=C;let v=null;return h.g&&(v=h.g,h.g=h.g.next,h.g||(h.h=null),v.next=null),v}class ne{constructor(){this.h=this.g=null}add(v,T){const A=Y.get();A.set(v,T),this.h?this.h.next=A:this.g=A,this.h=A}}var Y=new j(()=>new ie,h=>h.reset());class ie{constructor(){this.next=this.g=this.h=null}set(v,T){this.h=v,this.g=T,this.next=null}reset(){this.next=this.g=this.h=null}}let F,J=!1,C=new ne,R=()=>{const h=Promise.resolve(void 0);F=()=>{h.then(w)}};function w(){for(var h;h=ee();){try{h.h.call(h.g)}catch(T){V(T)}var v=Y;v.j(h),v.h<100&&(v.h++,h.next=v.g,v.g=h)}J=!1}function I(){this.u=this.u,this.C=this.C}I.prototype.u=!1,I.prototype.dispose=function(){this.u||(this.u=!0,this.N())},I.prototype[Symbol.dispose]=function(){this.dispose()},I.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function D(h,v){this.type=h,this.g=this.target=v,this.defaultPrevented=!1}D.prototype.h=function(){this.defaultPrevented=!0};var L=(function(){if(!u.addEventListener||!Object.defineProperty)return!1;var h=!1,v=Object.defineProperty({},"passive",{get:function(){h=!0}});try{const T=()=>{};u.addEventListener("test",T,v),u.removeEventListener("test",T,v)}catch{}return h})();function O(h){return/^[\s\xa0]*$/.test(h)}function Se(h,v){D.call(this,h?h.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,h&&this.init(h,v)}b(Se,D),Se.prototype.init=function(h,v){const T=this.type=h.type,A=h.changedTouches&&h.changedTouches.length?h.changedTouches[0]:null;this.target=h.target||h.srcElement,this.g=v,v=h.relatedTarget,v||(T=="mouseover"?v=h.fromElement:T=="mouseout"&&(v=h.toElement)),this.relatedTarget=v,A?(this.clientX=A.clientX!==void 0?A.clientX:A.pageX,this.clientY=A.clientY!==void 0?A.clientY:A.pageY,this.screenX=A.screenX||0,this.screenY=A.screenY||0):(this.clientX=h.clientX!==void 0?h.clientX:h.pageX,this.clientY=h.clientY!==void 0?h.clientY:h.pageY,this.screenX=h.screenX||0,this.screenY=h.screenY||0),this.button=h.button,this.key=h.key||"",this.ctrlKey=h.ctrlKey,this.altKey=h.altKey,this.shiftKey=h.shiftKey,this.metaKey=h.metaKey,this.pointerId=h.pointerId||0,this.pointerType=h.pointerType,this.state=h.state,this.i=h,h.defaultPrevented&&Se.Z.h.call(this)},Se.prototype.h=function(){Se.Z.h.call(this);const h=this.i;h.preventDefault?h.preventDefault():h.returnValue=!1};var pe="closure_listenable_"+(Math.random()*1e6|0),G=0;function le(h,v,T,A,Q){this.listener=h,this.proxy=null,this.src=v,this.type=T,this.capture=!!A,this.ha=Q,this.key=++G,this.da=this.fa=!1}function ye(h){h.da=!0,h.listener=null,h.proxy=null,h.src=null,h.ha=null}function Te(h,v,T){for(const A in h)v.call(T,h[A],A,h)}function Ve(h,v){for(const T in h)v.call(void 0,h[T],T,h)}function U(h){const v={};for(const T in h)v[T]=h[T];return v}const z="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function ue(h,v){let T,A;for(let Q=1;Q<arguments.length;Q++){A=arguments[Q];for(T in A)h[T]=A[T];for(let X=0;X<z.length;X++)T=z[X],Object.prototype.hasOwnProperty.call(A,T)&&(h[T]=A[T])}}function re(h){this.src=h,this.g={},this.h=0}re.prototype.add=function(h,v,T,A,Q){const X=h.toString();h=this.g[X],h||(h=this.g[X]=[],this.h++);const fe=Ie(h,v,A,Q);return fe>-1?(v=h[fe],T||(v.fa=!1)):(v=new le(v,this.src,X,!!A,Q),v.fa=T,h.push(v)),v};function ge(h,v){const T=v.type;if(T in h.g){var A=h.g[T],Q=Array.prototype.indexOf.call(A,v,void 0),X;(X=Q>=0)&&Array.prototype.splice.call(A,Q,1),X&&(ye(v),h.g[T].length==0&&(delete h.g[T],h.h--))}}function Ie(h,v,T,A){for(let Q=0;Q<h.length;++Q){const X=h[Q];if(!X.da&&X.listener==v&&X.capture==!!T&&X.ha==A)return Q}return-1}var Ne="closure_lm_"+(Math.random()*1e6|0),Qe={};function $e(h,v,T,A,Q){if(Array.isArray(v)){for(let X=0;X<v.length;X++)$e(h,v[X],T,A,Q);return null}return T=ji(T),h&&h[pe]?h.J(v,T,f(A)?!!A.capture:!1,Q):Di(h,v,T,!1,A,Q)}function Di(h,v,T,A,Q,X){if(!v)throw Error("Invalid event type");const fe=f(Q)?!!Q.capture:!!Q;let ke=ys(h);if(ke||(h[Ne]=ke=new re(h)),T=ke.add(v,T,A,fe,X),T.proxy)return T;if(A=ps(),T.proxy=A,A.src=h,A.listener=T,h.addEventListener)L||(Q=fe),Q===void 0&&(Q=!1),h.addEventListener(v.toString(),A,Q);else if(h.attachEvent)h.attachEvent(mn(v.toString()),A);else if(h.addListener&&h.removeListener)h.addListener(A);else throw Error("addEventListener and attachEvent are unavailable.");return T}function ps(){function h(T){return v.call(h.src,h.listener,T)}const v=Zs;return h}function gs(h,v,T,A,Q){if(Array.isArray(v))for(var X=0;X<v.length;X++)gs(h,v[X],T,A,Q);else A=f(A)?!!A.capture:!!A,T=ji(T),h&&h[pe]?(h=h.i,X=String(v).toString(),X in h.g&&(v=h.g[X],T=Ie(v,T,A,Q),T>-1&&(ye(v[T]),Array.prototype.splice.call(v,T,1),v.length==0&&(delete h.g[X],h.h--)))):h&&(h=ys(h))&&(v=h.g[v.toString()],h=-1,v&&(h=Ie(v,T,A,Q)),(T=h>-1?v[h]:null)&&Js(T))}function Js(h){if(typeof h!="number"&&h&&!h.da){var v=h.src;if(v&&v[pe])ge(v.i,h);else{var T=h.type,A=h.proxy;v.removeEventListener?v.removeEventListener(T,A,h.capture):v.detachEvent?v.detachEvent(mn(T),A):v.addListener&&v.removeListener&&v.removeListener(A),(T=ys(v))?(ge(T,h),T.h==0&&(T.src=null,v[Ne]=null)):ye(h)}}}function mn(h){return h in Qe?Qe[h]:Qe[h]="on"+h}function Zs(h,v){if(h.da)h=!0;else{v=new Se(v,this);const T=h.listener,A=h.ha||h.src;h.fa&&Js(h),h=T.call(A,v)}return h}function ys(h){return h=h[Ne],h instanceof re?h:null}var Ni="__closure_events_fn_"+(Math.random()*1e9>>>0);function ji(h){return typeof h=="function"?h:(h[Ni]||(h[Ni]=function(v){return h.handleEvent(v)}),h[Ni])}function He(){I.call(this),this.i=new re(this),this.M=this,this.G=null}b(He,I),He.prototype[pe]=!0,He.prototype.removeEventListener=function(h,v,T,A){gs(this,h,v,T,A)};function ft(h,v){var T,A=h.G;if(A)for(T=[];A;A=A.G)T.push(A);if(h=h.M,A=v.type||v,typeof v=="string")v=new D(v,h);else if(v instanceof D)v.target=v.target||h;else{var Q=v;v=new D(A,h),ue(v,Q)}Q=!0;let X,fe;if(T)for(fe=T.length-1;fe>=0;fe--)X=v.g=T[fe],Q=hi(X,A,!0,v)&&Q;if(X=v.g=h,Q=hi(X,A,!0,v)&&Q,Q=hi(X,A,!1,v)&&Q,T)for(fe=0;fe<T.length;fe++)X=v.g=T[fe],Q=hi(X,A,!1,v)&&Q}He.prototype.N=function(){if(He.Z.N.call(this),this.i){var h=this.i;for(const v in h.g){const T=h.g[v];for(let A=0;A<T.length;A++)ye(T[A]);delete h.g[v],h.h--}}this.G=null},He.prototype.J=function(h,v,T,A){return this.i.add(String(h),v,!1,T,A)},He.prototype.K=function(h,v,T,A){return this.i.add(String(h),v,!0,T,A)};function hi(h,v,T,A){if(v=h.i.g[String(v)],!v)return!0;v=v.concat();let Q=!0;for(let X=0;X<v.length;++X){const fe=v[X];if(fe&&!fe.da&&fe.capture==T){const ke=fe.listener,Ct=fe.ha||fe.src;fe.fa&&ge(h.i,fe),Q=ke.call(Ct,A)!==!1&&Q}}return Q&&!A.defaultPrevented}function fo(h,v){if(typeof h!="function")if(h&&typeof h.handleEvent=="function")h=y(h.handleEvent,h);else throw Error("Invalid listener argument");return Number(v)>2147483647?-1:u.setTimeout(h,v||0)}function aa(h){h.g=fo(()=>{h.g=null,h.i&&(h.i=!1,aa(h))},h.l);const v=h.h;h.h=null,h.m.apply(null,v)}class vt extends I{constructor(v,T){super(),this.m=v,this.l=T,this.h=null,this.i=!1,this.g=null}j(v){this.h=arguments,this.g?this.i=!0:aa(this)}N(){super.N(),this.g&&(u.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Kn(h){I.call(this),this.h=h,this.g={}}b(Kn,I);var oa=[];function la(h){Te(h.g,function(v,T){this.g.hasOwnProperty(T)&&Js(v)},h),h.g={}}Kn.prototype.N=function(){Kn.Z.N.call(this),la(this)},Kn.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var ki=u.JSON.stringify,mo=u.JSON.parse,po=class{stringify(h){return u.JSON.stringify(h,void 0)}parse(h){return u.JSON.parse(h,void 0)}};function ca(){}function go(){}var Dn={OPEN:"a",hb:"b",ERROR:"c",tb:"d"};function qt(){D.call(this,"d")}b(qt,D);function _n(){D.call(this,"c")}b(_n,D);var de={},Jt=null;function Nn(){return Jt=Jt||new He}de.Ia="serverreachability";function er(h){D.call(this,de.Ia,h)}b(er,D);function ht(h){const v=Nn();ft(v,new er(v))}de.STAT_EVENT="statevent";function vs(h,v){D.call(this,de.STAT_EVENT,h),this.stat=v}b(vs,D);function mt(h){const v=Nn();ft(v,new vs(v,h))}de.Ja="timingevent";function Oi(h,v){D.call(this,de.Ja,h),this.size=v}b(Oi,D);function Mi(h,v){if(typeof h!="function")throw Error("Fn must not be null and must be a function");return u.setTimeout(function(){h()},v)}function di(){this.g=!0}di.prototype.ua=function(){this.g=!1};function Am(h,v,T,A,Q,X){h.info(function(){if(h.g)if(X){var fe="",ke=X.split("&");for(let Xe=0;Xe<ke.length;Xe++){var Ct=ke[Xe].split("=");if(Ct.length>1){const _t=Ct[0];Ct=Ct[1];const Xn=_t.split("_");fe=Xn.length>=2&&Xn[1]=="type"?fe+(_t+"="+Ct+"&"):fe+(_t+"=redacted&")}}}else fe=null;else fe=X;return"XMLHTTP REQ ("+A+") [attempt "+Q+"]: "+v+`
`+T+`
`+fe})}function hh(h,v,T,A,Q,X,fe){h.info(function(){return"XMLHTTP RESP ("+A+") [ attempt "+Q+"]: "+v+`
`+T+`
`+X+" "+fe})}function Vi(h,v,T,A){h.info(function(){return"XMLHTTP TEXT ("+v+"): "+Im(h,T)+(A?" "+A:"")})}function ua(h,v){h.info(function(){return"TIMEOUT: "+v})}di.prototype.info=function(){};function Im(h,v){if(!h.g)return v;if(!v)return null;try{const X=JSON.parse(v);if(X){for(h=0;h<X.length;h++)if(Array.isArray(X[h])){var T=X[h];if(!(T.length<2)){var A=T[1];if(Array.isArray(A)&&!(A.length<1)){var Q=A[0];if(Q!="noop"&&Q!="stop"&&Q!="close")for(let fe=1;fe<A.length;fe++)A[fe]=""}}}}return ki(X)}catch{return v}}var ha={NO_ERROR:0,cb:1,qb:2,pb:3,kb:4,ob:5,rb:6,Ga:7,TIMEOUT:8,ub:9},Zl={ib:"complete",Fb:"success",ERROR:"error",Ga:"abort",xb:"ready",yb:"readystatechange",TIMEOUT:"timeout",sb:"incrementaldata",wb:"progress",lb:"downloadprogress",Nb:"uploadprogress"},ec;function da(){}b(da,ca),da.prototype.g=function(){return new XMLHttpRequest},ec=new da;function _s(h){return encodeURIComponent(String(h))}function dh(h){var v=1;h=h.split(":");const T=[];for(;v>0&&h.length;)T.push(h.shift()),v--;return h.length&&T.push(h.join(":")),T}function fi(h,v,T,A){this.j=h,this.i=v,this.l=T,this.S=A||1,this.V=new Kn(this),this.H=45e3,this.J=null,this.o=!1,this.u=this.B=this.A=this.M=this.F=this.T=this.D=null,this.G=[],this.g=null,this.C=0,this.m=this.v=null,this.X=-1,this.K=!1,this.P=0,this.O=null,this.W=this.L=this.U=this.R=!1,this.h=new mi}function mi(){this.i=null,this.g="",this.h=!1}var Ot={},$t={};function Pi(h,v,T){h.M=1,h.A=fa(Vt(v)),h.u=T,h.R=!0,yo(h,null)}function yo(h,v){h.F=Date.now(),Li(h),h.B=Vt(h.A);var T=h.B,A=h.S;Array.isArray(A)||(A=[String(A)]),Eo(T.i,"t",A),h.C=0,T=h.j.L,h.h=new mi,h.g=Ih(h.j,T?v:null,!h.u),h.P>0&&(h.O=new vt(y(h.Y,h,h.g),h.P)),v=h.V,T=h.g,A=h.ba;var Q="readystatechange";Array.isArray(Q)||(Q&&(oa[0]=Q.toString()),Q=oa);for(let X=0;X<Q.length;X++){const fe=$e(T,Q[X],A||v.handleEvent,!1,v.h||v);if(!fe)break;v.g[fe.key]=fe}v=h.J?U(h.J):{},h.u?(h.v||(h.v="POST"),v["Content-Type"]="application/x-www-form-urlencoded",h.g.ea(h.B,h.v,h.u,v)):(h.v="GET",h.g.ea(h.B,h.v,null,v)),ht(),Am(h.i,h.v,h.B,h.l,h.S,h.u)}fi.prototype.ba=function(h){h=h.target;const v=this.O;v&&yi(h)==3?v.j():this.Y(h)},fi.prototype.Y=function(h){try{if(h==this.g)e:{const ke=yi(this.g),Ct=this.g.ya(),Xe=this.g.ca();if(!(ke<3)&&(ke!=3||this.g&&(this.h.h||this.g.la()||Zt(this.g)))){this.K||ke!=4||Ct==7||(Ct==8||Xe<=0?ht(3):ht(2)),Ui(this);var v=this.g.ca();this.X=v;var T=Cm(this);if(this.o=v==200,hh(this.i,this.v,this.B,this.l,this.S,ke,v),this.o){if(this.U&&!this.L){t:{if(this.g){var A,Q=this.g;if((A=Q.g?Q.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!O(A)){var X=A;break t}}X=null}if(h=X)Vi(this.i,this.l,h,"Initial handshake response via X-HTTP-Initial-Response"),this.L=!0,zi(this,h);else{this.o=!1,this.m=3,mt(12),jn(this),$n(this);break e}}if(this.R){h=!0;let _t;for(;!this.K&&this.C<T.length;)if(_t=mh(this,T),_t==$t){ke==4&&(this.m=4,mt(14),h=!1),Vi(this.i,this.l,null,"[Incomplete Response]");break}else if(_t==Ot){this.m=4,mt(15),Vi(this.i,this.l,T,"[Invalid Chunk]"),h=!1;break}else Vi(this.i,this.l,_t,null),zi(this,_t);if(fh(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),ke!=4||T.length!=0||this.h.h||(this.m=1,mt(16),h=!1),this.o=this.o&&h,!h)Vi(this.i,this.l,T,"[Invalid Chunked Response]"),jn(this),$n(this);else if(T.length>0&&!this.W){this.W=!0;var fe=this.j;fe.g==this&&fe.aa&&!fe.P&&(fe.j.info("Great, no buffering proxy detected. Bytes received: "+T.length),pc(fe),fe.P=!0,mt(11))}}else Vi(this.i,this.l,T,null),zi(this,T);ke==4&&jn(this),this.o&&!this.K&&(ke==4?xh(this.j,this):(this.o=!1,Li(this)))}else Es(this.g),v==400&&T.indexOf("Unknown SID")>0?(this.m=3,mt(12)):(this.m=0,mt(13)),jn(this),$n(this)}}}catch{}};function Cm(h){if(!fh(h))return h.g.la();const v=Zt(h.g);if(v==="")return"";let T="";const A=v.length,Q=yi(h.g)==4;if(!h.h.i){if(typeof TextDecoder>"u")return jn(h),$n(h),"";h.h.i=new u.TextDecoder}for(let X=0;X<A;X++)h.h.h=!0,T+=h.h.i.decode(v[X],{stream:!(Q&&X==A-1)});return v.length=0,h.h.g+=T,h.C=0,h.h.g}function fh(h){return h.g?h.v=="GET"&&h.M!=2&&h.j.Aa:!1}function mh(h,v){var T=h.C,A=v.indexOf(`
`,T);return A==-1?$t:(T=Number(v.substring(T,A)),isNaN(T)?Ot:(A+=1,A+T>v.length?$t:(v=v.slice(A,A+T),h.C=A+T,v)))}fi.prototype.cancel=function(){this.K=!0,jn(this)};function Li(h){h.T=Date.now()+h.H,vo(h,h.H)}function vo(h,v){if(h.D!=null)throw Error("WatchDog timer not null");h.D=Mi(y(h.aa,h),v)}function Ui(h){h.D&&(u.clearTimeout(h.D),h.D=null)}fi.prototype.aa=function(){this.D=null;const h=Date.now();h-this.T>=0?(ua(this.i,this.B),this.M!=2&&(ht(),mt(17)),jn(this),this.m=2,$n(this)):vo(this,this.T-h)};function $n(h){h.j.I==0||h.K||xh(h.j,h)}function jn(h){Ui(h);var v=h.O;v&&typeof v.dispose=="function"&&v.dispose(),h.O=null,la(h.V),h.g&&(v=h.g,h.g=null,v.abort(),v.dispose())}function zi(h,v){try{var T=h.j;if(T.I!=0&&(T.g==h||Fi(T.h,h))){if(!h.L&&Fi(T.h,h)&&T.I==3){try{var A=T.Ba.g.parse(v)}catch{A=null}if(Array.isArray(A)&&A.length==3){var Q=A;if(Q[0]==0){e:if(!T.v){if(T.g)if(T.g.F+3e3<h.F)Ao(T),lr(T);else break e;ba(T),mt(18)}}else T.xa=Q[1],0<T.xa-T.K&&Q[2]<37500&&T.F&&T.A==0&&!T.C&&(T.C=Mi(y(T.Va,T),6e3));Bi(T.h)<=1&&T.ta&&(T.ta=void 0)}else $i(T,11)}else if((h.L||T.g==h)&&Ao(T),!O(v))for(Q=T.Ba.g.parse(v),v=0;v<Q.length;v++){let Xe=Q[v];const _t=Xe[0];if(!(_t<=T.K))if(T.K=_t,Xe=Xe[1],T.I==2)if(Xe[0]=="c"){T.M=Xe[1],T.ba=Xe[2];const Xn=Xe[3];Xn!=null&&(T.ka=Xn,T.j.info("VER="+T.ka));const Wi=Xe[4];Wi!=null&&(T.za=Wi,T.j.info("SVER="+T.za));const vi=Xe[5];vi!=null&&typeof vi=="number"&&vi>0&&(A=1.5*vi,T.O=A,T.j.info("backChannelRequestTimeoutMs_="+A)),A=T;const _i=h.g;if(_i){const Ea=_i.g?_i.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(Ea){var X=A.h;X.g||Ea.indexOf("spdy")==-1&&Ea.indexOf("quic")==-1&&Ea.indexOf("h2")==-1||(X.j=X.l,X.g=new Set,X.h&&(ic(X,X.h),X.h=null))}if(A.G){const Io=_i.g?_i.g.getResponseHeader("X-HTTP-Session-Id"):null;Io&&(A.wa=Io,et(A.J,A.G,Io))}}T.I=3,T.l&&T.l.ra(),T.aa&&(T.T=Date.now()-h.F,T.j.info("Handshake RTT: "+T.T+"ms")),A=T;var fe=h;if(A.na=Ah(A,A.L?A.ba:null,A.W),fe.L){sc(A.h,fe);var ke=fe,Ct=A.O;Ct&&(ke.H=Ct),ke.D&&(Ui(ke),Li(ke)),A.g=fe}else Eh(A);T.i.length>0&&Ki(T)}else Xe[0]!="stop"&&Xe[0]!="close"||$i(T,7);else T.I==3&&(Xe[0]=="stop"||Xe[0]=="close"?Xe[0]=="stop"?$i(T,7):fc(T):Xe[0]!="noop"&&T.l&&T.l.qa(Xe),T.A=0)}}ht(4)}catch{}}var Mt=class{constructor(h,v){this.g=h,this.map=v}};function tc(h){this.l=h||10,u.PerformanceNavigationTiming?(h=u.performance.getEntriesByType("navigation"),h=h.length>0&&(h[0].nextHopProtocol=="hq"||h[0].nextHopProtocol=="h2")):h=!!(u.chrome&&u.chrome.loadTimes&&u.chrome.loadTimes()&&u.chrome.loadTimes().wasFetchedViaSpdy),this.j=h?this.l:1,this.g=null,this.j>1&&(this.g=new Set),this.h=null,this.i=[]}function nc(h){return h.h?!0:h.g?h.g.size>=h.j:!1}function Bi(h){return h.h?1:h.g?h.g.size:0}function Fi(h,v){return h.h?h.h==v:h.g?h.g.has(v):!1}function ic(h,v){h.g?h.g.add(v):h.h=v}function sc(h,v){h.h&&h.h==v?h.h=null:h.g&&h.g.has(v)&&h.g.delete(v)}tc.prototype.cancel=function(){if(this.i=rc(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const h of this.g.values())h.cancel();this.g.clear()}};function rc(h){if(h.h!=null)return h.i.concat(h.h.G);if(h.g!=null&&h.g.size!==0){let v=h.i;for(const T of h.g.values())v=v.concat(T.G);return v}return k(h.i)}var ph=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function _o(h,v){if(h){h=h.split("&");for(let T=0;T<h.length;T++){const A=h[T].indexOf("=");let Q,X=null;A>=0?(Q=h[T].substring(0,A),X=h[T].substring(A+1)):Q=h[T],v(Q,X?decodeURIComponent(X.replace(/\+/g," ")):"")}}}function kn(h){this.g=this.o=this.j="",this.u=null,this.m=this.h="",this.l=!1;let v;h instanceof kn?(this.l=h.l,Wt(this,h.j),this.o=h.o,this.g=h.g,tr(this,h.u),this.h=h.h,ac(this,_h(h.i)),this.m=h.m):h&&(v=String(h).match(ph))?(this.l=!1,Wt(this,v[1]||"",!0),this.o=qi(v[2]||""),this.g=qi(v[3]||"",!0),tr(this,v[4]),this.h=qi(v[5]||"",!0),ac(this,v[6]||"",!0),this.m=qi(v[7]||"")):(this.l=!1,this.i=new ir(null,this.l))}kn.prototype.toString=function(){const h=[];var v=this.j;v&&h.push(ma(v,bo,!0),":");var T=this.g;return(T||v=="file")&&(h.push("//"),(v=this.o)&&h.push(ma(v,bo,!0),"@"),h.push(_s(T).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),T=this.u,T!=null&&h.push(":",String(T))),(T=this.h)&&(this.g&&T.charAt(0)!="/"&&h.push("/"),h.push(ma(T,T.charAt(0)=="/"?oc:gh,!0))),(T=this.i.toString())&&h.push("?",T),(T=this.m)&&h.push("#",ma(T,yh)),h.join("")},kn.prototype.resolve=function(h){const v=Vt(this);let T=!!h.j;T?Wt(v,h.j):T=!!h.o,T?v.o=h.o:T=!!h.g,T?v.g=h.g:T=h.u!=null;var A=h.h;if(T)tr(v,h.u);else if(T=!!h.h){if(A.charAt(0)!="/")if(this.g&&!this.h)A="/"+A;else{var Q=v.h.lastIndexOf("/");Q!=-1&&(A=v.h.slice(0,Q+1)+A)}if(Q=A,Q==".."||Q==".")A="";else if(Q.indexOf("./")!=-1||Q.indexOf("/.")!=-1){A=Q.lastIndexOf("/",0)==0,Q=Q.split("/");const X=[];for(let fe=0;fe<Q.length;){const ke=Q[fe++];ke=="."?A&&fe==Q.length&&X.push(""):ke==".."?((X.length>1||X.length==1&&X[0]!="")&&X.pop(),A&&fe==Q.length&&X.push("")):(X.push(ke),A=!0)}A=X.join("/")}else A=Q}return T?v.h=A:T=h.i.toString()!=="",T?ac(v,_h(h.i)):T=!!h.m,T&&(v.m=h.m),v};function Vt(h){return new kn(h)}function Wt(h,v,T){h.j=T?qi(v,!0):v,h.j&&(h.j=h.j.replace(/:$/,""))}function tr(h,v){if(v){if(v=Number(v),isNaN(v)||v<0)throw Error("Bad port number "+v);h.u=v}else h.u=null}function ac(h,v,T){v instanceof ir?(h.i=v,To(h.i,h.l)):(T||(v=ma(v,nr)),h.i=new ir(v,h.l))}function et(h,v,T){h.i.set(v,T)}function fa(h){return et(h,"zx",Math.floor(Math.random()*2147483648).toString(36)+Math.abs(Math.floor(Math.random()*2147483648)^Date.now()).toString(36)),h}function qi(h,v){return h?v?decodeURI(h.replace(/%25/g,"%2525")):decodeURIComponent(h):""}function ma(h,v,T){return typeof h=="string"?(h=encodeURI(h).replace(v,bn),T&&(h=h.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),h):null}function bn(h){return h=h.charCodeAt(0),"%"+(h>>4&15).toString(16)+(h&15).toString(16)}var bo=/[#\/\?@]/g,gh=/[#\?:]/g,oc=/[#\?]/g,nr=/[#\?@]/g,yh=/#/g;function ir(h,v){this.h=this.g=null,this.i=h||null,this.j=!!v}function En(h){h.g||(h.g=new Map,h.h=0,h.i&&_o(h.i,function(v,T){h.add(decodeURIComponent(v.replace(/\+/g," ")),T)}))}s=ir.prototype,s.add=function(h,v){En(this),this.i=null,h=sr(this,h);let T=this.g.get(h);return T||this.g.set(h,T=[]),T.push(v),this.h+=1,this};function vh(h,v){En(h),v=sr(h,v),h.g.has(v)&&(h.i=null,h.h-=h.g.get(v).length,h.g.delete(v))}function lc(h,v){return En(h),v=sr(h,v),h.g.has(v)}s.forEach=function(h,v){En(this),this.g.forEach(function(T,A){T.forEach(function(Q){h.call(v,Q,A,this)},this)},this)};function cc(h,v){En(h);let T=[];if(typeof v=="string")lc(h,v)&&(T=T.concat(h.g.get(sr(h,v))));else for(h=Array.from(h.g.values()),v=0;v<h.length;v++)T=T.concat(h[v]);return T}s.set=function(h,v){return En(this),this.i=null,h=sr(this,h),lc(this,h)&&(this.h-=this.g.get(h).length),this.g.set(h,[v]),this.h+=1,this},s.get=function(h,v){return h?(h=cc(this,h),h.length>0?String(h[0]):v):v};function Eo(h,v,T){vh(h,v),T.length>0&&(h.i=null,h.g.set(sr(h,v),k(T)),h.h+=T.length)}s.toString=function(){if(this.i)return this.i;if(!this.g)return"";const h=[],v=Array.from(this.g.keys());for(let A=0;A<v.length;A++){var T=v[A];const Q=_s(T);T=cc(this,T);for(let X=0;X<T.length;X++){let fe=Q;T[X]!==""&&(fe+="="+_s(T[X])),h.push(fe)}}return this.i=h.join("&")};function _h(h){const v=new ir;return v.i=h.i,h.g&&(v.g=new Map(h.g),v.h=h.h),v}function sr(h,v){return v=String(v),h.j&&(v=v.toLowerCase()),v}function To(h,v){v&&!h.j&&(En(h),h.i=null,h.g.forEach(function(T,A){const Q=A.toLowerCase();A!=Q&&(vh(this,A),Eo(this,Q,T))},h)),h.j=v}function pi(h,v){const T=new di;if(u.Image){const A=new Image;A.onload=_(Wn,T,"TestLoadImage: loaded",!0,v,A),A.onerror=_(Wn,T,"TestLoadImage: error",!1,v,A),A.onabort=_(Wn,T,"TestLoadImage: abort",!1,v,A),A.ontimeout=_(Wn,T,"TestLoadImage: timeout",!1,v,A),u.setTimeout(function(){A.ontimeout&&A.ontimeout()},1e4),A.src=h}else v(!1)}function uc(h,v){const T=new di,A=new AbortController,Q=setTimeout(()=>{A.abort(),Wn(T,"TestPingServer: timeout",!1,v)},1e4);fetch(h,{signal:A.signal}).then(X=>{clearTimeout(Q),X.ok?Wn(T,"TestPingServer: ok",!0,v):Wn(T,"TestPingServer: server error",!1,v)}).catch(()=>{clearTimeout(Q),Wn(T,"TestPingServer: error",!1,v)})}function Wn(h,v,T,A,Q){try{Q&&(Q.onload=null,Q.onerror=null,Q.onabort=null,Q.ontimeout=null),A(T)}catch{}}function rr(){this.g=new po}function Hi(h){this.i=h.Sb||null,this.h=h.ab||!1}b(Hi,ca),Hi.prototype.g=function(){return new pa(this.i,this.h)};function pa(h,v){He.call(this),this.H=h,this.o=v,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.A=new Headers,this.h=null,this.F="GET",this.D="",this.g=!1,this.B=this.j=this.l=null,this.v=new AbortController}b(pa,He),s=pa.prototype,s.open=function(h,v){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.F=h,this.D=v,this.readyState=1,gi(this)},s.send=function(h){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");if(this.v.signal.aborted)throw this.abort(),Error("Request was aborted.");this.g=!0;const v={headers:this.A,method:this.F,credentials:this.m,cache:void 0,signal:this.v.signal};h&&(v.body=h),(this.H||u).fetch(new Request(this.D,v)).then(this.Pa.bind(this),this.ga.bind(this))},s.abort=function(){this.response=this.responseText="",this.A=new Headers,this.status=0,this.v.abort(),this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),this.readyState>=1&&this.g&&this.readyState!=4&&(this.g=!1,ar(this)),this.readyState=0},s.Pa=function(h){if(this.g&&(this.l=h,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=h.headers,this.readyState=2,gi(this)),this.g&&(this.readyState=3,gi(this),this.g)))if(this.responseType==="arraybuffer")h.arrayBuffer().then(this.Na.bind(this),this.ga.bind(this));else if(typeof u.ReadableStream<"u"&&"body"in h){if(this.j=h.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.B=new TextDecoder;xo(this)}else h.text().then(this.Oa.bind(this),this.ga.bind(this))};function xo(h){h.j.read().then(h.Ma.bind(h)).catch(h.ga.bind(h))}s.Ma=function(h){if(this.g){if(this.o&&h.value)this.response.push(h.value);else if(!this.o){var v=h.value?h.value:new Uint8Array(0);(v=this.B.decode(v,{stream:!h.done}))&&(this.response=this.responseText+=v)}h.done?ar(this):gi(this),this.readyState==3&&xo(this)}},s.Oa=function(h){this.g&&(this.response=this.responseText=h,ar(this))},s.Na=function(h){this.g&&(this.response=h,ar(this))},s.ga=function(){this.g&&ar(this)};function ar(h){h.readyState=4,h.l=null,h.j=null,h.B=null,gi(h)}s.setRequestHeader=function(h,v){this.A.append(h,v)},s.getResponseHeader=function(h){return this.h&&this.h.get(h.toLowerCase())||""},s.getAllResponseHeaders=function(){if(!this.h)return"";const h=[],v=this.h.entries();for(var T=v.next();!T.done;)T=T.value,h.push(T[0]+": "+T[1]),T=v.next();return h.join(`\r
`)};function gi(h){h.onreadystatechange&&h.onreadystatechange.call(h)}Object.defineProperty(pa.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(h){this.m=h?"include":"same-origin"}});function Yn(h){let v="";return Te(h,function(T,A){v+=A,v+=":",v+=T,v+=`\r
`}),v}function ga(h,v,T){e:{for(A in T){var A=!1;break e}A=!0}A||(T=Yn(T),typeof h=="string"?T!=null&&_s(T):et(h,v,T))}function at(h){He.call(this),this.headers=new Map,this.L=h||null,this.h=!1,this.g=null,this.D="",this.o=0,this.l="",this.j=this.B=this.v=this.A=!1,this.m=null,this.F="",this.H=!1}b(at,He);var Gi=/^https?$/i,hc=["POST","PUT"];s=at.prototype,s.Fa=function(h){this.H=h},s.ea=function(h,v,T,A){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+h);v=v?v.toUpperCase():"GET",this.D=h,this.l="",this.o=0,this.A=!1,this.h=!0,this.g=this.L?this.L.g():ec.g(),this.g.onreadystatechange=x(y(this.Ca,this));try{this.B=!0,this.g.open(v,String(h),!0),this.B=!1}catch(X){ya(this,X);return}if(h=T||"",T=new Map(this.headers),A)if(Object.getPrototypeOf(A)===Object.prototype)for(var Q in A)T.set(Q,A[Q]);else if(typeof A.keys=="function"&&typeof A.get=="function")for(const X of A.keys())T.set(X,A.get(X));else throw Error("Unknown input type for opt_headers: "+String(A));A=Array.from(T.keys()).find(X=>X.toLowerCase()=="content-type"),Q=u.FormData&&h instanceof u.FormData,!(Array.prototype.indexOf.call(hc,v,void 0)>=0)||A||Q||T.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[X,fe]of T)this.g.setRequestHeader(X,fe);this.F&&(this.g.responseType=this.F),"withCredentials"in this.g&&this.g.withCredentials!==this.H&&(this.g.withCredentials=this.H);try{this.m&&(clearTimeout(this.m),this.m=null),this.v=!0,this.g.send(h),this.v=!1}catch(X){ya(this,X)}};function ya(h,v){h.h=!1,h.g&&(h.j=!0,h.g.abort(),h.j=!1),h.l=v,h.o=5,dc(h),bs(h)}function dc(h){h.A||(h.A=!0,ft(h,"complete"),ft(h,"error"))}s.abort=function(h){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.o=h||7,ft(this,"complete"),ft(this,"abort"),bs(this))},s.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),bs(this,!0)),at.Z.N.call(this)},s.Ca=function(){this.u||(this.B||this.v||this.j?va(this):this.Xa())},s.Xa=function(){va(this)};function va(h){if(h.h&&typeof l<"u"){if(h.v&&yi(h)==4)setTimeout(h.Ca.bind(h),0);else if(ft(h,"readystatechange"),yi(h)==4){h.h=!1;try{const X=h.ca();e:switch(X){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var v=!0;break e;default:v=!1}var T;if(!(T=v)){var A;if(A=X===0){let fe=String(h.D).match(ph)[1]||null;!fe&&u.self&&u.self.location&&(fe=u.self.location.protocol.slice(0,-1)),A=!Gi.test(fe?fe.toLowerCase():"")}T=A}if(T)ft(h,"complete"),ft(h,"success");else{h.o=6;try{var Q=yi(h)>2?h.g.statusText:""}catch{Q=""}h.l=Q+" ["+h.ca()+"]",dc(h)}}finally{bs(h)}}}}function bs(h,v){if(h.g){h.m&&(clearTimeout(h.m),h.m=null);const T=h.g;h.g=null,v||ft(h,"ready");try{T.onreadystatechange=null}catch{}}}s.isActive=function(){return!!this.g};function yi(h){return h.g?h.g.readyState:0}s.ca=function(){try{return yi(this)>2?this.g.status:-1}catch{return-1}},s.la=function(){try{return this.g?this.g.responseText:""}catch{return""}},s.La=function(h){if(this.g){var v=this.g.responseText;return h&&v.indexOf(h)==0&&(v=v.substring(h.length)),mo(v)}};function Zt(h){try{if(!h.g)return null;if("response"in h.g)return h.g.response;switch(h.F){case"":case"text":return h.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in h.g)return h.g.mozResponseArrayBuffer}return null}catch{return null}}function Es(h){const v={};h=(h.g&&yi(h)>=2&&h.g.getAllResponseHeaders()||"").split(`\r
`);for(let A=0;A<h.length;A++){if(O(h[A]))continue;var T=dh(h[A]);const Q=T[0];if(T=T[1],typeof T!="string")continue;T=T.trim();const X=v[Q]||[];v[Q]=X,X.push(T)}Ve(v,function(A){return A.join(", ")})}s.ya=function(){return this.o},s.Ha=function(){return typeof this.l=="string"?this.l:String(this.l)};function Qi(h,v,T){return T&&T.internalChannelParams&&T.internalChannelParams[h]||v}function or(h){this.za=0,this.i=[],this.j=new di,this.ba=this.na=this.J=this.W=this.g=this.wa=this.G=this.H=this.u=this.U=this.o=null,this.Ya=this.V=0,this.Sa=Qi("failFast",!1,h),this.F=this.C=this.v=this.m=this.l=null,this.X=!0,this.xa=this.K=-1,this.Y=this.A=this.D=0,this.Qa=Qi("baseRetryDelayMs",5e3,h),this.Za=Qi("retryDelaySeedMs",1e4,h),this.Ta=Qi("forwardChannelMaxRetries",2,h),this.va=Qi("forwardChannelRequestTimeoutMs",2e4,h),this.ma=h&&h.xmlHttpFactory||void 0,this.Ua=h&&h.Rb||void 0,this.Aa=h&&h.useFetchStreams||!1,this.O=void 0,this.L=h&&h.supportsCrossDomainXhr||!1,this.M="",this.h=new tc(h&&h.concurrentRequestLimit),this.Ba=new rr,this.S=h&&h.fastHandshake||!1,this.R=h&&h.encodeInitMessageHeaders||!1,this.S&&this.R&&(this.R=!1),this.Ra=h&&h.Pb||!1,h&&h.ua&&this.j.ua(),h&&h.forceLongPolling&&(this.X=!1),this.aa=!this.S&&this.X&&h&&h.detectBufferingProxy||!1,this.ia=void 0,h&&h.longPollingTimeout&&h.longPollingTimeout>0&&(this.ia=h.longPollingTimeout),this.ta=void 0,this.T=0,this.P=!1,this.ja=this.B=null}s=or.prototype,s.ka=8,s.I=1,s.connect=function(h,v,T,A){mt(0),this.W=h,this.H=v||{},T&&A!==void 0&&(this.H.OSID=T,this.H.OAID=A),this.F=this.X,this.J=Ah(this,null,this.W),Ki(this)};function fc(h){if(So(h),h.I==3){var v=h.V++,T=Vt(h.J);if(et(T,"SID",h.M),et(T,"RID",v),et(T,"TYPE","terminate"),_a(h,T),v=new fi(h,h.j,v),v.M=2,v.A=fa(Vt(T)),T=!1,u.navigator&&u.navigator.sendBeacon)try{T=u.navigator.sendBeacon(v.A.toString(),"")}catch{}!T&&u.Image&&(new Image().src=v.A,T=!0),T||(v.g=Ih(v.j,null),v.g.ea(v.A)),v.F=Date.now(),Li(v)}wh(h)}function lr(h){h.g&&(pc(h),h.g.cancel(),h.g=null)}function So(h){lr(h),h.v&&(u.clearTimeout(h.v),h.v=null),Ao(h),h.h.cancel(),h.m&&(typeof h.m=="number"&&u.clearTimeout(h.m),h.m=null)}function Ki(h){if(!nc(h.h)&&!h.m){h.m=!0;var v=h.Ea;F||R(),J||(F(),J=!0),C.add(v,h),h.D=0}}function wo(h,v){return Bi(h.h)>=h.h.j-(h.m?1:0)?!1:h.m?(h.i=v.G.concat(h.i),!0):h.I==1||h.I==2||h.D>=(h.Sa?0:h.Ta)?!1:(h.m=Mi(y(h.Ea,h,v),Sh(h,h.D)),h.D++,!0)}s.Ea=function(h){if(this.m)if(this.m=null,this.I==1){if(!h){this.V=Math.floor(Math.random()*1e5),h=this.V++;const Q=new fi(this,this.j,h);let X=this.o;if(this.U&&(X?(X=U(X),ue(X,this.U)):X=this.U),this.u!==null||this.R||(Q.J=X,X=null),this.S)e:{for(var v=0,T=0;T<this.i.length;T++){t:{var A=this.i[T];if("__data__"in A.map&&(A=A.map.__data__,typeof A=="string")){A=A.length;break t}A=void 0}if(A===void 0)break;if(v+=A,v>4096){v=T;break e}if(v===4096||T===this.i.length-1){v=T+1;break e}}v=1e3}else v=1e3;v=bh(this,Q,v),T=Vt(this.J),et(T,"RID",h),et(T,"CVER",22),this.G&&et(T,"X-HTTP-Session-Id",this.G),_a(this,T),X&&(this.R?v="headers="+_s(Yn(X))+"&"+v:this.u&&ga(T,this.u,X)),ic(this.h,Q),this.Ra&&et(T,"TYPE","init"),this.S?(et(T,"$req",v),et(T,"SID","null"),Q.U=!0,Pi(Q,T,null)):Pi(Q,T,v),this.I=2}}else this.I==3&&(h?mc(this,h):this.i.length==0||nc(this.h)||mc(this))};function mc(h,v){var T;v?T=v.l:T=h.V++;const A=Vt(h.J);et(A,"SID",h.M),et(A,"RID",T),et(A,"AID",h.K),_a(h,A),h.u&&h.o&&ga(A,h.u,h.o),T=new fi(h,h.j,T,h.D+1),h.u===null&&(T.J=h.o),v&&(h.i=v.G.concat(h.i)),v=bh(h,T,1e3),T.H=Math.round(h.va*.5)+Math.round(h.va*.5*Math.random()),ic(h.h,T),Pi(T,A,v)}function _a(h,v){h.H&&Te(h.H,function(T,A){et(v,A,T)}),h.l&&Te({},function(T,A){et(v,A,T)})}function bh(h,v,T){T=Math.min(h.i.length,T);const A=h.l?y(h.l.Ka,h.l,h):null;e:{var Q=h.i;let ke=-1;for(;;){const Ct=["count="+T];ke==-1?T>0?(ke=Q[0].g,Ct.push("ofs="+ke)):ke=0:Ct.push("ofs="+ke);let Xe=!0;for(let _t=0;_t<T;_t++){var X=Q[_t].g;const Xn=Q[_t].map;if(X-=ke,X<0)ke=Math.max(0,Q[_t].g-100),Xe=!1;else try{X="req"+X+"_"||"";try{var fe=Xn instanceof Map?Xn:Object.entries(Xn);for(const[Wi,vi]of fe){let _i=vi;f(vi)&&(_i=ki(vi)),Ct.push(X+Wi+"="+encodeURIComponent(_i))}}catch(Wi){throw Ct.push(X+"type="+encodeURIComponent("_badmap")),Wi}}catch{A&&A(Xn)}}if(Xe){fe=Ct.join("&");break e}}fe=void 0}return h=h.i.splice(0,T),v.G=h,fe}function Eh(h){if(!h.g&&!h.v){h.Y=1;var v=h.Da;F||R(),J||(F(),J=!0),C.add(v,h),h.A=0}}function ba(h){return h.g||h.v||h.A>=3?!1:(h.Y++,h.v=Mi(y(h.Da,h),Sh(h,h.A)),h.A++,!0)}s.Da=function(){if(this.v=null,Th(this),this.aa&&!(this.P||this.g==null||this.T<=0)){var h=4*this.T;this.j.info("BP detection timer enabled: "+h),this.B=Mi(y(this.Wa,this),h)}},s.Wa=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.P=!0,mt(10),lr(this),Th(this))};function pc(h){h.B!=null&&(u.clearTimeout(h.B),h.B=null)}function Th(h){h.g=new fi(h,h.j,"rpc",h.Y),h.u===null&&(h.g.J=h.o),h.g.P=0;var v=Vt(h.na);et(v,"RID","rpc"),et(v,"SID",h.M),et(v,"AID",h.K),et(v,"CI",h.F?"0":"1"),!h.F&&h.ia&&et(v,"TO",h.ia),et(v,"TYPE","xmlhttp"),_a(h,v),h.u&&h.o&&ga(v,h.u,h.o),h.O&&(h.g.H=h.O);var T=h.g;h=h.ba,T.M=1,T.A=fa(Vt(v)),T.u=null,T.R=!0,yo(T,h)}s.Va=function(){this.C!=null&&(this.C=null,lr(this),ba(this),mt(19))};function Ao(h){h.C!=null&&(u.clearTimeout(h.C),h.C=null)}function xh(h,v){var T=null;if(h.g==v){Ao(h),pc(h),h.g=null;var A=2}else if(Fi(h.h,v))T=v.G,sc(h.h,v),A=1;else return;if(h.I!=0){if(v.o)if(A==1){T=v.u?v.u.length:0,v=Date.now()-v.F;var Q=h.D;A=Nn(),ft(A,new Oi(A,T)),Ki(h)}else Eh(h);else if(Q=v.m,Q==3||Q==0&&v.X>0||!(A==1&&wo(h,v)||A==2&&ba(h)))switch(T&&T.length>0&&(v=h.h,v.i=v.i.concat(T)),Q){case 1:$i(h,5);break;case 4:$i(h,10);break;case 3:$i(h,6);break;default:$i(h,2)}}}function Sh(h,v){let T=h.Qa+Math.floor(Math.random()*h.Za);return h.isActive()||(T*=2),T*v}function $i(h,v){if(h.j.info("Error code "+v),v==2){var T=y(h.bb,h),A=h.Ua;const Q=!A;A=new kn(A||"//www.google.com/images/cleardot.gif"),u.location&&u.location.protocol=="http"||Wt(A,"https"),fa(A),Q?pi(A.toString(),T):uc(A.toString(),T)}else mt(2);h.I=0,h.l&&h.l.pa(v),wh(h),So(h)}s.bb=function(h){h?(this.j.info("Successfully pinged google.com"),mt(2)):(this.j.info("Failed to ping google.com"),mt(1))};function wh(h){if(h.I=0,h.ja=[],h.l){const v=rc(h.h);(v.length!=0||h.i.length!=0)&&(M(h.ja,v),M(h.ja,h.i),h.h.i.length=0,k(h.i),h.i.length=0),h.l.oa()}}function Ah(h,v,T){var A=T instanceof kn?Vt(T):new kn(T);if(A.g!="")v&&(A.g=v+"."+A.g),tr(A,A.u);else{var Q=u.location;A=Q.protocol,v=v?v+"."+Q.hostname:Q.hostname,Q=+Q.port;const X=new kn(null);A&&Wt(X,A),v&&(X.g=v),Q&&tr(X,Q),T&&(X.h=T),A=X}return T=h.G,v=h.wa,T&&v&&et(A,T,v),et(A,"VER",h.ka),_a(h,A),A}function Ih(h,v,T){if(v&&!h.L)throw Error("Can't create secondary domain capable XhrIo object.");return v=h.Aa&&!h.ma?new at(new Hi({ab:T})):new at(h.ma),v.Fa(h.L),v}s.isActive=function(){return!!this.l&&this.l.isActive(this)};function Ch(){}s=Ch.prototype,s.ra=function(){},s.qa=function(){},s.pa=function(){},s.oa=function(){},s.isActive=function(){return!0},s.Ka=function(){};function cr(){}cr.prototype.g=function(h,v){return new pn(h,v)};function pn(h,v){He.call(this),this.g=new or(v),this.l=h,this.h=v&&v.messageUrlParams||null,h=v&&v.messageHeaders||null,v&&v.clientProtocolHeaderRequired&&(h?h["X-Client-Protocol"]="webchannel":h={"X-Client-Protocol":"webchannel"}),this.g.o=h,h=v&&v.initMessageHeaders||null,v&&v.messageContentType&&(h?h["X-WebChannel-Content-Type"]=v.messageContentType:h={"X-WebChannel-Content-Type":v.messageContentType}),v&&v.sa&&(h?h["X-WebChannel-Client-Profile"]=v.sa:h={"X-WebChannel-Client-Profile":v.sa}),this.g.U=h,(h=v&&v.Qb)&&!O(h)&&(this.g.u=h),this.A=v&&v.supportsCrossDomainXhr||!1,this.v=v&&v.sendRawJson||!1,(v=v&&v.httpSessionIdParam)&&!O(v)&&(this.g.G=v,h=this.h,h!==null&&v in h&&(h=this.h,v in h&&delete h[v])),this.j=new Ts(this)}b(pn,He),pn.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.L=!0),this.g.connect(this.l,this.h||void 0)},pn.prototype.close=function(){fc(this.g)},pn.prototype.o=function(h){var v=this.g;if(typeof h=="string"){var T={};T.__data__=h,h=T}else this.v&&(T={},T.__data__=ki(h),h=T);v.i.push(new Mt(v.Ya++,h)),v.I==3&&Ki(v)},pn.prototype.N=function(){this.g.l=null,delete this.j,fc(this.g),delete this.g,pn.Z.N.call(this)};function Rh(h){qt.call(this),h.__headers__&&(this.headers=h.__headers__,this.statusCode=h.__status__,delete h.__headers__,delete h.__status__);var v=h.__sm__;if(v){e:{for(const T in v){h=T;break e}h=void 0}(this.i=h)&&(h=this.i,v=v!==null&&h in v?v[h]:void 0),this.data=v}else this.data=h}b(Rh,qt);function Dh(){_n.call(this),this.status=1}b(Dh,_n);function Ts(h){this.g=h}b(Ts,Ch),Ts.prototype.ra=function(){ft(this.g,"a")},Ts.prototype.qa=function(h){ft(this.g,new Rh(h))},Ts.prototype.pa=function(h){ft(this.g,new Dh)},Ts.prototype.oa=function(){ft(this.g,"b")},cr.prototype.createWebChannel=cr.prototype.g,pn.prototype.send=pn.prototype.o,pn.prototype.open=pn.prototype.m,pn.prototype.close=pn.prototype.close,pS=function(){return new cr},mS=function(){return Nn()},fS=de,ly={jb:0,mb:1,nb:2,Hb:3,Mb:4,Jb:5,Kb:6,Ib:7,Gb:8,Lb:9,PROXY:10,NOPROXY:11,Eb:12,Ab:13,Bb:14,zb:15,Cb:16,Db:17,fb:18,eb:19,gb:20},ha.NO_ERROR=0,ha.TIMEOUT=8,ha.HTTP_ERROR=6,nf=ha,Zl.COMPLETE="complete",dS=Zl,go.EventType=Dn,Dn.OPEN="a",Dn.CLOSE="b",Dn.ERROR="c",Dn.MESSAGE="d",He.prototype.listen=He.prototype.J,cu=go,at.prototype.listenOnce=at.prototype.K,at.prototype.getLastError=at.prototype.Ha,at.prototype.getLastErrorCode=at.prototype.ya,at.prototype.getStatus=at.prototype.ca,at.prototype.getResponseJson=at.prototype.La,at.prototype.getResponseText=at.prototype.la,at.prototype.send=at.prototype.ea,at.prototype.setWithCredentials=at.prototype.Fa,hS=at}).apply(typeof Pd<"u"?Pd:typeof self<"u"?self:typeof window<"u"?window:{});class un{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}un.UNAUTHENTICATED=new un(null),un.GOOGLE_CREDENTIALS=new un("google-credentials-uid"),un.FIRST_PARTY=new un("first-party-uid"),un.MOCK_USER=new un("mock-user");let Kl="12.9.0";function Ik(s){Kl=s}const eo=new Fy("@firebase/firestore");function ul(){return eo.logLevel}function ce(s,...e){if(eo.logLevel<=Fe.DEBUG){const t=e.map(Jy);eo.debug(`Firestore (${Kl}): ${s}`,...t)}}function Nt(s,...e){if(eo.logLevel<=Fe.ERROR){const t=e.map(Jy);eo.error(`Firestore (${Kl}): ${s}`,...t)}}function xl(s,...e){if(eo.logLevel<=Fe.WARN){const t=e.map(Jy);eo.warn(`Firestore (${Kl}): ${s}`,...t)}}function Jy(s){if(typeof s=="string")return s;try{return(function(t){return JSON.stringify(t)})(s)}catch{return s}}function ve(s,e,t){let i="Unexpected state";typeof e=="string"?i=e:t=e,gS(s,i,t)}function gS(s,e,t){let i=`FIRESTORE (${Kl}) INTERNAL ASSERTION FAILED: ${e} (ID: ${s.toString(16)})`;if(t!==void 0)try{i+=" CONTEXT: "+JSON.stringify(t)}catch{i+=" CONTEXT: "+t}throw Nt(i),new Error(i)}function xe(s,e,t,i){let a="Unexpected state";typeof t=="string"?a=t:i=t,s||gS(e,a,i)}function be(s,e){return s}const te={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class he extends ds{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}class ls{constructor(){this.promise=new Promise(((e,t)=>{this.resolve=e,this.reject=t}))}}class Ck{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class Rk{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable((()=>t(un.UNAUTHENTICATED)))}shutdown(){}}class Dk{constructor(e){this.t=e,this.currentUser=un.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){xe(this.o===void 0,42304);let i=this.i;const a=p=>this.i!==i?(i=this.i,t(p)):Promise.resolve();let l=new ls;this.o=()=>{this.i++,this.currentUser=this.u(),l.resolve(),l=new ls,e.enqueueRetryable((()=>a(this.currentUser)))};const u=()=>{const p=l;e.enqueueRetryable((async()=>{await p.promise,await a(this.currentUser)}))},f=p=>{ce("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=p,this.o&&(this.auth.addAuthTokenListener(this.o),u())};this.t.onInit((p=>f(p))),setTimeout((()=>{if(!this.auth){const p=this.t.getImmediate({optional:!0});p?f(p):(ce("FirebaseAuthCredentialsProvider","Auth not yet detected"),l.resolve(),l=new ls)}}),0),u()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then((i=>this.i!==e?(ce("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):i?(xe(typeof i.accessToken=="string",31837,{l:i}),new Ck(i.accessToken,this.currentUser)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return xe(e===null||typeof e=="string",2055,{h:e}),new un(e)}}class Nk{constructor(e,t,i){this.P=e,this.T=t,this.I=i,this.type="FirstParty",this.user=un.FIRST_PARTY,this.R=new Map}A(){return this.I?this.I():null}get headers(){this.R.set("X-Goog-AuthUser",this.P);const e=this.A();return e&&this.R.set("Authorization",e),this.T&&this.R.set("X-Goog-Iam-Authorization-Token",this.T),this.R}}class jk{constructor(e,t,i){this.P=e,this.T=t,this.I=i}getToken(){return Promise.resolve(new Nk(this.P,this.T,this.I))}start(e,t){e.enqueueRetryable((()=>t(un.FIRST_PARTY)))}shutdown(){}invalidateToken(){}}class gT{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class kk{constructor(e,t){this.V=t,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,Fn(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,t){xe(this.o===void 0,3512);const i=l=>{l.error!=null&&ce("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${l.error.message}`);const u=l.token!==this.m;return this.m=l.token,ce("FirebaseAppCheckTokenProvider",`Received ${u?"new":"existing"} token.`),u?t(l.token):Promise.resolve()};this.o=l=>{e.enqueueRetryable((()=>i(l)))};const a=l=>{ce("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=l,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit((l=>a(l))),setTimeout((()=>{if(!this.appCheck){const l=this.V.getImmediate({optional:!0});l?a(l):ce("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}}),0)}getToken(){if(this.p)return Promise.resolve(new gT(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then((t=>t?(xe(typeof t.token=="string",44558,{tokenResult:t}),this.m=t.token,new gT(t.token)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}function Ok(s){const e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(s);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let i=0;i<s;i++)t[i]=Math.floor(256*Math.random());return t}class Zy{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=62*Math.floor(4.129032258064516);let i="";for(;i.length<20;){const a=Ok(40);for(let l=0;l<a.length;++l)i.length<20&&a[l]<t&&(i+=e.charAt(a[l]%62))}return i}}function De(s,e){return s<e?-1:s>e?1:0}function cy(s,e){const t=Math.min(s.length,e.length);for(let i=0;i<t;i++){const a=s.charAt(i),l=e.charAt(i);if(a!==l)return Lg(a)===Lg(l)?De(a,l):Lg(a)?1:-1}return De(s.length,e.length)}const Mk=55296,Vk=57343;function Lg(s){const e=s.charCodeAt(0);return e>=Mk&&e<=Vk}function Sl(s,e,t){return s.length===e.length&&s.every(((i,a)=>t(i,e[a])))}function yS(s){return s+"\0"}const yT="__name__";class es{constructor(e,t,i){t===void 0?t=0:t>e.length&&ve(637,{offset:t,range:e.length}),i===void 0?i=e.length-t:i>e.length-t&&ve(1746,{length:i,range:e.length-t}),this.segments=e,this.offset=t,this.len=i}get length(){return this.len}isEqual(e){return es.comparator(this,e)===0}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof es?e.forEach((i=>{t.push(i)})):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,i=this.limit();t<i;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const i=Math.min(e.length,t.length);for(let a=0;a<i;a++){const l=es.compareSegments(e.get(a),t.get(a));if(l!==0)return l}return De(e.length,t.length)}static compareSegments(e,t){const i=es.isNumericId(e),a=es.isNumericId(t);return i&&!a?-1:!i&&a?1:i&&a?es.extractNumericId(e).compare(es.extractNumericId(t)):cy(e,t)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return Gr.fromString(e.substring(4,e.length-2))}}class Ze extends es{construct(e,t,i){return new Ze(e,t,i)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const t=[];for(const i of e){if(i.indexOf("//")>=0)throw new he(te.INVALID_ARGUMENT,`Invalid segment (${i}). Paths must not contain // in them.`);t.push(...i.split("/").filter((a=>a.length>0)))}return new Ze(t)}static emptyPath(){return new Ze([])}}const Pk=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class xt extends es{construct(e,t,i){return new xt(e,t,i)}static isValidIdentifier(e){return Pk.test(e)}canonicalString(){return this.toArray().map((e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),xt.isValidIdentifier(e)||(e="`"+e+"`"),e))).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===yT}static keyField(){return new xt([yT])}static fromServerFormat(e){const t=[];let i="",a=0;const l=()=>{if(i.length===0)throw new he(te.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(i),i=""};let u=!1;for(;a<e.length;){const f=e[a];if(f==="\\"){if(a+1===e.length)throw new he(te.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const p=e[a+1];if(p!=="\\"&&p!=="."&&p!=="`")throw new he(te.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);i+=p,a+=2}else f==="`"?(u=!u,a++):f!=="."||u?(i+=f,a++):(l(),a++)}if(l(),u)throw new he(te.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new xt(t)}static emptyPath(){return new xt([])}}class me{constructor(e){this.path=e}static fromPath(e){return new me(Ze.fromString(e))}static fromName(e){return new me(Ze.fromString(e).popFirst(5))}static empty(){return new me(Ze.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&Ze.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return Ze.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new me(new Ze(e.slice()))}}function vS(s,e,t){if(!t)throw new he(te.INVALID_ARGUMENT,`Function ${s}() cannot be called with an empty ${e}.`)}function Lk(s,e,t,i){if(e===!0&&i===!0)throw new he(te.INVALID_ARGUMENT,`${s} and ${t} cannot be used together.`)}function vT(s){if(!me.isDocumentKey(s))throw new he(te.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${s} has ${s.length}.`)}function _T(s){if(me.isDocumentKey(s))throw new he(te.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${s} has ${s.length}.`)}function _S(s){return typeof s=="object"&&s!==null&&(Object.getPrototypeOf(s)===Object.prototype||Object.getPrototypeOf(s)===null)}function tm(s){if(s===void 0)return"undefined";if(s===null)return"null";if(typeof s=="string")return s.length>20&&(s=`${s.substring(0,20)}...`),JSON.stringify(s);if(typeof s=="number"||typeof s=="boolean")return""+s;if(typeof s=="object"){if(s instanceof Array)return"an array";{const e=(function(i){return i.constructor?i.constructor.name:null})(s);return e?`a custom ${e} object`:"an object"}}return typeof s=="function"?"a function":ve(12329,{type:typeof s})}function Ci(s,e){if("_delegate"in s&&(s=s._delegate),!(s instanceof e)){if(e.name===s.constructor.name)throw new he(te.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const t=tm(s);throw new he(te.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return s}function Uk(s,e){if(e<=0)throw new he(te.INVALID_ARGUMENT,`Function ${s}() requires a positive number, but it was: ${e}.`)}function Ft(s,e){const t={typeString:s};return e&&(t.value=e),t}function Wu(s,e){if(!_S(s))throw new he(te.INVALID_ARGUMENT,"JSON must be an object");let t;for(const i in e)if(e[i]){const a=e[i].typeString,l="value"in e[i]?{value:e[i].value}:void 0;if(!(i in s)){t=`JSON missing required field: '${i}'`;break}const u=s[i];if(a&&typeof u!==a){t=`JSON field '${i}' must be a ${a}.`;break}if(l!==void 0&&u!==l.value){t=`Expected '${i}' field to equal '${l.value}'`;break}}if(t)throw new he(te.INVALID_ARGUMENT,t);return!0}const bT=-62135596800,ET=1e6;class it{static now(){return it.fromMillis(Date.now())}static fromDate(e){return it.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),i=Math.floor((e-1e3*t)*ET);return new it(t,i)}constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new he(te.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new he(te.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<bT)throw new he(te.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new he(te.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/ET}_compareTo(e){return this.seconds===e.seconds?De(this.nanoseconds,e.nanoseconds):De(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:it._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(Wu(e,it._jsonSchema))return new it(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-bT;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}it._jsonSchemaVersion="firestore/timestamp/1.0",it._jsonSchema={type:Ft("string",it._jsonSchemaVersion),seconds:Ft("number"),nanoseconds:Ft("number")};class Ae{static fromTimestamp(e){return new Ae(e)}static min(){return new Ae(new it(0,0))}static max(){return new Ae(new it(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}const wl=-1;class wf{constructor(e,t,i,a){this.indexId=e,this.collectionGroup=t,this.fields=i,this.indexState=a}}function uy(s){return s.fields.find((e=>e.kind===2))}function Ua(s){return s.fields.filter((e=>e.kind!==2))}wf.UNKNOWN_ID=-1;class sf{constructor(e,t){this.fieldPath=e,this.kind=t}}class Cu{constructor(e,t){this.sequenceNumber=e,this.offset=t}static empty(){return new Cu(0,Gn.min())}}function bS(s,e){const t=s.toTimestamp().seconds,i=s.toTimestamp().nanoseconds+1,a=Ae.fromTimestamp(i===1e9?new it(t+1,0):new it(t,i));return new Gn(a,me.empty(),e)}function ES(s){return new Gn(s.readTime,s.key,wl)}class Gn{constructor(e,t,i){this.readTime=e,this.documentKey=t,this.largestBatchId=i}static min(){return new Gn(Ae.min(),me.empty(),wl)}static max(){return new Gn(Ae.max(),me.empty(),wl)}}function ev(s,e){let t=s.readTime.compareTo(e.readTime);return t!==0?t:(t=me.comparator(s.documentKey,e.documentKey),t!==0?t:De(s.largestBatchId,e.largestBatchId))}const TS="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class xS{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach((e=>e()))}}async function ea(s){if(s.code!==te.FAILED_PRECONDITION||s.message!==TS)throw s;ce("LocalStore","Unexpectedly lost primary lease")}class H{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e((t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)}),(t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)}))}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&ve(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new H(((i,a)=>{this.nextCallback=l=>{this.wrapSuccess(e,l).next(i,a)},this.catchCallback=l=>{this.wrapFailure(t,l).next(i,a)}}))}toPromise(){return new Promise(((e,t)=>{this.next(e,t)}))}wrapUserFunction(e){try{const t=e();return t instanceof H?t:H.resolve(t)}catch(t){return H.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction((()=>e(t))):H.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction((()=>e(t))):H.reject(t)}static resolve(e){return new H(((t,i)=>{t(e)}))}static reject(e){return new H(((t,i)=>{i(e)}))}static waitFor(e){return new H(((t,i)=>{let a=0,l=0,u=!1;e.forEach((f=>{++a,f.next((()=>{++l,u&&l===a&&t()}),(p=>i(p)))})),u=!0,l===a&&t()}))}static or(e){let t=H.resolve(!1);for(const i of e)t=t.next((a=>a?H.resolve(a):i()));return t}static forEach(e,t){const i=[];return e.forEach(((a,l)=>{i.push(t.call(this,a,l))})),this.waitFor(i)}static mapArray(e,t){return new H(((i,a)=>{const l=e.length,u=new Array(l);let f=0;for(let p=0;p<l;p++){const y=p;t(e[y]).next((_=>{u[y]=_,++f,f===l&&i(u)}),(_=>a(_)))}}))}static doWhile(e,t){return new H(((i,a)=>{const l=()=>{e()===!0?t().next((()=>{l()}),a):i()};l()}))}}const Bn="SimpleDb";class nm{static open(e,t,i,a){try{return new nm(t,e.transaction(a,i))}catch(l){throw new gu(t,l)}}constructor(e,t){this.action=e,this.transaction=t,this.aborted=!1,this.S=new ls,this.transaction.oncomplete=()=>{this.S.resolve()},this.transaction.onabort=()=>{t.error?this.S.reject(new gu(e,t.error)):this.S.resolve()},this.transaction.onerror=i=>{const a=tv(i.target.error);this.S.reject(new gu(e,a))}}get D(){return this.S.promise}abort(e){e&&this.S.reject(e),this.aborted||(ce(Bn,"Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}C(){const e=this.transaction;this.aborted||typeof e.commit!="function"||e.commit()}store(e){const t=this.transaction.objectStore(e);return new Bk(t)}}class Qr{static delete(e){return ce(Bn,"Removing database:",e),Ba(p1().indexedDB.deleteDatabase(e)).toPromise()}static v(){if(!x1())return!1;if(Qr.F())return!0;const e=Qt(),t=Qr.M(e),i=0<t&&t<10,a=SS(e),l=0<a&&a<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||i||l)}static F(){return typeof process<"u"&&process.__PRIVATE_env?.__PRIVATE_USE_MOCK_PERSISTENCE==="YES"}static O(e,t){return e.store(t)}static M(e){const t=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),i=t?t[1].split("_").slice(0,2).join("."):"-1";return Number(i)}constructor(e,t,i){this.name=e,this.version=t,this.N=i,this.B=null,Qr.M(Qt())===12.2&&Nt("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}async L(e){return this.db||(ce(Bn,"Opening database:",this.name),this.db=await new Promise(((t,i)=>{const a=indexedDB.open(this.name,this.version);a.onsuccess=l=>{const u=l.target.result;t(u)},a.onblocked=()=>{i(new gu(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},a.onerror=l=>{const u=l.target.error;u.name==="VersionError"?i(new he(te.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):u.name==="InvalidStateError"?i(new he(te.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+u)):i(new gu(e,u))},a.onupgradeneeded=l=>{ce(Bn,'Database "'+this.name+'" requires upgrade from version:',l.oldVersion);const u=l.target.result;this.N.k(u,a.transaction,l.oldVersion,this.version).next((()=>{ce(Bn,"Database upgrade to version "+this.version+" complete")}))}}))),this.K&&(this.db.onversionchange=t=>this.K(t)),this.db}q(e){this.K=e,this.db&&(this.db.onversionchange=t=>e(t))}async runTransaction(e,t,i,a){const l=t==="readonly";let u=0;for(;;){++u;try{this.db=await this.L(e);const f=nm.open(this.db,e,l?"readonly":"readwrite",i),p=a(f).next((y=>(f.C(),y))).catch((y=>(f.abort(y),H.reject(y)))).toPromise();return p.catch((()=>{})),await f.D,p}catch(f){const p=f,y=p.name!=="FirebaseError"&&u<3;if(ce(Bn,"Transaction failed with error:",p.message,"Retrying:",y),this.close(),!y)return Promise.reject(p)}}}close(){this.db&&this.db.close(),this.db=void 0}}function SS(s){const e=s.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}class zk{constructor(e){this.U=e,this.$=!1,this.W=null}get isDone(){return this.$}get G(){return this.W}set cursor(e){this.U=e}done(){this.$=!0}j(e){this.W=e}delete(){return Ba(this.U.delete())}}class gu extends he{constructor(e,t){super(te.UNAVAILABLE,`IndexedDB transaction '${e}' failed: ${t}`),this.name="IndexedDbTransactionError"}}function ta(s){return s.name==="IndexedDbTransactionError"}class Bk{constructor(e){this.store=e}put(e,t){let i;return t!==void 0?(ce(Bn,"PUT",this.store.name,e,t),i=this.store.put(t,e)):(ce(Bn,"PUT",this.store.name,"<auto-key>",e),i=this.store.put(e)),Ba(i)}add(e){return ce(Bn,"ADD",this.store.name,e,e),Ba(this.store.add(e))}get(e){return Ba(this.store.get(e)).next((t=>(t===void 0&&(t=null),ce(Bn,"GET",this.store.name,e,t),t)))}delete(e){return ce(Bn,"DELETE",this.store.name,e),Ba(this.store.delete(e))}count(){return ce(Bn,"COUNT",this.store.name),Ba(this.store.count())}H(e,t){const i=this.options(e,t),a=i.index?this.store.index(i.index):this.store;if(typeof a.getAll=="function"){const l=a.getAll(i.range);return new H(((u,f)=>{l.onerror=p=>{f(p.target.error)},l.onsuccess=p=>{u(p.target.result)}}))}{const l=this.cursor(i),u=[];return this.J(l,((f,p)=>{u.push(p)})).next((()=>u))}}Z(e,t){const i=this.store.getAll(e,t===null?void 0:t);return new H(((a,l)=>{i.onerror=u=>{l(u.target.error)},i.onsuccess=u=>{a(u.target.result)}}))}X(e,t){ce(Bn,"DELETE ALL",this.store.name);const i=this.options(e,t);i.Y=!1;const a=this.cursor(i);return this.J(a,((l,u,f)=>f.delete()))}ee(e,t){let i;t?i=e:(i={},t=e);const a=this.cursor(i);return this.J(a,t)}te(e){const t=this.cursor({});return new H(((i,a)=>{t.onerror=l=>{const u=tv(l.target.error);a(u)},t.onsuccess=l=>{const u=l.target.result;u?e(u.primaryKey,u.value).next((f=>{f?u.continue():i()})):i()}}))}J(e,t){const i=[];return new H(((a,l)=>{e.onerror=u=>{l(u.target.error)},e.onsuccess=u=>{const f=u.target.result;if(!f)return void a();const p=new zk(f),y=t(f.primaryKey,f.value,p);if(y instanceof H){const _=y.catch((b=>(p.done(),H.reject(b))));i.push(_)}p.isDone?a():p.G===null?f.continue():f.continue(p.G)}})).next((()=>H.waitFor(i)))}options(e,t){let i;return e!==void 0&&(typeof e=="string"?i=e:t=e),{index:i,range:t}}cursor(e){let t="next";if(e.reverse&&(t="prev"),e.index){const i=this.store.index(e.index);return e.Y?i.openKeyCursor(e.range,t):i.openCursor(e.range,t)}return this.store.openCursor(e.range,t)}}function Ba(s){return new H(((e,t)=>{s.onsuccess=i=>{const a=i.target.result;e(a)},s.onerror=i=>{const a=tv(i.target.error);t(a)}}))}let TT=!1;function tv(s){const e=Qr.M(Qt());if(e>=12.2&&e<13){const t="An internal error was encountered in the Indexed Database server";if(s.message.indexOf(t)>=0){const i=new he("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${t}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return TT||(TT=!0,setTimeout((()=>{throw i}),0)),i}}return s}const yu="IndexBackfiller";class Fk{constructor(e,t){this.asyncQueue=e,this.ne=t,this.task=null}start(){this.re(15e3)}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return this.task!==null}re(e){ce(yu,`Scheduled in ${e}ms`),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",e,(async()=>{this.task=null;try{const t=await this.ne.ie();ce(yu,`Documents written: ${t}`)}catch(t){ta(t)?ce(yu,"Ignoring IndexedDB error during index backfill: ",t):await ea(t)}await this.re(6e4)}))}}class qk{constructor(e,t){this.localStore=e,this.persistence=t}async ie(e=50){return this.persistence.runTransaction("Backfill Indexes","readwrite-primary",(t=>this.se(t,e)))}se(e,t){const i=new Set;let a=t,l=!0;return H.doWhile((()=>l===!0&&a>0),(()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(e).next((u=>{if(u!==null&&!i.has(u))return ce(yu,`Processing collection: ${u}`),this.oe(e,u,a).next((f=>{a-=f,i.add(u)}));l=!1})))).next((()=>t-a))}oe(e,t,i){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(e,t).next((a=>this.localStore.localDocuments.getNextDocuments(e,t,a,i).next((l=>{const u=l.changes;return this.localStore.indexManager.updateIndexEntries(e,u).next((()=>this._e(a,l))).next((f=>(ce(yu,`Updating offset: ${f}`),this.localStore.indexManager.updateCollectionGroup(e,t,f)))).next((()=>u.size))}))))}_e(e,t){let i=e;return t.changes.forEach(((a,l)=>{const u=ES(l);ev(u,i)>0&&(i=u)})),new Gn(i.readTime,i.documentKey,Math.max(t.batchId,e.largestBatchId))}}class In{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=i=>this.ae(i),this.ue=i=>t.writeSequenceNumber(i))}ae(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ue&&this.ue(e),e}}In.ce=-1;const Qa=-1;function im(s){return s==null}function Ru(s){return s===0&&1/s==-1/0}function wS(s){return typeof s=="number"&&Number.isInteger(s)&&!Ru(s)&&s<=Number.MAX_SAFE_INTEGER&&s>=Number.MIN_SAFE_INTEGER}const Af="";function fn(s){let e="";for(let t=0;t<s.length;t++)e.length>0&&(e=xT(e)),e=Hk(s.get(t),e);return xT(e)}function Hk(s,e){let t=e;const i=s.length;for(let a=0;a<i;a++){const l=s.charAt(a);switch(l){case"\0":t+="";break;case Af:t+="";break;default:t+=l}}return t}function xT(s){return s+Af+""}function ns(s){const e=s.length;if(xe(e>=2,64408,{path:s}),e===2)return xe(s.charAt(0)===Af&&s.charAt(1)==="",56145,{path:s}),Ze.emptyPath();const t=e-2,i=[];let a="";for(let l=0;l<e;){const u=s.indexOf(Af,l);switch((u<0||u>t)&&ve(50515,{path:s}),s.charAt(u+1)){case"":const f=s.substring(l,u);let p;a.length===0?p=f:(a+=f,p=a,a=""),i.push(p);break;case"":a+=s.substring(l,u),a+="\0";break;case"":a+=s.substring(l,u+1);break;default:ve(61167,{path:s})}l=u+2}return new Ze(i)}const za="remoteDocuments",Yu="owner",il="owner",Du="mutationQueues",Gk="userId",xi="mutations",ST="batchId",Ga="userMutationsIndex",wT=["userId","batchId"];function rf(s,e){return[s,fn(e)]}function AS(s,e,t){return[s,fn(e),t]}const Qk={},Al="documentMutations",If="remoteDocumentsV14",Kk=["prefixPath","collectionGroup","readTime","documentId"],af="documentKeyIndex",$k=["prefixPath","collectionGroup","documentId"],IS="collectionGroupIndex",Wk=["collectionGroup","readTime","prefixPath","documentId"],Nu="remoteDocumentGlobal",hy="remoteDocumentGlobalKey",Il="targets",CS="queryTargetsIndex",Yk=["canonicalId","targetId"],Cl="targetDocuments",Xk=["targetId","path"],nv="documentTargetsIndex",Jk=["path","targetId"],Cf="targetGlobalKey",Ka="targetGlobal",ju="collectionParents",Zk=["collectionId","parent"],Rl="clientMetadata",eO="clientId",sm="bundles",tO="bundleId",rm="namedQueries",nO="name",iv="indexConfiguration",iO="indexId",dy="collectionGroupIndex",sO="collectionGroup",vu="indexState",rO=["indexId","uid"],RS="sequenceNumberIndex",aO=["uid","sequenceNumber"],_u="indexEntries",oO=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],DS="documentKeyIndex",lO=["indexId","uid","orderedDocumentKey"],am="documentOverlays",cO=["userId","collectionPath","documentId"],fy="collectionPathOverlayIndex",uO=["userId","collectionPath","largestBatchId"],NS="collectionGroupOverlayIndex",hO=["userId","collectionGroup","largestBatchId"],sv="globals",dO="name",jS=[Du,xi,Al,za,Il,Yu,Ka,Cl,Rl,Nu,ju,sm,rm],fO=[...jS,am],kS=[Du,xi,Al,If,Il,Yu,Ka,Cl,Rl,Nu,ju,sm,rm,am],OS=kS,rv=[...OS,iv,vu,_u],mO=rv,MS=[...rv,sv],pO=MS;class my extends xS{constructor(e,t){super(),this.le=e,this.currentSequenceNumber=t}}function Kt(s,e){const t=be(s);return Qr.O(t.le,e)}function AT(s){let e=0;for(const t in s)Object.prototype.hasOwnProperty.call(s,t)&&e++;return e}function na(s,e){for(const t in s)Object.prototype.hasOwnProperty.call(s,t)&&e(t,s[t])}function VS(s){for(const e in s)if(Object.prototype.hasOwnProperty.call(s,e))return!1;return!0}class dt{constructor(e,t){this.comparator=e,this.root=t||rn.EMPTY}insert(e,t){return new dt(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,rn.BLACK,null,null))}remove(e){return new dt(this.comparator,this.root.remove(e,this.comparator).copy(null,null,rn.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const i=this.comparator(e,t.key);if(i===0)return t.value;i<0?t=t.left:i>0&&(t=t.right)}return null}indexOf(e){let t=0,i=this.root;for(;!i.isEmpty();){const a=this.comparator(e,i.key);if(a===0)return t+i.left.size;a<0?i=i.left:(t+=i.left.size+1,i=i.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal(((t,i)=>(e(t,i),!1)))}toString(){const e=[];return this.inorderTraversal(((t,i)=>(e.push(`${t}:${i}`),!1))),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Ld(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Ld(this.root,e,this.comparator,!1)}getReverseIterator(){return new Ld(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Ld(this.root,e,this.comparator,!0)}}class Ld{constructor(e,t,i,a){this.isReverse=a,this.nodeStack=[];let l=1;for(;!e.isEmpty();)if(l=t?i(e.key,t):1,t&&a&&(l*=-1),l<0)e=this.isReverse?e.left:e.right;else{if(l===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class rn{constructor(e,t,i,a,l){this.key=e,this.value=t,this.color=i??rn.RED,this.left=a??rn.EMPTY,this.right=l??rn.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,i,a,l){return new rn(e??this.key,t??this.value,i??this.color,a??this.left,l??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,i){let a=this;const l=i(e,a.key);return a=l<0?a.copy(null,null,null,a.left.insert(e,t,i),null):l===0?a.copy(null,t,null,null,null):a.copy(null,null,null,null,a.right.insert(e,t,i)),a.fixUp()}removeMin(){if(this.left.isEmpty())return rn.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let i,a=this;if(t(e,a.key)<0)a.left.isEmpty()||a.left.isRed()||a.left.left.isRed()||(a=a.moveRedLeft()),a=a.copy(null,null,null,a.left.remove(e,t),null);else{if(a.left.isRed()&&(a=a.rotateRight()),a.right.isEmpty()||a.right.isRed()||a.right.left.isRed()||(a=a.moveRedRight()),t(e,a.key)===0){if(a.right.isEmpty())return rn.EMPTY;i=a.right.min(),a=a.copy(i.key,i.value,null,null,a.right.removeMin())}a=a.copy(null,null,null,null,a.right.remove(e,t))}return a.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,rn.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,rn.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw ve(43730,{key:this.key,value:this.value});if(this.right.isRed())throw ve(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw ve(27949);return e+(this.isRed()?0:1)}}rn.EMPTY=null,rn.RED=!0,rn.BLACK=!1;rn.EMPTY=new class{constructor(){this.size=0}get key(){throw ve(57766)}get value(){throw ve(16141)}get color(){throw ve(16727)}get left(){throw ve(29726)}get right(){throw ve(36894)}copy(e,t,i,a,l){return this}insert(e,t,i){return new rn(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};class rt{constructor(e){this.comparator=e,this.data=new dt(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal(((t,i)=>(e(t),!1)))}forEachInRange(e,t){const i=this.data.getIteratorFrom(e[0]);for(;i.hasNext();){const a=i.getNext();if(this.comparator(a.key,e[1])>=0)return;t(a.key)}}forEachWhile(e,t){let i;for(i=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();i.hasNext();)if(!e(i.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new IT(this.data.getIterator())}getIteratorFrom(e){return new IT(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach((i=>{t=t.add(i)})),t}isEqual(e){if(!(e instanceof rt)||this.size!==e.size)return!1;const t=this.data.getIterator(),i=e.data.getIterator();for(;t.hasNext();){const a=t.getNext().key,l=i.getNext().key;if(this.comparator(a,l)!==0)return!1}return!0}toArray(){const e=[];return this.forEach((t=>{e.push(t)})),e}toString(){const e=[];return this.forEach((t=>e.push(t))),"SortedSet("+e.toString()+")"}copy(e){const t=new rt(this.comparator);return t.data=e,t}}class IT{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}function sl(s){return s.hasNext()?s.getNext():void 0}class Cn{constructor(e){this.fields=e,e.sort(xt.comparator)}static empty(){return new Cn([])}unionWith(e){let t=new rt(xt.comparator);for(const i of this.fields)t=t.add(i);for(const i of e)t=t.add(i);return new Cn(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return Sl(this.fields,e.fields,((t,i)=>t.isEqual(i)))}}class PS extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}class kt{constructor(e){this.binaryString=e}static fromBase64String(e){const t=(function(a){try{return atob(a)}catch(l){throw typeof DOMException<"u"&&l instanceof DOMException?new PS("Invalid base64 string: "+l):l}})(e);return new kt(t)}static fromUint8Array(e){const t=(function(a){let l="";for(let u=0;u<a.length;++u)l+=String.fromCharCode(a[u]);return l})(e);return new kt(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return(function(t){return btoa(t)})(this.binaryString)}toUint8Array(){return(function(t){const i=new Uint8Array(t.length);for(let a=0;a<t.length;a++)i[a]=t.charCodeAt(a);return i})(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return De(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}kt.EMPTY_BYTE_STRING=new kt("");const gO=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Qs(s){if(xe(!!s,39018),typeof s=="string"){let e=0;const t=gO.exec(s);if(xe(!!t,46558,{timestamp:s}),t[1]){let a=t[1];a=(a+"000000000").substr(0,9),e=Number(a)}const i=new Date(s);return{seconds:Math.floor(i.getTime()/1e3),nanos:e}}return{seconds:Et(s.seconds),nanos:Et(s.nanos)}}function Et(s){return typeof s=="number"?s:typeof s=="string"?Number(s):0}function Ks(s){return typeof s=="string"?kt.fromBase64String(s):kt.fromUint8Array(s)}const LS="server_timestamp",US="__type__",zS="__previous_value__",BS="__local_write_time__";function av(s){return(s?.mapValue?.fields||{})[US]?.stringValue===LS}function om(s){const e=s.mapValue.fields[zS];return av(e)?om(e):e}function ku(s){const e=Qs(s.mapValue.fields[BS].timestampValue);return new it(e.seconds,e.nanos)}class yO{constructor(e,t,i,a,l,u,f,p,y,_,b){this.databaseId=e,this.appId=t,this.persistenceKey=i,this.host=a,this.ssl=l,this.forceLongPolling=u,this.autoDetectLongPolling=f,this.longPollingOptions=p,this.useFetchStreams=y,this.isUsingEmulator=_,this.apiKey=b}}const Rf="(default)";class to{constructor(e,t){this.projectId=e,this.database=t||Rf}static empty(){return new to("","")}get isDefaultDatabase(){return this.database===Rf}isEqual(e){return e instanceof to&&e.projectId===this.projectId&&e.database===this.database}}function vO(s,e){if(!Object.prototype.hasOwnProperty.apply(s.options,["projectId"]))throw new he(te.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new to(s.options.projectId,e)}const ov="__type__",FS="__max__",Fr={mapValue:{fields:{__type__:{stringValue:FS}}}},lv="__vector__",Dl="value",of={nullValue:"NULL_VALUE"};function Wr(s){return"nullValue"in s?0:"booleanValue"in s?1:"integerValue"in s||"doubleValue"in s?2:"timestampValue"in s?3:"stringValue"in s?5:"bytesValue"in s?6:"referenceValue"in s?7:"geoPointValue"in s?8:"arrayValue"in s?9:"mapValue"in s?av(s)?4:qS(s)?9007199254740991:lm(s)?10:11:ve(28295,{value:s})}function us(s,e){if(s===e)return!0;const t=Wr(s);if(t!==Wr(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return s.booleanValue===e.booleanValue;case 4:return ku(s).isEqual(ku(e));case 3:return(function(a,l){if(typeof a.timestampValue=="string"&&typeof l.timestampValue=="string"&&a.timestampValue.length===l.timestampValue.length)return a.timestampValue===l.timestampValue;const u=Qs(a.timestampValue),f=Qs(l.timestampValue);return u.seconds===f.seconds&&u.nanos===f.nanos})(s,e);case 5:return s.stringValue===e.stringValue;case 6:return(function(a,l){return Ks(a.bytesValue).isEqual(Ks(l.bytesValue))})(s,e);case 7:return s.referenceValue===e.referenceValue;case 8:return(function(a,l){return Et(a.geoPointValue.latitude)===Et(l.geoPointValue.latitude)&&Et(a.geoPointValue.longitude)===Et(l.geoPointValue.longitude)})(s,e);case 2:return(function(a,l){if("integerValue"in a&&"integerValue"in l)return Et(a.integerValue)===Et(l.integerValue);if("doubleValue"in a&&"doubleValue"in l){const u=Et(a.doubleValue),f=Et(l.doubleValue);return u===f?Ru(u)===Ru(f):isNaN(u)&&isNaN(f)}return!1})(s,e);case 9:return Sl(s.arrayValue.values||[],e.arrayValue.values||[],us);case 10:case 11:return(function(a,l){const u=a.mapValue.fields||{},f=l.mapValue.fields||{};if(AT(u)!==AT(f))return!1;for(const p in u)if(u.hasOwnProperty(p)&&(f[p]===void 0||!us(u[p],f[p])))return!1;return!0})(s,e);default:return ve(52216,{left:s})}}function Ou(s,e){return(s.values||[]).find((t=>us(t,e)))!==void 0}function Yr(s,e){if(s===e)return 0;const t=Wr(s),i=Wr(e);if(t!==i)return De(t,i);switch(t){case 0:case 9007199254740991:return 0;case 1:return De(s.booleanValue,e.booleanValue);case 2:return(function(l,u){const f=Et(l.integerValue||l.doubleValue),p=Et(u.integerValue||u.doubleValue);return f<p?-1:f>p?1:f===p?0:isNaN(f)?isNaN(p)?0:-1:1})(s,e);case 3:return CT(s.timestampValue,e.timestampValue);case 4:return CT(ku(s),ku(e));case 5:return cy(s.stringValue,e.stringValue);case 6:return(function(l,u){const f=Ks(l),p=Ks(u);return f.compareTo(p)})(s.bytesValue,e.bytesValue);case 7:return(function(l,u){const f=l.split("/"),p=u.split("/");for(let y=0;y<f.length&&y<p.length;y++){const _=De(f[y],p[y]);if(_!==0)return _}return De(f.length,p.length)})(s.referenceValue,e.referenceValue);case 8:return(function(l,u){const f=De(Et(l.latitude),Et(u.latitude));return f!==0?f:De(Et(l.longitude),Et(u.longitude))})(s.geoPointValue,e.geoPointValue);case 9:return RT(s.arrayValue,e.arrayValue);case 10:return(function(l,u){const f=l.fields||{},p=u.fields||{},y=f[Dl]?.arrayValue,_=p[Dl]?.arrayValue,b=De(y?.values?.length||0,_?.values?.length||0);return b!==0?b:RT(y,_)})(s.mapValue,e.mapValue);case 11:return(function(l,u){if(l===Fr.mapValue&&u===Fr.mapValue)return 0;if(l===Fr.mapValue)return 1;if(u===Fr.mapValue)return-1;const f=l.fields||{},p=Object.keys(f),y=u.fields||{},_=Object.keys(y);p.sort(),_.sort();for(let b=0;b<p.length&&b<_.length;++b){const x=cy(p[b],_[b]);if(x!==0)return x;const k=Yr(f[p[b]],y[_[b]]);if(k!==0)return k}return De(p.length,_.length)})(s.mapValue,e.mapValue);default:throw ve(23264,{he:t})}}function CT(s,e){if(typeof s=="string"&&typeof e=="string"&&s.length===e.length)return De(s,e);const t=Qs(s),i=Qs(e),a=De(t.seconds,i.seconds);return a!==0?a:De(t.nanos,i.nanos)}function RT(s,e){const t=s.values||[],i=e.values||[];for(let a=0;a<t.length&&a<i.length;++a){const l=Yr(t[a],i[a]);if(l)return l}return De(t.length,i.length)}function Nl(s){return py(s)}function py(s){return"nullValue"in s?"null":"booleanValue"in s?""+s.booleanValue:"integerValue"in s?""+s.integerValue:"doubleValue"in s?""+s.doubleValue:"timestampValue"in s?(function(t){const i=Qs(t);return`time(${i.seconds},${i.nanos})`})(s.timestampValue):"stringValue"in s?s.stringValue:"bytesValue"in s?(function(t){return Ks(t).toBase64()})(s.bytesValue):"referenceValue"in s?(function(t){return me.fromName(t).toString()})(s.referenceValue):"geoPointValue"in s?(function(t){return`geo(${t.latitude},${t.longitude})`})(s.geoPointValue):"arrayValue"in s?(function(t){let i="[",a=!0;for(const l of t.values||[])a?a=!1:i+=",",i+=py(l);return i+"]"})(s.arrayValue):"mapValue"in s?(function(t){const i=Object.keys(t.fields||{}).sort();let a="{",l=!0;for(const u of i)l?l=!1:a+=",",a+=`${u}:${py(t.fields[u])}`;return a+"}"})(s.mapValue):ve(61005,{value:s})}function lf(s){switch(Wr(s)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=om(s);return e?16+lf(e):16;case 5:return 2*s.stringValue.length;case 6:return Ks(s.bytesValue).approximateByteSize();case 7:return s.referenceValue.length;case 9:return(function(i){return(i.values||[]).reduce(((a,l)=>a+lf(l)),0)})(s.arrayValue);case 10:case 11:return(function(i){let a=0;return na(i.fields,((l,u)=>{a+=l.length+lf(u)})),a})(s.mapValue);default:throw ve(13486,{value:s})}}function Mu(s,e){return{referenceValue:`projects/${s.projectId}/databases/${s.database}/documents/${e.path.canonicalString()}`}}function gy(s){return!!s&&"integerValue"in s}function Vu(s){return!!s&&"arrayValue"in s}function DT(s){return!!s&&"nullValue"in s}function NT(s){return!!s&&"doubleValue"in s&&isNaN(Number(s.doubleValue))}function cf(s){return!!s&&"mapValue"in s}function lm(s){return(s?.mapValue?.fields||{})[ov]?.stringValue===lv}function bu(s){if(s.geoPointValue)return{geoPointValue:{...s.geoPointValue}};if(s.timestampValue&&typeof s.timestampValue=="object")return{timestampValue:{...s.timestampValue}};if(s.mapValue){const e={mapValue:{fields:{}}};return na(s.mapValue.fields,((t,i)=>e.mapValue.fields[t]=bu(i))),e}if(s.arrayValue){const e={arrayValue:{values:[]}};for(let t=0;t<(s.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=bu(s.arrayValue.values[t]);return e}return{...s}}function qS(s){return(((s.mapValue||{}).fields||{}).__type__||{}).stringValue===FS}const HS={mapValue:{fields:{[ov]:{stringValue:lv},[Dl]:{arrayValue:{}}}}};function _O(s){return"nullValue"in s?of:"booleanValue"in s?{booleanValue:!1}:"integerValue"in s||"doubleValue"in s?{doubleValue:NaN}:"timestampValue"in s?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in s?{stringValue:""}:"bytesValue"in s?{bytesValue:""}:"referenceValue"in s?Mu(to.empty(),me.empty()):"geoPointValue"in s?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in s?{arrayValue:{}}:"mapValue"in s?lm(s)?HS:{mapValue:{}}:ve(35942,{value:s})}function bO(s){return"nullValue"in s?{booleanValue:!1}:"booleanValue"in s?{doubleValue:NaN}:"integerValue"in s||"doubleValue"in s?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in s?{stringValue:""}:"stringValue"in s?{bytesValue:""}:"bytesValue"in s?Mu(to.empty(),me.empty()):"referenceValue"in s?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in s?{arrayValue:{}}:"arrayValue"in s?HS:"mapValue"in s?lm(s)?{mapValue:{}}:Fr:ve(61959,{value:s})}function jT(s,e){const t=Yr(s.value,e.value);return t!==0?t:s.inclusive&&!e.inclusive?-1:!s.inclusive&&e.inclusive?1:0}function kT(s,e){const t=Yr(s.value,e.value);return t!==0?t:s.inclusive&&!e.inclusive?1:!s.inclusive&&e.inclusive?-1:0}class dn{constructor(e){this.value=e}static empty(){return new dn({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let i=0;i<e.length-1;++i)if(t=(t.mapValue.fields||{})[e.get(i)],!cf(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=bu(t)}setAll(e){let t=xt.emptyPath(),i={},a=[];e.forEach(((u,f)=>{if(!t.isImmediateParentOf(f)){const p=this.getFieldsMap(t);this.applyChanges(p,i,a),i={},a=[],t=f.popLast()}u?i[f.lastSegment()]=bu(u):a.push(f.lastSegment())}));const l=this.getFieldsMap(t);this.applyChanges(l,i,a)}delete(e){const t=this.field(e.popLast());cf(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return us(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let i=0;i<e.length;++i){let a=t.mapValue.fields[e.get(i)];cf(a)&&a.mapValue.fields||(a={mapValue:{fields:{}}},t.mapValue.fields[e.get(i)]=a),t=a}return t.mapValue.fields}applyChanges(e,t,i){na(t,((a,l)=>e[a]=l));for(const a of i)delete e[a]}clone(){return new dn(bu(this.value))}}function GS(s){const e=[];return na(s.fields,((t,i)=>{const a=new xt([t]);if(cf(i)){const l=GS(i.mapValue).fields;if(l.length===0)e.push(a);else for(const u of l)e.push(a.child(u))}else e.push(a)})),new Cn(e)}class At{constructor(e,t,i,a,l,u,f){this.key=e,this.documentType=t,this.version=i,this.readTime=a,this.createTime=l,this.data=u,this.documentState=f}static newInvalidDocument(e){return new At(e,0,Ae.min(),Ae.min(),Ae.min(),dn.empty(),0)}static newFoundDocument(e,t,i,a){return new At(e,1,t,Ae.min(),i,a,0)}static newNoDocument(e,t){return new At(e,2,t,Ae.min(),Ae.min(),dn.empty(),0)}static newUnknownDocument(e,t){return new At(e,3,t,Ae.min(),Ae.min(),dn.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(Ae.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=dn.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=dn.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=Ae.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof At&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new At(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}class jl{constructor(e,t){this.position=e,this.inclusive=t}}function OT(s,e,t){let i=0;for(let a=0;a<s.position.length;a++){const l=e[a],u=s.position[a];if(l.field.isKeyField()?i=me.comparator(me.fromName(u.referenceValue),t.key):i=Yr(u,t.data.field(l.field)),l.dir==="desc"&&(i*=-1),i!==0)break}return i}function MT(s,e){if(s===null)return e===null;if(e===null||s.inclusive!==e.inclusive||s.position.length!==e.position.length)return!1;for(let t=0;t<s.position.length;t++)if(!us(s.position[t],e.position[t]))return!1;return!0}class Pu{constructor(e,t="asc"){this.field=e,this.dir=t}}function EO(s,e){return s.dir===e.dir&&s.field.isEqual(e.field)}class QS{}class qe extends QS{constructor(e,t,i){super(),this.field=e,this.op=t,this.value=i}static create(e,t,i){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,i):new TO(e,t,i):t==="array-contains"?new wO(e,i):t==="in"?new JS(e,i):t==="not-in"?new AO(e,i):t==="array-contains-any"?new IO(e,i):new qe(e,t,i)}static createKeyFieldInFilter(e,t,i){return t==="in"?new xO(e,i):new SO(e,i)}matches(e){const t=e.data.field(this.field);return this.op==="!="?t!==null&&t.nullValue===void 0&&this.matchesComparison(Yr(t,this.value)):t!==null&&Wr(this.value)===Wr(t)&&this.matchesComparison(Yr(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return ve(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class st extends QS{constructor(e,t){super(),this.filters=e,this.op=t,this.Pe=null}static create(e,t){return new st(e,t)}matches(e){return kl(this)?this.filters.find((t=>!t.matches(e)))===void 0:this.filters.find((t=>t.matches(e)))!==void 0}getFlattenedFilters(){return this.Pe!==null||(this.Pe=this.filters.reduce(((e,t)=>e.concat(t.getFlattenedFilters())),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function kl(s){return s.op==="and"}function yy(s){return s.op==="or"}function cv(s){return KS(s)&&kl(s)}function KS(s){for(const e of s.filters)if(e instanceof st)return!1;return!0}function vy(s){if(s instanceof qe)return s.field.canonicalString()+s.op.toString()+Nl(s.value);if(cv(s))return s.filters.map((e=>vy(e))).join(",");{const e=s.filters.map((t=>vy(t))).join(",");return`${s.op}(${e})`}}function $S(s,e){return s instanceof qe?(function(i,a){return a instanceof qe&&i.op===a.op&&i.field.isEqual(a.field)&&us(i.value,a.value)})(s,e):s instanceof st?(function(i,a){return a instanceof st&&i.op===a.op&&i.filters.length===a.filters.length?i.filters.reduce(((l,u,f)=>l&&$S(u,a.filters[f])),!0):!1})(s,e):void ve(19439)}function WS(s,e){const t=s.filters.concat(e);return st.create(t,s.op)}function YS(s){return s instanceof qe?(function(t){return`${t.field.canonicalString()} ${t.op} ${Nl(t.value)}`})(s):s instanceof st?(function(t){return t.op.toString()+" {"+t.getFilters().map(YS).join(" ,")+"}"})(s):"Filter"}class TO extends qe{constructor(e,t,i){super(e,t,i),this.key=me.fromName(i.referenceValue)}matches(e){const t=me.comparator(e.key,this.key);return this.matchesComparison(t)}}class xO extends qe{constructor(e,t){super(e,"in",t),this.keys=XS("in",t)}matches(e){return this.keys.some((t=>t.isEqual(e.key)))}}class SO extends qe{constructor(e,t){super(e,"not-in",t),this.keys=XS("not-in",t)}matches(e){return!this.keys.some((t=>t.isEqual(e.key)))}}function XS(s,e){return(e.arrayValue?.values||[]).map((t=>me.fromName(t.referenceValue)))}class wO extends qe{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return Vu(t)&&Ou(t.arrayValue,this.value)}}class JS extends qe{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return t!==null&&Ou(this.value.arrayValue,t)}}class AO extends qe{constructor(e,t){super(e,"not-in",t)}matches(e){if(Ou(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return t!==null&&t.nullValue===void 0&&!Ou(this.value.arrayValue,t)}}class IO extends qe{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!Vu(t)||!t.arrayValue.values)&&t.arrayValue.values.some((i=>Ou(this.value.arrayValue,i)))}}class CO{constructor(e,t=null,i=[],a=[],l=null,u=null,f=null){this.path=e,this.collectionGroup=t,this.orderBy=i,this.filters=a,this.limit=l,this.startAt=u,this.endAt=f,this.Te=null}}function _y(s,e=null,t=[],i=[],a=null,l=null,u=null){return new CO(s,e,t,i,a,l,u)}function no(s){const e=be(s);if(e.Te===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map((i=>vy(i))).join(","),t+="|ob:",t+=e.orderBy.map((i=>(function(l){return l.field.canonicalString()+l.dir})(i))).join(","),im(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map((i=>Nl(i))).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map((i=>Nl(i))).join(",")),e.Te=t}return e.Te}function Xu(s,e){if(s.limit!==e.limit||s.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<s.orderBy.length;t++)if(!EO(s.orderBy[t],e.orderBy[t]))return!1;if(s.filters.length!==e.filters.length)return!1;for(let t=0;t<s.filters.length;t++)if(!$S(s.filters[t],e.filters[t]))return!1;return s.collectionGroup===e.collectionGroup&&!!s.path.isEqual(e.path)&&!!MT(s.startAt,e.startAt)&&MT(s.endAt,e.endAt)}function Df(s){return me.isDocumentKey(s.path)&&s.collectionGroup===null&&s.filters.length===0}function Nf(s,e){return s.filters.filter((t=>t instanceof qe&&t.field.isEqual(e)))}function VT(s,e,t){let i=of,a=!0;for(const l of Nf(s,e)){let u=of,f=!0;switch(l.op){case"<":case"<=":u=_O(l.value);break;case"==":case"in":case">=":u=l.value;break;case">":u=l.value,f=!1;break;case"!=":case"not-in":u=of}jT({value:i,inclusive:a},{value:u,inclusive:f})<0&&(i=u,a=f)}if(t!==null){for(let l=0;l<s.orderBy.length;++l)if(s.orderBy[l].field.isEqual(e)){const u=t.position[l];jT({value:i,inclusive:a},{value:u,inclusive:t.inclusive})<0&&(i=u,a=t.inclusive);break}}return{value:i,inclusive:a}}function PT(s,e,t){let i=Fr,a=!0;for(const l of Nf(s,e)){let u=Fr,f=!0;switch(l.op){case">=":case">":u=bO(l.value),f=!1;break;case"==":case"in":case"<=":u=l.value;break;case"<":u=l.value,f=!1;break;case"!=":case"not-in":u=Fr}kT({value:i,inclusive:a},{value:u,inclusive:f})>0&&(i=u,a=f)}if(t!==null){for(let l=0;l<s.orderBy.length;++l)if(s.orderBy[l].field.isEqual(e)){const u=t.position[l];kT({value:i,inclusive:a},{value:u,inclusive:t.inclusive})>0&&(i=u,a=t.inclusive);break}}return{value:i,inclusive:a}}class $l{constructor(e,t=null,i=[],a=[],l=null,u="F",f=null,p=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=i,this.filters=a,this.limit=l,this.limitType=u,this.startAt=f,this.endAt=p,this.Ie=null,this.Ee=null,this.Re=null,this.startAt,this.endAt}}function ZS(s,e,t,i,a,l,u,f){return new $l(s,e,t,i,a,l,u,f)}function cm(s){return new $l(s)}function LT(s){return s.filters.length===0&&s.limit===null&&s.startAt==null&&s.endAt==null&&(s.explicitOrderBy.length===0||s.explicitOrderBy.length===1&&s.explicitOrderBy[0].field.isKeyField())}function RO(s){return me.isDocumentKey(s.path)&&s.collectionGroup===null&&s.filters.length===0}function ew(s){return s.collectionGroup!==null}function Eu(s){const e=be(s);if(e.Ie===null){e.Ie=[];const t=new Set;for(const l of e.explicitOrderBy)e.Ie.push(l),t.add(l.field.canonicalString());const i=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(u){let f=new rt(xt.comparator);return u.filters.forEach((p=>{p.getFlattenedFilters().forEach((y=>{y.isInequality()&&(f=f.add(y.field))}))})),f})(e).forEach((l=>{t.has(l.canonicalString())||l.isKeyField()||e.Ie.push(new Pu(l,i))})),t.has(xt.keyField().canonicalString())||e.Ie.push(new Pu(xt.keyField(),i))}return e.Ie}function Hn(s){const e=be(s);return e.Ee||(e.Ee=DO(e,Eu(s))),e.Ee}function DO(s,e){if(s.limitType==="F")return _y(s.path,s.collectionGroup,e,s.filters,s.limit,s.startAt,s.endAt);{e=e.map((a=>{const l=a.dir==="desc"?"asc":"desc";return new Pu(a.field,l)}));const t=s.endAt?new jl(s.endAt.position,s.endAt.inclusive):null,i=s.startAt?new jl(s.startAt.position,s.startAt.inclusive):null;return _y(s.path,s.collectionGroup,e,s.filters,s.limit,t,i)}}function by(s,e){const t=s.filters.concat([e]);return new $l(s.path,s.collectionGroup,s.explicitOrderBy.slice(),t,s.limit,s.limitType,s.startAt,s.endAt)}function NO(s,e){const t=s.explicitOrderBy.concat([e]);return new $l(s.path,s.collectionGroup,t,s.filters.slice(),s.limit,s.limitType,s.startAt,s.endAt)}function jf(s,e,t){return new $l(s.path,s.collectionGroup,s.explicitOrderBy.slice(),s.filters.slice(),e,t,s.startAt,s.endAt)}function um(s,e){return Xu(Hn(s),Hn(e))&&s.limitType===e.limitType}function tw(s){return`${no(Hn(s))}|lt:${s.limitType}`}function hl(s){return`Query(target=${(function(t){let i=t.path.canonicalString();return t.collectionGroup!==null&&(i+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(i+=`, filters: [${t.filters.map((a=>YS(a))).join(", ")}]`),im(t.limit)||(i+=", limit: "+t.limit),t.orderBy.length>0&&(i+=`, orderBy: [${t.orderBy.map((a=>(function(u){return`${u.field.canonicalString()} (${u.dir})`})(a))).join(", ")}]`),t.startAt&&(i+=", startAt: ",i+=t.startAt.inclusive?"b:":"a:",i+=t.startAt.position.map((a=>Nl(a))).join(",")),t.endAt&&(i+=", endAt: ",i+=t.endAt.inclusive?"a:":"b:",i+=t.endAt.position.map((a=>Nl(a))).join(",")),`Target(${i})`})(Hn(s))}; limitType=${s.limitType})`}function Ju(s,e){return e.isFoundDocument()&&(function(i,a){const l=a.key.path;return i.collectionGroup!==null?a.key.hasCollectionId(i.collectionGroup)&&i.path.isPrefixOf(l):me.isDocumentKey(i.path)?i.path.isEqual(l):i.path.isImmediateParentOf(l)})(s,e)&&(function(i,a){for(const l of Eu(i))if(!l.field.isKeyField()&&a.data.field(l.field)===null)return!1;return!0})(s,e)&&(function(i,a){for(const l of i.filters)if(!l.matches(a))return!1;return!0})(s,e)&&(function(i,a){return!(i.startAt&&!(function(u,f,p){const y=OT(u,f,p);return u.inclusive?y<=0:y<0})(i.startAt,Eu(i),a)||i.endAt&&!(function(u,f,p){const y=OT(u,f,p);return u.inclusive?y>=0:y>0})(i.endAt,Eu(i),a))})(s,e)}function nw(s){return s.collectionGroup||(s.path.length%2==1?s.path.lastSegment():s.path.get(s.path.length-2))}function iw(s){return(e,t)=>{let i=!1;for(const a of Eu(s)){const l=jO(a,e,t);if(l!==0)return l;i=i||a.field.isKeyField()}return 0}}function jO(s,e,t){const i=s.field.isKeyField()?me.comparator(e.key,t.key):(function(l,u,f){const p=u.data.field(l),y=f.data.field(l);return p!==null&&y!==null?Yr(p,y):ve(42886)})(s.field,e,t);switch(s.dir){case"asc":return i;case"desc":return-1*i;default:return ve(19790,{direction:s.dir})}}class Ws{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),i=this.inner[t];if(i!==void 0){for(const[a,l]of i)if(this.equalsFn(a,e))return l}}has(e){return this.get(e)!==void 0}set(e,t){const i=this.mapKeyFn(e),a=this.inner[i];if(a===void 0)return this.inner[i]=[[e,t]],void this.innerSize++;for(let l=0;l<a.length;l++)if(this.equalsFn(a[l][0],e))return void(a[l]=[e,t]);a.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),i=this.inner[t];if(i===void 0)return!1;for(let a=0;a<i.length;a++)if(this.equalsFn(i[a][0],e))return i.length===1?delete this.inner[t]:i.splice(a,1),this.innerSize--,!0;return!1}forEach(e){na(this.inner,((t,i)=>{for(const[a,l]of i)e(a,l)}))}isEmpty(){return VS(this.inner)}size(){return this.innerSize}}const kO=new dt(me.comparator);function qn(){return kO}const sw=new dt(me.comparator);function uu(...s){let e=sw;for(const t of s)e=e.insert(t.key,t);return e}function rw(s){let e=sw;return s.forEach(((t,i)=>e=e.insert(t,i.overlayedDocument))),e}function is(){return Tu()}function aw(){return Tu()}function Tu(){return new Ws((s=>s.toString()),((s,e)=>s.isEqual(e)))}const OO=new dt(me.comparator),MO=new rt(me.comparator);function Pe(...s){let e=MO;for(const t of s)e=e.add(t);return e}const VO=new rt(De);function uv(){return VO}function hv(s,e){if(s.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Ru(e)?"-0":e}}function ow(s){return{integerValue:""+s}}function PO(s,e){return wS(e)?ow(e):hv(s,e)}class hm{constructor(){this._=void 0}}function LO(s,e,t){return s instanceof Ol?(function(a,l){const u={fields:{[US]:{stringValue:LS},[BS]:{timestampValue:{seconds:a.seconds,nanos:a.nanoseconds}}}};return l&&av(l)&&(l=om(l)),l&&(u.fields[zS]=l),{mapValue:u}})(t,e):s instanceof Ml?cw(s,e):s instanceof Vl?uw(s,e):(function(a,l){const u=lw(a,l),f=UT(u)+UT(a.Ae);return gy(u)&&gy(a.Ae)?ow(f):hv(a.serializer,f)})(s,e)}function UO(s,e,t){return s instanceof Ml?cw(s,e):s instanceof Vl?uw(s,e):t}function lw(s,e){return s instanceof Lu?(function(i){return gy(i)||(function(l){return!!l&&"doubleValue"in l})(i)})(e)?e:{integerValue:0}:null}class Ol extends hm{}class Ml extends hm{constructor(e){super(),this.elements=e}}function cw(s,e){const t=hw(e);for(const i of s.elements)t.some((a=>us(a,i)))||t.push(i);return{arrayValue:{values:t}}}class Vl extends hm{constructor(e){super(),this.elements=e}}function uw(s,e){let t=hw(e);for(const i of s.elements)t=t.filter((a=>!us(a,i)));return{arrayValue:{values:t}}}class Lu extends hm{constructor(e,t){super(),this.serializer=e,this.Ae=t}}function UT(s){return Et(s.integerValue||s.doubleValue)}function hw(s){return Vu(s)&&s.arrayValue.values?s.arrayValue.values.slice():[]}class dw{constructor(e,t){this.field=e,this.transform=t}}function zO(s,e){return s.field.isEqual(e.field)&&(function(i,a){return i instanceof Ml&&a instanceof Ml||i instanceof Vl&&a instanceof Vl?Sl(i.elements,a.elements,us):i instanceof Lu&&a instanceof Lu?us(i.Ae,a.Ae):i instanceof Ol&&a instanceof Ol})(s.transform,e.transform)}class BO{constructor(e,t){this.version=e,this.transformResults=t}}class Gt{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new Gt}static exists(e){return new Gt(void 0,e)}static updateTime(e){return new Gt(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function uf(s,e){return s.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(s.updateTime):s.exists===void 0||s.exists===e.isFoundDocument()}class dm{}function fw(s,e){if(!s.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return s.isNoDocument()?new Zu(s.key,Gt.none()):new Wl(s.key,s.data,Gt.none());{const t=s.data,i=dn.empty();let a=new rt(xt.comparator);for(let l of e.fields)if(!a.has(l)){let u=t.field(l);u===null&&l.length>1&&(l=l.popLast(),u=t.field(l)),u===null?i.delete(l):i.set(l,u),a=a.add(l)}return new Ys(s.key,i,new Cn(a.toArray()),Gt.none())}}function FO(s,e,t){s instanceof Wl?(function(a,l,u){const f=a.value.clone(),p=BT(a.fieldTransforms,l,u.transformResults);f.setAll(p),l.convertToFoundDocument(u.version,f).setHasCommittedMutations()})(s,e,t):s instanceof Ys?(function(a,l,u){if(!uf(a.precondition,l))return void l.convertToUnknownDocument(u.version);const f=BT(a.fieldTransforms,l,u.transformResults),p=l.data;p.setAll(mw(a)),p.setAll(f),l.convertToFoundDocument(u.version,p).setHasCommittedMutations()})(s,e,t):(function(a,l,u){l.convertToNoDocument(u.version).setHasCommittedMutations()})(0,e,t)}function xu(s,e,t,i){return s instanceof Wl?(function(l,u,f,p){if(!uf(l.precondition,u))return f;const y=l.value.clone(),_=FT(l.fieldTransforms,p,u);return y.setAll(_),u.convertToFoundDocument(u.version,y).setHasLocalMutations(),null})(s,e,t,i):s instanceof Ys?(function(l,u,f,p){if(!uf(l.precondition,u))return f;const y=FT(l.fieldTransforms,p,u),_=u.data;return _.setAll(mw(l)),_.setAll(y),u.convertToFoundDocument(u.version,_).setHasLocalMutations(),f===null?null:f.unionWith(l.fieldMask.fields).unionWith(l.fieldTransforms.map((b=>b.field)))})(s,e,t,i):(function(l,u,f){return uf(l.precondition,u)?(u.convertToNoDocument(u.version).setHasLocalMutations(),null):f})(s,e,t)}function qO(s,e){let t=null;for(const i of s.fieldTransforms){const a=e.data.field(i.field),l=lw(i.transform,a||null);l!=null&&(t===null&&(t=dn.empty()),t.set(i.field,l))}return t||null}function zT(s,e){return s.type===e.type&&!!s.key.isEqual(e.key)&&!!s.precondition.isEqual(e.precondition)&&!!(function(i,a){return i===void 0&&a===void 0||!(!i||!a)&&Sl(i,a,((l,u)=>zO(l,u)))})(s.fieldTransforms,e.fieldTransforms)&&(s.type===0?s.value.isEqual(e.value):s.type!==1||s.data.isEqual(e.data)&&s.fieldMask.isEqual(e.fieldMask))}class Wl extends dm{constructor(e,t,i,a=[]){super(),this.key=e,this.value=t,this.precondition=i,this.fieldTransforms=a,this.type=0}getFieldMask(){return null}}class Ys extends dm{constructor(e,t,i,a,l=[]){super(),this.key=e,this.data=t,this.fieldMask=i,this.precondition=a,this.fieldTransforms=l,this.type=1}getFieldMask(){return this.fieldMask}}function mw(s){const e=new Map;return s.fieldMask.fields.forEach((t=>{if(!t.isEmpty()){const i=s.data.field(t);e.set(t,i)}})),e}function BT(s,e,t){const i=new Map;xe(s.length===t.length,32656,{Ve:t.length,de:s.length});for(let a=0;a<t.length;a++){const l=s[a],u=l.transform,f=e.data.field(l.field);i.set(l.field,UO(u,f,t[a]))}return i}function FT(s,e,t){const i=new Map;for(const a of s){const l=a.transform,u=t.data.field(a.field);i.set(a.field,LO(l,u,e))}return i}class Zu extends dm{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class pw extends dm{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}class dv{constructor(e,t,i,a){this.batchId=e,this.localWriteTime=t,this.baseMutations=i,this.mutations=a}applyToRemoteDocument(e,t){const i=t.mutationResults;for(let a=0;a<this.mutations.length;a++){const l=this.mutations[a];l.key.isEqual(e.key)&&FO(l,e,i[a])}}applyToLocalView(e,t){for(const i of this.baseMutations)i.key.isEqual(e.key)&&(t=xu(i,e,t,this.localWriteTime));for(const i of this.mutations)i.key.isEqual(e.key)&&(t=xu(i,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const i=aw();return this.mutations.forEach((a=>{const l=e.get(a.key),u=l.overlayedDocument;let f=this.applyToLocalView(u,l.mutatedFields);f=t.has(a.key)?null:f;const p=fw(u,f);p!==null&&i.set(a.key,p),u.isValidDocument()||u.convertToNoDocument(Ae.min())})),i}keys(){return this.mutations.reduce(((e,t)=>e.add(t.key)),Pe())}isEqual(e){return this.batchId===e.batchId&&Sl(this.mutations,e.mutations,((t,i)=>zT(t,i)))&&Sl(this.baseMutations,e.baseMutations,((t,i)=>zT(t,i)))}}class fv{constructor(e,t,i,a){this.batch=e,this.commitVersion=t,this.mutationResults=i,this.docVersions=a}static from(e,t,i){xe(e.mutations.length===i.length,58842,{me:e.mutations.length,fe:i.length});let a=(function(){return OO})();const l=e.mutations;for(let u=0;u<l.length;u++)a=a.insert(l[u].key,i[u].version);return new fv(e,t,i,a)}}class mv{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}class HO{constructor(e,t){this.count=e,this.unchangedNames=t}}var Bt,Ke;function GO(s){switch(s){case te.OK:return ve(64938);case te.CANCELLED:case te.UNKNOWN:case te.DEADLINE_EXCEEDED:case te.RESOURCE_EXHAUSTED:case te.INTERNAL:case te.UNAVAILABLE:case te.UNAUTHENTICATED:return!1;case te.INVALID_ARGUMENT:case te.NOT_FOUND:case te.ALREADY_EXISTS:case te.PERMISSION_DENIED:case te.FAILED_PRECONDITION:case te.ABORTED:case te.OUT_OF_RANGE:case te.UNIMPLEMENTED:case te.DATA_LOSS:return!0;default:return ve(15467,{code:s})}}function gw(s){if(s===void 0)return Nt("GRPC error has no .code"),te.UNKNOWN;switch(s){case Bt.OK:return te.OK;case Bt.CANCELLED:return te.CANCELLED;case Bt.UNKNOWN:return te.UNKNOWN;case Bt.DEADLINE_EXCEEDED:return te.DEADLINE_EXCEEDED;case Bt.RESOURCE_EXHAUSTED:return te.RESOURCE_EXHAUSTED;case Bt.INTERNAL:return te.INTERNAL;case Bt.UNAVAILABLE:return te.UNAVAILABLE;case Bt.UNAUTHENTICATED:return te.UNAUTHENTICATED;case Bt.INVALID_ARGUMENT:return te.INVALID_ARGUMENT;case Bt.NOT_FOUND:return te.NOT_FOUND;case Bt.ALREADY_EXISTS:return te.ALREADY_EXISTS;case Bt.PERMISSION_DENIED:return te.PERMISSION_DENIED;case Bt.FAILED_PRECONDITION:return te.FAILED_PRECONDITION;case Bt.ABORTED:return te.ABORTED;case Bt.OUT_OF_RANGE:return te.OUT_OF_RANGE;case Bt.UNIMPLEMENTED:return te.UNIMPLEMENTED;case Bt.DATA_LOSS:return te.DATA_LOSS;default:return ve(39323,{code:s})}}(Ke=Bt||(Bt={}))[Ke.OK=0]="OK",Ke[Ke.CANCELLED=1]="CANCELLED",Ke[Ke.UNKNOWN=2]="UNKNOWN",Ke[Ke.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Ke[Ke.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Ke[Ke.NOT_FOUND=5]="NOT_FOUND",Ke[Ke.ALREADY_EXISTS=6]="ALREADY_EXISTS",Ke[Ke.PERMISSION_DENIED=7]="PERMISSION_DENIED",Ke[Ke.UNAUTHENTICATED=16]="UNAUTHENTICATED",Ke[Ke.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Ke[Ke.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Ke[Ke.ABORTED=10]="ABORTED",Ke[Ke.OUT_OF_RANGE=11]="OUT_OF_RANGE",Ke[Ke.UNIMPLEMENTED=12]="UNIMPLEMENTED",Ke[Ke.INTERNAL=13]="INTERNAL",Ke[Ke.UNAVAILABLE=14]="UNAVAILABLE",Ke[Ke.DATA_LOSS=15]="DATA_LOSS";function QO(){return new TextEncoder}const KO=new Gr([4294967295,4294967295],0);function qT(s){const e=QO().encode(s),t=new uS;return t.update(e),new Uint8Array(t.digest())}function HT(s){const e=new DataView(s.buffer),t=e.getUint32(0,!0),i=e.getUint32(4,!0),a=e.getUint32(8,!0),l=e.getUint32(12,!0);return[new Gr([t,i],0),new Gr([a,l],0)]}class pv{constructor(e,t,i){if(this.bitmap=e,this.padding=t,this.hashCount=i,t<0||t>=8)throw new hu(`Invalid padding: ${t}`);if(i<0)throw new hu(`Invalid hash count: ${i}`);if(e.length>0&&this.hashCount===0)throw new hu(`Invalid hash count: ${i}`);if(e.length===0&&t!==0)throw new hu(`Invalid padding when bitmap length is 0: ${t}`);this.ge=8*e.length-t,this.pe=Gr.fromNumber(this.ge)}ye(e,t,i){let a=e.add(t.multiply(Gr.fromNumber(i)));return a.compare(KO)===1&&(a=new Gr([a.getBits(0),a.getBits(1)],0)),a.modulo(this.pe).toNumber()}we(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.ge===0)return!1;const t=qT(e),[i,a]=HT(t);for(let l=0;l<this.hashCount;l++){const u=this.ye(i,a,l);if(!this.we(u))return!1}return!0}static create(e,t,i){const a=e%8==0?0:8-e%8,l=new Uint8Array(Math.ceil(e/8)),u=new pv(l,a,t);return i.forEach((f=>u.insert(f))),u}insert(e){if(this.ge===0)return;const t=qT(e),[i,a]=HT(t);for(let l=0;l<this.hashCount;l++){const u=this.ye(i,a,l);this.be(u)}}be(e){const t=Math.floor(e/8),i=e%8;this.bitmap[t]|=1<<i}}class hu extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}class eh{constructor(e,t,i,a,l){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=i,this.documentUpdates=a,this.resolvedLimboDocuments=l}static createSynthesizedRemoteEventForCurrentChange(e,t,i){const a=new Map;return a.set(e,th.createSynthesizedTargetChangeForCurrentChange(e,t,i)),new eh(Ae.min(),a,new dt(De),qn(),Pe())}}class th{constructor(e,t,i,a,l){this.resumeToken=e,this.current=t,this.addedDocuments=i,this.modifiedDocuments=a,this.removedDocuments=l}static createSynthesizedTargetChangeForCurrentChange(e,t,i){return new th(i,t,Pe(),Pe(),Pe())}}class hf{constructor(e,t,i,a){this.Se=e,this.removedTargetIds=t,this.key=i,this.De=a}}class yw{constructor(e,t){this.targetId=e,this.Ce=t}}class vw{constructor(e,t,i=kt.EMPTY_BYTE_STRING,a=null){this.state=e,this.targetIds=t,this.resumeToken=i,this.cause=a}}class GT{constructor(){this.ve=0,this.Fe=QT(),this.Me=kt.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return this.ve!==0}get Be(){return this.Oe}Le(e){e.approximateByteSize()>0&&(this.Oe=!0,this.Me=e)}ke(){let e=Pe(),t=Pe(),i=Pe();return this.Fe.forEach(((a,l)=>{switch(l){case 0:e=e.add(a);break;case 2:t=t.add(a);break;case 1:i=i.add(a);break;default:ve(38017,{changeType:l})}})),new th(this.Me,this.xe,e,t,i)}Ke(){this.Oe=!1,this.Fe=QT()}qe(e,t){this.Oe=!0,this.Fe=this.Fe.insert(e,t)}Ue(e){this.Oe=!0,this.Fe=this.Fe.remove(e)}$e(){this.ve+=1}We(){this.ve-=1,xe(this.ve>=0,3241,{ve:this.ve})}Qe(){this.Oe=!0,this.xe=!0}}class $O{constructor(e){this.Ge=e,this.ze=new Map,this.je=qn(),this.He=Ud(),this.Je=Ud(),this.Ze=new dt(De)}Xe(e){for(const t of e.Se)e.De&&e.De.isFoundDocument()?this.Ye(t,e.De):this.et(t,e.key,e.De);for(const t of e.removedTargetIds)this.et(t,e.key,e.De)}tt(e){this.forEachTarget(e,(t=>{const i=this.nt(t);switch(e.state){case 0:this.rt(t)&&i.Le(e.resumeToken);break;case 1:i.We(),i.Ne||i.Ke(),i.Le(e.resumeToken);break;case 2:i.We(),i.Ne||this.removeTarget(t);break;case 3:this.rt(t)&&(i.Qe(),i.Le(e.resumeToken));break;case 4:this.rt(t)&&(this.it(t),i.Le(e.resumeToken));break;default:ve(56790,{state:e.state})}}))}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.ze.forEach(((i,a)=>{this.rt(a)&&t(a)}))}st(e){const t=e.targetId,i=e.Ce.count,a=this.ot(t);if(a){const l=a.target;if(Df(l))if(i===0){const u=new me(l.path);this.et(t,u,At.newNoDocument(u,Ae.min()))}else xe(i===1,20013,{expectedCount:i});else{const u=this._t(t);if(u!==i){const f=this.ut(e),p=f?this.ct(f,e,u):1;if(p!==0){this.it(t);const y=p===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ze=this.Ze.insert(t,y)}}}}}ut(e){const t=e.Ce.unchangedNames;if(!t||!t.bits)return null;const{bits:{bitmap:i="",padding:a=0},hashCount:l=0}=t;let u,f;try{u=Ks(i).toUint8Array()}catch(p){if(p instanceof PS)return xl("Decoding the base64 bloom filter in existence filter failed ("+p.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw p}try{f=new pv(u,a,l)}catch(p){return xl(p instanceof hu?"BloomFilter error: ":"Applying bloom filter failed: ",p),null}return f.ge===0?null:f}ct(e,t,i){return t.Ce.count===i-this.Pt(e,t.targetId)?0:2}Pt(e,t){const i=this.Ge.getRemoteKeysForTarget(t);let a=0;return i.forEach((l=>{const u=this.Ge.ht(),f=`projects/${u.projectId}/databases/${u.database}/documents/${l.path.canonicalString()}`;e.mightContain(f)||(this.et(t,l,null),a++)})),a}Tt(e){const t=new Map;this.ze.forEach(((l,u)=>{const f=this.ot(u);if(f){if(l.current&&Df(f.target)){const p=new me(f.target.path);this.It(p).has(u)||this.Et(u,p)||this.et(u,p,At.newNoDocument(p,e))}l.Be&&(t.set(u,l.ke()),l.Ke())}}));let i=Pe();this.Je.forEach(((l,u)=>{let f=!0;u.forEachWhile((p=>{const y=this.ot(p);return!y||y.purpose==="TargetPurposeLimboResolution"||(f=!1,!1)})),f&&(i=i.add(l))})),this.je.forEach(((l,u)=>u.setReadTime(e)));const a=new eh(e,t,this.Ze,this.je,i);return this.je=qn(),this.He=Ud(),this.Je=Ud(),this.Ze=new dt(De),a}Ye(e,t){if(!this.rt(e))return;const i=this.Et(e,t.key)?2:0;this.nt(e).qe(t.key,i),this.je=this.je.insert(t.key,t),this.He=this.He.insert(t.key,this.It(t.key).add(e)),this.Je=this.Je.insert(t.key,this.Rt(t.key).add(e))}et(e,t,i){if(!this.rt(e))return;const a=this.nt(e);this.Et(e,t)?a.qe(t,1):a.Ue(t),this.Je=this.Je.insert(t,this.Rt(t).delete(e)),this.Je=this.Je.insert(t,this.Rt(t).add(e)),i&&(this.je=this.je.insert(t,i))}removeTarget(e){this.ze.delete(e)}_t(e){const t=this.nt(e).ke();return this.Ge.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}$e(e){this.nt(e).$e()}nt(e){let t=this.ze.get(e);return t||(t=new GT,this.ze.set(e,t)),t}Rt(e){let t=this.Je.get(e);return t||(t=new rt(De),this.Je=this.Je.insert(e,t)),t}It(e){let t=this.He.get(e);return t||(t=new rt(De),this.He=this.He.insert(e,t)),t}rt(e){const t=this.ot(e)!==null;return t||ce("WatchChangeAggregator","Detected inactive target",e),t}ot(e){const t=this.ze.get(e);return t&&t.Ne?null:this.Ge.At(e)}it(e){this.ze.set(e,new GT),this.Ge.getRemoteKeysForTarget(e).forEach((t=>{this.et(e,t,null)}))}Et(e,t){return this.Ge.getRemoteKeysForTarget(e).has(t)}}function Ud(){return new dt(me.comparator)}function QT(){return new dt(me.comparator)}const WO={asc:"ASCENDING",desc:"DESCENDING"},YO={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},XO={and:"AND",or:"OR"};class JO{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function Ey(s,e){return s.useProto3Json||im(e)?e:{value:e}}function Pl(s,e){return s.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function _w(s,e){return s.useProto3Json?e.toBase64():e.toUint8Array()}function ZO(s,e){return Pl(s,e.toTimestamp())}function yn(s){return xe(!!s,49232),Ae.fromTimestamp((function(t){const i=Qs(t);return new it(i.seconds,i.nanos)})(s))}function gv(s,e){return Ty(s,e).canonicalString()}function Ty(s,e){const t=(function(a){return new Ze(["projects",a.projectId,"databases",a.database])})(s).child("documents");return e===void 0?t:t.child(e)}function bw(s){const e=Ze.fromString(s);return xe(Rw(e),10190,{key:e.toString()}),e}function kf(s,e){return gv(s.databaseId,e.path)}function $a(s,e){const t=bw(e);if(t.get(1)!==s.databaseId.projectId)throw new he(te.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+s.databaseId.projectId);if(t.get(3)!==s.databaseId.database)throw new he(te.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+s.databaseId.database);return new me(xw(t))}function Ew(s,e){return gv(s.databaseId,e)}function Tw(s){const e=bw(s);return e.length===4?Ze.emptyPath():xw(e)}function xy(s){return new Ze(["projects",s.databaseId.projectId,"databases",s.databaseId.database]).canonicalString()}function xw(s){return xe(s.length>4&&s.get(4)==="documents",29091,{key:s.toString()}),s.popFirst(5)}function KT(s,e,t){return{name:kf(s,e),fields:t.value.mapValue.fields}}function e4(s,e,t){const i=$a(s,e.name),a=yn(e.updateTime),l=e.createTime?yn(e.createTime):Ae.min(),u=new dn({mapValue:{fields:e.fields}}),f=At.newFoundDocument(i,a,l,u);return t&&f.setHasCommittedMutations(),t?f.setHasCommittedMutations():f}function t4(s,e){let t;if("targetChange"in e){e.targetChange;const i=(function(y){return y==="NO_CHANGE"?0:y==="ADD"?1:y==="REMOVE"?2:y==="CURRENT"?3:y==="RESET"?4:ve(39313,{state:y})})(e.targetChange.targetChangeType||"NO_CHANGE"),a=e.targetChange.targetIds||[],l=(function(y,_){return y.useProto3Json?(xe(_===void 0||typeof _=="string",58123),kt.fromBase64String(_||"")):(xe(_===void 0||_ instanceof Buffer||_ instanceof Uint8Array,16193),kt.fromUint8Array(_||new Uint8Array))})(s,e.targetChange.resumeToken),u=e.targetChange.cause,f=u&&(function(y){const _=y.code===void 0?te.UNKNOWN:gw(y.code);return new he(_,y.message||"")})(u);t=new vw(i,a,l,f||null)}else if("documentChange"in e){e.documentChange;const i=e.documentChange;i.document,i.document.name,i.document.updateTime;const a=$a(s,i.document.name),l=yn(i.document.updateTime),u=i.document.createTime?yn(i.document.createTime):Ae.min(),f=new dn({mapValue:{fields:i.document.fields}}),p=At.newFoundDocument(a,l,u,f),y=i.targetIds||[],_=i.removedTargetIds||[];t=new hf(y,_,p.key,p)}else if("documentDelete"in e){e.documentDelete;const i=e.documentDelete;i.document;const a=$a(s,i.document),l=i.readTime?yn(i.readTime):Ae.min(),u=At.newNoDocument(a,l),f=i.removedTargetIds||[];t=new hf([],f,u.key,u)}else if("documentRemove"in e){e.documentRemove;const i=e.documentRemove;i.document;const a=$a(s,i.document),l=i.removedTargetIds||[];t=new hf([],l,a,null)}else{if(!("filter"in e))return ve(11601,{Vt:e});{e.filter;const i=e.filter;i.targetId;const{count:a=0,unchangedNames:l}=i,u=new HO(a,l),f=i.targetId;t=new yw(f,u)}}return t}function Of(s,e){let t;if(e instanceof Wl)t={update:KT(s,e.key,e.value)};else if(e instanceof Zu)t={delete:kf(s,e.key)};else if(e instanceof Ys)t={update:KT(s,e.key,e.data),updateMask:o4(e.fieldMask)};else{if(!(e instanceof pw))return ve(16599,{dt:e.type});t={verify:kf(s,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map((i=>(function(l,u){const f=u.transform;if(f instanceof Ol)return{fieldPath:u.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(f instanceof Ml)return{fieldPath:u.field.canonicalString(),appendMissingElements:{values:f.elements}};if(f instanceof Vl)return{fieldPath:u.field.canonicalString(),removeAllFromArray:{values:f.elements}};if(f instanceof Lu)return{fieldPath:u.field.canonicalString(),increment:f.Ae};throw ve(20930,{transform:u.transform})})(0,i)))),e.precondition.isNone||(t.currentDocument=(function(a,l){return l.updateTime!==void 0?{updateTime:ZO(a,l.updateTime)}:l.exists!==void 0?{exists:l.exists}:ve(27497)})(s,e.precondition)),t}function Sy(s,e){const t=e.currentDocument?(function(l){return l.updateTime!==void 0?Gt.updateTime(yn(l.updateTime)):l.exists!==void 0?Gt.exists(l.exists):Gt.none()})(e.currentDocument):Gt.none(),i=e.updateTransforms?e.updateTransforms.map((a=>(function(u,f){let p=null;if("setToServerValue"in f)xe(f.setToServerValue==="REQUEST_TIME",16630,{proto:f}),p=new Ol;else if("appendMissingElements"in f){const _=f.appendMissingElements.values||[];p=new Ml(_)}else if("removeAllFromArray"in f){const _=f.removeAllFromArray.values||[];p=new Vl(_)}else"increment"in f?p=new Lu(u,f.increment):ve(16584,{proto:f});const y=xt.fromServerFormat(f.fieldPath);return new dw(y,p)})(s,a))):[];if(e.update){e.update.name;const a=$a(s,e.update.name),l=new dn({mapValue:{fields:e.update.fields}});if(e.updateMask){const u=(function(p){const y=p.fieldPaths||[];return new Cn(y.map((_=>xt.fromServerFormat(_))))})(e.updateMask);return new Ys(a,l,u,t,i)}return new Wl(a,l,t,i)}if(e.delete){const a=$a(s,e.delete);return new Zu(a,t)}if(e.verify){const a=$a(s,e.verify);return new pw(a,t)}return ve(1463,{proto:e})}function n4(s,e){return s&&s.length>0?(xe(e!==void 0,14353),s.map((t=>(function(a,l){let u=a.updateTime?yn(a.updateTime):yn(l);return u.isEqual(Ae.min())&&(u=yn(l)),new BO(u,a.transformResults||[])})(t,e)))):[]}function Sw(s,e){return{documents:[Ew(s,e.path)]}}function ww(s,e){const t={structuredQuery:{}},i=e.path;let a;e.collectionGroup!==null?(a=i,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(a=i.popLast(),t.structuredQuery.from=[{collectionId:i.lastSegment()}]),t.parent=Ew(s,a);const l=(function(y){if(y.length!==0)return Cw(st.create(y,"and"))})(e.filters);l&&(t.structuredQuery.where=l);const u=(function(y){if(y.length!==0)return y.map((_=>(function(x){return{field:dl(x.field),direction:s4(x.dir)}})(_)))})(e.orderBy);u&&(t.structuredQuery.orderBy=u);const f=Ey(s,e.limit);return f!==null&&(t.structuredQuery.limit=f),e.startAt&&(t.structuredQuery.startAt=(function(y){return{before:y.inclusive,values:y.position}})(e.startAt)),e.endAt&&(t.structuredQuery.endAt=(function(y){return{before:!y.inclusive,values:y.position}})(e.endAt)),{ft:t,parent:a}}function Aw(s){let e=Tw(s.parent);const t=s.structuredQuery,i=t.from?t.from.length:0;let a=null;if(i>0){xe(i===1,65062);const _=t.from[0];_.allDescendants?a=_.collectionId:e=e.child(_.collectionId)}let l=[];t.where&&(l=(function(b){const x=Iw(b);return x instanceof st&&cv(x)?x.getFilters():[x]})(t.where));let u=[];t.orderBy&&(u=(function(b){return b.map((x=>(function(M){return new Pu(fl(M.field),(function(V){switch(V){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}})(M.direction))})(x)))})(t.orderBy));let f=null;t.limit&&(f=(function(b){let x;return x=typeof b=="object"?b.value:b,im(x)?null:x})(t.limit));let p=null;t.startAt&&(p=(function(b){const x=!!b.before,k=b.values||[];return new jl(k,x)})(t.startAt));let y=null;return t.endAt&&(y=(function(b){const x=!b.before,k=b.values||[];return new jl(k,x)})(t.endAt)),ZS(e,a,u,l,f,"F",p,y)}function i4(s,e){const t=(function(a){switch(a){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return ve(28987,{purpose:a})}})(e.purpose);return t==null?null:{"goog-listen-tags":t}}function Iw(s){return s.unaryFilter!==void 0?(function(t){switch(t.unaryFilter.op){case"IS_NAN":const i=fl(t.unaryFilter.field);return qe.create(i,"==",{doubleValue:NaN});case"IS_NULL":const a=fl(t.unaryFilter.field);return qe.create(a,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const l=fl(t.unaryFilter.field);return qe.create(l,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const u=fl(t.unaryFilter.field);return qe.create(u,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return ve(61313);default:return ve(60726)}})(s):s.fieldFilter!==void 0?(function(t){return qe.create(fl(t.fieldFilter.field),(function(a){switch(a){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return ve(58110);default:return ve(50506)}})(t.fieldFilter.op),t.fieldFilter.value)})(s):s.compositeFilter!==void 0?(function(t){return st.create(t.compositeFilter.filters.map((i=>Iw(i))),(function(a){switch(a){case"AND":return"and";case"OR":return"or";default:return ve(1026)}})(t.compositeFilter.op))})(s):ve(30097,{filter:s})}function s4(s){return WO[s]}function r4(s){return YO[s]}function a4(s){return XO[s]}function dl(s){return{fieldPath:s.canonicalString()}}function fl(s){return xt.fromServerFormat(s.fieldPath)}function Cw(s){return s instanceof qe?(function(t){if(t.op==="=="){if(NT(t.value))return{unaryFilter:{field:dl(t.field),op:"IS_NAN"}};if(DT(t.value))return{unaryFilter:{field:dl(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(NT(t.value))return{unaryFilter:{field:dl(t.field),op:"IS_NOT_NAN"}};if(DT(t.value))return{unaryFilter:{field:dl(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:dl(t.field),op:r4(t.op),value:t.value}}})(s):s instanceof st?(function(t){const i=t.getFilters().map((a=>Cw(a)));return i.length===1?i[0]:{compositeFilter:{op:a4(t.op),filters:i}}})(s):ve(54877,{filter:s})}function o4(s){const e=[];return s.fields.forEach((t=>e.push(t.canonicalString()))),{fieldPaths:e}}function Rw(s){return s.length>=4&&s.get(0)==="projects"&&s.get(2)==="databases"}function Dw(s){return!!s&&typeof s._toProto=="function"&&s._protoValueType==="ProtoValue"}class zs{constructor(e,t,i,a,l=Ae.min(),u=Ae.min(),f=kt.EMPTY_BYTE_STRING,p=null){this.target=e,this.targetId=t,this.purpose=i,this.sequenceNumber=a,this.snapshotVersion=l,this.lastLimboFreeSnapshotVersion=u,this.resumeToken=f,this.expectedCount=p}withSequenceNumber(e){return new zs(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new zs(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new zs(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new zs(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}class Nw{constructor(e){this.yt=e}}function l4(s,e){let t;if(e.document)t=e4(s.yt,e.document,!!e.hasCommittedMutations);else if(e.noDocument){const i=me.fromSegments(e.noDocument.path),a=so(e.noDocument.readTime);t=At.newNoDocument(i,a),e.hasCommittedMutations&&t.setHasCommittedMutations()}else{if(!e.unknownDocument)return ve(56709);{const i=me.fromSegments(e.unknownDocument.path),a=so(e.unknownDocument.version);t=At.newUnknownDocument(i,a)}}return e.readTime&&t.setReadTime((function(a){const l=new it(a[0],a[1]);return Ae.fromTimestamp(l)})(e.readTime)),t}function $T(s,e){const t=e.key,i={prefixPath:t.getCollectionPath().popLast().toArray(),collectionGroup:t.collectionGroup,documentId:t.path.lastSegment(),readTime:Mf(e.readTime),hasCommittedMutations:e.hasCommittedMutations};if(e.isFoundDocument())i.document=(function(l,u){return{name:kf(l,u.key),fields:u.data.value.mapValue.fields,updateTime:Pl(l,u.version.toTimestamp()),createTime:Pl(l,u.createTime.toTimestamp())}})(s.yt,e);else if(e.isNoDocument())i.noDocument={path:t.path.toArray(),readTime:io(e.version)};else{if(!e.isUnknownDocument())return ve(57904,{document:e});i.unknownDocument={path:t.path.toArray(),version:io(e.version)}}return i}function Mf(s){const e=s.toTimestamp();return[e.seconds,e.nanoseconds]}function io(s){const e=s.toTimestamp();return{seconds:e.seconds,nanoseconds:e.nanoseconds}}function so(s){const e=new it(s.seconds,s.nanoseconds);return Ae.fromTimestamp(e)}function Fa(s,e){const t=(e.baseMutations||[]).map((l=>Sy(s.yt,l)));for(let l=0;l<e.mutations.length-1;++l){const u=e.mutations[l];if(l+1<e.mutations.length&&e.mutations[l+1].transform!==void 0){const f=e.mutations[l+1];u.updateTransforms=f.transform.fieldTransforms,e.mutations.splice(l+1,1),++l}}const i=e.mutations.map((l=>Sy(s.yt,l))),a=it.fromMillis(e.localWriteTimeMs);return new dv(e.batchId,a,t,i)}function du(s){const e=so(s.readTime),t=s.lastLimboFreeSnapshotVersion!==void 0?so(s.lastLimboFreeSnapshotVersion):Ae.min();let i;return i=(function(l){return l.documents!==void 0})(s.query)?(function(l){const u=l.documents.length;return xe(u===1,1966,{count:u}),Hn(cm(Tw(l.documents[0])))})(s.query):(function(l){return Hn(Aw(l))})(s.query),new zs(i,s.targetId,"TargetPurposeListen",s.lastListenSequenceNumber,e,t,kt.fromBase64String(s.resumeToken))}function jw(s,e){const t=io(e.snapshotVersion),i=io(e.lastLimboFreeSnapshotVersion);let a;a=Df(e.target)?Sw(s.yt,e.target):ww(s.yt,e.target).ft;const l=e.resumeToken.toBase64();return{targetId:e.targetId,canonicalId:no(e.target),readTime:t,resumeToken:l,lastListenSequenceNumber:e.sequenceNumber,lastLimboFreeSnapshotVersion:i,query:a}}function kw(s){const e=Aw({parent:s.parent,structuredQuery:s.structuredQuery});return s.limitType==="LAST"?jf(e,e.limit,"L"):e}function Ug(s,e){return new mv(e.largestBatchId,Sy(s.yt,e.overlayMutation))}function WT(s,e){const t=e.path.lastSegment();return[s,fn(e.path.popLast()),t]}function YT(s,e,t,i){return{indexId:s,uid:e,sequenceNumber:t,readTime:io(i.readTime),documentKey:fn(i.documentKey.path),largestBatchId:i.largestBatchId}}class c4{getBundleMetadata(e,t){return XT(e).get(t).next((i=>{if(i)return(function(l){return{id:l.bundleId,createTime:so(l.createTime),version:l.version}})(i)}))}saveBundleMetadata(e,t){return XT(e).put((function(a){return{bundleId:a.id,createTime:io(yn(a.createTime)),version:a.version}})(t))}getNamedQuery(e,t){return JT(e).get(t).next((i=>{if(i)return(function(l){return{name:l.name,query:kw(l.bundledQuery),readTime:so(l.readTime)}})(i)}))}saveNamedQuery(e,t){return JT(e).put((function(a){return{name:a.name,readTime:io(yn(a.readTime)),bundledQuery:a.bundledQuery}})(t))}}function XT(s){return Kt(s,sm)}function JT(s){return Kt(s,rm)}class fm{constructor(e,t){this.serializer=e,this.userId=t}static wt(e,t){const i=t.uid||"";return new fm(e,i)}getOverlay(e,t){return tu(e).get(WT(this.userId,t)).next((i=>i?Ug(this.serializer,i):null))}getOverlays(e,t){const i=is();return H.forEach(t,(a=>this.getOverlay(e,a).next((l=>{l!==null&&i.set(a,l)})))).next((()=>i))}saveOverlays(e,t,i){const a=[];return i.forEach(((l,u)=>{const f=new mv(t,u);a.push(this.bt(e,f))})),H.waitFor(a)}removeOverlaysForBatchId(e,t,i){const a=new Set;t.forEach((u=>a.add(fn(u.getCollectionPath()))));const l=[];return a.forEach((u=>{const f=IDBKeyRange.bound([this.userId,u,i],[this.userId,u,i+1],!1,!0);l.push(tu(e).X(fy,f))})),H.waitFor(l)}getOverlaysForCollection(e,t,i){const a=is(),l=fn(t),u=IDBKeyRange.bound([this.userId,l,i],[this.userId,l,Number.POSITIVE_INFINITY],!0);return tu(e).H(fy,u).next((f=>{for(const p of f){const y=Ug(this.serializer,p);a.set(y.getKey(),y)}return a}))}getOverlaysForCollectionGroup(e,t,i,a){const l=is();let u;const f=IDBKeyRange.bound([this.userId,t,i],[this.userId,t,Number.POSITIVE_INFINITY],!0);return tu(e).ee({index:NS,range:f},((p,y,_)=>{const b=Ug(this.serializer,y);l.size()<a||b.largestBatchId===u?(l.set(b.getKey(),b),u=b.largestBatchId):_.done()})).next((()=>l))}bt(e,t){return tu(e).put((function(a,l,u){const[f,p,y]=WT(l,u.mutation.key);return{userId:l,collectionPath:p,documentId:y,collectionGroup:u.mutation.key.getCollectionGroup(),largestBatchId:u.largestBatchId,overlayMutation:Of(a.yt,u.mutation)}})(this.serializer,this.userId,t))}}function tu(s){return Kt(s,am)}class u4{St(e){return Kt(e,sv)}getSessionToken(e){return this.St(e).get("sessionToken").next((t=>{const i=t?.value;return i?kt.fromUint8Array(i):kt.EMPTY_BYTE_STRING}))}setSessionToken(e,t){return this.St(e).put({name:"sessionToken",value:t.toUint8Array()})}}class qa{constructor(){}Dt(e,t){this.Ct(e,t),t.vt()}Ct(e,t){if("nullValue"in e)this.Ft(t,5);else if("booleanValue"in e)this.Ft(t,10),t.Mt(e.booleanValue?1:0);else if("integerValue"in e)this.Ft(t,15),t.Mt(Et(e.integerValue));else if("doubleValue"in e){const i=Et(e.doubleValue);isNaN(i)?this.Ft(t,13):(this.Ft(t,15),Ru(i)?t.Mt(0):t.Mt(i))}else if("timestampValue"in e){let i=e.timestampValue;this.Ft(t,20),typeof i=="string"&&(i=Qs(i)),t.xt(`${i.seconds||""}`),t.Mt(i.nanos||0)}else if("stringValue"in e)this.Ot(e.stringValue,t),this.Nt(t);else if("bytesValue"in e)this.Ft(t,30),t.Bt(Ks(e.bytesValue)),this.Nt(t);else if("referenceValue"in e)this.Lt(e.referenceValue,t);else if("geoPointValue"in e){const i=e.geoPointValue;this.Ft(t,45),t.Mt(i.latitude||0),t.Mt(i.longitude||0)}else"mapValue"in e?qS(e)?this.Ft(t,Number.MAX_SAFE_INTEGER):lm(e)?this.kt(e.mapValue,t):(this.Kt(e.mapValue,t),this.Nt(t)):"arrayValue"in e?(this.qt(e.arrayValue,t),this.Nt(t)):ve(19022,{Ut:e})}Ot(e,t){this.Ft(t,25),this.$t(e,t)}$t(e,t){t.xt(e)}Kt(e,t){const i=e.fields||{};this.Ft(t,55);for(const a of Object.keys(i))this.Ot(a,t),this.Ct(i[a],t)}kt(e,t){const i=e.fields||{};this.Ft(t,53);const a=Dl,l=i[a].arrayValue?.values?.length||0;this.Ft(t,15),t.Mt(Et(l)),this.Ot(a,t),this.Ct(i[a],t)}qt(e,t){const i=e.values||[];this.Ft(t,50);for(const a of i)this.Ct(a,t)}Lt(e,t){this.Ft(t,37),me.fromName(e).path.forEach((i=>{this.Ft(t,60),this.$t(i,t)}))}Ft(e,t){e.Mt(t)}Nt(e){e.Mt(2)}}qa.Wt=new qa;const rl=255;function h4(s){if(s===0)return 8;let e=0;return s>>4||(e+=4,s<<=4),s>>6||(e+=2,s<<=2),s>>7||(e+=1),e}function ZT(s){const e=64-(function(i){let a=0;for(let l=0;l<8;++l){const u=h4(255&i[l]);if(a+=u,u!==8)break}return a})(s);return Math.ceil(e/8)}class d4{constructor(){this.buffer=new Uint8Array(1024),this.position=0}Qt(e){const t=e[Symbol.iterator]();let i=t.next();for(;!i.done;)this.Gt(i.value),i=t.next();this.zt()}jt(e){const t=e[Symbol.iterator]();let i=t.next();for(;!i.done;)this.Ht(i.value),i=t.next();this.Jt()}Zt(e){for(const t of e){const i=t.charCodeAt(0);if(i<128)this.Gt(i);else if(i<2048)this.Gt(960|i>>>6),this.Gt(128|63&i);else if(t<"\uD800"||"\uDBFF"<t)this.Gt(480|i>>>12),this.Gt(128|63&i>>>6),this.Gt(128|63&i);else{const a=t.codePointAt(0);this.Gt(240|a>>>18),this.Gt(128|63&a>>>12),this.Gt(128|63&a>>>6),this.Gt(128|63&a)}}this.zt()}Xt(e){for(const t of e){const i=t.charCodeAt(0);if(i<128)this.Ht(i);else if(i<2048)this.Ht(960|i>>>6),this.Ht(128|63&i);else if(t<"\uD800"||"\uDBFF"<t)this.Ht(480|i>>>12),this.Ht(128|63&i>>>6),this.Ht(128|63&i);else{const a=t.codePointAt(0);this.Ht(240|a>>>18),this.Ht(128|63&a>>>12),this.Ht(128|63&a>>>6),this.Ht(128|63&a)}}this.Jt()}Yt(e){const t=this.en(e),i=ZT(t);this.tn(1+i),this.buffer[this.position++]=255&i;for(let a=t.length-i;a<t.length;++a)this.buffer[this.position++]=255&t[a]}nn(e){const t=this.en(e),i=ZT(t);this.tn(1+i),this.buffer[this.position++]=~(255&i);for(let a=t.length-i;a<t.length;++a)this.buffer[this.position++]=~(255&t[a])}rn(){this.sn(rl),this.sn(255)}_n(){this.an(rl),this.an(255)}reset(){this.position=0}seed(e){this.tn(e.length),this.buffer.set(e,this.position),this.position+=e.length}un(){return this.buffer.slice(0,this.position)}en(e){const t=(function(l){const u=new DataView(new ArrayBuffer(8));return u.setFloat64(0,l,!1),new Uint8Array(u.buffer)})(e),i=!!(128&t[0]);t[0]^=i?255:128;for(let a=1;a<t.length;++a)t[a]^=i?255:0;return t}Gt(e){const t=255&e;t===0?(this.sn(0),this.sn(255)):t===rl?(this.sn(rl),this.sn(0)):this.sn(t)}Ht(e){const t=255&e;t===0?(this.an(0),this.an(255)):t===rl?(this.an(rl),this.an(0)):this.an(e)}zt(){this.sn(0),this.sn(1)}Jt(){this.an(0),this.an(1)}sn(e){this.tn(1),this.buffer[this.position++]=e}an(e){this.tn(1),this.buffer[this.position++]=~e}tn(e){const t=e+this.position;if(t<=this.buffer.length)return;let i=2*this.buffer.length;i<t&&(i=t);const a=new Uint8Array(i);a.set(this.buffer),this.buffer=a}}class f4{constructor(e){this.cn=e}Bt(e){this.cn.Qt(e)}xt(e){this.cn.Zt(e)}Mt(e){this.cn.Yt(e)}vt(){this.cn.rn()}}class m4{constructor(e){this.cn=e}Bt(e){this.cn.jt(e)}xt(e){this.cn.Xt(e)}Mt(e){this.cn.nn(e)}vt(){this.cn._n()}}class nu{constructor(){this.cn=new d4,this.ascending=new f4(this.cn),this.descending=new m4(this.cn)}seed(e){this.cn.seed(e)}ln(e){return e===0?this.ascending:this.descending}un(){return this.cn.un()}reset(){this.cn.reset()}}class Ha{constructor(e,t,i,a){this.hn=e,this.Pn=t,this.Tn=i,this.In=a}En(){const e=this.In.length,t=e===0||this.In[e-1]===255?e+1:e,i=new Uint8Array(t);return i.set(this.In,0),t!==e?i.set([0],this.In.length):++i[i.length-1],new Ha(this.hn,this.Pn,this.Tn,i)}Rn(e,t,i){return{indexId:this.hn,uid:e,arrayValue:df(this.Tn),directionalValue:df(this.In),orderedDocumentKey:df(t),documentKey:i.path.toArray()}}An(e,t,i){const a=this.Rn(e,t,i);return[a.indexId,a.uid,a.arrayValue,a.directionalValue,a.orderedDocumentKey,a.documentKey]}}function kr(s,e){let t=s.hn-e.hn;return t!==0?t:(t=ex(s.Tn,e.Tn),t!==0?t:(t=ex(s.In,e.In),t!==0?t:me.comparator(s.Pn,e.Pn)))}function ex(s,e){for(let t=0;t<s.length&&t<e.length;++t){const i=s[t]-e[t];if(i!==0)return i}return s.length-e.length}function df(s){return T1()?(function(t){let i="";for(let a=0;a<t.length;a++)i+=String.fromCharCode(t[a]);return i})(s):s}function tx(s){return typeof s!="string"?s:(function(t){const i=new Uint8Array(t.length);for(let a=0;a<t.length;a++)i[a]=t.charCodeAt(a);return i})(s)}class nx{constructor(e){this.Vn=new rt(((t,i)=>xt.comparator(t.field,i.field))),this.collectionId=e.collectionGroup!=null?e.collectionGroup:e.path.lastSegment(),this.dn=e.orderBy,this.mn=[];for(const t of e.filters){const i=t;i.isInequality()?this.Vn=this.Vn.add(i):this.mn.push(i)}}get fn(){return this.Vn.size>1}gn(e){if(xe(e.collectionGroup===this.collectionId,49279),this.fn)return!1;const t=uy(e);if(t!==void 0&&!this.pn(t))return!1;const i=Ua(e);let a=new Set,l=0,u=0;for(;l<i.length&&this.pn(i[l]);++l)a=a.add(i[l].fieldPath.canonicalString());if(l===i.length)return!0;if(this.Vn.size>0){const f=this.Vn.getIterator().getNext();if(!a.has(f.field.canonicalString())){const p=i[l];if(!this.yn(f,p)||!this.wn(this.dn[u++],p))return!1}++l}for(;l<i.length;++l){const f=i[l];if(u>=this.dn.length||!this.wn(this.dn[u++],f))return!1}return!0}bn(){if(this.fn)return null;let e=new rt(xt.comparator);const t=[];for(const i of this.mn)if(!i.field.isKeyField())if(i.op==="array-contains"||i.op==="array-contains-any")t.push(new sf(i.field,2));else{if(e.has(i.field))continue;e=e.add(i.field),t.push(new sf(i.field,0))}for(const i of this.dn)i.field.isKeyField()||e.has(i.field)||(e=e.add(i.field),t.push(new sf(i.field,i.dir==="asc"?0:1)));return new wf(wf.UNKNOWN_ID,this.collectionId,t,Cu.empty())}pn(e){for(const t of this.mn)if(this.yn(t,e))return!0;return!1}yn(e,t){if(e===void 0||!e.field.isEqual(t.fieldPath))return!1;const i=e.op==="array-contains"||e.op==="array-contains-any";return t.kind===2===i}wn(e,t){return!!e.field.isEqual(t.fieldPath)&&(t.kind===0&&e.dir==="asc"||t.kind===1&&e.dir==="desc")}}function Ow(s){if(xe(s instanceof qe||s instanceof st,20012),s instanceof qe){if(s instanceof JS){const t=s.value.arrayValue?.values?.map((i=>qe.create(s.field,"==",i)))||[];return st.create(t,"or")}return s}const e=s.filters.map((t=>Ow(t)));return st.create(e,s.op)}function p4(s){if(s.getFilters().length===0)return[];const e=Iy(Ow(s));return xe(Mw(e),7391),wy(e)||Ay(e)?[e]:e.getFilters()}function wy(s){return s instanceof qe}function Ay(s){return s instanceof st&&cv(s)}function Mw(s){return wy(s)||Ay(s)||(function(t){if(t instanceof st&&yy(t)){for(const i of t.getFilters())if(!wy(i)&&!Ay(i))return!1;return!0}return!1})(s)}function Iy(s){if(xe(s instanceof qe||s instanceof st,34018),s instanceof qe)return s;if(s.filters.length===1)return Iy(s.filters[0]);const e=s.filters.map((i=>Iy(i)));let t=st.create(e,s.op);return t=Vf(t),Mw(t)?t:(xe(t instanceof st,64498),xe(kl(t),40251),xe(t.filters.length>1,57927),t.filters.reduce(((i,a)=>yv(i,a))))}function yv(s,e){let t;return xe(s instanceof qe||s instanceof st,38388),xe(e instanceof qe||e instanceof st,25473),t=s instanceof qe?e instanceof qe?(function(a,l){return st.create([a,l],"and")})(s,e):ix(s,e):e instanceof qe?ix(e,s):(function(a,l){if(xe(a.filters.length>0&&l.filters.length>0,48005),kl(a)&&kl(l))return WS(a,l.getFilters());const u=yy(a)?a:l,f=yy(a)?l:a,p=u.filters.map((y=>yv(y,f)));return st.create(p,"or")})(s,e),Vf(t)}function ix(s,e){if(kl(e))return WS(e,s.getFilters());{const t=e.filters.map((i=>yv(s,i)));return st.create(t,"or")}}function Vf(s){if(xe(s instanceof qe||s instanceof st,11850),s instanceof qe)return s;const e=s.getFilters();if(e.length===1)return Vf(e[0]);if(KS(s))return s;const t=e.map((a=>Vf(a))),i=[];return t.forEach((a=>{a instanceof qe?i.push(a):a instanceof st&&(a.op===s.op?i.push(...a.filters):i.push(a))})),i.length===1?i[0]:st.create(i,s.op)}class g4{constructor(){this.Sn=new vv}addToCollectionParentIndex(e,t){return this.Sn.add(t),H.resolve()}getCollectionParents(e,t){return H.resolve(this.Sn.getEntries(t))}addFieldIndex(e,t){return H.resolve()}deleteFieldIndex(e,t){return H.resolve()}deleteAllFieldIndexes(e){return H.resolve()}createTargetIndexes(e,t){return H.resolve()}getDocumentsMatchingTarget(e,t){return H.resolve(null)}getIndexType(e,t){return H.resolve(0)}getFieldIndexes(e,t){return H.resolve([])}getNextCollectionGroupToUpdate(e){return H.resolve(null)}getMinOffset(e,t){return H.resolve(Gn.min())}getMinOffsetFromCollectionGroup(e,t){return H.resolve(Gn.min())}updateCollectionGroup(e,t,i){return H.resolve()}updateIndexEntries(e,t){return H.resolve()}}class vv{constructor(){this.index={}}add(e){const t=e.lastSegment(),i=e.popLast(),a=this.index[t]||new rt(Ze.comparator),l=!a.has(i);return this.index[t]=a.add(i),l}has(e){const t=e.lastSegment(),i=e.popLast(),a=this.index[t];return a&&a.has(i)}getEntries(e){return(this.index[e]||new rt(Ze.comparator)).toArray()}}const sx="IndexedDbIndexManager",zd=new Uint8Array(0);class y4{constructor(e,t){this.databaseId=t,this.Dn=new vv,this.Cn=new Ws((i=>no(i)),((i,a)=>Xu(i,a))),this.uid=e.uid||""}addToCollectionParentIndex(e,t){if(!this.Dn.has(t)){const i=t.lastSegment(),a=t.popLast();e.addOnCommittedListener((()=>{this.Dn.add(t)}));const l={collectionId:i,parent:fn(a)};return rx(e).put(l)}return H.resolve()}getCollectionParents(e,t){const i=[],a=IDBKeyRange.bound([t,""],[yS(t),""],!1,!0);return rx(e).H(a).next((l=>{for(const u of l){if(u.collectionId!==t)break;i.push(ns(u.parent))}return i}))}addFieldIndex(e,t){const i=iu(e),a=(function(f){return{indexId:f.indexId,collectionGroup:f.collectionGroup,fields:f.fields.map((p=>[p.fieldPath.canonicalString(),p.kind]))}})(t);delete a.indexId;const l=i.add(a);if(t.indexState){const u=ol(e);return l.next((f=>{u.put(YT(f,this.uid,t.indexState.sequenceNumber,t.indexState.offset))}))}return l.next()}deleteFieldIndex(e,t){const i=iu(e),a=ol(e),l=al(e);return i.delete(t.indexId).next((()=>a.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0)))).next((()=>l.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0))))}deleteAllFieldIndexes(e){const t=iu(e),i=al(e),a=ol(e);return t.X().next((()=>i.X())).next((()=>a.X()))}createTargetIndexes(e,t){return H.forEach(this.vn(t),(i=>this.getIndexType(e,i).next((a=>{if(a===0||a===1){const l=new nx(i).bn();if(l!=null)return this.addFieldIndex(e,l)}}))))}getDocumentsMatchingTarget(e,t){const i=al(e);let a=!0;const l=new Map;return H.forEach(this.vn(t),(u=>this.Fn(e,u).next((f=>{a&&(a=!!f),l.set(u,f)})))).next((()=>{if(a){let u=Pe();const f=[];return H.forEach(l,((p,y)=>{ce(sx,`Using index ${(function(Y){return`id=${Y.indexId}|cg=${Y.collectionGroup}|f=${Y.fields.map((ie=>`${ie.fieldPath}:${ie.kind}`)).join(",")}`})(p)} to execute ${no(t)}`);const _=(function(Y,ie){const F=uy(ie);if(F===void 0)return null;for(const J of Nf(Y,F.fieldPath))switch(J.op){case"array-contains-any":return J.value.arrayValue.values||[];case"array-contains":return[J.value]}return null})(y,p),b=(function(Y,ie){const F=new Map;for(const J of Ua(ie))for(const C of Nf(Y,J.fieldPath))switch(C.op){case"==":case"in":F.set(J.fieldPath.canonicalString(),C.value);break;case"not-in":case"!=":return F.set(J.fieldPath.canonicalString(),C.value),Array.from(F.values())}return null})(y,p),x=(function(Y,ie){const F=[];let J=!0;for(const C of Ua(ie)){const R=C.kind===0?VT(Y,C.fieldPath,Y.startAt):PT(Y,C.fieldPath,Y.startAt);F.push(R.value),J&&(J=R.inclusive)}return new jl(F,J)})(y,p),k=(function(Y,ie){const F=[];let J=!0;for(const C of Ua(ie)){const R=C.kind===0?PT(Y,C.fieldPath,Y.endAt):VT(Y,C.fieldPath,Y.endAt);F.push(R.value),J&&(J=R.inclusive)}return new jl(F,J)})(y,p),M=this.Mn(p,y,x),j=this.Mn(p,y,k),V=this.xn(p,y,b),ee=this.On(p.indexId,_,M,x.inclusive,j,k.inclusive,V);return H.forEach(ee,(ne=>i.Z(ne,t.limit).next((Y=>{Y.forEach((ie=>{const F=me.fromSegments(ie.documentKey);u.has(F)||(u=u.add(F),f.push(F))}))}))))})).next((()=>f))}return H.resolve(null)}))}vn(e){let t=this.Cn.get(e);return t||(e.filters.length===0?t=[e]:t=p4(st.create(e.filters,"and")).map((i=>_y(e.path,e.collectionGroup,e.orderBy,i.getFilters(),e.limit,e.startAt,e.endAt))),this.Cn.set(e,t),t)}On(e,t,i,a,l,u,f){const p=(t!=null?t.length:1)*Math.max(i.length,l.length),y=p/(t!=null?t.length:1),_=[];for(let b=0;b<p;++b){const x=t?this.Nn(t[b/y]):zd,k=this.Bn(e,x,i[b%y],a),M=this.Ln(e,x,l[b%y],u),j=f.map((V=>this.Bn(e,x,V,!0)));_.push(...this.createRange(k,M,j))}return _}Bn(e,t,i,a){const l=new Ha(e,me.empty(),t,i);return a?l:l.En()}Ln(e,t,i,a){const l=new Ha(e,me.empty(),t,i);return a?l.En():l}Fn(e,t){const i=new nx(t),a=t.collectionGroup!=null?t.collectionGroup:t.path.lastSegment();return this.getFieldIndexes(e,a).next((l=>{let u=null;for(const f of l)i.gn(f)&&(!u||f.fields.length>u.fields.length)&&(u=f);return u}))}getIndexType(e,t){let i=2;const a=this.vn(t);return H.forEach(a,(l=>this.Fn(e,l).next((u=>{u?i!==0&&u.fields.length<(function(p){let y=new rt(xt.comparator),_=!1;for(const b of p.filters)for(const x of b.getFlattenedFilters())x.field.isKeyField()||(x.op==="array-contains"||x.op==="array-contains-any"?_=!0:y=y.add(x.field));for(const b of p.orderBy)b.field.isKeyField()||(y=y.add(b.field));return y.size+(_?1:0)})(l)&&(i=1):i=0})))).next((()=>(function(u){return u.limit!==null})(t)&&a.length>1&&i===2?1:i))}kn(e,t){const i=new nu;for(const a of Ua(e)){const l=t.data.field(a.fieldPath);if(l==null)return null;const u=i.ln(a.kind);qa.Wt.Dt(l,u)}return i.un()}Nn(e){const t=new nu;return qa.Wt.Dt(e,t.ln(0)),t.un()}Kn(e,t){const i=new nu;return qa.Wt.Dt(Mu(this.databaseId,t),i.ln((function(l){const u=Ua(l);return u.length===0?0:u[u.length-1].kind})(e))),i.un()}xn(e,t,i){if(i===null)return[];let a=[];a.push(new nu);let l=0;for(const u of Ua(e)){const f=i[l++];for(const p of a)if(this.qn(t,u.fieldPath)&&Vu(f))a=this.Un(a,u,f);else{const y=p.ln(u.kind);qa.Wt.Dt(f,y)}}return this.$n(a)}Mn(e,t,i){return this.xn(e,t,i.position)}$n(e){const t=[];for(let i=0;i<e.length;++i)t[i]=e[i].un();return t}Un(e,t,i){const a=[...e],l=[];for(const u of i.arrayValue.values||[])for(const f of a){const p=new nu;p.seed(f.un()),qa.Wt.Dt(u,p.ln(t.kind)),l.push(p)}return l}qn(e,t){return!!e.filters.find((i=>i instanceof qe&&i.field.isEqual(t)&&(i.op==="in"||i.op==="not-in")))}getFieldIndexes(e,t){const i=iu(e),a=ol(e);return(t?i.H(dy,IDBKeyRange.bound(t,t)):i.H()).next((l=>{const u=[];return H.forEach(l,(f=>a.get([f.indexId,this.uid]).next((p=>{u.push((function(_,b){const x=b?new Cu(b.sequenceNumber,new Gn(so(b.readTime),new me(ns(b.documentKey)),b.largestBatchId)):Cu.empty(),k=_.fields.map((([M,j])=>new sf(xt.fromServerFormat(M),j)));return new wf(_.indexId,_.collectionGroup,k,x)})(f,p))})))).next((()=>u))}))}getNextCollectionGroupToUpdate(e){return this.getFieldIndexes(e).next((t=>t.length===0?null:(t.sort(((i,a)=>{const l=i.indexState.sequenceNumber-a.indexState.sequenceNumber;return l!==0?l:De(i.collectionGroup,a.collectionGroup)})),t[0].collectionGroup)))}updateCollectionGroup(e,t,i){const a=iu(e),l=ol(e);return this.Wn(e).next((u=>a.H(dy,IDBKeyRange.bound(t,t)).next((f=>H.forEach(f,(p=>l.put(YT(p.indexId,this.uid,u,i))))))))}updateIndexEntries(e,t){const i=new Map;return H.forEach(t,((a,l)=>{const u=i.get(a.collectionGroup);return(u?H.resolve(u):this.getFieldIndexes(e,a.collectionGroup)).next((f=>(i.set(a.collectionGroup,f),H.forEach(f,(p=>this.Qn(e,a,p).next((y=>{const _=this.Gn(l,p);return y.isEqual(_)?H.resolve():this.zn(e,l,p,y,_)})))))))}))}jn(e,t,i,a){return al(e).put(a.Rn(this.uid,this.Kn(i,t.key),t.key))}Hn(e,t,i,a){return al(e).delete(a.An(this.uid,this.Kn(i,t.key),t.key))}Qn(e,t,i){const a=al(e);let l=new rt(kr);return a.ee({index:DS,range:IDBKeyRange.only([i.indexId,this.uid,df(this.Kn(i,t))])},((u,f)=>{l=l.add(new Ha(i.indexId,t,tx(f.arrayValue),tx(f.directionalValue)))})).next((()=>l))}Gn(e,t){let i=new rt(kr);const a=this.kn(t,e);if(a==null)return i;const l=uy(t);if(l!=null){const u=e.data.field(l.fieldPath);if(Vu(u))for(const f of u.arrayValue.values||[])i=i.add(new Ha(t.indexId,e.key,this.Nn(f),a))}else i=i.add(new Ha(t.indexId,e.key,zd,a));return i}zn(e,t,i,a,l){ce(sx,"Updating index entries for document '%s'",t.key);const u=[];return(function(p,y,_,b,x){const k=p.getIterator(),M=y.getIterator();let j=sl(k),V=sl(M);for(;j||V;){let ee=!1,ne=!1;if(j&&V){const Y=_(j,V);Y<0?ne=!0:Y>0&&(ee=!0)}else j!=null?ne=!0:ee=!0;ee?(b(V),V=sl(M)):ne?(x(j),j=sl(k)):(j=sl(k),V=sl(M))}})(a,l,kr,(f=>{u.push(this.jn(e,t,i,f))}),(f=>{u.push(this.Hn(e,t,i,f))})),H.waitFor(u)}Wn(e){let t=1;return ol(e).ee({index:RS,reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},((i,a,l)=>{l.done(),t=a.sequenceNumber+1})).next((()=>t))}createRange(e,t,i){i=i.sort(((u,f)=>kr(u,f))).filter(((u,f,p)=>!f||kr(u,p[f-1])!==0));const a=[];a.push(e);for(const u of i){const f=kr(u,e),p=kr(u,t);if(f===0)a[0]=e.En();else if(f>0&&p<0)a.push(u),a.push(u.En());else if(p>0)break}a.push(t);const l=[];for(let u=0;u<a.length;u+=2){if(this.Jn(a[u],a[u+1]))return[];const f=a[u].An(this.uid,zd,me.empty()),p=a[u+1].An(this.uid,zd,me.empty());l.push(IDBKeyRange.bound(f,p))}return l}Jn(e,t){return kr(e,t)>0}getMinOffsetFromCollectionGroup(e,t){return this.getFieldIndexes(e,t).next(ax)}getMinOffset(e,t){return H.mapArray(this.vn(t),(i=>this.Fn(e,i).next((a=>a||ve(44426))))).next(ax)}}function rx(s){return Kt(s,ju)}function al(s){return Kt(s,_u)}function iu(s){return Kt(s,iv)}function ol(s){return Kt(s,vu)}function ax(s){xe(s.length!==0,28825);let e=s[0].indexState.offset,t=e.largestBatchId;for(let i=1;i<s.length;i++){const a=s[i].indexState.offset;ev(a,e)<0&&(e=a),t<a.largestBatchId&&(t=a.largestBatchId)}return new Gn(e.readTime,e.documentKey,t)}const ox={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},Vw=41943040;class hn{static withCacheSize(e){return new hn(e,hn.DEFAULT_COLLECTION_PERCENTILE,hn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,t,i){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=i}}function Pw(s,e,t){const i=s.store(xi),a=s.store(Al),l=[],u=IDBKeyRange.only(t.batchId);let f=0;const p=i.ee({range:u},((_,b,x)=>(f++,x.delete())));l.push(p.next((()=>{xe(f===1,47070,{batchId:t.batchId})})));const y=[];for(const _ of t.mutations){const b=AS(e,_.key.path,t.batchId);l.push(a.delete(b)),y.push(_.key)}return H.waitFor(l).next((()=>y))}function Pf(s){if(!s)return 0;let e;if(s.document)e=s.document;else if(s.unknownDocument)e=s.unknownDocument;else{if(!s.noDocument)throw ve(14731);e=s.noDocument}return JSON.stringify(e).length}hn.DEFAULT_COLLECTION_PERCENTILE=10,hn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,hn.DEFAULT=new hn(Vw,hn.DEFAULT_COLLECTION_PERCENTILE,hn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),hn.DISABLED=new hn(-1,0,0);class mm{constructor(e,t,i,a){this.userId=e,this.serializer=t,this.indexManager=i,this.referenceDelegate=a,this.Zn={}}static wt(e,t,i,a){xe(e.uid!=="",64387);const l=e.isAuthenticated()?e.uid:"";return new mm(l,t,i,a)}checkEmpty(e){let t=!0;const i=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return Or(e).ee({index:Ga,range:i},((a,l,u)=>{t=!1,u.done()})).next((()=>t))}addMutationBatch(e,t,i,a){const l=ml(e),u=Or(e);return u.add({}).next((f=>{xe(typeof f=="number",49019);const p=new dv(f,t,i,a),y=(function(k,M,j){const V=j.baseMutations.map((ne=>Of(k.yt,ne))),ee=j.mutations.map((ne=>Of(k.yt,ne)));return{userId:M,batchId:j.batchId,localWriteTimeMs:j.localWriteTime.toMillis(),baseMutations:V,mutations:ee}})(this.serializer,this.userId,p),_=[];let b=new rt(((x,k)=>De(x.canonicalString(),k.canonicalString())));for(const x of a){const k=AS(this.userId,x.key.path,f);b=b.add(x.key.path.popLast()),_.push(u.put(y)),_.push(l.put(k,Qk))}return b.forEach((x=>{_.push(this.indexManager.addToCollectionParentIndex(e,x))})),e.addOnCommittedListener((()=>{this.Zn[f]=p.keys()})),H.waitFor(_).next((()=>p))}))}lookupMutationBatch(e,t){return Or(e).get(t).next((i=>i?(xe(i.userId===this.userId,48,"Unexpected user for mutation batch",{userId:i.userId,batchId:t}),Fa(this.serializer,i)):null))}Xn(e,t){return this.Zn[t]?H.resolve(this.Zn[t]):this.lookupMutationBatch(e,t).next((i=>{if(i){const a=i.keys();return this.Zn[t]=a,a}return null}))}getNextMutationBatchAfterBatchId(e,t){const i=t+1,a=IDBKeyRange.lowerBound([this.userId,i]);let l=null;return Or(e).ee({index:Ga,range:a},((u,f,p)=>{f.userId===this.userId&&(xe(f.batchId>=i,47524,{Yn:i}),l=Fa(this.serializer,f)),p.done()})).next((()=>l))}getHighestUnacknowledgedBatchId(e){const t=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]);let i=Qa;return Or(e).ee({index:Ga,range:t,reverse:!0},((a,l,u)=>{i=l.batchId,u.done()})).next((()=>i))}getAllMutationBatches(e){const t=IDBKeyRange.bound([this.userId,Qa],[this.userId,Number.POSITIVE_INFINITY]);return Or(e).H(Ga,t).next((i=>i.map((a=>Fa(this.serializer,a)))))}getAllMutationBatchesAffectingDocumentKey(e,t){const i=rf(this.userId,t.path),a=IDBKeyRange.lowerBound(i),l=[];return ml(e).ee({range:a},((u,f,p)=>{const[y,_,b]=u,x=ns(_);if(y===this.userId&&t.path.isEqual(x))return Or(e).get(b).next((k=>{if(!k)throw ve(61480,{er:u,batchId:b});xe(k.userId===this.userId,10503,"Unexpected user for mutation batch",{userId:k.userId,batchId:b}),l.push(Fa(this.serializer,k))}));p.done()})).next((()=>l))}getAllMutationBatchesAffectingDocumentKeys(e,t){let i=new rt(De);const a=[];return t.forEach((l=>{const u=rf(this.userId,l.path),f=IDBKeyRange.lowerBound(u),p=ml(e).ee({range:f},((y,_,b)=>{const[x,k,M]=y,j=ns(k);x===this.userId&&l.path.isEqual(j)?i=i.add(M):b.done()}));a.push(p)})),H.waitFor(a).next((()=>this.tr(e,i)))}getAllMutationBatchesAffectingQuery(e,t){const i=t.path,a=i.length+1,l=rf(this.userId,i),u=IDBKeyRange.lowerBound(l);let f=new rt(De);return ml(e).ee({range:u},((p,y,_)=>{const[b,x,k]=p,M=ns(x);b===this.userId&&i.isPrefixOf(M)?M.length===a&&(f=f.add(k)):_.done()})).next((()=>this.tr(e,f)))}tr(e,t){const i=[],a=[];return t.forEach((l=>{a.push(Or(e).get(l).next((u=>{if(u===null)throw ve(35274,{batchId:l});xe(u.userId===this.userId,9748,"Unexpected user for mutation batch",{userId:u.userId,batchId:l}),i.push(Fa(this.serializer,u))})))})),H.waitFor(a).next((()=>i))}removeMutationBatch(e,t){return Pw(e.le,this.userId,t).next((i=>(e.addOnCommittedListener((()=>{this.nr(t.batchId)})),H.forEach(i,(a=>this.referenceDelegate.markPotentiallyOrphaned(e,a))))))}nr(e){delete this.Zn[e]}performConsistencyCheck(e){return this.checkEmpty(e).next((t=>{if(!t)return H.resolve();const i=IDBKeyRange.lowerBound((function(u){return[u]})(this.userId)),a=[];return ml(e).ee({range:i},((l,u,f)=>{if(l[0]===this.userId){const p=ns(l[1]);a.push(p)}else f.done()})).next((()=>{xe(a.length===0,56720,{rr:a.map((l=>l.canonicalString()))})}))}))}containsKey(e,t){return Lw(e,this.userId,t)}ir(e){return Uw(e).get(this.userId).next((t=>t||{userId:this.userId,lastAcknowledgedBatchId:Qa,lastStreamToken:""}))}}function Lw(s,e,t){const i=rf(e,t.path),a=i[1],l=IDBKeyRange.lowerBound(i);let u=!1;return ml(s).ee({range:l,Y:!0},((f,p,y)=>{const[_,b,x]=f;_===e&&b===a&&(u=!0),y.done()})).next((()=>u))}function Or(s){return Kt(s,xi)}function ml(s){return Kt(s,Al)}function Uw(s){return Kt(s,Du)}class ro{constructor(e){this.sr=e}next(){return this.sr+=2,this.sr}static _r(){return new ro(0)}static ar(){return new ro(-1)}}class v4{constructor(e,t){this.referenceDelegate=e,this.serializer=t}allocateTargetId(e){return this.ur(e).next((t=>{const i=new ro(t.highestTargetId);return t.highestTargetId=i.next(),this.cr(e,t).next((()=>t.highestTargetId))}))}getLastRemoteSnapshotVersion(e){return this.ur(e).next((t=>Ae.fromTimestamp(new it(t.lastRemoteSnapshotVersion.seconds,t.lastRemoteSnapshotVersion.nanoseconds))))}getHighestSequenceNumber(e){return this.ur(e).next((t=>t.highestListenSequenceNumber))}setTargetsMetadata(e,t,i){return this.ur(e).next((a=>(a.highestListenSequenceNumber=t,i&&(a.lastRemoteSnapshotVersion=i.toTimestamp()),t>a.highestListenSequenceNumber&&(a.highestListenSequenceNumber=t),this.cr(e,a))))}addTargetData(e,t){return this.lr(e,t).next((()=>this.ur(e).next((i=>(i.targetCount+=1,this.hr(t,i),this.cr(e,i))))))}updateTargetData(e,t){return this.lr(e,t)}removeTargetData(e,t){return this.removeMatchingKeysForTargetId(e,t.targetId).next((()=>ll(e).delete(t.targetId))).next((()=>this.ur(e))).next((i=>(xe(i.targetCount>0,8065),i.targetCount-=1,this.cr(e,i))))}removeTargets(e,t,i){let a=0;const l=[];return ll(e).ee(((u,f)=>{const p=du(f);p.sequenceNumber<=t&&i.get(p.targetId)===null&&(a++,l.push(this.removeTargetData(e,p)))})).next((()=>H.waitFor(l))).next((()=>a))}forEachTarget(e,t){return ll(e).ee(((i,a)=>{const l=du(a);t(l)}))}ur(e){return lx(e).get(Cf).next((t=>(xe(t!==null,2888),t)))}cr(e,t){return lx(e).put(Cf,t)}lr(e,t){return ll(e).put(jw(this.serializer,t))}hr(e,t){let i=!1;return e.targetId>t.highestTargetId&&(t.highestTargetId=e.targetId,i=!0),e.sequenceNumber>t.highestListenSequenceNumber&&(t.highestListenSequenceNumber=e.sequenceNumber,i=!0),i}getTargetCount(e){return this.ur(e).next((t=>t.targetCount))}getTargetData(e,t){const i=no(t),a=IDBKeyRange.bound([i,Number.NEGATIVE_INFINITY],[i,Number.POSITIVE_INFINITY]);let l=null;return ll(e).ee({range:a,index:CS},((u,f,p)=>{const y=du(f);Xu(t,y.target)&&(l=y,p.done())})).next((()=>l))}addMatchingKeys(e,t,i){const a=[],l=Br(e);return t.forEach((u=>{const f=fn(u.path);a.push(l.put({targetId:i,path:f})),a.push(this.referenceDelegate.addReference(e,i,u))})),H.waitFor(a)}removeMatchingKeys(e,t,i){const a=Br(e);return H.forEach(t,(l=>{const u=fn(l.path);return H.waitFor([a.delete([i,u]),this.referenceDelegate.removeReference(e,i,l)])}))}removeMatchingKeysForTargetId(e,t){const i=Br(e),a=IDBKeyRange.bound([t],[t+1],!1,!0);return i.delete(a)}getMatchingKeysForTargetId(e,t){const i=IDBKeyRange.bound([t],[t+1],!1,!0),a=Br(e);let l=Pe();return a.ee({range:i,Y:!0},((u,f,p)=>{const y=ns(u[1]),_=new me(y);l=l.add(_)})).next((()=>l))}containsKey(e,t){const i=fn(t.path),a=IDBKeyRange.bound([i],[yS(i)],!1,!0);let l=0;return Br(e).ee({index:nv,Y:!0,range:a},(([u,f],p,y)=>{u!==0&&(l++,y.done())})).next((()=>l>0))}At(e,t){return ll(e).get(t).next((i=>i?du(i):null))}}function ll(s){return Kt(s,Il)}function lx(s){return Kt(s,Ka)}function Br(s){return Kt(s,Cl)}const cx="LruGarbageCollector",zw=1048576;function ux([s,e],[t,i]){const a=De(s,t);return a===0?De(e,i):a}class _4{constructor(e){this.Pr=e,this.buffer=new rt(ux),this.Tr=0}Ir(){return++this.Tr}Er(e){const t=[e,this.Ir()];if(this.buffer.size<this.Pr)this.buffer=this.buffer.add(t);else{const i=this.buffer.last();ux(t,i)<0&&(this.buffer=this.buffer.delete(i).add(t))}}get maxValue(){return this.buffer.last()[0]}}class Bw{constructor(e,t,i){this.garbageCollector=e,this.asyncQueue=t,this.localStore=i,this.Rr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Ar(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return this.Rr!==null}Ar(e){ce(cx,`Garbage collection scheduled in ${e}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,(async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(t){ta(t)?ce(cx,"Ignoring IndexedDB error during garbage collection: ",t):await ea(t)}await this.Ar(3e5)}))}}class b4{constructor(e,t){this.Vr=e,this.params=t}calculateTargetCount(e,t){return this.Vr.dr(e).next((i=>Math.floor(t/100*i)))}nthSequenceNumber(e,t){if(t===0)return H.resolve(In.ce);const i=new _4(t);return this.Vr.forEachTarget(e,(a=>i.Er(a.sequenceNumber))).next((()=>this.Vr.mr(e,(a=>i.Er(a))))).next((()=>i.maxValue))}removeTargets(e,t,i){return this.Vr.removeTargets(e,t,i)}removeOrphanedDocuments(e,t){return this.Vr.removeOrphanedDocuments(e,t)}collect(e,t){return this.params.cacheSizeCollectionThreshold===-1?(ce("LruGarbageCollector","Garbage collection skipped; disabled"),H.resolve(ox)):this.getCacheSize(e).next((i=>i<this.params.cacheSizeCollectionThreshold?(ce("LruGarbageCollector",`Garbage collection skipped; Cache size ${i} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),ox):this.gr(e,t)))}getCacheSize(e){return this.Vr.getCacheSize(e)}gr(e,t){let i,a,l,u,f,p,y;const _=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next((b=>(b>this.params.maximumSequenceNumbersToCollect?(ce("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${b}`),a=this.params.maximumSequenceNumbersToCollect):a=b,u=Date.now(),this.nthSequenceNumber(e,a)))).next((b=>(i=b,f=Date.now(),this.removeTargets(e,i,t)))).next((b=>(l=b,p=Date.now(),this.removeOrphanedDocuments(e,i)))).next((b=>(y=Date.now(),ul()<=Fe.DEBUG&&ce("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${u-_}ms
	Determined least recently used ${a} in `+(f-u)+`ms
	Removed ${l} targets in `+(p-f)+`ms
	Removed ${b} documents in `+(y-p)+`ms
Total Duration: ${y-_}ms`),H.resolve({didRun:!0,sequenceNumbersCollected:a,targetsRemoved:l,documentsRemoved:b}))))}}function Fw(s,e){return new b4(s,e)}class E4{constructor(e,t){this.db=e,this.garbageCollector=Fw(this,t)}dr(e){const t=this.pr(e);return this.db.getTargetCache().getTargetCount(e).next((i=>t.next((a=>i+a))))}pr(e){let t=0;return this.mr(e,(i=>{t++})).next((()=>t))}forEachTarget(e,t){return this.db.getTargetCache().forEachTarget(e,t)}mr(e,t){return this.yr(e,((i,a)=>t(a)))}addReference(e,t,i){return Bd(e,i)}removeReference(e,t,i){return Bd(e,i)}removeTargets(e,t,i){return this.db.getTargetCache().removeTargets(e,t,i)}markPotentiallyOrphaned(e,t){return Bd(e,t)}wr(e,t){return(function(a,l){let u=!1;return Uw(a).te((f=>Lw(a,f,l).next((p=>(p&&(u=!0),H.resolve(!p)))))).next((()=>u))})(e,t)}removeOrphanedDocuments(e,t){const i=this.db.getRemoteDocumentCache().newChangeBuffer(),a=[];let l=0;return this.yr(e,((u,f)=>{if(f<=t){const p=this.wr(e,u).next((y=>{if(!y)return l++,i.getEntry(e,u).next((()=>(i.removeEntry(u,Ae.min()),Br(e).delete((function(b){return[0,fn(b.path)]})(u)))))}));a.push(p)}})).next((()=>H.waitFor(a))).next((()=>i.apply(e))).next((()=>l))}removeTarget(e,t){const i=t.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,i)}updateLimboDocument(e,t){return Bd(e,t)}yr(e,t){const i=Br(e);let a,l=In.ce;return i.ee({index:nv},(([u,f],{path:p,sequenceNumber:y})=>{u===0?(l!==In.ce&&t(new me(ns(a)),l),l=y,a=p):l=In.ce})).next((()=>{l!==In.ce&&t(new me(ns(a)),l)}))}getCacheSize(e){return this.db.getRemoteDocumentCache().getSize(e)}}function Bd(s,e){return Br(s).put((function(i,a){return{targetId:0,path:fn(i.path),sequenceNumber:a}})(e,s.currentSequenceNumber))}class qw{constructor(){this.changes=new Ws((e=>e.toString()),((e,t)=>e.isEqual(t))),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,At.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const i=this.changes.get(t);return i!==void 0?H.resolve(i):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}class T4{constructor(e){this.serializer=e}setIndexManager(e){this.indexManager=e}addEntry(e,t,i){return Pa(e).put(i)}removeEntry(e,t,i){return Pa(e).delete((function(l,u){const f=l.path.toArray();return[f.slice(0,f.length-2),f[f.length-2],Mf(u),f[f.length-1]]})(t,i))}updateMetadata(e,t){return this.getMetadata(e).next((i=>(i.byteSize+=t,this.br(e,i))))}getEntry(e,t){let i=At.newInvalidDocument(t);return Pa(e).ee({index:af,range:IDBKeyRange.only(su(t))},((a,l)=>{i=this.Sr(t,l)})).next((()=>i))}Dr(e,t){let i={size:0,document:At.newInvalidDocument(t)};return Pa(e).ee({index:af,range:IDBKeyRange.only(su(t))},((a,l)=>{i={document:this.Sr(t,l),size:Pf(l)}})).next((()=>i))}getEntries(e,t){let i=qn();return this.Cr(e,t,((a,l)=>{const u=this.Sr(a,l);i=i.insert(a,u)})).next((()=>i))}vr(e,t){let i=qn(),a=new dt(me.comparator);return this.Cr(e,t,((l,u)=>{const f=this.Sr(l,u);i=i.insert(l,f),a=a.insert(l,Pf(u))})).next((()=>({documents:i,Fr:a})))}Cr(e,t,i){if(t.isEmpty())return H.resolve();let a=new rt(fx);t.forEach((p=>a=a.add(p)));const l=IDBKeyRange.bound(su(a.first()),su(a.last())),u=a.getIterator();let f=u.getNext();return Pa(e).ee({index:af,range:l},((p,y,_)=>{const b=me.fromSegments([...y.prefixPath,y.collectionGroup,y.documentId]);for(;f&&fx(f,b)<0;)i(f,null),f=u.getNext();f&&f.isEqual(b)&&(i(f,y),f=u.hasNext()?u.getNext():null),f?_.j(su(f)):_.done()})).next((()=>{for(;f;)i(f,null),f=u.hasNext()?u.getNext():null}))}getDocumentsMatchingQuery(e,t,i,a,l){const u=t.path,f=[u.popLast().toArray(),u.lastSegment(),Mf(i.readTime),i.documentKey.path.isEmpty()?"":i.documentKey.path.lastSegment()],p=[u.popLast().toArray(),u.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return Pa(e).H(IDBKeyRange.bound(f,p,!0)).next((y=>{l?.incrementDocumentReadCount(y.length);let _=qn();for(const b of y){const x=this.Sr(me.fromSegments(b.prefixPath.concat(b.collectionGroup,b.documentId)),b);x.isFoundDocument()&&(Ju(t,x)||a.has(x.key))&&(_=_.insert(x.key,x))}return _}))}getAllFromCollectionGroup(e,t,i,a){let l=qn();const u=dx(t,i),f=dx(t,Gn.max());return Pa(e).ee({index:IS,range:IDBKeyRange.bound(u,f,!0)},((p,y,_)=>{const b=this.Sr(me.fromSegments(y.prefixPath.concat(y.collectionGroup,y.documentId)),y);l=l.insert(b.key,b),l.size===a&&_.done()})).next((()=>l))}newChangeBuffer(e){return new x4(this,!!e&&e.trackRemovals)}getSize(e){return this.getMetadata(e).next((t=>t.byteSize))}getMetadata(e){return hx(e).get(hy).next((t=>(xe(!!t,20021),t)))}br(e,t){return hx(e).put(hy,t)}Sr(e,t){if(t){const i=l4(this.serializer,t);if(!(i.isNoDocument()&&i.version.isEqual(Ae.min())))return i}return At.newInvalidDocument(e)}}function Hw(s){return new T4(s)}class x4 extends qw{constructor(e,t){super(),this.Mr=e,this.trackRemovals=t,this.Or=new Ws((i=>i.toString()),((i,a)=>i.isEqual(a)))}applyChanges(e){const t=[];let i=0,a=new rt(((l,u)=>De(l.canonicalString(),u.canonicalString())));return this.changes.forEach(((l,u)=>{const f=this.Or.get(l);if(t.push(this.Mr.removeEntry(e,l,f.readTime)),u.isValidDocument()){const p=$T(this.Mr.serializer,u);a=a.add(l.path.popLast());const y=Pf(p);i+=y-f.size,t.push(this.Mr.addEntry(e,l,p))}else if(i-=f.size,this.trackRemovals){const p=$T(this.Mr.serializer,u.convertToNoDocument(Ae.min()));t.push(this.Mr.addEntry(e,l,p))}})),a.forEach((l=>{t.push(this.Mr.indexManager.addToCollectionParentIndex(e,l))})),t.push(this.Mr.updateMetadata(e,i)),H.waitFor(t)}getFromCache(e,t){return this.Mr.Dr(e,t).next((i=>(this.Or.set(t,{size:i.size,readTime:i.document.readTime}),i.document)))}getAllFromCache(e,t){return this.Mr.vr(e,t).next((({documents:i,Fr:a})=>(a.forEach(((l,u)=>{this.Or.set(l,{size:u,readTime:i.get(l).readTime})})),i)))}}function hx(s){return Kt(s,Nu)}function Pa(s){return Kt(s,If)}function su(s){const e=s.path.toArray();return[e.slice(0,e.length-2),e[e.length-2],e[e.length-1]]}function dx(s,e){const t=e.documentKey.path.toArray();return[s,Mf(e.readTime),t.slice(0,t.length-2),t.length>0?t[t.length-1]:""]}function fx(s,e){const t=s.path.toArray(),i=e.path.toArray();let a=0;for(let l=0;l<t.length-2&&l<i.length-2;++l)if(a=De(t[l],i[l]),a)return a;return a=De(t.length,i.length),a||(a=De(t[t.length-2],i[i.length-2]),a||De(t[t.length-1],i[i.length-1]))}class S4{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}class Gw{constructor(e,t,i,a){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=i,this.indexManager=a}getDocument(e,t){let i=null;return this.documentOverlayCache.getOverlay(e,t).next((a=>(i=a,this.remoteDocumentCache.getEntry(e,t)))).next((a=>(i!==null&&xu(i.mutation,a,Cn.empty(),it.now()),a)))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next((i=>this.getLocalViewOfDocuments(e,i,Pe()).next((()=>i))))}getLocalViewOfDocuments(e,t,i=Pe()){const a=is();return this.populateOverlays(e,a,t).next((()=>this.computeViews(e,t,a,i).next((l=>{let u=uu();return l.forEach(((f,p)=>{u=u.insert(f,p.overlayedDocument)})),u}))))}getOverlayedDocuments(e,t){const i=is();return this.populateOverlays(e,i,t).next((()=>this.computeViews(e,t,i,Pe())))}populateOverlays(e,t,i){const a=[];return i.forEach((l=>{t.has(l)||a.push(l)})),this.documentOverlayCache.getOverlays(e,a).next((l=>{l.forEach(((u,f)=>{t.set(u,f)}))}))}computeViews(e,t,i,a){let l=qn();const u=Tu(),f=(function(){return Tu()})();return t.forEach(((p,y)=>{const _=i.get(y.key);a.has(y.key)&&(_===void 0||_.mutation instanceof Ys)?l=l.insert(y.key,y):_!==void 0?(u.set(y.key,_.mutation.getFieldMask()),xu(_.mutation,y,_.mutation.getFieldMask(),it.now())):u.set(y.key,Cn.empty())})),this.recalculateAndSaveOverlays(e,l).next((p=>(p.forEach(((y,_)=>u.set(y,_))),t.forEach(((y,_)=>f.set(y,new S4(_,u.get(y)??null)))),f)))}recalculateAndSaveOverlays(e,t){const i=Tu();let a=new dt(((u,f)=>u-f)),l=Pe();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next((u=>{for(const f of u)f.keys().forEach((p=>{const y=t.get(p);if(y===null)return;let _=i.get(p)||Cn.empty();_=f.applyToLocalView(y,_),i.set(p,_);const b=(a.get(f.batchId)||Pe()).add(p);a=a.insert(f.batchId,b)}))})).next((()=>{const u=[],f=a.getReverseIterator();for(;f.hasNext();){const p=f.getNext(),y=p.key,_=p.value,b=aw();_.forEach((x=>{if(!l.has(x)){const k=fw(t.get(x),i.get(x));k!==null&&b.set(x,k),l=l.add(x)}})),u.push(this.documentOverlayCache.saveOverlays(e,y,b))}return H.waitFor(u)})).next((()=>i))}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next((i=>this.recalculateAndSaveOverlays(e,i)))}getDocumentsMatchingQuery(e,t,i,a){return RO(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):ew(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,i,a):this.getDocumentsMatchingCollectionQuery(e,t,i,a)}getNextDocuments(e,t,i,a){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,i,a).next((l=>{const u=a-l.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,i.largestBatchId,a-l.size):H.resolve(is());let f=wl,p=l;return u.next((y=>H.forEach(y,((_,b)=>(f<b.largestBatchId&&(f=b.largestBatchId),l.get(_)?H.resolve():this.remoteDocumentCache.getEntry(e,_).next((x=>{p=p.insert(_,x)}))))).next((()=>this.populateOverlays(e,y,l))).next((()=>this.computeViews(e,p,y,Pe()))).next((_=>({batchId:f,changes:rw(_)})))))}))}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new me(t)).next((i=>{let a=uu();return i.isFoundDocument()&&(a=a.insert(i.key,i)),a}))}getDocumentsMatchingCollectionGroupQuery(e,t,i,a){const l=t.collectionGroup;let u=uu();return this.indexManager.getCollectionParents(e,l).next((f=>H.forEach(f,(p=>{const y=(function(b,x){return new $l(x,null,b.explicitOrderBy.slice(),b.filters.slice(),b.limit,b.limitType,b.startAt,b.endAt)})(t,p.child(l));return this.getDocumentsMatchingCollectionQuery(e,y,i,a).next((_=>{_.forEach(((b,x)=>{u=u.insert(b,x)}))}))})).next((()=>u))))}getDocumentsMatchingCollectionQuery(e,t,i,a){let l;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,i.largestBatchId).next((u=>(l=u,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,i,l,a)))).next((u=>{l.forEach(((p,y)=>{const _=y.getKey();u.get(_)===null&&(u=u.insert(_,At.newInvalidDocument(_)))}));let f=uu();return u.forEach(((p,y)=>{const _=l.get(p);_!==void 0&&xu(_.mutation,y,Cn.empty(),it.now()),Ju(t,y)&&(f=f.insert(p,y))})),f}))}}class w4{constructor(e){this.serializer=e,this.Nr=new Map,this.Br=new Map}getBundleMetadata(e,t){return H.resolve(this.Nr.get(t))}saveBundleMetadata(e,t){return this.Nr.set(t.id,(function(a){return{id:a.id,version:a.version,createTime:yn(a.createTime)}})(t)),H.resolve()}getNamedQuery(e,t){return H.resolve(this.Br.get(t))}saveNamedQuery(e,t){return this.Br.set(t.name,(function(a){return{name:a.name,query:kw(a.bundledQuery),readTime:yn(a.readTime)}})(t)),H.resolve()}}class A4{constructor(){this.overlays=new dt(me.comparator),this.Lr=new Map}getOverlay(e,t){return H.resolve(this.overlays.get(t))}getOverlays(e,t){const i=is();return H.forEach(t,(a=>this.getOverlay(e,a).next((l=>{l!==null&&i.set(a,l)})))).next((()=>i))}saveOverlays(e,t,i){return i.forEach(((a,l)=>{this.bt(e,t,l)})),H.resolve()}removeOverlaysForBatchId(e,t,i){const a=this.Lr.get(i);return a!==void 0&&(a.forEach((l=>this.overlays=this.overlays.remove(l))),this.Lr.delete(i)),H.resolve()}getOverlaysForCollection(e,t,i){const a=is(),l=t.length+1,u=new me(t.child("")),f=this.overlays.getIteratorFrom(u);for(;f.hasNext();){const p=f.getNext().value,y=p.getKey();if(!t.isPrefixOf(y.path))break;y.path.length===l&&p.largestBatchId>i&&a.set(p.getKey(),p)}return H.resolve(a)}getOverlaysForCollectionGroup(e,t,i,a){let l=new dt(((y,_)=>y-_));const u=this.overlays.getIterator();for(;u.hasNext();){const y=u.getNext().value;if(y.getKey().getCollectionGroup()===t&&y.largestBatchId>i){let _=l.get(y.largestBatchId);_===null&&(_=is(),l=l.insert(y.largestBatchId,_)),_.set(y.getKey(),y)}}const f=is(),p=l.getIterator();for(;p.hasNext()&&(p.getNext().value.forEach(((y,_)=>f.set(y,_))),!(f.size()>=a)););return H.resolve(f)}bt(e,t,i){const a=this.overlays.get(i.key);if(a!==null){const u=this.Lr.get(a.largestBatchId).delete(i.key);this.Lr.set(a.largestBatchId,u)}this.overlays=this.overlays.insert(i.key,new mv(t,i));let l=this.Lr.get(t);l===void 0&&(l=Pe(),this.Lr.set(t,l)),this.Lr.set(t,l.add(i.key))}}class I4{constructor(){this.sessionToken=kt.EMPTY_BYTE_STRING}getSessionToken(e){return H.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,H.resolve()}}class _v{constructor(){this.kr=new rt(Xt.Kr),this.qr=new rt(Xt.Ur)}isEmpty(){return this.kr.isEmpty()}addReference(e,t){const i=new Xt(e,t);this.kr=this.kr.add(i),this.qr=this.qr.add(i)}$r(e,t){e.forEach((i=>this.addReference(i,t)))}removeReference(e,t){this.Wr(new Xt(e,t))}Qr(e,t){e.forEach((i=>this.removeReference(i,t)))}Gr(e){const t=new me(new Ze([])),i=new Xt(t,e),a=new Xt(t,e+1),l=[];return this.qr.forEachInRange([i,a],(u=>{this.Wr(u),l.push(u.key)})),l}zr(){this.kr.forEach((e=>this.Wr(e)))}Wr(e){this.kr=this.kr.delete(e),this.qr=this.qr.delete(e)}jr(e){const t=new me(new Ze([])),i=new Xt(t,e),a=new Xt(t,e+1);let l=Pe();return this.qr.forEachInRange([i,a],(u=>{l=l.add(u.key)})),l}containsKey(e){const t=new Xt(e,0),i=this.kr.firstAfterOrEqual(t);return i!==null&&e.isEqual(i.key)}}class Xt{constructor(e,t){this.key=e,this.Hr=t}static Kr(e,t){return me.comparator(e.key,t.key)||De(e.Hr,t.Hr)}static Ur(e,t){return De(e.Hr,t.Hr)||me.comparator(e.key,t.key)}}class C4{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.Yn=1,this.Jr=new rt(Xt.Kr)}checkEmpty(e){return H.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,i,a){const l=this.Yn;this.Yn++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const u=new dv(l,t,i,a);this.mutationQueue.push(u);for(const f of a)this.Jr=this.Jr.add(new Xt(f.key,l)),this.indexManager.addToCollectionParentIndex(e,f.key.path.popLast());return H.resolve(u)}lookupMutationBatch(e,t){return H.resolve(this.Zr(t))}getNextMutationBatchAfterBatchId(e,t){const i=t+1,a=this.Xr(i),l=a<0?0:a;return H.resolve(this.mutationQueue.length>l?this.mutationQueue[l]:null)}getHighestUnacknowledgedBatchId(){return H.resolve(this.mutationQueue.length===0?Qa:this.Yn-1)}getAllMutationBatches(e){return H.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const i=new Xt(t,0),a=new Xt(t,Number.POSITIVE_INFINITY),l=[];return this.Jr.forEachInRange([i,a],(u=>{const f=this.Zr(u.Hr);l.push(f)})),H.resolve(l)}getAllMutationBatchesAffectingDocumentKeys(e,t){let i=new rt(De);return t.forEach((a=>{const l=new Xt(a,0),u=new Xt(a,Number.POSITIVE_INFINITY);this.Jr.forEachInRange([l,u],(f=>{i=i.add(f.Hr)}))})),H.resolve(this.Yr(i))}getAllMutationBatchesAffectingQuery(e,t){const i=t.path,a=i.length+1;let l=i;me.isDocumentKey(l)||(l=l.child(""));const u=new Xt(new me(l),0);let f=new rt(De);return this.Jr.forEachWhile((p=>{const y=p.key.path;return!!i.isPrefixOf(y)&&(y.length===a&&(f=f.add(p.Hr)),!0)}),u),H.resolve(this.Yr(f))}Yr(e){const t=[];return e.forEach((i=>{const a=this.Zr(i);a!==null&&t.push(a)})),t}removeMutationBatch(e,t){xe(this.ei(t.batchId,"removed")===0,55003),this.mutationQueue.shift();let i=this.Jr;return H.forEach(t.mutations,(a=>{const l=new Xt(a.key,t.batchId);return i=i.delete(l),this.referenceDelegate.markPotentiallyOrphaned(e,a.key)})).next((()=>{this.Jr=i}))}nr(e){}containsKey(e,t){const i=new Xt(t,0),a=this.Jr.firstAfterOrEqual(i);return H.resolve(t.isEqual(a&&a.key))}performConsistencyCheck(e){return this.mutationQueue.length,H.resolve()}ei(e,t){return this.Xr(e)}Xr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Zr(e){const t=this.Xr(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}class R4{constructor(e){this.ti=e,this.docs=(function(){return new dt(me.comparator)})(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const i=t.key,a=this.docs.get(i),l=a?a.size:0,u=this.ti(t);return this.docs=this.docs.insert(i,{document:t.mutableCopy(),size:u}),this.size+=u-l,this.indexManager.addToCollectionParentIndex(e,i.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const i=this.docs.get(t);return H.resolve(i?i.document.mutableCopy():At.newInvalidDocument(t))}getEntries(e,t){let i=qn();return t.forEach((a=>{const l=this.docs.get(a);i=i.insert(a,l?l.document.mutableCopy():At.newInvalidDocument(a))})),H.resolve(i)}getDocumentsMatchingQuery(e,t,i,a){let l=qn();const u=t.path,f=new me(u.child("__id-9223372036854775808__")),p=this.docs.getIteratorFrom(f);for(;p.hasNext();){const{key:y,value:{document:_}}=p.getNext();if(!u.isPrefixOf(y.path))break;y.path.length>u.length+1||ev(ES(_),i)<=0||(a.has(_.key)||Ju(t,_))&&(l=l.insert(_.key,_.mutableCopy()))}return H.resolve(l)}getAllFromCollectionGroup(e,t,i,a){ve(9500)}ni(e,t){return H.forEach(this.docs,(i=>t(i)))}newChangeBuffer(e){return new D4(this)}getSize(e){return H.resolve(this.size)}}class D4 extends qw{constructor(e){super(),this.Mr=e}applyChanges(e){const t=[];return this.changes.forEach(((i,a)=>{a.isValidDocument()?t.push(this.Mr.addEntry(e,a)):this.Mr.removeEntry(i)})),H.waitFor(t)}getFromCache(e,t){return this.Mr.getEntry(e,t)}getAllFromCache(e,t){return this.Mr.getEntries(e,t)}}class N4{constructor(e){this.persistence=e,this.ri=new Ws((t=>no(t)),Xu),this.lastRemoteSnapshotVersion=Ae.min(),this.highestTargetId=0,this.ii=0,this.si=new _v,this.targetCount=0,this.oi=ro._r()}forEachTarget(e,t){return this.ri.forEach(((i,a)=>t(a))),H.resolve()}getLastRemoteSnapshotVersion(e){return H.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return H.resolve(this.ii)}allocateTargetId(e){return this.highestTargetId=this.oi.next(),H.resolve(this.highestTargetId)}setTargetsMetadata(e,t,i){return i&&(this.lastRemoteSnapshotVersion=i),t>this.ii&&(this.ii=t),H.resolve()}lr(e){this.ri.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.oi=new ro(t),this.highestTargetId=t),e.sequenceNumber>this.ii&&(this.ii=e.sequenceNumber)}addTargetData(e,t){return this.lr(t),this.targetCount+=1,H.resolve()}updateTargetData(e,t){return this.lr(t),H.resolve()}removeTargetData(e,t){return this.ri.delete(t.target),this.si.Gr(t.targetId),this.targetCount-=1,H.resolve()}removeTargets(e,t,i){let a=0;const l=[];return this.ri.forEach(((u,f)=>{f.sequenceNumber<=t&&i.get(f.targetId)===null&&(this.ri.delete(u),l.push(this.removeMatchingKeysForTargetId(e,f.targetId)),a++)})),H.waitFor(l).next((()=>a))}getTargetCount(e){return H.resolve(this.targetCount)}getTargetData(e,t){const i=this.ri.get(t)||null;return H.resolve(i)}addMatchingKeys(e,t,i){return this.si.$r(t,i),H.resolve()}removeMatchingKeys(e,t,i){this.si.Qr(t,i);const a=this.persistence.referenceDelegate,l=[];return a&&t.forEach((u=>{l.push(a.markPotentiallyOrphaned(e,u))})),H.waitFor(l)}removeMatchingKeysForTargetId(e,t){return this.si.Gr(t),H.resolve()}getMatchingKeysForTargetId(e,t){const i=this.si.jr(t);return H.resolve(i)}containsKey(e,t){return H.resolve(this.si.containsKey(t))}}class bv{constructor(e,t){this._i={},this.overlays={},this.ai=new In(0),this.ui=!1,this.ui=!0,this.ci=new I4,this.referenceDelegate=e(this),this.li=new N4(this),this.indexManager=new g4,this.remoteDocumentCache=(function(a){return new R4(a)})((i=>this.referenceDelegate.hi(i))),this.serializer=new Nw(t),this.Pi=new w4(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.ui=!1,Promise.resolve()}get started(){return this.ui}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new A4,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let i=this._i[e.toKey()];return i||(i=new C4(t,this.referenceDelegate),this._i[e.toKey()]=i),i}getGlobalsCache(){return this.ci}getTargetCache(){return this.li}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Pi}runTransaction(e,t,i){ce("MemoryPersistence","Starting transaction:",e);const a=new j4(this.ai.next());return this.referenceDelegate.Ti(),i(a).next((l=>this.referenceDelegate.Ii(a).next((()=>l)))).toPromise().then((l=>(a.raiseOnCommittedEvent(),l)))}Ei(e,t){return H.or(Object.values(this._i).map((i=>()=>i.containsKey(e,t))))}}class j4 extends xS{constructor(e){super(),this.currentSequenceNumber=e}}class pm{constructor(e){this.persistence=e,this.Ri=new _v,this.Ai=null}static Vi(e){return new pm(e)}get di(){if(this.Ai)return this.Ai;throw ve(60996)}addReference(e,t,i){return this.Ri.addReference(i,t),this.di.delete(i.toString()),H.resolve()}removeReference(e,t,i){return this.Ri.removeReference(i,t),this.di.add(i.toString()),H.resolve()}markPotentiallyOrphaned(e,t){return this.di.add(t.toString()),H.resolve()}removeTarget(e,t){this.Ri.Gr(t.targetId).forEach((a=>this.di.add(a.toString())));const i=this.persistence.getTargetCache();return i.getMatchingKeysForTargetId(e,t.targetId).next((a=>{a.forEach((l=>this.di.add(l.toString())))})).next((()=>i.removeTargetData(e,t)))}Ti(){this.Ai=new Set}Ii(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return H.forEach(this.di,(i=>{const a=me.fromPath(i);return this.mi(e,a).next((l=>{l||t.removeEntry(a,Ae.min())}))})).next((()=>(this.Ai=null,t.apply(e))))}updateLimboDocument(e,t){return this.mi(e,t).next((i=>{i?this.di.delete(t.toString()):this.di.add(t.toString())}))}hi(e){return 0}mi(e,t){return H.or([()=>H.resolve(this.Ri.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Ei(e,t)])}}class Lf{constructor(e,t){this.persistence=e,this.fi=new Ws((i=>fn(i.path)),((i,a)=>i.isEqual(a))),this.garbageCollector=Fw(this,t)}static Vi(e,t){return new Lf(e,t)}Ti(){}Ii(e){return H.resolve()}forEachTarget(e,t){return this.persistence.getTargetCache().forEachTarget(e,t)}dr(e){const t=this.pr(e);return this.persistence.getTargetCache().getTargetCount(e).next((i=>t.next((a=>i+a))))}pr(e){let t=0;return this.mr(e,(i=>{t++})).next((()=>t))}mr(e,t){return H.forEach(this.fi,((i,a)=>this.wr(e,i,a).next((l=>l?H.resolve():t(a)))))}removeTargets(e,t,i){return this.persistence.getTargetCache().removeTargets(e,t,i)}removeOrphanedDocuments(e,t){let i=0;const a=this.persistence.getRemoteDocumentCache(),l=a.newChangeBuffer();return a.ni(e,(u=>this.wr(e,u,t).next((f=>{f||(i++,l.removeEntry(u,Ae.min()))})))).next((()=>l.apply(e))).next((()=>i))}markPotentiallyOrphaned(e,t){return this.fi.set(t,e.currentSequenceNumber),H.resolve()}removeTarget(e,t){const i=t.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,i)}addReference(e,t,i){return this.fi.set(i,e.currentSequenceNumber),H.resolve()}removeReference(e,t,i){return this.fi.set(i,e.currentSequenceNumber),H.resolve()}updateLimboDocument(e,t){return this.fi.set(t,e.currentSequenceNumber),H.resolve()}hi(e){let t=e.key.toString().length;return e.isFoundDocument()&&(t+=lf(e.data.value)),t}wr(e,t,i){return H.or([()=>this.persistence.Ei(e,t),()=>this.persistence.getTargetCache().containsKey(e,t),()=>{const a=this.fi.get(t);return H.resolve(a!==void 0&&a>i)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}class k4{constructor(e){this.serializer=e}k(e,t,i,a){const l=new nm("createOrUpgrade",t);i<1&&a>=1&&((function(p){p.createObjectStore(Yu)})(e),(function(p){p.createObjectStore(Du,{keyPath:Gk}),p.createObjectStore(xi,{keyPath:ST,autoIncrement:!0}).createIndex(Ga,wT,{unique:!0}),p.createObjectStore(Al)})(e),mx(e),(function(p){p.createObjectStore(za)})(e));let u=H.resolve();return i<3&&a>=3&&(i!==0&&((function(p){p.deleteObjectStore(Cl),p.deleteObjectStore(Il),p.deleteObjectStore(Ka)})(e),mx(e)),u=u.next((()=>(function(p){const y=p.store(Ka),_={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:Ae.min().toTimestamp(),targetCount:0};return y.put(Cf,_)})(l)))),i<4&&a>=4&&(i!==0&&(u=u.next((()=>(function(p,y){return y.store(xi).H().next((b=>{p.deleteObjectStore(xi),p.createObjectStore(xi,{keyPath:ST,autoIncrement:!0}).createIndex(Ga,wT,{unique:!0});const x=y.store(xi),k=b.map((M=>x.put(M)));return H.waitFor(k)}))})(e,l)))),u=u.next((()=>{(function(p){p.createObjectStore(Rl,{keyPath:eO})})(e)}))),i<5&&a>=5&&(u=u.next((()=>this.gi(l)))),i<6&&a>=6&&(u=u.next((()=>((function(p){p.createObjectStore(Nu)})(e),this.pi(l))))),i<7&&a>=7&&(u=u.next((()=>this.yi(l)))),i<8&&a>=8&&(u=u.next((()=>this.wi(e,l)))),i<9&&a>=9&&(u=u.next((()=>{(function(p){p.objectStoreNames.contains("remoteDocumentChanges")&&p.deleteObjectStore("remoteDocumentChanges")})(e)}))),i<10&&a>=10&&(u=u.next((()=>this.bi(l)))),i<11&&a>=11&&(u=u.next((()=>{(function(p){p.createObjectStore(sm,{keyPath:tO})})(e),(function(p){p.createObjectStore(rm,{keyPath:nO})})(e)}))),i<12&&a>=12&&(u=u.next((()=>{(function(p){const y=p.createObjectStore(am,{keyPath:cO});y.createIndex(fy,uO,{unique:!1}),y.createIndex(NS,hO,{unique:!1})})(e)}))),i<13&&a>=13&&(u=u.next((()=>(function(p){const y=p.createObjectStore(If,{keyPath:Kk});y.createIndex(af,$k),y.createIndex(IS,Wk)})(e))).next((()=>this.Si(e,l))).next((()=>e.deleteObjectStore(za)))),i<14&&a>=14&&(u=u.next((()=>this.Di(e,l)))),i<15&&a>=15&&(u=u.next((()=>(function(p){p.createObjectStore(iv,{keyPath:iO,autoIncrement:!0}).createIndex(dy,sO,{unique:!1}),p.createObjectStore(vu,{keyPath:rO}).createIndex(RS,aO,{unique:!1}),p.createObjectStore(_u,{keyPath:oO}).createIndex(DS,lO,{unique:!1})})(e)))),i<16&&a>=16&&(u=u.next((()=>{t.objectStore(vu).clear()})).next((()=>{t.objectStore(_u).clear()}))),i<17&&a>=17&&(u=u.next((()=>{(function(p){p.createObjectStore(sv,{keyPath:dO})})(e)}))),i<18&&a>=18&&T1()&&(u=u.next((()=>{t.objectStore(vu).clear()})).next((()=>{t.objectStore(_u).clear()}))),u}pi(e){let t=0;return e.store(za).ee(((i,a)=>{t+=Pf(a)})).next((()=>{const i={byteSize:t};return e.store(Nu).put(hy,i)}))}gi(e){const t=e.store(Du),i=e.store(xi);return t.H().next((a=>H.forEach(a,(l=>{const u=IDBKeyRange.bound([l.userId,Qa],[l.userId,l.lastAcknowledgedBatchId]);return i.H(Ga,u).next((f=>H.forEach(f,(p=>{xe(p.userId===l.userId,18650,"Cannot process batch from unexpected user",{batchId:p.batchId});const y=Fa(this.serializer,p);return Pw(e,l.userId,y).next((()=>{}))}))))}))))}yi(e){const t=e.store(Cl),i=e.store(za);return e.store(Ka).get(Cf).next((a=>{const l=[];return i.ee(((u,f)=>{const p=new Ze(u),y=(function(b){return[0,fn(b)]})(p);l.push(t.get(y).next((_=>_?H.resolve():(b=>t.put({targetId:0,path:fn(b),sequenceNumber:a.highestListenSequenceNumber}))(p))))})).next((()=>H.waitFor(l)))}))}wi(e,t){e.createObjectStore(ju,{keyPath:Zk});const i=t.store(ju),a=new vv,l=u=>{if(a.add(u)){const f=u.lastSegment(),p=u.popLast();return i.put({collectionId:f,parent:fn(p)})}};return t.store(za).ee({Y:!0},((u,f)=>{const p=new Ze(u);return l(p.popLast())})).next((()=>t.store(Al).ee({Y:!0},(([u,f,p],y)=>{const _=ns(f);return l(_.popLast())}))))}bi(e){const t=e.store(Il);return t.ee(((i,a)=>{const l=du(a),u=jw(this.serializer,l);return t.put(u)}))}Si(e,t){const i=t.store(za),a=[];return i.ee(((l,u)=>{const f=t.store(If),p=(function(b){return b.document?new me(Ze.fromString(b.document.name).popFirst(5)):b.noDocument?me.fromSegments(b.noDocument.path):b.unknownDocument?me.fromSegments(b.unknownDocument.path):ve(36783)})(u).path.toArray(),y={prefixPath:p.slice(0,p.length-2),collectionGroup:p[p.length-2],documentId:p[p.length-1],readTime:u.readTime||[0,0],unknownDocument:u.unknownDocument,noDocument:u.noDocument,document:u.document,hasCommittedMutations:!!u.hasCommittedMutations};a.push(f.put(y))})).next((()=>H.waitFor(a)))}Di(e,t){const i=t.store(xi),a=Hw(this.serializer),l=new bv(pm.Vi,this.serializer.yt);return i.H().next((u=>{const f=new Map;return u.forEach((p=>{let y=f.get(p.userId)??Pe();Fa(this.serializer,p).keys().forEach((_=>y=y.add(_))),f.set(p.userId,y)})),H.forEach(f,((p,y)=>{const _=new un(y),b=fm.wt(this.serializer,_),x=l.getIndexManager(_),k=mm.wt(_,this.serializer,x,l.referenceDelegate);return new Gw(a,k,b,x).recalculateAndSaveOverlaysForDocumentKeys(new my(t,In.ce),p).next()}))}))}}function mx(s){s.createObjectStore(Cl,{keyPath:Xk}).createIndex(nv,Jk,{unique:!0}),s.createObjectStore(Il,{keyPath:"targetId"}).createIndex(CS,Yk,{unique:!0}),s.createObjectStore(Ka)}const Mr="IndexedDbPersistence",zg=18e5,Bg=5e3,Fg="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.",O4="main";class Ev{constructor(e,t,i,a,l,u,f,p,y,_,b=18){if(this.allowTabSynchronization=e,this.persistenceKey=t,this.clientId=i,this.Ci=l,this.window=u,this.document=f,this.Fi=y,this.Mi=_,this.xi=b,this.ai=null,this.ui=!1,this.isPrimary=!1,this.networkEnabled=!0,this.Oi=null,this.inForeground=!1,this.Ni=null,this.Bi=null,this.Li=Number.NEGATIVE_INFINITY,this.ki=x=>Promise.resolve(),!Ev.v())throw new he(te.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new E4(this,a),this.Ki=t+O4,this.serializer=new Nw(p),this.qi=new Qr(this.Ki,this.xi,new k4(this.serializer)),this.ci=new u4,this.li=new v4(this.referenceDelegate,this.serializer),this.remoteDocumentCache=Hw(this.serializer),this.Pi=new c4,this.window&&this.window.localStorage?this.Ui=this.window.localStorage:(this.Ui=null,_===!1&&Nt(Mr,"LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.$i().then((()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new he(te.FAILED_PRECONDITION,Fg);return this.Wi(),this.Qi(),this.Gi(),this.runTransaction("getHighestListenSequenceNumber","readonly",(e=>this.li.getHighestSequenceNumber(e)))})).then((e=>{this.ai=new In(e,this.Fi)})).then((()=>{this.ui=!0})).catch((e=>(this.qi&&this.qi.close(),Promise.reject(e))))}zi(e){return this.ki=async t=>{if(this.started)return e(t)},e(this.isPrimary)}setDatabaseDeletedListener(e){this.qi.q((async t=>{t.newVersion===null&&await e()}))}setNetworkEnabled(e){this.networkEnabled!==e&&(this.networkEnabled=e,this.Ci.enqueueAndForget((async()=>{this.started&&await this.$i()})))}$i(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",(e=>Fd(e).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next((()=>{if(this.isPrimary)return this.ji(e).next((t=>{t||(this.isPrimary=!1,this.Ci.enqueueRetryable((()=>this.ki(!1))))}))})).next((()=>this.Hi(e))).next((t=>this.isPrimary&&!t?this.Ji(e).next((()=>!1)):!!t&&this.Zi(e).next((()=>!0)))))).catch((e=>{if(ta(e))return ce(Mr,"Failed to extend owner lease: ",e),this.isPrimary;if(!this.allowTabSynchronization)throw e;return ce(Mr,"Releasing owner lease after error during lease refresh",e),!1})).then((e=>{this.isPrimary!==e&&this.Ci.enqueueRetryable((()=>this.ki(e))),this.isPrimary=e}))}ji(e){return ru(e).get(il).next((t=>H.resolve(this.Xi(t))))}Yi(e){return Fd(e).delete(this.clientId)}async es(){if(this.isPrimary&&!this.ts(this.Li,zg)){this.Li=Date.now();const e=await this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",(t=>{const i=Kt(t,Rl);return i.H().next((a=>{const l=this.ns(a,zg),u=a.filter((f=>l.indexOf(f)===-1));return H.forEach(u,(f=>i.delete(f.clientId))).next((()=>u))}))})).catch((()=>[]));if(this.Ui)for(const t of e)this.Ui.removeItem(this.rs(t.clientId))}}Gi(){this.Bi=this.Ci.enqueueAfterDelay("client_metadata_refresh",4e3,(()=>this.$i().then((()=>this.es())).then((()=>this.Gi()))))}Xi(e){return!!e&&e.ownerId===this.clientId}Hi(e){return this.Mi?H.resolve(!0):ru(e).get(il).next((t=>{if(t!==null&&this.ts(t.leaseTimestampMs,Bg)&&!this.ss(t.ownerId)){if(this.Xi(t)&&this.networkEnabled)return!0;if(!this.Xi(t)){if(!t.allowTabSynchronization)throw new he(te.FAILED_PRECONDITION,Fg);return!1}}return!(!this.networkEnabled||!this.inForeground)||Fd(e).H().next((i=>this.ns(i,Bg).find((a=>{if(this.clientId!==a.clientId){const l=!this.networkEnabled&&a.networkEnabled,u=!this.inForeground&&a.inForeground,f=this.networkEnabled===a.networkEnabled;if(l||u&&f)return!0}return!1}))===void 0))})).next((t=>(this.isPrimary!==t&&ce(Mr,`Client ${t?"is":"is not"} eligible for a primary lease.`),t)))}async shutdown(){this.ui=!1,this._s(),this.Bi&&(this.Bi.cancel(),this.Bi=null),this.us(),this.cs(),await this.qi.runTransaction("shutdown","readwrite",[Yu,Rl],(e=>{const t=new my(e,In.ce);return this.Ji(t).next((()=>this.Yi(t)))})),this.qi.close(),this.ls()}ns(e,t){return e.filter((i=>this.ts(i.updateTimeMs,t)&&!this.ss(i.clientId)))}hs(){return this.runTransaction("getActiveClients","readonly",(e=>Fd(e).H().next((t=>this.ns(t,zg).map((i=>i.clientId))))))}get started(){return this.ui}getGlobalsCache(){return this.ci}getMutationQueue(e,t){return mm.wt(e,this.serializer,t,this.referenceDelegate)}getTargetCache(){return this.li}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(e){return new y4(e,this.serializer.yt.databaseId)}getDocumentOverlayCache(e){return fm.wt(this.serializer,e)}getBundleCache(){return this.Pi}runTransaction(e,t,i){ce(Mr,"Starting transaction:",e);const a=t==="readonly"?"readonly":"readwrite",l=(function(p){return p===18?pO:p===17?MS:p===16?mO:p===15?rv:p===14?OS:p===13?kS:p===12?fO:p===11?jS:void ve(60245)})(this.xi);let u;return this.qi.runTransaction(e,a,l,(f=>(u=new my(f,this.ai?this.ai.next():In.ce),t==="readwrite-primary"?this.ji(u).next((p=>!!p||this.Hi(u))).next((p=>{if(!p)throw Nt(`Failed to obtain primary lease for action '${e}'.`),this.isPrimary=!1,this.Ci.enqueueRetryable((()=>this.ki(!1))),new he(te.FAILED_PRECONDITION,TS);return i(u)})).next((p=>this.Zi(u).next((()=>p)))):this.Ps(u).next((()=>i(u)))))).then((f=>(u.raiseOnCommittedEvent(),f)))}Ps(e){return ru(e).get(il).next((t=>{if(t!==null&&this.ts(t.leaseTimestampMs,Bg)&&!this.ss(t.ownerId)&&!this.Xi(t)&&!(this.Mi||this.allowTabSynchronization&&t.allowTabSynchronization))throw new he(te.FAILED_PRECONDITION,Fg)}))}Zi(e){const t={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return ru(e).put(il,t)}static v(){return Qr.v()}Ji(e){const t=ru(e);return t.get(il).next((i=>this.Xi(i)?(ce(Mr,"Releasing primary lease."),t.delete(il)):H.resolve()))}ts(e,t){const i=Date.now();return!(e<i-t)&&(!(e>i)||(Nt(`Detected an update time that is in the future: ${e} > ${i}`),!1))}Wi(){this.document!==null&&typeof this.document.addEventListener=="function"&&(this.Ni=()=>{this.Ci.enqueueAndForget((()=>(this.inForeground=this.document.visibilityState==="visible",this.$i())))},this.document.addEventListener("visibilitychange",this.Ni),this.inForeground=this.document.visibilityState==="visible")}us(){this.Ni&&(this.document.removeEventListener("visibilitychange",this.Ni),this.Ni=null)}Qi(){typeof this.window?.addEventListener=="function"&&(this.Oi=()=>{this._s();const e=/(?:Version|Mobile)\/1[456]/;E1()&&(navigator.appVersion.match(e)||navigator.userAgent.match(e))&&this.Ci.enterRestrictedMode(!0),this.Ci.enqueueAndForget((()=>this.shutdown()))},this.window.addEventListener("pagehide",this.Oi))}cs(){this.Oi&&(this.window.removeEventListener("pagehide",this.Oi),this.Oi=null)}ss(e){try{const t=this.Ui?.getItem(this.rs(e))!==null;return ce(Mr,`Client '${e}' ${t?"is":"is not"} zombied in LocalStorage`),t}catch(t){return Nt(Mr,"Failed to get zombied client id.",t),!1}}_s(){if(this.Ui)try{this.Ui.setItem(this.rs(this.clientId),String(Date.now()))}catch(e){Nt("Failed to set zombie client id.",e)}}ls(){if(this.Ui)try{this.Ui.removeItem(this.rs(this.clientId))}catch{}}rs(e){return`firestore_zombie_${this.persistenceKey}_${e}`}}function ru(s){return Kt(s,Yu)}function Fd(s){return Kt(s,Rl)}function Qw(s,e){let t=s.projectId;return s.isDefaultDatabase||(t+="."+s.database),"firestore/"+e+"/"+t+"/"}class Tv{constructor(e,t,i,a){this.targetId=e,this.fromCache=t,this.Ts=i,this.Is=a}static Es(e,t){let i=Pe(),a=Pe();for(const l of t.docChanges)switch(l.type){case 0:i=i.add(l.doc.key);break;case 1:a=a.add(l.doc.key)}return new Tv(e,t.fromCache,i,a)}}class M4{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}class Kw{constructor(){this.Rs=!1,this.As=!1,this.Vs=100,this.ds=(function(){return E1()?8:SS(Qt())>0?6:4})()}initialize(e,t){this.fs=e,this.indexManager=t,this.Rs=!0}getDocumentsMatchingQuery(e,t,i,a){const l={result:null};return this.gs(e,t).next((u=>{l.result=u})).next((()=>{if(!l.result)return this.ps(e,t,a,i).next((u=>{l.result=u}))})).next((()=>{if(l.result)return;const u=new M4;return this.ys(e,t,u).next((f=>{if(l.result=f,this.As)return this.ws(e,t,u,f.size)}))})).next((()=>l.result))}ws(e,t,i,a){return i.documentReadCount<this.Vs?(ul()<=Fe.DEBUG&&ce("QueryEngine","SDK will not create cache indexes for query:",hl(t),"since it only creates cache indexes for collection contains","more than or equal to",this.Vs,"documents"),H.resolve()):(ul()<=Fe.DEBUG&&ce("QueryEngine","Query:",hl(t),"scans",i.documentReadCount,"local documents and returns",a,"documents as results."),i.documentReadCount>this.ds*a?(ul()<=Fe.DEBUG&&ce("QueryEngine","The SDK decides to create cache indexes for query:",hl(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Hn(t))):H.resolve())}gs(e,t){if(LT(t))return H.resolve(null);let i=Hn(t);return this.indexManager.getIndexType(e,i).next((a=>a===0?null:(t.limit!==null&&a===1&&(t=jf(t,null,"F"),i=Hn(t)),this.indexManager.getDocumentsMatchingTarget(e,i).next((l=>{const u=Pe(...l);return this.fs.getDocuments(e,u).next((f=>this.indexManager.getMinOffset(e,i).next((p=>{const y=this.bs(t,f);return this.Ss(t,y,u,p.readTime)?this.gs(e,jf(t,null,"F")):this.Ds(e,y,t,p)}))))})))))}ps(e,t,i,a){return LT(t)||a.isEqual(Ae.min())?H.resolve(null):this.fs.getDocuments(e,i).next((l=>{const u=this.bs(t,l);return this.Ss(t,u,i,a)?H.resolve(null):(ul()<=Fe.DEBUG&&ce("QueryEngine","Re-using previous result from %s to execute query: %s",a.toString(),hl(t)),this.Ds(e,u,t,bS(a,wl)).next((f=>f)))}))}bs(e,t){let i=new rt(iw(e));return t.forEach(((a,l)=>{Ju(e,l)&&(i=i.add(l))})),i}Ss(e,t,i,a){if(e.limit===null)return!1;if(i.size!==t.size)return!0;const l=e.limitType==="F"?t.last():t.first();return!!l&&(l.hasPendingWrites||l.version.compareTo(a)>0)}ys(e,t,i){return ul()<=Fe.DEBUG&&ce("QueryEngine","Using full collection scan to execute query:",hl(t)),this.fs.getDocumentsMatchingQuery(e,t,Gn.min(),i)}Ds(e,t,i,a){return this.fs.getDocumentsMatchingQuery(e,i,a).next((l=>(t.forEach((u=>{l=l.insert(u.key,u)})),l)))}}const xv="LocalStore",V4=3e8;class P4{constructor(e,t,i,a){this.persistence=e,this.Cs=t,this.serializer=a,this.vs=new dt(De),this.Fs=new Ws((l=>no(l)),Xu),this.Ms=new Map,this.xs=e.getRemoteDocumentCache(),this.li=e.getTargetCache(),this.Pi=e.getBundleCache(),this.Os(i)}Os(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new Gw(this.xs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.xs.setIndexManager(this.indexManager),this.Cs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",(t=>e.collect(t,this.vs)))}}function $w(s,e,t,i){return new P4(s,e,t,i)}async function Ww(s,e){const t=be(s);return await t.persistence.runTransaction("Handle user change","readonly",(i=>{let a;return t.mutationQueue.getAllMutationBatches(i).next((l=>(a=l,t.Os(e),t.mutationQueue.getAllMutationBatches(i)))).next((l=>{const u=[],f=[];let p=Pe();for(const y of a){u.push(y.batchId);for(const _ of y.mutations)p=p.add(_.key)}for(const y of l){f.push(y.batchId);for(const _ of y.mutations)p=p.add(_.key)}return t.localDocuments.getDocuments(i,p).next((y=>({Ns:y,removedBatchIds:u,addedBatchIds:f})))}))}))}function L4(s,e){const t=be(s);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",(i=>{const a=e.batch.keys(),l=t.xs.newChangeBuffer({trackRemovals:!0});return(function(f,p,y,_){const b=y.batch,x=b.keys();let k=H.resolve();return x.forEach((M=>{k=k.next((()=>_.getEntry(p,M))).next((j=>{const V=y.docVersions.get(M);xe(V!==null,48541),j.version.compareTo(V)<0&&(b.applyToRemoteDocument(j,y),j.isValidDocument()&&(j.setReadTime(y.commitVersion),_.addEntry(j)))}))})),k.next((()=>f.mutationQueue.removeMutationBatch(p,b)))})(t,i,e,l).next((()=>l.apply(i))).next((()=>t.mutationQueue.performConsistencyCheck(i))).next((()=>t.documentOverlayCache.removeOverlaysForBatchId(i,a,e.batch.batchId))).next((()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(i,(function(f){let p=Pe();for(let y=0;y<f.mutationResults.length;++y)f.mutationResults[y].transformResults.length>0&&(p=p.add(f.batch.mutations[y].key));return p})(e)))).next((()=>t.localDocuments.getDocuments(i,a)))}))}function Yw(s){const e=be(s);return e.persistence.runTransaction("Get last remote snapshot version","readonly",(t=>e.li.getLastRemoteSnapshotVersion(t)))}function U4(s,e){const t=be(s),i=e.snapshotVersion;let a=t.vs;return t.persistence.runTransaction("Apply remote event","readwrite-primary",(l=>{const u=t.xs.newChangeBuffer({trackRemovals:!0});a=t.vs;const f=[];e.targetChanges.forEach(((_,b)=>{const x=a.get(b);if(!x)return;f.push(t.li.removeMatchingKeys(l,_.removedDocuments,b).next((()=>t.li.addMatchingKeys(l,_.addedDocuments,b))));let k=x.withSequenceNumber(l.currentSequenceNumber);e.targetMismatches.get(b)!==null?k=k.withResumeToken(kt.EMPTY_BYTE_STRING,Ae.min()).withLastLimboFreeSnapshotVersion(Ae.min()):_.resumeToken.approximateByteSize()>0&&(k=k.withResumeToken(_.resumeToken,i)),a=a.insert(b,k),(function(j,V,ee){return j.resumeToken.approximateByteSize()===0||V.snapshotVersion.toMicroseconds()-j.snapshotVersion.toMicroseconds()>=V4?!0:ee.addedDocuments.size+ee.modifiedDocuments.size+ee.removedDocuments.size>0})(x,k,_)&&f.push(t.li.updateTargetData(l,k))}));let p=qn(),y=Pe();if(e.documentUpdates.forEach((_=>{e.resolvedLimboDocuments.has(_)&&f.push(t.persistence.referenceDelegate.updateLimboDocument(l,_))})),f.push(z4(l,u,e.documentUpdates).next((_=>{p=_.Bs,y=_.Ls}))),!i.isEqual(Ae.min())){const _=t.li.getLastRemoteSnapshotVersion(l).next((b=>t.li.setTargetsMetadata(l,l.currentSequenceNumber,i)));f.push(_)}return H.waitFor(f).next((()=>u.apply(l))).next((()=>t.localDocuments.getLocalViewOfDocuments(l,p,y))).next((()=>p))})).then((l=>(t.vs=a,l)))}function z4(s,e,t){let i=Pe(),a=Pe();return t.forEach((l=>i=i.add(l))),e.getEntries(s,i).next((l=>{let u=qn();return t.forEach(((f,p)=>{const y=l.get(f);p.isFoundDocument()!==y.isFoundDocument()&&(a=a.add(f)),p.isNoDocument()&&p.version.isEqual(Ae.min())?(e.removeEntry(f,p.readTime),u=u.insert(f,p)):!y.isValidDocument()||p.version.compareTo(y.version)>0||p.version.compareTo(y.version)===0&&y.hasPendingWrites?(e.addEntry(p),u=u.insert(f,p)):ce(xv,"Ignoring outdated watch update for ",f,". Current version:",y.version," Watch version:",p.version)})),{Bs:u,Ls:a}}))}function B4(s,e){const t=be(s);return t.persistence.runTransaction("Get next mutation batch","readonly",(i=>(e===void 0&&(e=Qa),t.mutationQueue.getNextMutationBatchAfterBatchId(i,e))))}function Uf(s,e){const t=be(s);return t.persistence.runTransaction("Allocate target","readwrite",(i=>{let a;return t.li.getTargetData(i,e).next((l=>l?(a=l,H.resolve(a)):t.li.allocateTargetId(i).next((u=>(a=new zs(e,u,"TargetPurposeListen",i.currentSequenceNumber),t.li.addTargetData(i,a).next((()=>a)))))))})).then((i=>{const a=t.vs.get(i.targetId);return(a===null||i.snapshotVersion.compareTo(a.snapshotVersion)>0)&&(t.vs=t.vs.insert(i.targetId,i),t.Fs.set(e,i.targetId)),i}))}async function Ll(s,e,t){const i=be(s),a=i.vs.get(e),l=t?"readwrite":"readwrite-primary";try{t||await i.persistence.runTransaction("Release target",l,(u=>i.persistence.referenceDelegate.removeTarget(u,a)))}catch(u){if(!ta(u))throw u;ce(xv,`Failed to update sequence numbers for target ${e}: ${u}`)}i.vs=i.vs.remove(e),i.Fs.delete(a.target)}function Cy(s,e,t){const i=be(s);let a=Ae.min(),l=Pe();return i.persistence.runTransaction("Execute query","readwrite",(u=>(function(p,y,_){const b=be(p),x=b.Fs.get(_);return x!==void 0?H.resolve(b.vs.get(x)):b.li.getTargetData(y,_)})(i,u,Hn(e)).next((f=>{if(f)return a=f.lastLimboFreeSnapshotVersion,i.li.getMatchingKeysForTargetId(u,f.targetId).next((p=>{l=p}))})).next((()=>i.Cs.getDocumentsMatchingQuery(u,e,t?a:Ae.min(),t?l:Pe()))).next((f=>(Zw(i,nw(e),f),{documents:f,ks:l})))))}function Xw(s,e){const t=be(s),i=be(t.li),a=t.vs.get(e);return a?Promise.resolve(a.target):t.persistence.runTransaction("Get target data","readonly",(l=>i.At(l,e).next((u=>u?u.target:null))))}function Jw(s,e){const t=be(s),i=t.Ms.get(e)||Ae.min();return t.persistence.runTransaction("Get new document changes","readonly",(a=>t.xs.getAllFromCollectionGroup(a,e,bS(i,wl),Number.MAX_SAFE_INTEGER))).then((a=>(Zw(t,e,a),a)))}function Zw(s,e,t){let i=s.Ms.get(e)||Ae.min();t.forEach(((a,l)=>{l.readTime.compareTo(i)>0&&(i=l.readTime)})),s.Ms.set(e,i)}const eA="firestore_clients";function px(s,e){return`${eA}_${s}_${e}`}const tA="firestore_mutations";function gx(s,e,t){let i=`${tA}_${s}_${t}`;return e.isAuthenticated()&&(i+=`_${e.uid}`),i}const nA="firestore_targets";function qg(s,e){return`${nA}_${s}_${e}`}const ts="SharedClientState";class zf{constructor(e,t,i,a){this.user=e,this.batchId=t,this.state=i,this.error=a}static $s(e,t,i){const a=JSON.parse(i);let l,u=typeof a=="object"&&["pending","acknowledged","rejected"].indexOf(a.state)!==-1&&(a.error===void 0||typeof a.error=="object");return u&&a.error&&(u=typeof a.error.message=="string"&&typeof a.error.code=="string",u&&(l=new he(a.error.code,a.error.message))),u?new zf(e,t,a.state,l):(Nt(ts,`Failed to parse mutation state for ID '${t}': ${i}`),null)}Ws(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class Su{constructor(e,t,i){this.targetId=e,this.state=t,this.error=i}static $s(e,t){const i=JSON.parse(t);let a,l=typeof i=="object"&&["not-current","current","rejected"].indexOf(i.state)!==-1&&(i.error===void 0||typeof i.error=="object");return l&&i.error&&(l=typeof i.error.message=="string"&&typeof i.error.code=="string",l&&(a=new he(i.error.code,i.error.message))),l?new Su(e,i.state,a):(Nt(ts,`Failed to parse target state for ID '${e}': ${t}`),null)}Ws(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class Bf{constructor(e,t){this.clientId=e,this.activeTargetIds=t}static $s(e,t){const i=JSON.parse(t);let a=typeof i=="object"&&i.activeTargetIds instanceof Array,l=uv();for(let u=0;a&&u<i.activeTargetIds.length;++u)a=wS(i.activeTargetIds[u]),l=l.add(i.activeTargetIds[u]);return a?new Bf(e,l):(Nt(ts,`Failed to parse client data for instance '${e}': ${t}`),null)}}class Sv{constructor(e,t){this.clientId=e,this.onlineState=t}static $s(e){const t=JSON.parse(e);return typeof t=="object"&&["Unknown","Online","Offline"].indexOf(t.onlineState)!==-1&&typeof t.clientId=="string"?new Sv(t.clientId,t.onlineState):(Nt(ts,`Failed to parse online state: ${e}`),null)}}class Ry{constructor(){this.activeTargetIds=uv()}Qs(e){this.activeTargetIds=this.activeTargetIds.add(e)}Gs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Ws(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class Hg{constructor(e,t,i,a,l){this.window=e,this.Ci=t,this.persistenceKey=i,this.zs=a,this.syncEngine=null,this.onlineStateHandler=null,this.sequenceNumberHandler=null,this.js=this.Hs.bind(this),this.Js=new dt(De),this.started=!1,this.Zs=[];const u=i.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=l,this.Xs=px(this.persistenceKey,this.zs),this.Ys=(function(p){return`firestore_sequence_number_${p}`})(this.persistenceKey),this.Js=this.Js.insert(this.zs,new Ry),this.eo=new RegExp(`^${eA}_${u}_([^_]*)$`),this.no=new RegExp(`^${tA}_${u}_(\\d+)(?:_(.*))?$`),this.ro=new RegExp(`^${nA}_${u}_(\\d+)$`),this.io=(function(p){return`firestore_online_state_${p}`})(this.persistenceKey),this.so=(function(p){return`firestore_bundle_loaded_v2_${p}`})(this.persistenceKey),this.window.addEventListener("storage",this.js)}static v(e){return!(!e||!e.localStorage)}async start(){const e=await this.syncEngine.hs();for(const i of e){if(i===this.zs)continue;const a=this.getItem(px(this.persistenceKey,i));if(a){const l=Bf.$s(i,a);l&&(this.Js=this.Js.insert(l.clientId,l))}}this.oo();const t=this.storage.getItem(this.io);if(t){const i=this._o(t);i&&this.ao(i)}for(const i of this.Zs)this.Hs(i);this.Zs=[],this.window.addEventListener("pagehide",(()=>this.shutdown())),this.started=!0}writeSequenceNumber(e){this.setItem(this.Ys,JSON.stringify(e))}getAllActiveQueryTargets(){return this.uo(this.Js)}isActiveQueryTarget(e){let t=!1;return this.Js.forEach(((i,a)=>{a.activeTargetIds.has(e)&&(t=!0)})),t}addPendingMutation(e){this.co(e,"pending")}updateMutationState(e,t,i){this.co(e,t,i),this.lo(e)}addLocalQueryTarget(e,t=!0){let i="not-current";if(this.isActiveQueryTarget(e)){const a=this.storage.getItem(qg(this.persistenceKey,e));if(a){const l=Su.$s(e,a);l&&(i=l.state)}}return t&&this.ho.Qs(e),this.oo(),i}removeLocalQueryTarget(e){this.ho.Gs(e),this.oo()}isLocalQueryTarget(e){return this.ho.activeTargetIds.has(e)}clearQueryState(e){this.removeItem(qg(this.persistenceKey,e))}updateQueryState(e,t,i){this.Po(e,t,i)}handleUserChange(e,t,i){t.forEach((a=>{this.lo(a)})),this.currentUser=e,i.forEach((a=>{this.addPendingMutation(a)}))}setOnlineState(e){this.To(e)}notifyBundleLoaded(e){this.Io(e)}shutdown(){this.started&&(this.window.removeEventListener("storage",this.js),this.removeItem(this.Xs),this.started=!1)}getItem(e){const t=this.storage.getItem(e);return ce(ts,"READ",e,t),t}setItem(e,t){ce(ts,"SET",e,t),this.storage.setItem(e,t)}removeItem(e){ce(ts,"REMOVE",e),this.storage.removeItem(e)}Hs(e){const t=e;if(t.storageArea===this.storage){if(ce(ts,"EVENT",t.key,t.newValue),t.key===this.Xs)return void Nt("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.Ci.enqueueRetryable((async()=>{if(this.started){if(t.key!==null){if(this.eo.test(t.key)){if(t.newValue==null){const i=this.Eo(t.key);return this.Ro(i,null)}{const i=this.Ao(t.key,t.newValue);if(i)return this.Ro(i.clientId,i)}}else if(this.no.test(t.key)){if(t.newValue!==null){const i=this.Vo(t.key,t.newValue);if(i)return this.mo(i)}}else if(this.ro.test(t.key)){if(t.newValue!==null){const i=this.fo(t.key,t.newValue);if(i)return this.po(i)}}else if(t.key===this.io){if(t.newValue!==null){const i=this._o(t.newValue);if(i)return this.ao(i)}}else if(t.key===this.Ys){const i=(function(l){let u=In.ce;if(l!=null)try{const f=JSON.parse(l);xe(typeof f=="number",30636,{yo:l}),u=f}catch(f){Nt(ts,"Failed to read sequence number from WebStorage",f)}return u})(t.newValue);i!==In.ce&&this.sequenceNumberHandler(i)}else if(t.key===this.so){const i=this.wo(t.newValue);await Promise.all(i.map((a=>this.syncEngine.bo(a))))}}}else this.Zs.push(t)}))}}get ho(){return this.Js.get(this.zs)}oo(){this.setItem(this.Xs,this.ho.Ws())}co(e,t,i){const a=new zf(this.currentUser,e,t,i),l=gx(this.persistenceKey,this.currentUser,e);this.setItem(l,a.Ws())}lo(e){const t=gx(this.persistenceKey,this.currentUser,e);this.removeItem(t)}To(e){const t={clientId:this.zs,onlineState:e};this.storage.setItem(this.io,JSON.stringify(t))}Po(e,t,i){const a=qg(this.persistenceKey,e),l=new Su(e,t,i);this.setItem(a,l.Ws())}Io(e){const t=JSON.stringify(Array.from(e));this.setItem(this.so,t)}Eo(e){const t=this.eo.exec(e);return t?t[1]:null}Ao(e,t){const i=this.Eo(e);return Bf.$s(i,t)}Vo(e,t){const i=this.no.exec(e),a=Number(i[1]),l=i[2]!==void 0?i[2]:null;return zf.$s(new un(l),a,t)}fo(e,t){const i=this.ro.exec(e),a=Number(i[1]);return Su.$s(a,t)}_o(e){return Sv.$s(e)}wo(e){return JSON.parse(e)}async mo(e){if(e.user.uid===this.currentUser.uid)return this.syncEngine.So(e.batchId,e.state,e.error);ce(ts,`Ignoring mutation for non-active user ${e.user.uid}`)}po(e){return this.syncEngine.Do(e.targetId,e.state,e.error)}Ro(e,t){const i=t?this.Js.insert(e,t):this.Js.remove(e),a=this.uo(this.Js),l=this.uo(i),u=[],f=[];return l.forEach((p=>{a.has(p)||u.push(p)})),a.forEach((p=>{l.has(p)||f.push(p)})),this.syncEngine.Co(u,f).then((()=>{this.Js=i}))}ao(e){this.Js.get(e.clientId)&&this.onlineStateHandler(e.onlineState)}uo(e){let t=uv();return e.forEach(((i,a)=>{t=t.unionWith(a.activeTargetIds)})),t}}class iA{constructor(){this.vo=new Ry,this.Fo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,i){}addLocalQueryTarget(e,t=!0){return t&&this.vo.Qs(e),this.Fo[e]||"not-current"}updateQueryState(e,t,i){this.Fo[e]=t}removeLocalQueryTarget(e){this.vo.Gs(e)}isLocalQueryTarget(e){return this.vo.activeTargetIds.has(e)}clearQueryState(e){delete this.Fo[e]}getAllActiveQueryTargets(){return this.vo.activeTargetIds}isActiveQueryTarget(e){return this.vo.activeTargetIds.has(e)}start(){return this.vo=new Ry,Promise.resolve()}handleUserChange(e,t,i){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}class F4{Mo(e){}shutdown(){}}const yx="ConnectivityMonitor";class vx{constructor(){this.xo=()=>this.Oo(),this.No=()=>this.Bo(),this.Lo=[],this.ko()}Mo(e){this.Lo.push(e)}shutdown(){window.removeEventListener("online",this.xo),window.removeEventListener("offline",this.No)}ko(){window.addEventListener("online",this.xo),window.addEventListener("offline",this.No)}Oo(){ce(yx,"Network connectivity changed: AVAILABLE");for(const e of this.Lo)e(0)}Bo(){ce(yx,"Network connectivity changed: UNAVAILABLE");for(const e of this.Lo)e(1)}static v(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}let qd=null;function Dy(){return qd===null?qd=(function(){return 268435456+Math.round(2147483648*Math.random())})():qd++,"0x"+qd.toString(16)}const Gg="RestConnection",q4={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery",ExecutePipeline:"executePipeline"};class H4{get Ko(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const t=e.ssl?"https":"http",i=encodeURIComponent(this.databaseId.projectId),a=encodeURIComponent(this.databaseId.database);this.qo=t+"://"+e.host,this.Uo=`projects/${i}/databases/${a}`,this.$o=this.databaseId.database===Rf?`project_id=${i}`:`project_id=${i}&database_id=${a}`}Wo(e,t,i,a,l){const u=Dy(),f=this.Qo(e,t.toUriEncodedString());ce(Gg,`Sending RPC '${e}' ${u}:`,f,i);const p={"google-cloud-resource-prefix":this.Uo,"x-goog-request-params":this.$o};this.Go(p,a,l);const{host:y}=new URL(f),_=lo(y);return this.zo(e,f,p,i,_).then((b=>(ce(Gg,`Received RPC '${e}' ${u}: `,b),b)),(b=>{throw xl(Gg,`RPC '${e}' ${u} failed with error: `,b,"url: ",f,"request:",i),b}))}jo(e,t,i,a,l,u){return this.Wo(e,t,i,a,l)}Go(e,t,i){e["X-Goog-Api-Client"]=(function(){return"gl-js/ fire/"+Kl})(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach(((a,l)=>e[l]=a)),i&&i.headers.forEach(((a,l)=>e[l]=a))}Qo(e,t){const i=q4[e];let a=`${this.qo}/v1/${t}:${i}`;return this.databaseInfo.apiKey&&(a=`${a}?key=${encodeURIComponent(this.databaseInfo.apiKey)}`),a}terminate(){}}class G4{constructor(e){this.Ho=e.Ho,this.Jo=e.Jo}Zo(e){this.Xo=e}Yo(e){this.e_=e}t_(e){this.n_=e}onMessage(e){this.r_=e}close(){this.Jo()}send(e){this.Ho(e)}i_(){this.Xo()}s_(){this.e_()}o_(e){this.n_(e)}__(e){this.r_(e)}}const ln="WebChannelConnection",au=(s,e,t)=>{s.listen(e,(i=>{try{t(i)}catch(a){setTimeout((()=>{throw a}),0)}}))};class _l extends H4{constructor(e){super(e),this.a_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}static u_(){if(!_l.c_){const e=mS();au(e,fS.STAT_EVENT,(t=>{t.stat===ly.PROXY?ce(ln,"STAT_EVENT: detected buffering proxy"):t.stat===ly.NOPROXY&&ce(ln,"STAT_EVENT: detected no buffering proxy")})),_l.c_=!0}}zo(e,t,i,a,l){const u=Dy();return new Promise(((f,p)=>{const y=new hS;y.setWithCredentials(!0),y.listenOnce(dS.COMPLETE,(()=>{try{switch(y.getLastErrorCode()){case nf.NO_ERROR:const b=y.getResponseJson();ce(ln,`XHR for RPC '${e}' ${u} received:`,JSON.stringify(b)),f(b);break;case nf.TIMEOUT:ce(ln,`RPC '${e}' ${u} timed out`),p(new he(te.DEADLINE_EXCEEDED,"Request time out"));break;case nf.HTTP_ERROR:const x=y.getStatus();if(ce(ln,`RPC '${e}' ${u} failed with status:`,x,"response text:",y.getResponseText()),x>0){let k=y.getResponseJson();Array.isArray(k)&&(k=k[0]);const M=k?.error;if(M&&M.status&&M.message){const j=(function(ee){const ne=ee.toLowerCase().replace(/_/g,"-");return Object.values(te).indexOf(ne)>=0?ne:te.UNKNOWN})(M.status);p(new he(j,M.message))}else p(new he(te.UNKNOWN,"Server responded with status "+y.getStatus()))}else p(new he(te.UNAVAILABLE,"Connection failed."));break;default:ve(9055,{l_:e,streamId:u,h_:y.getLastErrorCode(),P_:y.getLastError()})}}finally{ce(ln,`RPC '${e}' ${u} completed.`)}}));const _=JSON.stringify(a);ce(ln,`RPC '${e}' ${u} sending request:`,a),y.send(t,"POST",_,i,15)}))}T_(e,t,i){const a=Dy(),l=[this.qo,"/","google.firestore.v1.Firestore","/",e,"/channel"],u=this.createWebChannelTransport(),f={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},p=this.longPollingOptions.timeoutSeconds;p!==void 0&&(f.longPollingTimeout=Math.round(1e3*p)),this.useFetchStreams&&(f.useFetchStreams=!0),this.Go(f.initMessageHeaders,t,i),f.encodeInitMessageHeaders=!0;const y=l.join("");ce(ln,`Creating RPC '${e}' stream ${a}: ${y}`,f);const _=u.createWebChannel(y,f);this.I_(_);let b=!1,x=!1;const k=new G4({Ho:M=>{x?ce(ln,`Not sending because RPC '${e}' stream ${a} is closed:`,M):(b||(ce(ln,`Opening RPC '${e}' stream ${a} transport.`),_.open(),b=!0),ce(ln,`RPC '${e}' stream ${a} sending:`,M),_.send(M))},Jo:()=>_.close()});return au(_,cu.EventType.OPEN,(()=>{x||(ce(ln,`RPC '${e}' stream ${a} transport opened.`),k.i_())})),au(_,cu.EventType.CLOSE,(()=>{x||(x=!0,ce(ln,`RPC '${e}' stream ${a} transport closed`),k.o_(),this.E_(_))})),au(_,cu.EventType.ERROR,(M=>{x||(x=!0,xl(ln,`RPC '${e}' stream ${a} transport errored. Name:`,M.name,"Message:",M.message),k.o_(new he(te.UNAVAILABLE,"The operation could not be completed")))})),au(_,cu.EventType.MESSAGE,(M=>{if(!x){const j=M.data[0];xe(!!j,16349);const V=j,ee=V?.error||V[0]?.error;if(ee){ce(ln,`RPC '${e}' stream ${a} received error:`,ee);const ne=ee.status;let Y=(function(J){const C=Bt[J];if(C!==void 0)return gw(C)})(ne),ie=ee.message;ne==="NOT_FOUND"&&ie.includes("database")&&ie.includes("does not exist")&&ie.includes(this.databaseId.database)&&xl(`Database '${this.databaseId.database}' not found. Please check your project configuration.`),Y===void 0&&(Y=te.INTERNAL,ie="Unknown error status: "+ne+" with message "+ee.message),x=!0,k.o_(new he(Y,ie)),_.close()}else ce(ln,`RPC '${e}' stream ${a} received:`,j),k.__(j)}})),_l.u_(),setTimeout((()=>{k.s_()}),0),k}terminate(){this.a_.forEach((e=>e.close())),this.a_=[]}I_(e){this.a_.push(e)}E_(e){this.a_=this.a_.filter((t=>t===e))}Go(e,t,i){super.Go(e,t,i),this.databaseInfo.apiKey&&(e["x-goog-api-key"]=this.databaseInfo.apiKey)}createWebChannelTransport(){return pS()}}function Q4(s){return new _l(s)}function sA(){return typeof window<"u"?window:null}function ff(){return typeof document<"u"?document:null}function gm(s){return new JO(s,!0)}_l.c_=!1;class rA{constructor(e,t,i=1e3,a=1.5,l=6e4){this.Ci=e,this.timerId=t,this.R_=i,this.A_=a,this.V_=l,this.d_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.d_=0}g_(){this.d_=this.V_}p_(e){this.cancel();const t=Math.floor(this.d_+this.y_()),i=Math.max(0,Date.now()-this.f_),a=Math.max(0,t-i);a>0&&ce("ExponentialBackoff",`Backing off for ${a} ms (base delay: ${this.d_} ms, delay with jitter: ${t} ms, last attempt: ${i} ms ago)`),this.m_=this.Ci.enqueueAfterDelay(this.timerId,a,(()=>(this.f_=Date.now(),e()))),this.d_*=this.A_,this.d_<this.R_&&(this.d_=this.R_),this.d_>this.V_&&(this.d_=this.V_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.d_}}const _x="PersistentStream";class aA{constructor(e,t,i,a,l,u,f,p){this.Ci=e,this.b_=i,this.S_=a,this.connection=l,this.authCredentialsProvider=u,this.appCheckCredentialsProvider=f,this.listener=p,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new rA(e,t)}x_(){return this.state===1||this.state===5||this.O_()}O_(){return this.state===2||this.state===3}start(){this.F_=0,this.state!==4?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&this.C_===null&&(this.C_=this.Ci.enqueueAfterDelay(this.b_,6e4,(()=>this.k_())))}K_(e){this.q_(),this.stream.send(e)}async k_(){if(this.O_())return this.close(0)}q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,t){this.q_(),this.U_(),this.M_.cancel(),this.D_++,e!==4?this.M_.reset():t&&t.code===te.RESOURCE_EXHAUSTED?(Nt(t.toString()),Nt("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):t&&t.code===te.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.W_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.t_(t)}W_(){}auth(){this.state=1;const e=this.Q_(this.D_),t=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then((([i,a])=>{this.D_===t&&this.G_(i,a)}),(i=>{e((()=>{const a=new he(te.UNKNOWN,"Fetching auth token failed: "+i.message);return this.z_(a)}))}))}G_(e,t){const i=this.Q_(this.D_);this.stream=this.j_(e,t),this.stream.Zo((()=>{i((()=>this.listener.Zo()))})),this.stream.Yo((()=>{i((()=>(this.state=2,this.v_=this.Ci.enqueueAfterDelay(this.S_,1e4,(()=>(this.O_()&&(this.state=3),Promise.resolve()))),this.listener.Yo())))})),this.stream.t_((a=>{i((()=>this.z_(a)))})),this.stream.onMessage((a=>{i((()=>++this.F_==1?this.H_(a):this.onNext(a)))}))}N_(){this.state=5,this.M_.p_((async()=>{this.state=0,this.start()}))}z_(e){return ce(_x,`close with error: ${e}`),this.stream=null,this.close(4,e)}Q_(e){return t=>{this.Ci.enqueueAndForget((()=>this.D_===e?t():(ce(_x,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())))}}}class K4 extends aA{constructor(e,t,i,a,l,u){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,i,a,u),this.serializer=l}j_(e,t){return this.connection.T_("Listen",e,t)}H_(e){return this.onNext(e)}onNext(e){this.M_.reset();const t=t4(this.serializer,e),i=(function(l){if(!("targetChange"in l))return Ae.min();const u=l.targetChange;return u.targetIds&&u.targetIds.length?Ae.min():u.readTime?yn(u.readTime):Ae.min()})(e);return this.listener.J_(t,i)}Z_(e){const t={};t.database=xy(this.serializer),t.addTarget=(function(l,u){let f;const p=u.target;if(f=Df(p)?{documents:Sw(l,p)}:{query:ww(l,p).ft},f.targetId=u.targetId,u.resumeToken.approximateByteSize()>0){f.resumeToken=_w(l,u.resumeToken);const y=Ey(l,u.expectedCount);y!==null&&(f.expectedCount=y)}else if(u.snapshotVersion.compareTo(Ae.min())>0){f.readTime=Pl(l,u.snapshotVersion.toTimestamp());const y=Ey(l,u.expectedCount);y!==null&&(f.expectedCount=y)}return f})(this.serializer,e);const i=i4(this.serializer,e);i&&(t.labels=i),this.K_(t)}X_(e){const t={};t.database=xy(this.serializer),t.removeTarget=e,this.K_(t)}}class $4 extends aA{constructor(e,t,i,a,l,u){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,i,a,u),this.serializer=l}get Y_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}W_(){this.Y_&&this.ea([])}j_(e,t){return this.connection.T_("Write",e,t)}H_(e){return xe(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,xe(!e.writeResults||e.writeResults.length===0,55816),this.listener.ta()}onNext(e){xe(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.M_.reset();const t=n4(e.writeResults,e.commitTime),i=yn(e.commitTime);return this.listener.na(i,t)}ra(){const e={};e.database=xy(this.serializer),this.K_(e)}ea(e){const t={streamToken:this.lastStreamToken,writes:e.map((i=>Of(this.serializer,i)))};this.K_(t)}}class W4{}class Y4 extends W4{constructor(e,t,i,a){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=i,this.serializer=a,this.ia=!1}sa(){if(this.ia)throw new he(te.FAILED_PRECONDITION,"The client has already been terminated.")}Wo(e,t,i,a){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([l,u])=>this.connection.Wo(e,Ty(t,i),a,l,u))).catch((l=>{throw l.name==="FirebaseError"?(l.code===te.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),l):new he(te.UNKNOWN,l.toString())}))}jo(e,t,i,a,l){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([u,f])=>this.connection.jo(e,Ty(t,i),a,u,f,l))).catch((u=>{throw u.name==="FirebaseError"?(u.code===te.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),u):new he(te.UNKNOWN,u.toString())}))}terminate(){this.ia=!0,this.connection.terminate()}}function X4(s,e,t,i){return new Y4(s,e,t,i)}class J4{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){this.oa===0&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve()))))}ha(e){this.state==="Online"?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ca("Offline")))}set(e){this.Pa(),this.oa=0,e==="Online"&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){const t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(Nt(t),this.aa=!1):ce("OnlineStateTracker",t)}Pa(){this._a!==null&&(this._a.cancel(),this._a=null)}}const ao="RemoteStore";class Z4{constructor(e,t,i,a,l){this.localStore=e,this.datastore=t,this.asyncQueue=i,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.Ra=[],this.Aa=l,this.Aa.Mo((u=>{i.enqueueAndForget((async()=>{uo(this)&&(ce(ao,"Restarting streams for network reachability change."),await(async function(p){const y=be(p);y.Ea.add(4),await nh(y),y.Va.set("Unknown"),y.Ea.delete(4),await ym(y)})(this))}))})),this.Va=new J4(i,a)}}async function ym(s){if(uo(s))for(const e of s.Ra)await e(!0)}async function nh(s){for(const e of s.Ra)await e(!1)}function vm(s,e){const t=be(s);t.Ia.has(e.targetId)||(t.Ia.set(e.targetId,e),Iv(t)?Av(t):Xl(t).O_()&&wv(t,e))}function Ul(s,e){const t=be(s),i=Xl(t);t.Ia.delete(e),i.O_()&&oA(t,e),t.Ia.size===0&&(i.O_()?i.L_():uo(t)&&t.Va.set("Unknown"))}function wv(s,e){if(s.da.$e(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(Ae.min())>0){const t=s.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}Xl(s).Z_(e)}function oA(s,e){s.da.$e(e),Xl(s).X_(e)}function Av(s){s.da=new $O({getRemoteKeysForTarget:e=>s.remoteSyncer.getRemoteKeysForTarget(e),At:e=>s.Ia.get(e)||null,ht:()=>s.datastore.serializer.databaseId}),Xl(s).start(),s.Va.ua()}function Iv(s){return uo(s)&&!Xl(s).x_()&&s.Ia.size>0}function uo(s){return be(s).Ea.size===0}function lA(s){s.da=void 0}async function eM(s){s.Va.set("Online")}async function tM(s){s.Ia.forEach(((e,t)=>{wv(s,e)}))}async function nM(s,e){lA(s),Iv(s)?(s.Va.ha(e),Av(s)):s.Va.set("Unknown")}async function iM(s,e,t){if(s.Va.set("Online"),e instanceof vw&&e.state===2&&e.cause)try{await(async function(a,l){const u=l.cause;for(const f of l.targetIds)a.Ia.has(f)&&(await a.remoteSyncer.rejectListen(f,u),a.Ia.delete(f),a.da.removeTarget(f))})(s,e)}catch(i){ce(ao,"Failed to remove targets %s: %s ",e.targetIds.join(","),i),await Ff(s,i)}else if(e instanceof hf?s.da.Xe(e):e instanceof yw?s.da.st(e):s.da.tt(e),!t.isEqual(Ae.min()))try{const i=await Yw(s.localStore);t.compareTo(i)>=0&&await(function(l,u){const f=l.da.Tt(u);return f.targetChanges.forEach(((p,y)=>{if(p.resumeToken.approximateByteSize()>0){const _=l.Ia.get(y);_&&l.Ia.set(y,_.withResumeToken(p.resumeToken,u))}})),f.targetMismatches.forEach(((p,y)=>{const _=l.Ia.get(p);if(!_)return;l.Ia.set(p,_.withResumeToken(kt.EMPTY_BYTE_STRING,_.snapshotVersion)),oA(l,p);const b=new zs(_.target,p,y,_.sequenceNumber);wv(l,b)})),l.remoteSyncer.applyRemoteEvent(f)})(s,t)}catch(i){ce(ao,"Failed to raise snapshot:",i),await Ff(s,i)}}async function Ff(s,e,t){if(!ta(e))throw e;s.Ea.add(1),await nh(s),s.Va.set("Offline"),t||(t=()=>Yw(s.localStore)),s.asyncQueue.enqueueRetryable((async()=>{ce(ao,"Retrying IndexedDB access"),await t(),s.Ea.delete(1),await ym(s)}))}function cA(s,e){return e().catch((t=>Ff(s,t,e)))}async function Yl(s){const e=be(s),t=Xr(e);let i=e.Ta.length>0?e.Ta[e.Ta.length-1].batchId:Qa;for(;sM(e);)try{const a=await B4(e.localStore,i);if(a===null){e.Ta.length===0&&t.L_();break}i=a.batchId,rM(e,a)}catch(a){await Ff(e,a)}uA(e)&&hA(e)}function sM(s){return uo(s)&&s.Ta.length<10}function rM(s,e){s.Ta.push(e);const t=Xr(s);t.O_()&&t.Y_&&t.ea(e.mutations)}function uA(s){return uo(s)&&!Xr(s).x_()&&s.Ta.length>0}function hA(s){Xr(s).start()}async function aM(s){Xr(s).ra()}async function oM(s){const e=Xr(s);for(const t of s.Ta)e.ea(t.mutations)}async function lM(s,e,t){const i=s.Ta.shift(),a=fv.from(i,e,t);await cA(s,(()=>s.remoteSyncer.applySuccessfulWrite(a))),await Yl(s)}async function cM(s,e){e&&Xr(s).Y_&&await(async function(i,a){if((function(u){return GO(u)&&u!==te.ABORTED})(a.code)){const l=i.Ta.shift();Xr(i).B_(),await cA(i,(()=>i.remoteSyncer.rejectFailedWrite(l.batchId,a))),await Yl(i)}})(s,e),uA(s)&&hA(s)}async function bx(s,e){const t=be(s);t.asyncQueue.verifyOperationInProgress(),ce(ao,"RemoteStore received new credentials");const i=uo(t);t.Ea.add(3),await nh(t),i&&t.Va.set("Unknown"),await t.remoteSyncer.handleCredentialChange(e),t.Ea.delete(3),await ym(t)}async function Ny(s,e){const t=be(s);e?(t.Ea.delete(2),await ym(t)):e||(t.Ea.add(2),await nh(t),t.Va.set("Unknown"))}function Xl(s){return s.ma||(s.ma=(function(t,i,a){const l=be(t);return l.sa(),new K4(i,l.connection,l.authCredentials,l.appCheckCredentials,l.serializer,a)})(s.datastore,s.asyncQueue,{Zo:eM.bind(null,s),Yo:tM.bind(null,s),t_:nM.bind(null,s),J_:iM.bind(null,s)}),s.Ra.push((async e=>{e?(s.ma.B_(),Iv(s)?Av(s):s.Va.set("Unknown")):(await s.ma.stop(),lA(s))}))),s.ma}function Xr(s){return s.fa||(s.fa=(function(t,i,a){const l=be(t);return l.sa(),new $4(i,l.connection,l.authCredentials,l.appCheckCredentials,l.serializer,a)})(s.datastore,s.asyncQueue,{Zo:()=>Promise.resolve(),Yo:aM.bind(null,s),t_:cM.bind(null,s),ta:oM.bind(null,s),na:lM.bind(null,s)}),s.Ra.push((async e=>{e?(s.fa.B_(),await Yl(s)):(await s.fa.stop(),s.Ta.length>0&&(ce(ao,`Stopping write stream with ${s.Ta.length} pending writes`),s.Ta=[]))}))),s.fa}class Cv{constructor(e,t,i,a,l){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=i,this.op=a,this.removalCallback=l,this.deferred=new ls,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((u=>{}))}get promise(){return this.deferred.promise}static createAndSchedule(e,t,i,a,l){const u=Date.now()+i,f=new Cv(e,t,u,a,l);return f.start(i),f}start(e){this.timerHandle=setTimeout((()=>this.handleDelayElapsed()),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new he(te.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget((()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then((e=>this.deferred.resolve(e)))):Promise.resolve()))}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function Rv(s,e){if(Nt("AsyncQueue",`${e}: ${s}`),ta(s))return new he(te.UNAVAILABLE,`${e}: ${s}`);throw s}class bl{static emptySet(e){return new bl(e.comparator)}constructor(e){this.comparator=e?(t,i)=>e(t,i)||me.comparator(t.key,i.key):(t,i)=>me.comparator(t.key,i.key),this.keyedMap=uu(),this.sortedSet=new dt(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal(((t,i)=>(e(t),!1)))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof bl)||this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),i=e.sortedSet.getIterator();for(;t.hasNext();){const a=t.getNext().key,l=i.getNext().key;if(!a.isEqual(l))return!1}return!0}toString(){const e=[];return this.forEach((t=>{e.push(t.toString())})),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){const i=new bl;return i.comparator=this.comparator,i.keyedMap=e,i.sortedSet=t,i}}class Ex{constructor(){this.ga=new dt(me.comparator)}track(e){const t=e.doc.key,i=this.ga.get(t);i?e.type!==0&&i.type===3?this.ga=this.ga.insert(t,e):e.type===3&&i.type!==1?this.ga=this.ga.insert(t,{type:i.type,doc:e.doc}):e.type===2&&i.type===2?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):e.type===2&&i.type===0?this.ga=this.ga.insert(t,{type:0,doc:e.doc}):e.type===1&&i.type===0?this.ga=this.ga.remove(t):e.type===1&&i.type===2?this.ga=this.ga.insert(t,{type:1,doc:i.doc}):e.type===0&&i.type===1?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):ve(63341,{Vt:e,pa:i}):this.ga=this.ga.insert(t,e)}ya(){const e=[];return this.ga.inorderTraversal(((t,i)=>{e.push(i)})),e}}class zl{constructor(e,t,i,a,l,u,f,p,y){this.query=e,this.docs=t,this.oldDocs=i,this.docChanges=a,this.mutatedKeys=l,this.fromCache=u,this.syncStateChanged=f,this.excludesMetadataChanges=p,this.hasCachedResults=y}static fromInitialDocuments(e,t,i,a,l){const u=[];return t.forEach((f=>{u.push({type:0,doc:f})})),new zl(e,t,bl.emptySet(t),u,i,a,!0,!1,l)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&um(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,i=e.docChanges;if(t.length!==i.length)return!1;for(let a=0;a<t.length;a++)if(t[a].type!==i[a].type||!t[a].doc.isEqual(i[a].doc))return!1;return!0}}class uM{constructor(){this.wa=void 0,this.ba=[]}Sa(){return this.ba.some((e=>e.Da()))}}class hM{constructor(){this.queries=Tx(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(t,i){const a=be(t),l=a.queries;a.queries=Tx(),l.forEach(((u,f)=>{for(const p of f.ba)p.onError(i)}))})(this,new he(te.ABORTED,"Firestore shutting down"))}}function Tx(){return new Ws((s=>tw(s)),um)}async function dA(s,e){const t=be(s);let i=3;const a=e.query;let l=t.queries.get(a);l?!l.Sa()&&e.Da()&&(i=2):(l=new uM,i=e.Da()?0:1);try{switch(i){case 0:l.wa=await t.onListen(a,!0);break;case 1:l.wa=await t.onListen(a,!1);break;case 2:await t.onFirstRemoteStoreListen(a)}}catch(u){const f=Rv(u,`Initialization of query '${hl(e.query)}' failed`);return void e.onError(f)}t.queries.set(a,l),l.ba.push(e),e.va(t.onlineState),l.wa&&e.Fa(l.wa)&&Dv(t)}async function fA(s,e){const t=be(s),i=e.query;let a=3;const l=t.queries.get(i);if(l){const u=l.ba.indexOf(e);u>=0&&(l.ba.splice(u,1),l.ba.length===0?a=e.Da()?0:1:!l.Sa()&&e.Da()&&(a=2))}switch(a){case 0:return t.queries.delete(i),t.onUnlisten(i,!0);case 1:return t.queries.delete(i),t.onUnlisten(i,!1);case 2:return t.onLastRemoteStoreUnlisten(i);default:return}}function dM(s,e){const t=be(s);let i=!1;for(const a of e){const l=a.query,u=t.queries.get(l);if(u){for(const f of u.ba)f.Fa(a)&&(i=!0);u.wa=a}}i&&Dv(t)}function fM(s,e,t){const i=be(s),a=i.queries.get(e);if(a)for(const l of a.ba)l.onError(t);i.queries.delete(e)}function Dv(s){s.Ca.forEach((e=>{e.next()}))}var jy,xx;(xx=jy||(jy={})).Ma="default",xx.Cache="cache";class mA{constructor(e,t,i){this.query=e,this.xa=t,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=i||{}}Fa(e){if(!this.options.includeMetadataChanges){const i=[];for(const a of e.docChanges)a.type!==3&&i.push(a);e=new zl(e.query,e.docs,e.oldDocs,i,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.Oa?this.Ba(e)&&(this.xa.next(e),t=!0):this.La(e,this.onlineState)&&(this.ka(e),t=!0),this.Na=e,t}onError(e){this.xa.error(e)}va(e){this.onlineState=e;let t=!1;return this.Na&&!this.Oa&&this.La(this.Na,e)&&(this.ka(this.Na),t=!0),t}La(e,t){if(!e.fromCache||!this.Da())return!0;const i=t!=="Offline";return(!this.options.Ka||!i)&&(!e.docs.isEmpty()||e.hasCachedResults||t==="Offline")}Ba(e){if(e.docChanges.length>0)return!0;const t=this.Na&&this.Na.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&this.options.includeMetadataChanges===!0}ka(e){e=zl.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Oa=!0,this.xa.next(e)}Da(){return this.options.source!==jy.Cache}}class pA{constructor(e){this.key=e}}class gA{constructor(e){this.key=e}}class mM{constructor(e,t){this.query=e,this.Za=t,this.Xa=null,this.hasCachedResults=!1,this.current=!1,this.Ya=Pe(),this.mutatedKeys=Pe(),this.eu=iw(e),this.tu=new bl(this.eu)}get nu(){return this.Za}ru(e,t){const i=t?t.iu:new Ex,a=t?t.tu:this.tu;let l=t?t.mutatedKeys:this.mutatedKeys,u=a,f=!1;const p=this.query.limitType==="F"&&a.size===this.query.limit?a.last():null,y=this.query.limitType==="L"&&a.size===this.query.limit?a.first():null;if(e.inorderTraversal(((_,b)=>{const x=a.get(_),k=Ju(this.query,b)?b:null,M=!!x&&this.mutatedKeys.has(x.key),j=!!k&&(k.hasLocalMutations||this.mutatedKeys.has(k.key)&&k.hasCommittedMutations);let V=!1;x&&k?x.data.isEqual(k.data)?M!==j&&(i.track({type:3,doc:k}),V=!0):this.su(x,k)||(i.track({type:2,doc:k}),V=!0,(p&&this.eu(k,p)>0||y&&this.eu(k,y)<0)&&(f=!0)):!x&&k?(i.track({type:0,doc:k}),V=!0):x&&!k&&(i.track({type:1,doc:x}),V=!0,(p||y)&&(f=!0)),V&&(k?(u=u.add(k),l=j?l.add(_):l.delete(_)):(u=u.delete(_),l=l.delete(_)))})),this.query.limit!==null)for(;u.size>this.query.limit;){const _=this.query.limitType==="F"?u.last():u.first();u=u.delete(_.key),l=l.delete(_.key),i.track({type:1,doc:_})}return{tu:u,iu:i,Ss:f,mutatedKeys:l}}su(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,i,a){const l=this.tu;this.tu=e.tu,this.mutatedKeys=e.mutatedKeys;const u=e.iu.ya();u.sort(((_,b)=>(function(k,M){const j=V=>{switch(V){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return ve(20277,{Vt:V})}};return j(k)-j(M)})(_.type,b.type)||this.eu(_.doc,b.doc))),this.ou(i),a=a??!1;const f=t&&!a?this._u():[],p=this.Ya.size===0&&this.current&&!a?1:0,y=p!==this.Xa;return this.Xa=p,u.length!==0||y?{snapshot:new zl(this.query,e.tu,l,u,e.mutatedKeys,p===0,y,!1,!!i&&i.resumeToken.approximateByteSize()>0),au:f}:{au:f}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({tu:this.tu,iu:new Ex,mutatedKeys:this.mutatedKeys,Ss:!1},!1)):{au:[]}}uu(e){return!this.Za.has(e)&&!!this.tu.has(e)&&!this.tu.get(e).hasLocalMutations}ou(e){e&&(e.addedDocuments.forEach((t=>this.Za=this.Za.add(t))),e.modifiedDocuments.forEach((t=>{})),e.removedDocuments.forEach((t=>this.Za=this.Za.delete(t))),this.current=e.current)}_u(){if(!this.current)return[];const e=this.Ya;this.Ya=Pe(),this.tu.forEach((i=>{this.uu(i.key)&&(this.Ya=this.Ya.add(i.key))}));const t=[];return e.forEach((i=>{this.Ya.has(i)||t.push(new gA(i))})),this.Ya.forEach((i=>{e.has(i)||t.push(new pA(i))})),t}cu(e){this.Za=e.ks,this.Ya=Pe();const t=this.ru(e.documents);return this.applyChanges(t,!0)}lu(){return zl.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,this.Xa===0,this.hasCachedResults)}}const Jl="SyncEngine";class pM{constructor(e,t,i){this.query=e,this.targetId=t,this.view=i}}class gM{constructor(e){this.key=e,this.hu=!1}}class yM{constructor(e,t,i,a,l,u){this.localStore=e,this.remoteStore=t,this.eventManager=i,this.sharedClientState=a,this.currentUser=l,this.maxConcurrentLimboResolutions=u,this.Pu={},this.Tu=new Ws((f=>tw(f)),um),this.Iu=new Map,this.Eu=new Set,this.Ru=new dt(me.comparator),this.Au=new Map,this.Vu=new _v,this.du={},this.mu=new Map,this.fu=ro.ar(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return this.gu===!0}}async function vM(s,e,t=!0){const i=_m(s);let a;const l=i.Tu.get(e);return l?(i.sharedClientState.addLocalQueryTarget(l.targetId),a=l.view.lu()):a=await yA(i,e,t,!0),a}async function _M(s,e){const t=_m(s);await yA(t,e,!0,!1)}async function yA(s,e,t,i){const a=await Uf(s.localStore,Hn(e)),l=a.targetId,u=s.sharedClientState.addLocalQueryTarget(l,t);let f;return i&&(f=await Nv(s,e,l,u==="current",a.resumeToken)),s.isPrimaryClient&&t&&vm(s.remoteStore,a),f}async function Nv(s,e,t,i,a){s.pu=(b,x,k)=>(async function(j,V,ee,ne){let Y=V.view.ru(ee);Y.Ss&&(Y=await Cy(j.localStore,V.query,!1).then((({documents:C})=>V.view.ru(C,Y))));const ie=ne&&ne.targetChanges.get(V.targetId),F=ne&&ne.targetMismatches.get(V.targetId)!=null,J=V.view.applyChanges(Y,j.isPrimaryClient,ie,F);return ky(j,V.targetId,J.au),J.snapshot})(s,b,x,k);const l=await Cy(s.localStore,e,!0),u=new mM(e,l.ks),f=u.ru(l.documents),p=th.createSynthesizedTargetChangeForCurrentChange(t,i&&s.onlineState!=="Offline",a),y=u.applyChanges(f,s.isPrimaryClient,p);ky(s,t,y.au);const _=new pM(e,t,u);return s.Tu.set(e,_),s.Iu.has(t)?s.Iu.get(t).push(e):s.Iu.set(t,[e]),y.snapshot}async function bM(s,e,t){const i=be(s),a=i.Tu.get(e),l=i.Iu.get(a.targetId);if(l.length>1)return i.Iu.set(a.targetId,l.filter((u=>!um(u,e)))),void i.Tu.delete(e);i.isPrimaryClient?(i.sharedClientState.removeLocalQueryTarget(a.targetId),i.sharedClientState.isActiveQueryTarget(a.targetId)||await Ll(i.localStore,a.targetId,!1).then((()=>{i.sharedClientState.clearQueryState(a.targetId),t&&Ul(i.remoteStore,a.targetId),Bl(i,a.targetId)})).catch(ea)):(Bl(i,a.targetId),await Ll(i.localStore,a.targetId,!0))}async function EM(s,e){const t=be(s),i=t.Tu.get(e),a=t.Iu.get(i.targetId);t.isPrimaryClient&&a.length===1&&(t.sharedClientState.removeLocalQueryTarget(i.targetId),Ul(t.remoteStore,i.targetId))}async function TM(s,e,t){const i=Mv(s);try{const a=await(function(u,f){const p=be(u),y=it.now(),_=f.reduce(((k,M)=>k.add(M.key)),Pe());let b,x;return p.persistence.runTransaction("Locally write mutations","readwrite",(k=>{let M=qn(),j=Pe();return p.xs.getEntries(k,_).next((V=>{M=V,M.forEach(((ee,ne)=>{ne.isValidDocument()||(j=j.add(ee))}))})).next((()=>p.localDocuments.getOverlayedDocuments(k,M))).next((V=>{b=V;const ee=[];for(const ne of f){const Y=qO(ne,b.get(ne.key).overlayedDocument);Y!=null&&ee.push(new Ys(ne.key,Y,GS(Y.value.mapValue),Gt.exists(!0)))}return p.mutationQueue.addMutationBatch(k,y,ee,f)})).next((V=>{x=V;const ee=V.applyToLocalDocumentSet(b,j);return p.documentOverlayCache.saveOverlays(k,V.batchId,ee)}))})).then((()=>({batchId:x.batchId,changes:rw(b)})))})(i.localStore,e);i.sharedClientState.addPendingMutation(a.batchId),(function(u,f,p){let y=u.du[u.currentUser.toKey()];y||(y=new dt(De)),y=y.insert(f,p),u.du[u.currentUser.toKey()]=y})(i,a.batchId,t),await ia(i,a.changes),await Yl(i.remoteStore)}catch(a){const l=Rv(a,"Failed to persist write");t.reject(l)}}async function vA(s,e){const t=be(s);try{const i=await U4(t.localStore,e);e.targetChanges.forEach(((a,l)=>{const u=t.Au.get(l);u&&(xe(a.addedDocuments.size+a.modifiedDocuments.size+a.removedDocuments.size<=1,22616),a.addedDocuments.size>0?u.hu=!0:a.modifiedDocuments.size>0?xe(u.hu,14607):a.removedDocuments.size>0&&(xe(u.hu,42227),u.hu=!1))})),await ia(t,i,e)}catch(i){await ea(i)}}function Sx(s,e,t){const i=be(s);if(i.isPrimaryClient&&t===0||!i.isPrimaryClient&&t===1){const a=[];i.Tu.forEach(((l,u)=>{const f=u.view.va(e);f.snapshot&&a.push(f.snapshot)})),(function(u,f){const p=be(u);p.onlineState=f;let y=!1;p.queries.forEach(((_,b)=>{for(const x of b.ba)x.va(f)&&(y=!0)})),y&&Dv(p)})(i.eventManager,e),a.length&&i.Pu.J_(a),i.onlineState=e,i.isPrimaryClient&&i.sharedClientState.setOnlineState(e)}}async function xM(s,e,t){const i=be(s);i.sharedClientState.updateQueryState(e,"rejected",t);const a=i.Au.get(e),l=a&&a.key;if(l){let u=new dt(me.comparator);u=u.insert(l,At.newNoDocument(l,Ae.min()));const f=Pe().add(l),p=new eh(Ae.min(),new Map,new dt(De),u,f);await vA(i,p),i.Ru=i.Ru.remove(l),i.Au.delete(e),Ov(i)}else await Ll(i.localStore,e,!1).then((()=>Bl(i,e,t))).catch(ea)}async function SM(s,e){const t=be(s),i=e.batch.batchId;try{const a=await L4(t.localStore,e);kv(t,i,null),jv(t,i),t.sharedClientState.updateMutationState(i,"acknowledged"),await ia(t,a)}catch(a){await ea(a)}}async function wM(s,e,t){const i=be(s);try{const a=await(function(u,f){const p=be(u);return p.persistence.runTransaction("Reject batch","readwrite-primary",(y=>{let _;return p.mutationQueue.lookupMutationBatch(y,f).next((b=>(xe(b!==null,37113),_=b.keys(),p.mutationQueue.removeMutationBatch(y,b)))).next((()=>p.mutationQueue.performConsistencyCheck(y))).next((()=>p.documentOverlayCache.removeOverlaysForBatchId(y,_,f))).next((()=>p.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(y,_))).next((()=>p.localDocuments.getDocuments(y,_)))}))})(i.localStore,e);kv(i,e,t),jv(i,e),i.sharedClientState.updateMutationState(e,"rejected",t),await ia(i,a)}catch(a){await ea(a)}}function jv(s,e){(s.mu.get(e)||[]).forEach((t=>{t.resolve()})),s.mu.delete(e)}function kv(s,e,t){const i=be(s);let a=i.du[i.currentUser.toKey()];if(a){const l=a.get(e);l&&(t?l.reject(t):l.resolve(),a=a.remove(e)),i.du[i.currentUser.toKey()]=a}}function Bl(s,e,t=null){s.sharedClientState.removeLocalQueryTarget(e);for(const i of s.Iu.get(e))s.Tu.delete(i),t&&s.Pu.yu(i,t);s.Iu.delete(e),s.isPrimaryClient&&s.Vu.Gr(e).forEach((i=>{s.Vu.containsKey(i)||_A(s,i)}))}function _A(s,e){s.Eu.delete(e.path.canonicalString());const t=s.Ru.get(e);t!==null&&(Ul(s.remoteStore,t),s.Ru=s.Ru.remove(e),s.Au.delete(t),Ov(s))}function ky(s,e,t){for(const i of t)i instanceof pA?(s.Vu.addReference(i.key,e),AM(s,i)):i instanceof gA?(ce(Jl,"Document no longer in limbo: "+i.key),s.Vu.removeReference(i.key,e),s.Vu.containsKey(i.key)||_A(s,i.key)):ve(19791,{wu:i})}function AM(s,e){const t=e.key,i=t.path.canonicalString();s.Ru.get(t)||s.Eu.has(i)||(ce(Jl,"New document in limbo: "+t),s.Eu.add(i),Ov(s))}function Ov(s){for(;s.Eu.size>0&&s.Ru.size<s.maxConcurrentLimboResolutions;){const e=s.Eu.values().next().value;s.Eu.delete(e);const t=new me(Ze.fromString(e)),i=s.fu.next();s.Au.set(i,new gM(t)),s.Ru=s.Ru.insert(t,i),vm(s.remoteStore,new zs(Hn(cm(t.path)),i,"TargetPurposeLimboResolution",In.ce))}}async function ia(s,e,t){const i=be(s),a=[],l=[],u=[];i.Tu.isEmpty()||(i.Tu.forEach(((f,p)=>{u.push(i.pu(p,e,t).then((y=>{if((y||t)&&i.isPrimaryClient){const _=y?!y.fromCache:t?.targetChanges.get(p.targetId)?.current;i.sharedClientState.updateQueryState(p.targetId,_?"current":"not-current")}if(y){a.push(y);const _=Tv.Es(p.targetId,y);l.push(_)}})))})),await Promise.all(u),i.Pu.J_(a),await(async function(p,y){const _=be(p);try{await _.persistence.runTransaction("notifyLocalViewChanges","readwrite",(b=>H.forEach(y,(x=>H.forEach(x.Ts,(k=>_.persistence.referenceDelegate.addReference(b,x.targetId,k))).next((()=>H.forEach(x.Is,(k=>_.persistence.referenceDelegate.removeReference(b,x.targetId,k)))))))))}catch(b){if(!ta(b))throw b;ce(xv,"Failed to update sequence numbers: "+b)}for(const b of y){const x=b.targetId;if(!b.fromCache){const k=_.vs.get(x),M=k.snapshotVersion,j=k.withLastLimboFreeSnapshotVersion(M);_.vs=_.vs.insert(x,j)}}})(i.localStore,l))}async function IM(s,e){const t=be(s);if(!t.currentUser.isEqual(e)){ce(Jl,"User change. New user:",e.toKey());const i=await Ww(t.localStore,e);t.currentUser=e,(function(l,u){l.mu.forEach((f=>{f.forEach((p=>{p.reject(new he(te.CANCELLED,u))}))})),l.mu.clear()})(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,i.removedBatchIds,i.addedBatchIds),await ia(t,i.Ns)}}function CM(s,e){const t=be(s),i=t.Au.get(e);if(i&&i.hu)return Pe().add(i.key);{let a=Pe();const l=t.Iu.get(e);if(!l)return a;for(const u of l){const f=t.Tu.get(u);a=a.unionWith(f.view.nu)}return a}}async function RM(s,e){const t=be(s),i=await Cy(t.localStore,e.query,!0),a=e.view.cu(i);return t.isPrimaryClient&&ky(t,e.targetId,a.au),a}async function DM(s,e){const t=be(s);return Jw(t.localStore,e).then((i=>ia(t,i)))}async function NM(s,e,t,i){const a=be(s),l=await(function(f,p){const y=be(f),_=be(y.mutationQueue);return y.persistence.runTransaction("Lookup mutation documents","readonly",(b=>_.Xn(b,p).next((x=>x?y.localDocuments.getDocuments(b,x):H.resolve(null)))))})(a.localStore,e);l!==null?(t==="pending"?await Yl(a.remoteStore):t==="acknowledged"||t==="rejected"?(kv(a,e,i||null),jv(a,e),(function(f,p){be(be(f).mutationQueue).nr(p)})(a.localStore,e)):ve(6720,"Unknown batchState",{bu:t}),await ia(a,l)):ce(Jl,"Cannot apply mutation batch with id: "+e)}async function jM(s,e){const t=be(s);if(_m(t),Mv(t),e===!0&&t.gu!==!0){const i=t.sharedClientState.getAllActiveQueryTargets(),a=await wx(t,i.toArray());t.gu=!0,await Ny(t.remoteStore,!0);for(const l of a)vm(t.remoteStore,l)}else if(e===!1&&t.gu!==!1){const i=[];let a=Promise.resolve();t.Iu.forEach(((l,u)=>{t.sharedClientState.isLocalQueryTarget(u)?i.push(u):a=a.then((()=>(Bl(t,u),Ll(t.localStore,u,!0)))),Ul(t.remoteStore,u)})),await a,await wx(t,i),(function(u){const f=be(u);f.Au.forEach(((p,y)=>{Ul(f.remoteStore,y)})),f.Vu.zr(),f.Au=new Map,f.Ru=new dt(me.comparator)})(t),t.gu=!1,await Ny(t.remoteStore,!1)}}async function wx(s,e,t){const i=be(s),a=[],l=[];for(const u of e){let f;const p=i.Iu.get(u);if(p&&p.length!==0){f=await Uf(i.localStore,Hn(p[0]));for(const y of p){const _=i.Tu.get(y),b=await RM(i,_);b.snapshot&&l.push(b.snapshot)}}else{const y=await Xw(i.localStore,u);f=await Uf(i.localStore,y),await Nv(i,bA(y),u,!1,f.resumeToken)}a.push(f)}return i.Pu.J_(l),a}function bA(s){return ZS(s.path,s.collectionGroup,s.orderBy,s.filters,s.limit,"F",s.startAt,s.endAt)}function kM(s){return(function(t){return be(be(t).persistence).hs()})(be(s).localStore)}async function OM(s,e,t,i){const a=be(s);if(a.gu)return void ce(Jl,"Ignoring unexpected query state notification.");const l=a.Iu.get(e);if(l&&l.length>0)switch(t){case"current":case"not-current":{const u=await Jw(a.localStore,nw(l[0])),f=eh.createSynthesizedRemoteEventForCurrentChange(e,t==="current",kt.EMPTY_BYTE_STRING);await ia(a,u,f);break}case"rejected":await Ll(a.localStore,e,!0),Bl(a,e,i);break;default:ve(64155,t)}}async function MM(s,e,t){const i=_m(s);if(i.gu){for(const a of e){if(i.Iu.has(a)&&i.sharedClientState.isActiveQueryTarget(a)){ce(Jl,"Adding an already active target "+a);continue}const l=await Xw(i.localStore,a),u=await Uf(i.localStore,l);await Nv(i,bA(l),u.targetId,!1,u.resumeToken),vm(i.remoteStore,u)}for(const a of t)i.Iu.has(a)&&await Ll(i.localStore,a,!1).then((()=>{Ul(i.remoteStore,a),Bl(i,a)})).catch(ea)}}function _m(s){const e=be(s);return e.remoteStore.remoteSyncer.applyRemoteEvent=vA.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=CM.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=xM.bind(null,e),e.Pu.J_=dM.bind(null,e.eventManager),e.Pu.yu=fM.bind(null,e.eventManager),e}function Mv(s){const e=be(s);return e.remoteStore.remoteSyncer.applySuccessfulWrite=SM.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=wM.bind(null,e),e}class Uu{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=gm(e.databaseInfo.databaseId),this.sharedClientState=this.Du(e),this.persistence=this.Cu(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Fu(e,this.localStore),this.indexBackfillerScheduler=this.Mu(e,this.localStore)}Fu(e,t){return null}Mu(e,t){return null}vu(e){return $w(this.persistence,new Kw,e.initialUser,this.serializer)}Cu(e){return new bv(pm.Vi,this.serializer)}Du(e){return new iA}async terminate(){this.gcScheduler?.stop(),this.indexBackfillerScheduler?.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}Uu.provider={build:()=>new Uu};class VM extends Uu{constructor(e){super(),this.cacheSizeBytes=e}Fu(e,t){xe(this.persistence.referenceDelegate instanceof Lf,46915);const i=this.persistence.referenceDelegate.garbageCollector;return new Bw(i,e.asyncQueue,t)}Cu(e){const t=this.cacheSizeBytes!==void 0?hn.withCacheSize(this.cacheSizeBytes):hn.DEFAULT;return new bv((i=>Lf.Vi(i,t)),this.serializer)}}class EA extends Uu{constructor(e,t,i){super(),this.xu=e,this.cacheSizeBytes=t,this.forceOwnership=i,this.kind="persistent",this.synchronizeTabs=!1}async initialize(e){await super.initialize(e),await this.xu.initialize(this,e),await Mv(this.xu.syncEngine),await Yl(this.xu.remoteStore),await this.persistence.zi((()=>(this.gcScheduler&&!this.gcScheduler.started&&this.gcScheduler.start(),this.indexBackfillerScheduler&&!this.indexBackfillerScheduler.started&&this.indexBackfillerScheduler.start(),Promise.resolve())))}vu(e){return $w(this.persistence,new Kw,e.initialUser,this.serializer)}Fu(e,t){const i=this.persistence.referenceDelegate.garbageCollector;return new Bw(i,e.asyncQueue,t)}Mu(e,t){const i=new qk(t,this.persistence);return new Fk(e.asyncQueue,i)}Cu(e){const t=Qw(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),i=this.cacheSizeBytes!==void 0?hn.withCacheSize(this.cacheSizeBytes):hn.DEFAULT;return new Ev(this.synchronizeTabs,t,e.clientId,i,e.asyncQueue,sA(),ff(),this.serializer,this.sharedClientState,!!this.forceOwnership)}Du(e){return new iA}}class PM extends EA{constructor(e,t){super(e,t,!1),this.xu=e,this.cacheSizeBytes=t,this.synchronizeTabs=!0}async initialize(e){await super.initialize(e);const t=this.xu.syncEngine;this.sharedClientState instanceof Hg&&(this.sharedClientState.syncEngine={So:NM.bind(null,t),Do:OM.bind(null,t),Co:MM.bind(null,t),hs:kM.bind(null,t),bo:DM.bind(null,t)},await this.sharedClientState.start()),await this.persistence.zi((async i=>{await jM(this.xu.syncEngine,i),this.gcScheduler&&(i&&!this.gcScheduler.started?this.gcScheduler.start():i||this.gcScheduler.stop()),this.indexBackfillerScheduler&&(i&&!this.indexBackfillerScheduler.started?this.indexBackfillerScheduler.start():i||this.indexBackfillerScheduler.stop())}))}Du(e){const t=sA();if(!Hg.v(t))throw new he(te.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");const i=Qw(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey);return new Hg(t,e.asyncQueue,i,e.clientId,e.initialUser)}}class zu{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=i=>Sx(this.syncEngine,i,1),this.remoteStore.remoteSyncer.handleCredentialChange=IM.bind(null,this.syncEngine),await Ny(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return(function(){return new hM})()}createDatastore(e){const t=gm(e.databaseInfo.databaseId),i=Q4(e.databaseInfo);return X4(e.authCredentials,e.appCheckCredentials,i,t)}createRemoteStore(e){return(function(i,a,l,u,f){return new Z4(i,a,l,u,f)})(this.localStore,this.datastore,e.asyncQueue,(t=>Sx(this.syncEngine,t,0)),(function(){return vx.v()?new vx:new F4})())}createSyncEngine(e,t){return(function(a,l,u,f,p,y,_){const b=new yM(a,l,u,f,p,y);return _&&(b.gu=!0),b})(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}async terminate(){await(async function(t){const i=be(t);ce(ao,"RemoteStore shutting down."),i.Ea.add(5),await nh(i),i.Aa.shutdown(),i.Va.set("Unknown")})(this.remoteStore),this.datastore?.terminate(),this.eventManager?.terminate()}}zu.provider={build:()=>new zu};class TA{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ou(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ou(this.observer.error,e):Nt("Uncaught Error in snapshot listener:",e.toString()))}Nu(){this.muted=!0}Ou(e,t){setTimeout((()=>{this.muted||e(t)}),0)}}const Jr="FirestoreClient";class LM{constructor(e,t,i,a,l){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=i,this._databaseInfo=a,this.user=un.UNAUTHENTICATED,this.clientId=Zy.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=l,this.authCredentials.start(i,(async u=>{ce(Jr,"Received user=",u.uid),await this.authCredentialListener(u),this.user=u})),this.appCheckCredentials.start(i,(u=>(ce(Jr,"Received new app check token=",u),this.appCheckCredentialListener(u,this.user))))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this._databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new ls;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){const i=Rv(t,"Failed to shutdown persistence");e.reject(i)}})),e.promise}}async function Qg(s,e){s.asyncQueue.verifyOperationInProgress(),ce(Jr,"Initializing OfflineComponentProvider");const t=s.configuration;await e.initialize(t);let i=t.initialUser;s.setCredentialChangeListener((async a=>{i.isEqual(a)||(await Ww(e.localStore,a),i=a)})),e.persistence.setDatabaseDeletedListener((()=>s.terminate())),s._offlineComponents=e}async function Ax(s,e){s.asyncQueue.verifyOperationInProgress();const t=await UM(s);ce(Jr,"Initializing OnlineComponentProvider"),await e.initialize(t,s.configuration),s.setCredentialChangeListener((i=>bx(e.remoteStore,i))),s.setAppCheckTokenChangeListener(((i,a)=>bx(e.remoteStore,a))),s._onlineComponents=e}async function UM(s){if(!s._offlineComponents)if(s._uninitializedComponentsProvider){ce(Jr,"Using user provided OfflineComponentProvider");try{await Qg(s,s._uninitializedComponentsProvider._offline)}catch(e){const t=e;if(!(function(a){return a.name==="FirebaseError"?a.code===te.FAILED_PRECONDITION||a.code===te.UNIMPLEMENTED:!(typeof DOMException<"u"&&a instanceof DOMException)||a.code===22||a.code===20||a.code===11})(t))throw t;xl("Error using user provided cache. Falling back to memory cache: "+t),await Qg(s,new Uu)}}else ce(Jr,"Using default OfflineComponentProvider"),await Qg(s,new VM(void 0));return s._offlineComponents}async function xA(s){return s._onlineComponents||(s._uninitializedComponentsProvider?(ce(Jr,"Using user provided OnlineComponentProvider"),await Ax(s,s._uninitializedComponentsProvider._online)):(ce(Jr,"Using default OnlineComponentProvider"),await Ax(s,new zu))),s._onlineComponents}function zM(s){return xA(s).then((e=>e.syncEngine))}async function SA(s){const e=await xA(s),t=e.eventManager;return t.onListen=vM.bind(null,e.syncEngine),t.onUnlisten=bM.bind(null,e.syncEngine),t.onFirstRemoteStoreListen=_M.bind(null,e.syncEngine),t.onLastRemoteStoreUnlisten=EM.bind(null,e.syncEngine),t}function BM(s,e,t={}){const i=new ls;return s.asyncQueue.enqueueAndForget((async()=>(function(l,u,f,p,y){const _=new TA({next:x=>{_.Nu(),u.enqueueAndForget((()=>fA(l,b)));const k=x.docs.has(f);!k&&x.fromCache?y.reject(new he(te.UNAVAILABLE,"Failed to get document because the client is offline.")):k&&x.fromCache&&p&&p.source==="server"?y.reject(new he(te.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):y.resolve(x)},error:x=>y.reject(x)}),b=new mA(cm(f.path),_,{includeMetadataChanges:!0,Ka:!0});return dA(l,b)})(await SA(s),s.asyncQueue,e,t,i))),i.promise}function FM(s,e,t={}){const i=new ls;return s.asyncQueue.enqueueAndForget((async()=>(function(l,u,f,p,y){const _=new TA({next:x=>{_.Nu(),u.enqueueAndForget((()=>fA(l,b))),x.fromCache&&p.source==="server"?y.reject(new he(te.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):y.resolve(x)},error:x=>y.reject(x)}),b=new mA(f,_,{includeMetadataChanges:!0,Ka:!0});return dA(l,b)})(await SA(s),s.asyncQueue,e,t,i))),i.promise}function qM(s,e){const t=new ls;return s.asyncQueue.enqueueAndForget((async()=>TM(await zM(s),e,t))),t.promise}function wA(s){const e={};return s.timeoutSeconds!==void 0&&(e.timeoutSeconds=s.timeoutSeconds),e}const HM="ComponentProvider",Ix=new Map;function GM(s,e,t,i,a){return new yO(s,e,t,a.host,a.ssl,a.experimentalForceLongPolling,a.experimentalAutoDetectLongPolling,wA(a.experimentalLongPollingOptions),a.useFetchStreams,a.isUsingEmulator,i)}const QM="firestore.googleapis.com",Cx=!0;class Rx{constructor(e){if(e.host===void 0){if(e.ssl!==void 0)throw new he(te.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=QM,this.ssl=Cx}else this.host=e.host,this.ssl=e.ssl??Cx;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=Vw;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<zw)throw new he(te.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}Lk("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=wA(e.experimentalLongPollingOptions??{}),(function(i){if(i.timeoutSeconds!==void 0){if(isNaN(i.timeoutSeconds))throw new he(te.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (must not be NaN)`);if(i.timeoutSeconds<5)throw new he(te.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (minimum allowed value is 5)`);if(i.timeoutSeconds>30)throw new he(te.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (maximum allowed value is 30)`)}})(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&(function(i,a){return i.timeoutSeconds===a.timeoutSeconds})(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class Vv{constructor(e,t,i,a){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=i,this._app=a,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new Rx({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new he(te.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new he(te.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new Rx(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=(function(i){if(!i)return new Rk;switch(i.type){case"firstParty":return new jk(i.sessionIndex||"0",i.iamToken||null,i.authTokenFactory||null);case"provider":return i.client;default:throw new he(te.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}})(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return(function(t){const i=Ix.get(t);i&&(ce(HM,"Removing Datastore"),Ix.delete(t),i.terminate())})(this),Promise.resolve()}}class sa{constructor(e,t,i){this.converter=t,this._query=i,this.type="query",this.firestore=e}withConverter(e){return new sa(this.firestore,e,this._query)}}class jt{constructor(e,t,i){this.converter=t,this._key=i,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Kr(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new jt(this.firestore,e,this._key)}toJSON(){return{type:jt._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,t,i){if(Wu(t,jt._jsonSchema))return new jt(e,i||null,new me(Ze.fromString(t.referencePath)))}}jt._jsonSchemaVersion="firestore/documentReference/1.0",jt._jsonSchema={type:Ft("string",jt._jsonSchemaVersion),referencePath:Ft("string")};class Kr extends sa{constructor(e,t,i){super(e,t,cm(i)),this._path=i,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new jt(this.firestore,null,new me(e))}withConverter(e){return new Kr(this.firestore,e,this._path)}}function Ri(s,e,...t){if(s=It(s),vS("collection","path",e),s instanceof Vv){const i=Ze.fromString(e,...t);return _T(i),new Kr(s,null,i)}{if(!(s instanceof jt||s instanceof Kr))throw new he(te.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const i=s._path.child(Ze.fromString(e,...t));return _T(i),new Kr(s.firestore,null,i)}}function Rn(s,e,...t){if(s=It(s),arguments.length===1&&(e=Zy.newId()),vS("doc","path",e),s instanceof Vv){const i=Ze.fromString(e,...t);return vT(i),new jt(s,null,new me(i))}{if(!(s instanceof jt||s instanceof Kr))throw new he(te.INVALID_ARGUMENT,"Expected first argument to doc() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const i=s._path.child(Ze.fromString(e,...t));return vT(i),new jt(s.firestore,s instanceof Kr?s.converter:null,new me(i))}}const Dx="AsyncQueue";class Nx{constructor(e=Promise.resolve()){this.Yu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new rA(this,"async_queue_retry"),this._c=()=>{const i=ff();i&&ce(Dx,"Visibility state changed to "+i.visibilityState),this.M_.w_()},this.ac=e;const t=ff();t&&typeof t.addEventListener=="function"&&t.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;const t=ff();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise((()=>{}));const t=new ls;return this.cc((()=>this.ec&&this.sc?Promise.resolve():(e().then(t.resolve,t.reject),t.promise))).then((()=>t.promise))}enqueueRetryable(e){this.enqueueAndForget((()=>(this.Yu.push(e),this.lc())))}async lc(){if(this.Yu.length!==0){try{await this.Yu[0](),this.Yu.shift(),this.M_.reset()}catch(e){if(!ta(e))throw e;ce(Dx,"Operation failed with retryable error: "+e)}this.Yu.length>0&&this.M_.p_((()=>this.lc()))}}cc(e){const t=this.ac.then((()=>(this.rc=!0,e().catch((i=>{throw this.nc=i,this.rc=!1,Nt("INTERNAL UNHANDLED ERROR: ",jx(i)),i})).then((i=>(this.rc=!1,i))))));return this.ac=t,t}enqueueAfterDelay(e,t,i){this.uc(),this.oc.indexOf(e)>-1&&(t=0);const a=Cv.createAndSchedule(this,e,t,i,(l=>this.hc(l)));return this.tc.push(a),a}uc(){this.nc&&ve(47125,{Pc:jx(this.nc)})}verifyOperationInProgress(){}async Tc(){let e;do e=this.ac,await e;while(e!==this.ac)}Ic(e){for(const t of this.tc)if(t.timerId===e)return!0;return!1}Ec(e){return this.Tc().then((()=>{this.tc.sort(((t,i)=>t.targetTimeMs-i.targetTimeMs));for(const t of this.tc)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.Tc()}))}Rc(e){this.oc.push(e)}hc(e){const t=this.tc.indexOf(e);this.tc.splice(t,1)}}function jx(s){let e=s.message||"";return s.stack&&(e=s.stack.includes(s.message)?s.stack:s.message+`
`+s.stack),e}class ra extends Vv{constructor(e,t,i,a){super(e,t,i,a),this.type="firestore",this._queue=new Nx,this._persistenceKey=a?.name||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new Nx(e),this._firestoreClient=void 0,await e}}}function KM(s,e,t){t||(t=Rf);const i=Xf(s,"firestore");if(i.isInitialized(t)){const a=i.getImmediate({identifier:t}),l=i.getOptions(t);if(Ya(l,e))return a;throw new he(te.FAILED_PRECONDITION,"initializeFirestore() has already been called with different options. To avoid this error, call initializeFirestore() with the same options as when it was originally called, or call getFirestore() to return the already initialized instance.")}if(e.cacheSizeBytes!==void 0&&e.localCache!==void 0)throw new he(te.INVALID_ARGUMENT,"cache and cacheSizeBytes cannot be specified at the same time as cacheSizeBytes willbe deprecated. Instead, specify the cache size in the cache object");if(e.cacheSizeBytes!==void 0&&e.cacheSizeBytes!==-1&&e.cacheSizeBytes<zw)throw new he(te.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");return e.host&&lo(e.host)&&By(e.host),i.initialize({options:e,instanceIdentifier:t})}function bm(s){if(s._terminated)throw new he(te.FAILED_PRECONDITION,"The client has already been terminated.");return s._firestoreClient||$M(s),s._firestoreClient}function $M(s){const e=s._freezeSettings(),t=GM(s._databaseId,s._app?.options.appId||"",s._persistenceKey,s._app?.options.apiKey,e);s._componentsProvider||e.localCache?._offlineComponentProvider&&e.localCache?._onlineComponentProvider&&(s._componentsProvider={_offline:e.localCache._offlineComponentProvider,_online:e.localCache._onlineComponentProvider}),s._firestoreClient=new LM(s._authCredentials,s._appCheckCredentials,s._queue,t,s._componentsProvider&&(function(a){const l=a?._online.build();return{_offline:a?._offline.build(l),_online:l}})(s._componentsProvider))}class ai{constructor(e){this._byteString=e}static fromBase64String(e){try{return new ai(kt.fromBase64String(e))}catch(t){throw new he(te.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new ai(kt.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:ai._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(Wu(e,ai._jsonSchema))return ai.fromBase64String(e.bytes)}}ai._jsonSchemaVersion="firestore/bytes/1.0",ai._jsonSchema={type:Ft("string",ai._jsonSchemaVersion),bytes:Ft("string")};class Em{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new he(te.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new xt(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}class Tm{constructor(e){this._methodName=e}}class cs{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new he(te.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new he(te.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return De(this._lat,e._lat)||De(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:cs._jsonSchemaVersion}}static fromJSON(e){if(Wu(e,cs._jsonSchema))return new cs(e.latitude,e.longitude)}}cs._jsonSchemaVersion="firestore/geoPoint/1.0",cs._jsonSchema={type:Ft("string",cs._jsonSchemaVersion),latitude:Ft("number"),longitude:Ft("number")};class Ai{constructor(e){this._values=(e||[]).map((t=>t))}toArray(){return this._values.map((e=>e))}isEqual(e){return(function(i,a){if(i.length!==a.length)return!1;for(let l=0;l<i.length;++l)if(i[l]!==a[l])return!1;return!0})(this._values,e._values)}toJSON(){return{type:Ai._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(Wu(e,Ai._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every((t=>typeof t=="number")))return new Ai(e.vectorValues);throw new he(te.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}Ai._jsonSchemaVersion="firestore/vectorValue/1.0",Ai._jsonSchema={type:Ft("string",Ai._jsonSchemaVersion),vectorValues:Ft("object")};const WM=/^__.*__$/;class YM{constructor(e,t,i){this.data=e,this.fieldMask=t,this.fieldTransforms=i}toMutation(e,t){return this.fieldMask!==null?new Ys(e,this.data,this.fieldMask,t,this.fieldTransforms):new Wl(e,this.data,t,this.fieldTransforms)}}class AA{constructor(e,t,i){this.data=e,this.fieldMask=t,this.fieldTransforms=i}toMutation(e,t){return new Ys(e,this.data,this.fieldMask,t,this.fieldTransforms)}}function IA(s){switch(s){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw ve(40011,{dataSource:s})}}class Pv{constructor(e,t,i,a,l,u){this.settings=e,this.databaseId=t,this.serializer=i,this.ignoreUndefinedProperties=a,l===void 0&&this.validatePath(),this.fieldTransforms=l||[],this.fieldMask=u||[]}get path(){return this.settings.path}get dataSource(){return this.settings.dataSource}contextWith(e){return new Pv({...this.settings,...e},this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}childContextForField(e){const t=this.path?.child(e),i=this.contextWith({path:t,arrayElement:!1});return i.validatePathSegment(e),i}childContextForFieldPath(e){const t=this.path?.child(e),i=this.contextWith({path:t,arrayElement:!1});return i.validatePath(),i}childContextForArray(e){return this.contextWith({path:void 0,arrayElement:!0})}createError(e){return qf(e,this.settings.methodName,this.settings.hasConverter||!1,this.path,this.settings.targetDoc)}contains(e){return this.fieldMask.find((t=>e.isPrefixOf(t)))!==void 0||this.fieldTransforms.find((t=>e.isPrefixOf(t.field)))!==void 0}validatePath(){if(this.path)for(let e=0;e<this.path.length;e++)this.validatePathSegment(this.path.get(e))}validatePathSegment(e){if(e.length===0)throw this.createError("Document fields must not be empty");if(IA(this.dataSource)&&WM.test(e))throw this.createError('Document fields cannot begin and end with "__"')}}class XM{constructor(e,t,i){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=i||gm(e)}createContext(e,t,i,a=!1){return new Pv({dataSource:e,methodName:t,targetDoc:i,path:xt.emptyPath(),arrayElement:!1,hasConverter:a},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function ih(s){const e=s._freezeSettings(),t=gm(s._databaseId);return new XM(s._databaseId,!!e.ignoreUndefinedProperties,t)}function Lv(s,e,t,i,a,l={}){const u=s.createContext(l.merge||l.mergeFields?2:0,e,t,a);zv("Data must be an object, but it was:",u,i);const f=DA(i,u);let p,y;if(l.merge)p=new Cn(u.fieldMask),y=u.fieldTransforms;else if(l.mergeFields){const _=[];for(const b of l.mergeFields){const x=oo(e,b,t);if(!u.contains(x))throw new he(te.INVALID_ARGUMENT,`Field '${x}' is specified in your field mask but missing from your input data.`);kA(_,x)||_.push(x)}p=new Cn(_),y=u.fieldTransforms.filter((b=>p.covers(b.field)))}else p=null,y=u.fieldTransforms;return new YM(new dn(f),p,y)}class xm extends Tm{_toFieldTransform(e){if(e.dataSource!==2)throw e.dataSource===1?e.createError(`${this._methodName}() can only appear at the top level of your update data`):e.createError(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof xm}}class Uv extends Tm{_toFieldTransform(e){return new dw(e.path,new Ol)}isEqual(e){return e instanceof Uv}}function CA(s,e,t,i){const a=s.createContext(1,e,t);zv("Data must be an object, but it was:",a,i);const l=[],u=dn.empty();na(i,((p,y)=>{const _=jA(e,p,t);y=It(y);const b=a.childContextForFieldPath(_);if(y instanceof xm)l.push(_);else{const x=sh(y,b);x!=null&&(l.push(_),u.set(_,x))}}));const f=new Cn(l);return new AA(u,f,a.fieldTransforms)}function RA(s,e,t,i,a,l){const u=s.createContext(1,e,t),f=[oo(e,i,t)],p=[a];if(l.length%2!=0)throw new he(te.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let x=0;x<l.length;x+=2)f.push(oo(e,l[x])),p.push(l[x+1]);const y=[],_=dn.empty();for(let x=f.length-1;x>=0;--x)if(!kA(y,f[x])){const k=f[x];let M=p[x];M=It(M);const j=u.childContextForFieldPath(k);if(M instanceof xm)y.push(k);else{const V=sh(M,j);V!=null&&(y.push(k),_.set(k,V))}}const b=new Cn(y);return new AA(_,b,u.fieldTransforms)}function JM(s,e,t,i=!1){return sh(t,s.createContext(i?4:3,e))}function sh(s,e){if(NA(s=It(s)))return zv("Unsupported field value:",e,s),DA(s,e);if(s instanceof Tm)return(function(i,a){if(!IA(a.dataSource))throw a.createError(`${i._methodName}() can only be used with update() and set()`);if(!a.path)throw a.createError(`${i._methodName}() is not currently supported inside arrays`);const l=i._toFieldTransform(a);l&&a.fieldTransforms.push(l)})(s,e),null;if(s===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),s instanceof Array){if(e.settings.arrayElement&&e.dataSource!==4)throw e.createError("Nested arrays are not supported");return(function(i,a){const l=[];let u=0;for(const f of i){let p=sh(f,a.childContextForArray(u));p==null&&(p={nullValue:"NULL_VALUE"}),l.push(p),u++}return{arrayValue:{values:l}}})(s,e)}return(function(i,a){if((i=It(i))===null)return{nullValue:"NULL_VALUE"};if(typeof i=="number")return PO(a.serializer,i);if(typeof i=="boolean")return{booleanValue:i};if(typeof i=="string")return{stringValue:i};if(i instanceof Date){const l=it.fromDate(i);return{timestampValue:Pl(a.serializer,l)}}if(i instanceof it){const l=new it(i.seconds,1e3*Math.floor(i.nanoseconds/1e3));return{timestampValue:Pl(a.serializer,l)}}if(i instanceof cs)return{geoPointValue:{latitude:i.latitude,longitude:i.longitude}};if(i instanceof ai)return{bytesValue:_w(a.serializer,i._byteString)};if(i instanceof jt){const l=a.databaseId,u=i.firestore._databaseId;if(!u.isEqual(l))throw a.createError(`Document reference is for database ${u.projectId}/${u.database} but should be for database ${l.projectId}/${l.database}`);return{referenceValue:gv(i.firestore._databaseId||a.databaseId,i._key.path)}}if(i instanceof Ai)return(function(u,f){const p=u instanceof Ai?u.toArray():u;return{mapValue:{fields:{[ov]:{stringValue:lv},[Dl]:{arrayValue:{values:p.map((_=>{if(typeof _!="number")throw f.createError("VectorValues must only contain numeric values.");return hv(f.serializer,_)}))}}}}}})(i,a);if(Dw(i))return i._toProto(a.serializer);throw a.createError(`Unsupported field value: ${tm(i)}`)})(s,e)}function DA(s,e){const t={};return VS(s)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):na(s,((i,a)=>{const l=sh(a,e.childContextForField(i));l!=null&&(t[i]=l)})),{mapValue:{fields:t}}}function NA(s){return!(typeof s!="object"||s===null||s instanceof Array||s instanceof Date||s instanceof it||s instanceof cs||s instanceof ai||s instanceof jt||s instanceof Tm||s instanceof Ai||Dw(s))}function zv(s,e,t){if(!NA(t)||!_S(t)){const i=tm(t);throw i==="an object"?e.createError(s+" a custom object"):e.createError(s+" "+i)}}function oo(s,e,t){if((e=It(e))instanceof Em)return e._internalPath;if(typeof e=="string")return jA(s,e);throw qf("Field path arguments must be of type string or ",s,!1,void 0,t)}const ZM=new RegExp("[~\\*/\\[\\]]");function jA(s,e,t){if(e.search(ZM)>=0)throw qf(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,s,!1,void 0,t);try{return new Em(...e.split("."))._internalPath}catch{throw qf(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,s,!1,void 0,t)}}function qf(s,e,t,i,a){const l=i&&!i.isEmpty(),u=a!==void 0;let f=`Function ${e}() called with invalid data`;t&&(f+=" (via `toFirestore()`)"),f+=". ";let p="";return(l||u)&&(p+=" (found",l&&(p+=` in field ${i}`),u&&(p+=` in document ${a}`),p+=")"),new he(te.INVALID_ARGUMENT,f+s+p)}function kA(s,e){return s.some((t=>t.isEqual(e)))}class e6{convertValue(e,t="none"){switch(Wr(e)){case 0:return null;case 1:return e.booleanValue;case 2:return Et(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(Ks(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw ve(62114,{value:e})}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){const i={};return na(e,((a,l)=>{i[a]=this.convertValue(l,t)})),i}convertVectorValue(e){const t=e.fields?.[Dl].arrayValue?.values?.map((i=>Et(i.doubleValue)));return new Ai(t)}convertGeoPoint(e){return new cs(Et(e.latitude),Et(e.longitude))}convertArray(e,t){return(e.values||[]).map((i=>this.convertValue(i,t)))}convertServerTimestamp(e,t){switch(t){case"previous":const i=om(e);return i==null?null:this.convertValue(i,t);case"estimate":return this.convertTimestamp(ku(e));default:return null}}convertTimestamp(e){const t=Qs(e);return new it(t.seconds,t.nanos)}convertDocumentKey(e,t){const i=Ze.fromString(e);xe(Rw(i),9688,{name:e});const a=new to(i.get(1),i.get(3)),l=new me(i.popFirst(5));return a.isEqual(t)||Nt(`Document ${l} contains a document reference within a different database (${a.projectId}/${a.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),l}}class OA extends e6{constructor(e){super(),this.firestore=e}convertBytes(e){return new ai(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new jt(this.firestore,null,t)}}function li(){return new Uv("serverTimestamp")}const kx="@firebase/firestore",Ox="4.11.0";class MA{constructor(e,t,i,a,l){this._firestore=e,this._userDataWriter=t,this._key=i,this._document=a,this._converter=l}get id(){return this._key.path.lastSegment()}get ref(){return new jt(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new t6(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}_fieldsProto(){return this._document?.data.clone().value.mapValue.fields??void 0}get(e){if(this._document){const t=this._document.data.field(oo("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}}class t6 extends MA{data(){return super.data()}}function n6(s){if(s.limitType==="L"&&s.explicitOrderBy.length===0)throw new he(te.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class Bv{}class Fv extends Bv{}function rh(s,e,...t){let i=[];e instanceof Bv&&i.push(e),i=i.concat(t),(function(l){const u=l.filter((p=>p instanceof qv)).length,f=l.filter((p=>p instanceof Sm)).length;if(u>1||u>0&&f>0)throw new he(te.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")})(i);for(const a of i)s=a._apply(s);return s}class Sm extends Fv{constructor(e,t,i){super(),this._field=e,this._op=t,this._value=i,this.type="where"}static _create(e,t,i){return new Sm(e,t,i)}_apply(e){const t=this._parse(e);return PA(e._query,t),new sa(e.firestore,e.converter,by(e._query,t))}_parse(e){const t=ih(e.firestore);return(function(l,u,f,p,y,_,b){let x;if(y.isKeyField()){if(_==="array-contains"||_==="array-contains-any")throw new he(te.INVALID_ARGUMENT,`Invalid Query. You can't perform '${_}' queries on documentId().`);if(_==="in"||_==="not-in"){Vx(b,_);const M=[];for(const j of b)M.push(Mx(p,l,j));x={arrayValue:{values:M}}}else x=Mx(p,l,b)}else _!=="in"&&_!=="not-in"&&_!=="array-contains-any"||Vx(b,_),x=JM(f,u,b,_==="in"||_==="not-in");return qe.create(y,_,x)})(e._query,"where",t,e.firestore._databaseId,this._field,this._op,this._value)}}function VA(s,e,t){const i=e,a=oo("where",s);return Sm._create(a,i,t)}class qv extends Bv{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new qv(e,t)}_parse(e){const t=this._queryConstraints.map((i=>i._parse(e))).filter((i=>i.getFilters().length>0));return t.length===1?t[0]:st.create(t,this._getOperator())}_apply(e){const t=this._parse(e);return t.getFilters().length===0?e:((function(a,l){let u=a;const f=l.getFlattenedFilters();for(const p of f)PA(u,p),u=by(u,p)})(e._query,t),new sa(e.firestore,e.converter,by(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}class Hv extends Fv{constructor(e,t){super(),this._field=e,this._direction=t,this.type="orderBy"}static _create(e,t){return new Hv(e,t)}_apply(e){const t=(function(a,l,u){if(a.startAt!==null)throw new he(te.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(a.endAt!==null)throw new he(te.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new Pu(l,u)})(e._query,this._field,this._direction);return new sa(e.firestore,e.converter,NO(e._query,t))}}function Gv(s,e="asc"){const t=e,i=oo("orderBy",s);return Hv._create(i,t)}class Qv extends Fv{constructor(e,t,i){super(),this.type=e,this._limit=t,this._limitType=i}static _create(e,t,i){return new Qv(e,t,i)}_apply(e){return new sa(e.firestore,e.converter,jf(e._query,this._limit,this._limitType))}}function Kv(s){return Uk("limit",s),Qv._create("limit",s,"F")}function Mx(s,e,t){if(typeof(t=It(t))=="string"){if(t==="")throw new he(te.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!ew(e)&&t.indexOf("/")!==-1)throw new he(te.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${t}' contains a '/' character.`);const i=e.path.child(Ze.fromString(t));if(!me.isDocumentKey(i))throw new he(te.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${i}' is not because it has an odd number of segments (${i.length}).`);return Mu(s,new me(i))}if(t instanceof jt)return Mu(s,t._key);throw new he(te.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${tm(t)}.`)}function Vx(s,e){if(!Array.isArray(s)||s.length===0)throw new he(te.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function PA(s,e){const t=(function(a,l){for(const u of a)for(const f of u.getFlattenedFilters())if(l.indexOf(f.op)>=0)return f.op;return null})(s.filters,(function(a){switch(a){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}})(e.op));if(t!==null)throw t===e.op?new he(te.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new he(te.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${t.toString()}' filters.`)}function $v(s,e,t){let i;return i=s?t&&(t.merge||t.mergeFields)?s.toFirestore(e,t):s.toFirestore(e):e,i}class i6{constructor(e){let t;this.kind="persistent",e?.tabManager?(e.tabManager._initialize(e),t=e.tabManager):(t=o6(void 0),t._initialize(e)),this._onlineComponentProvider=t._onlineComponentProvider,this._offlineComponentProvider=t._offlineComponentProvider}toJSON(){return{kind:this.kind}}}function s6(s){return new i6(s)}class r6{constructor(e){this.forceOwnership=e,this.kind="persistentSingleTab"}toJSON(){return{kind:this.kind}}_initialize(e){this._onlineComponentProvider=zu.provider,this._offlineComponentProvider={build:t=>new EA(t,e?.cacheSizeBytes,this.forceOwnership)}}}class a6{constructor(){this.kind="PersistentMultipleTab"}toJSON(){return{kind:this.kind}}_initialize(e){this._onlineComponentProvider=zu.provider,this._offlineComponentProvider={build:t=>new PM(t,e?.cacheSizeBytes)}}}function o6(s){return new r6(s?.forceOwnership)}function l6(){return new a6}class fu{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class Wa extends MA{constructor(e,t,i,a,l,u){super(e,t,i,a,u),this._firestore=e,this._firestoreImpl=e,this.metadata=l}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const t=new mf(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){const i=this._document.data.field(oo("DocumentSnapshot.get",e));if(i!==null)return this._userDataWriter.convertValue(i,t.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new he(te.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,t={};return t.type=Wa._jsonSchemaVersion,t.bundle="",t.bundleSource="DocumentSnapshot",t.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?t:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),t.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),t)}}Wa._jsonSchemaVersion="firestore/documentSnapshot/1.0",Wa._jsonSchema={type:Ft("string",Wa._jsonSchemaVersion),bundleSource:Ft("string","DocumentSnapshot"),bundleName:Ft("string"),bundle:Ft("string")};class mf extends Wa{data(e={}){return super.data(e)}}class El{constructor(e,t,i,a){this._firestore=e,this._userDataWriter=t,this._snapshot=a,this.metadata=new fu(a.hasPendingWrites,a.fromCache),this.query=i}get docs(){const e=[];return this.forEach((t=>e.push(t))),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach((i=>{e.call(t,new mf(this._firestore,this._userDataWriter,i.key,i,new fu(this._snapshot.mutatedKeys.has(i.key),this._snapshot.fromCache),this.query.converter))}))}docChanges(e={}){const t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new he(te.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=(function(a,l){if(a._snapshot.oldDocs.isEmpty()){let u=0;return a._snapshot.docChanges.map((f=>{const p=new mf(a._firestore,a._userDataWriter,f.doc.key,f.doc,new fu(a._snapshot.mutatedKeys.has(f.doc.key),a._snapshot.fromCache),a.query.converter);return f.doc,{type:"added",doc:p,oldIndex:-1,newIndex:u++}}))}{let u=a._snapshot.oldDocs;return a._snapshot.docChanges.filter((f=>l||f.type!==3)).map((f=>{const p=new mf(a._firestore,a._userDataWriter,f.doc.key,f.doc,new fu(a._snapshot.mutatedKeys.has(f.doc.key),a._snapshot.fromCache),a.query.converter);let y=-1,_=-1;return f.type!==0&&(y=u.indexOf(f.doc.key),u=u.delete(f.doc.key)),f.type!==1&&(u=u.add(f.doc),_=u.indexOf(f.doc.key)),{type:c6(f.type),doc:p,oldIndex:y,newIndex:_}}))}})(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new he(te.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=El._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=Zy.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const t=[],i=[],a=[];return this.docs.forEach((l=>{l._document!==null&&(t.push(l._document),i.push(this._userDataWriter.convertObjectMap(l._document.data.value.mapValue.fields,"previous")),a.push(l.ref.path))})),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function c6(s){switch(s){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return ve(61501,{type:s})}}El._jsonSchemaVersion="firestore/querySnapshot/1.0",El._jsonSchema={type:Ft("string",El._jsonSchemaVersion),bundleSource:Ft("string","QuerySnapshot"),bundleName:Ft("string"),bundle:Ft("string")};class u6{constructor(e,t){this._firestore=e,this._commitHandler=t,this._mutations=[],this._committed=!1,this._dataReader=ih(e)}set(e,t,i){this._verifyNotCommitted();const a=Kg(e,this._firestore),l=$v(a.converter,t,i),u=Lv(this._dataReader,"WriteBatch.set",a._key,l,a.converter!==null,i);return this._mutations.push(u.toMutation(a._key,Gt.none())),this}update(e,t,i,...a){this._verifyNotCommitted();const l=Kg(e,this._firestore);let u;return u=typeof(t=It(t))=="string"||t instanceof Em?RA(this._dataReader,"WriteBatch.update",l._key,t,i,a):CA(this._dataReader,"WriteBatch.update",l._key,t),this._mutations.push(u.toMutation(l._key,Gt.exists(!0))),this}delete(e){this._verifyNotCommitted();const t=Kg(e,this._firestore);return this._mutations=this._mutations.concat(new Zu(t._key,Gt.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new he(te.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}}function Kg(s,e){if((s=It(s)).firestore!==e)throw new he(te.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return s}function Wv(s){s=Ci(s,jt);const e=Ci(s.firestore,ra),t=bm(e);return BM(t,s._key).then((i=>d6(e,s,i)))}function ho(s){s=Ci(s,sa);const e=Ci(s.firestore,ra),t=bm(e),i=new OA(e);return n6(s._query),FM(t,s._query).then((a=>new El(e,i,s,a)))}function h6(s,e,t){s=Ci(s,jt);const i=Ci(s.firestore,ra),a=$v(s.converter,e,t),l=ih(i);return oh(i,[Lv(l,"setDoc",s._key,a,s.converter!==null,t).toMutation(s._key,Gt.none())])}function ah(s,e,t,...i){s=Ci(s,jt);const a=Ci(s.firestore,ra),l=ih(a);let u;return u=typeof(e=It(e))=="string"||e instanceof Em?RA(l,"updateDoc",s._key,e,t,i):CA(l,"updateDoc",s._key,e),oh(a,[u.toMutation(s._key,Gt.exists(!0))])}function Yv(s){return oh(Ci(s.firestore,ra),[new Zu(s._key,Gt.none())])}function Xv(s,e){const t=Ci(s.firestore,ra),i=Rn(s),a=$v(s.converter,e),l=ih(s.firestore);return oh(t,[Lv(l,"addDoc",i._key,a,s.converter!==null,{}).toMutation(i._key,Gt.exists(!1))]).then((()=>i))}function oh(s,e){const t=bm(s);return qM(t,e)}function d6(s,e,t){const i=t.docs.get(e._key),a=new OA(s);return new Wa(s,a,e._key,i,new fu(t.hasPendingWrites,t.fromCache),e.converter)}function LA(s){return s=Ci(s,ra),bm(s),new u6(s,(e=>oh(s,e)))}(function(e,t=!0){Ik(co),Xa(new $r("firestore",((i,{instanceIdentifier:a,options:l})=>{const u=i.getProvider("app").getImmediate(),f=new ra(new Dk(i.getProvider("auth-internal")),new kk(u,i.getProvider("app-check-internal")),vO(u,a),u);return l={useFetchStreams:t,...l},f._setSettings(l),f}),"PUBLIC").setMultipleInstances(!0)),rs(kx,Ox,e),rs(kx,Ox,"esm2020")})();const UA="firebasestorage.googleapis.com",f6="storageBucket",m6=120*1e3,p6=600*1e3;class ms extends ds{constructor(e,t,i=0){super($g(e),`Firebase Storage: ${t} (${$g(e)})`),this.status_=i,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,ms.prototype)}get status(){return this.status_}set status(e){this.status_=e}_codeEquals(e){return $g(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.customData.serverResponse?this.message=`${this._baseMessage}
${this.customData.serverResponse}`:this.message=this._baseMessage}}var hs;(function(s){s.UNKNOWN="unknown",s.OBJECT_NOT_FOUND="object-not-found",s.BUCKET_NOT_FOUND="bucket-not-found",s.PROJECT_NOT_FOUND="project-not-found",s.QUOTA_EXCEEDED="quota-exceeded",s.UNAUTHENTICATED="unauthenticated",s.UNAUTHORIZED="unauthorized",s.UNAUTHORIZED_APP="unauthorized-app",s.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",s.INVALID_CHECKSUM="invalid-checksum",s.CANCELED="canceled",s.INVALID_EVENT_NAME="invalid-event-name",s.INVALID_URL="invalid-url",s.INVALID_DEFAULT_BUCKET="invalid-default-bucket",s.NO_DEFAULT_BUCKET="no-default-bucket",s.CANNOT_SLICE_BLOB="cannot-slice-blob",s.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",s.NO_DOWNLOAD_URL="no-download-url",s.INVALID_ARGUMENT="invalid-argument",s.INVALID_ARGUMENT_COUNT="invalid-argument-count",s.APP_DELETED="app-deleted",s.INVALID_ROOT_OPERATION="invalid-root-operation",s.INVALID_FORMAT="invalid-format",s.INTERNAL_ERROR="internal-error",s.UNSUPPORTED_ENVIRONMENT="unsupported-environment"})(hs||(hs={}));function $g(s){return"storage/"+s}function g6(){const s="An unknown error occurred, please check the error payload for server response.";return new ms(hs.UNKNOWN,s)}function y6(){return new ms(hs.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function v6(){return new ms(hs.CANCELED,"User canceled the upload/download.")}function _6(s){return new ms(hs.INVALID_URL,"Invalid URL '"+s+"'.")}function b6(s){return new ms(hs.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+s+"'.")}function Px(s){return new ms(hs.INVALID_ARGUMENT,s)}function zA(){return new ms(hs.APP_DELETED,"The Firebase app was deleted.")}function E6(s){return new ms(hs.INVALID_ROOT_OPERATION,"The operation '"+s+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}class wi{constructor(e,t){this.bucket=e,this.path_=t}get path(){return this.path_}get isRoot(){return this.path.length===0}fullServerUrl(){const e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,t){let i;try{i=wi.makeFromUrl(e,t)}catch{return new wi(e,"")}if(i.path==="")return i;throw b6(e)}static makeFromUrl(e,t){let i=null;const a="([A-Za-z0-9.\\-_]+)";function l(ie){ie.path.charAt(ie.path.length-1)==="/"&&(ie.path_=ie.path_.slice(0,-1))}const u="(/(.*))?$",f=new RegExp("^gs://"+a+u,"i"),p={bucket:1,path:3};function y(ie){ie.path_=decodeURIComponent(ie.path)}const _="v[A-Za-z0-9_]+",b=t.replace(/[.]/g,"\\."),x="(/([^?#]*).*)?$",k=new RegExp(`^https?://${b}/${_}/b/${a}/o${x}`,"i"),M={bucket:1,path:3},j=t===UA?"(?:storage.googleapis.com|storage.cloud.google.com)":t,V="([^?#]*)",ee=new RegExp(`^https?://${j}/${a}/${V}`,"i"),Y=[{regex:f,indices:p,postModify:l},{regex:k,indices:M,postModify:y},{regex:ee,indices:{bucket:1,path:2},postModify:y}];for(let ie=0;ie<Y.length;ie++){const F=Y[ie],J=F.regex.exec(e);if(J){const C=J[F.indices.bucket];let R=J[F.indices.path];R||(R=""),i=new wi(C,R),F.postModify(i);break}}if(i==null)throw _6(e);return i}}class T6{constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(e=!1){}}function x6(s,e,t){let i=1,a=null,l=null,u=!1,f=0;function p(){return f===2}let y=!1;function _(...V){y||(y=!0,e.apply(null,V))}function b(V){a=setTimeout(()=>{a=null,s(k,p())},V)}function x(){l&&clearTimeout(l)}function k(V,...ee){if(y){x();return}if(V){x(),_.call(null,V,...ee);return}if(p()||u){x(),_.call(null,V,...ee);return}i<64&&(i*=2);let Y;f===1?(f=2,Y=0):Y=(i+Math.random())*1e3,b(Y)}let M=!1;function j(V){M||(M=!0,x(),!y&&(a!==null?(V||(f=2),clearTimeout(a),b(0)):V||(f=1)))}return b(0),l=setTimeout(()=>{u=!0,j(!0)},t),j}function S6(s){s(!1)}function w6(s){return s!==void 0}function Lx(s,e,t,i){if(i<e)throw Px(`Invalid value for '${s}'. Expected ${e} or greater.`);if(i>t)throw Px(`Invalid value for '${s}'. Expected ${t} or less.`)}function A6(s){const e=encodeURIComponent;let t="?";for(const i in s)if(s.hasOwnProperty(i)){const a=e(i)+"="+e(s[i]);t=t+a+"&"}return t=t.slice(0,-1),t}var Hf;(function(s){s[s.NO_ERROR=0]="NO_ERROR",s[s.NETWORK_ERROR=1]="NETWORK_ERROR",s[s.ABORT=2]="ABORT"})(Hf||(Hf={}));function I6(s,e){const t=s>=500&&s<600,a=[408,429].indexOf(s)!==-1,l=e.indexOf(s)!==-1;return t||a||l}class C6{constructor(e,t,i,a,l,u,f,p,y,_,b,x=!0,k=!1){this.url_=e,this.method_=t,this.headers_=i,this.body_=a,this.successCodes_=l,this.additionalRetryCodes_=u,this.callback_=f,this.errorCallback_=p,this.timeout_=y,this.progressCallback_=_,this.connectionFactory_=b,this.retry=x,this.isUsingEmulator=k,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((M,j)=>{this.resolve_=M,this.reject_=j,this.start_()})}start_(){const e=(i,a)=>{if(a){i(!1,new Hd(!1,null,!0));return}const l=this.connectionFactory_();this.pendingConnection_=l;const u=f=>{const p=f.loaded,y=f.lengthComputable?f.total:-1;this.progressCallback_!==null&&this.progressCallback_(p,y)};this.progressCallback_!==null&&l.addUploadProgressListener(u),l.send(this.url_,this.method_,this.isUsingEmulator,this.body_,this.headers_).then(()=>{this.progressCallback_!==null&&l.removeUploadProgressListener(u),this.pendingConnection_=null;const f=l.getErrorCode()===Hf.NO_ERROR,p=l.getStatus();if(!f||I6(p,this.additionalRetryCodes_)&&this.retry){const _=l.getErrorCode()===Hf.ABORT;i(!1,new Hd(!1,null,_));return}const y=this.successCodes_.indexOf(p)!==-1;i(!0,new Hd(y,l))})},t=(i,a)=>{const l=this.resolve_,u=this.reject_,f=a.connection;if(a.wasSuccessCode)try{const p=this.callback_(f,f.getResponse());w6(p)?l(p):l()}catch(p){u(p)}else if(f!==null){const p=g6();p.serverResponse=f.getErrorText(),this.errorCallback_?u(this.errorCallback_(f,p)):u(p)}else if(a.canceled){const p=this.appDelete_?zA():v6();u(p)}else{const p=y6();u(p)}};this.canceled_?t(!1,new Hd(!1,null,!0)):this.backoffId_=x6(e,t,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,this.backoffId_!==null&&S6(this.backoffId_),this.pendingConnection_!==null&&this.pendingConnection_.abort()}}class Hd{constructor(e,t,i){this.wasSuccessCode=e,this.connection=t,this.canceled=!!i}}function R6(s,e){e!==null&&e.length>0&&(s.Authorization="Firebase "+e)}function D6(s,e){s["X-Firebase-Storage-Version"]="webjs/"+(e??"AppManager")}function N6(s,e){e&&(s["X-Firebase-GMPID"]=e)}function j6(s,e){e!==null&&(s["X-Firebase-AppCheck"]=e)}function k6(s,e,t,i,a,l,u=!0,f=!1){const p=A6(s.urlParams),y=s.url+p,_=Object.assign({},s.headers);return N6(_,e),R6(_,t),D6(_,l),j6(_,i),new C6(y,s.method,_,s.body,s.successCodes,s.additionalRetryCodes,s.handler,s.errorHandler,s.timeout,s.progressCallback,a,u,f)}function O6(s){if(s.length===0)return null;const e=s.lastIndexOf("/");return e===-1?"":s.slice(0,e)}function M6(s){const e=s.lastIndexOf("/",s.length-2);return e===-1?s:s.slice(e+1)}class Gf{constructor(e,t){this._service=e,t instanceof wi?this._location=t:this._location=wi.makeFromUrl(t,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,t){return new Gf(e,t)}get root(){const e=new wi(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return M6(this._location.path)}get storage(){return this._service}get parent(){const e=O6(this._location.path);if(e===null)return null;const t=new wi(this._location.bucket,e);return new Gf(this._service,t)}_throwIfRoot(e){if(this._location.path==="")throw E6(e)}}function Ux(s,e){const t=e?.[f6];return t==null?null:wi.makeFromBucketSpec(t,s)}function V6(s,e,t,i={}){s.host=`${e}:${t}`;const a=lo(e);a&&(By(`https://${s.host}/b`),_1("Storage",!0)),s._isUsingEmulator=!0,s._protocol=a?"https":"http";const{mockUserToken:l}=i;l&&(s._overrideAuthToken=typeof l=="string"?l:MR(l,s.app.options.projectId))}class P6{constructor(e,t,i,a,l,u=!1){this.app=e,this._authProvider=t,this._appCheckProvider=i,this._url=a,this._firebaseVersion=l,this._isUsingEmulator=u,this._bucket=null,this._host=UA,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=m6,this._maxUploadRetryTime=p6,this._requests=new Set,a!=null?this._bucket=wi.makeFromBucketSpec(a,this._host):this._bucket=Ux(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,this._url!=null?this._bucket=wi.makeFromBucketSpec(this._url,e):this._bucket=Ux(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){Lx("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){Lx("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}async _getAuthToken(){if(this._overrideAuthToken)return this._overrideAuthToken;const e=this._authProvider.getImmediate({optional:!0});if(e){const t=await e.getToken();if(t!==null)return t.accessToken}return null}async _getAppCheckToken(){if(Fn(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=this._appCheckProvider.getImmediate({optional:!0});return e?(await e.getToken()).token:null}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(e=>e.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new Gf(this,e)}_makeRequest(e,t,i,a,l=!0){if(this._deleted)return new T6(zA());{const u=k6(e,this._appId,i,a,t,this._firebaseVersion,l,this._isUsingEmulator);return this._requests.add(u),u.getPromise().then(()=>this._requests.delete(u),()=>this._requests.delete(u)),u}}async makeRequestWithTokens(e,t){const[i,a]=await Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(e,t,i,a).getPromise()}}const zx="@firebase/storage",Bx="0.14.0";const BA="storage";function L6(s=I1(),e){s=It(s);const i=Xf(s,BA).getImmediate({identifier:e}),a=kR("storage");return a&&U6(i,...a),i}function U6(s,e,t,i={}){V6(s,e,t,i)}function z6(s,{instanceIdentifier:e}){const t=s.getProvider("app").getImmediate(),i=s.getProvider("auth-internal"),a=s.getProvider("app-check-internal");return new P6(t,i,a,e,co)}function B6(){Xa(new $r(BA,z6,"PUBLIC").setMultipleInstances(!0)),rs(zx,Bx,""),rs(zx,Bx,"esm2020")}B6();const F6={apiKey:"AIzaSyC_Y5AYNw-qfHRncEuzwOA9d1jReKztInY",authDomain:"neuralprep-e2d1b.firebaseapp.com",projectId:"neuralprep-e2d1b",storageBucket:"neuralprep-e2d1b.firebasestorage.app",messagingSenderId:"740904166312",appId:"1:740904166312:web:ac188708063855b5ec739d"},Jv=A1(F6),lh=xk(Jv),yt=KM(Jv,{localCache:s6({tabManager:l6()})});L6(Jv);async function q6(s,e,t){const i=await rj(lh,s,e);return t&&await lj(i.user,{displayName:t}),i.user}async function H6(s,e){return(await aj(lh,s,e)).user}async function G6(){await dj(lh)}function Q6(s){return hj(lh,s)}async function K6(s){await sj(lh,s)}async function $6(s,e){await h6(Rn(yt,"users",s),{...e,createdAt:li(),updatedAt:li()})}async function FA(s){const e=await Wv(Rn(yt,"users",s));return e.exists()?{id:e.id,...e.data()}:null}async function qA(s,e){await ah(Rn(yt,"users",s),{...e,updatedAt:li()})}async function W6(s,e){const t=Ri(yt,"users",s,"subjects");return(await Xv(t,{name:e.name,color:e.color||"#6C63FF",icon:e.icon||"",questionCount:0,masteredCount:0,createdAt:li(),updatedAt:li()})).id}async function Y6(s){const e=Ri(yt,"users",s,"subjects"),t=rh(e,Gv("createdAt","desc"));return(await ho(t)).docs.map(a=>({id:a.id,...a.data()}))}async function X6(s,e,t){await ah(Rn(yt,"users",s,"subjects",e),{...t,updatedAt:li()})}async function J6(s,e){await Yv(Rn(yt,"users",s,"subjects",e))}async function Z6(s,e,t){const i=Ri(yt,"users",s,"subjects",e,"chapters");return(await Xv(i,{name:t.name,questionCount:0,masteredCount:0,createdAt:li(),updatedAt:li()})).id}async function eV(s,e){const t=Ri(yt,"users",s,"subjects",e,"chapters"),i=rh(t,Gv("createdAt","desc"));return(await ho(i)).docs.map(l=>({id:l.id,...l.data()}))}async function tV(s,e,t){await Yv(Rn(yt,"users",s,"subjects",e,"chapters",t))}async function nV(s,e,t,i){const a=LA(yt),l=Ri(yt,"users",s,"subjects",e,"chapters",t,"questions");i.forEach(u=>{const f=Rn(l);a.set(f,{text:u.text,options:u.options,correctOption:u.correctOption,explanation:u.explanation||"",important:u.important||!1,masteryLevel:0,flagged:!1,timesAnswered:0,timesCorrect:0,nextReviewDate:null,createdAt:li()})}),await a.commit()}async function iV(s,e,t){const i=Ri(yt,"users",s,"subjects",e,"chapters",t,"questions");return(await ho(i)).docs.map(l=>({id:l.id,...l.data()}))}async function sV(s,e,t,i){await Yv(Rn(yt,"users",s,"subjects",e,"chapters",t,"questions",i))}const vn=Wf(s=>({user:null,loading:!0,isAuthenticated:!1,userProfile:null,error:null,setUser:e=>s({user:e,isAuthenticated:!!e,loading:!1}),setUserProfile:e=>s({userProfile:e}),setLoading:e=>s({loading:e}),setError:e=>s({error:e}),clearError:()=>s({error:null}),logout:()=>s({user:null,isAuthenticated:!1,userProfile:null,error:null})}));function rV({children:s}){const{setUser:e,setUserProfile:t,setLoading:i}=vn();return N.useEffect(()=>{const a=Q6(async l=>{if(l){e(l);try{const u=await FA(l.uid);t(u)}catch(u){console.error("Failed to fetch user profile:",u)}}else e(null),t(null);i(!1)});return()=>a()},[e,t,i]),s}function Wg({children:s}){const{isAuthenticated:e,loading:t}=vn();return t?d.jsx("div",{style:{minHeight:"100vh",display:"flex",alignItems:"center",justifyContent:"center",background:"var(--bg)"},children:d.jsx(wR,{})}):e?s:d.jsx(PC,{to:"/login",replace:!0})}const aV=[{path:"/",label:"Dashboard",icon:d.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[d.jsx("path",{d:"M3 9l9-7 9 7v11a2 2 0 01-2 2H5a2 2 0 01-2-2z"}),d.jsx("polyline",{points:"9 22 9 12 15 12 15 22"})]})},{path:"/practice",label:"Practice",icon:d.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:d.jsx("polygon",{points:"13 2 3 14 12 14 11 22 21 10 12 10 13 2"})})},{path:"/subjects",label:"Subjects",icon:d.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[d.jsx("path",{d:"M4 19.5A2.5 2.5 0 016.5 17H20"}),d.jsx("path",{d:"M6.5 2H20v20H6.5A2.5 2.5 0 014 19.5v-15A2.5 2.5 0 016.5 2z"})]})},{path:"/wrong-questions",label:"Wrong Questions",icon:d.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[d.jsx("circle",{cx:"12",cy:"12",r:"10"}),d.jsx("line",{x1:"15",y1:"9",x2:"9",y2:"15"}),d.jsx("line",{x1:"9",y1:"9",x2:"15",y2:"15"})]})},{path:"/analytics",label:"Analytics",icon:d.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[d.jsx("line",{x1:"18",y1:"20",x2:"18",y2:"10"}),d.jsx("line",{x1:"12",y1:"20",x2:"12",y2:"4"}),d.jsx("line",{x1:"6",y1:"20",x2:"6",y2:"14"})]})},{path:"/settings",label:"Settings",icon:d.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[d.jsx("circle",{cx:"12",cy:"12",r:"3"}),d.jsx("path",{d:"M19.4 15a1.65 1.65 0 00.33 1.82l.06.06a2 2 0 010 2.83 2 2 0 01-2.83 0l-.06-.06a1.65 1.65 0 00-1.82-.33 1.65 1.65 0 00-1 1.51V21a2 2 0 01-2 2 2 2 0 01-2-2v-.09A1.65 1.65 0 009 19.4a1.65 1.65 0 00-1.82.33l-.06.06a2 2 0 01-2.83 0 2 2 0 010-2.83l.06-.06A1.65 1.65 0 004.68 15a1.65 1.65 0 00-1.51-1H3a2 2 0 01-2-2 2 2 0 012-2h.09A1.65 1.65 0 004.6 9a1.65 1.65 0 00-.33-1.82l-.06-.06a2 2 0 010-2.83 2 2 0 012.83 0l.06.06A1.65 1.65 0 009 4.68a1.65 1.65 0 001-1.51V3a2 2 0 012-2 2 2 0 012 2v.09a1.65 1.65 0 001 1.51 1.65 1.65 0 001.82-.33l.06-.06a2 2 0 012.83 0 2 2 0 010 2.83l-.06.06a1.65 1.65 0 00-.33 1.82V9a1.65 1.65 0 001.51 1H21a2 2 0 012 2 2 2 0 01-2 2h-.09a1.65 1.65 0 00-1.51 1z"})]})}];function oV({mobileOpen:s,onClose:e}){const{sidebarCollapsed:t,toggleSidebar:i}=Gl(),a=ui(),l=()=>{window.innerWidth<=768&&e&&e()};return d.jsxs(d.Fragment,{children:[d.jsx("div",{className:`np-sidebar-overlay ${s?"visible":""}`,onClick:e}),d.jsxs("aside",{className:`np-sidebar ${t?"np-sidebar-collapsed":"np-sidebar-expanded"} ${s?"mobile-open":""}`,children:[d.jsxs("div",{className:"np-sidebar-header",children:[d.jsx("div",{className:"np-sidebar-logo",children:d.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"white",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:d.jsx("polygon",{points:"13 2 3 14 12 14 11 22 21 10 12 10 13 2"})})}),d.jsx("span",{className:"np-sidebar-brand",children:"NeuralPrep"}),s&&d.jsx("button",{onClick:e,style:{marginLeft:"auto",width:32,height:32,borderRadius:8,display:"flex",alignItems:"center",justifyContent:"center",color:"var(--muted)",transition:"color 0.15s"},children:d.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:d.jsx("path",{d:"M18 6L6 18M6 6l12 12"})})})]}),d.jsx("nav",{className:"np-nav",children:aV.map(u=>{const f=a.pathname===u.path||u.path!=="/"&&a.pathname.startsWith(u.path);return d.jsxs(l1,{to:u.path,className:`np-nav-item ${f?"active":""}`,onClick:l,children:[d.jsx("span",{className:"np-nav-icon",children:u.icon}),d.jsx("span",{children:u.label})]},u.path)})}),d.jsx("div",{className:"np-sidebar-collapse",style:{padding:12,borderTop:"1px solid var(--border)"},children:d.jsxs("button",{onClick:i,className:"np-nav-item",style:{width:"100%",justifyContent:t?"center":"flex-start"},children:[d.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",style:{transition:"transform 0.3s",transform:t?"rotate(180deg)":"none"},children:[d.jsx("polyline",{points:"11 17 6 12 11 7"}),d.jsx("polyline",{points:"18 17 13 12 18 7"})]}),d.jsx("span",{children:"Collapse"})]})})]})]})}const lV={"/":"Dashboard","/practice":"Practice Hub","/subjects":"Subjects","/wrong-questions":"Wrong Questions","/flashcards":"Flashcards","/analytics":"Analytics","/settings":"Settings","/test":"Test Session","/test/results":"Results","/rapid-fire":"Rapid Fire"};function cV({onMenuToggle:s}){const e=ui(),{sidebarCollapsed:t}=Gl(),i=lV[e.pathname]||"NeuralPrep";return d.jsxs("header",{className:"np-topbar",style:{marginLeft:t?"var(--sidebar-collapsed)":"var(--sidebar-width)"},children:[d.jsxs("div",{style:{display:"flex",alignItems:"center",gap:12},children:[d.jsx("button",{className:"np-mobile-menu-btn",onClick:s,children:d.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[d.jsx("line",{x1:"3",y1:"6",x2:"21",y2:"6"}),d.jsx("line",{x1:"3",y1:"12",x2:"21",y2:"12"}),d.jsx("line",{x1:"3",y1:"18",x2:"21",y2:"18"})]})}),d.jsx("h1",{className:"np-topbar-title",children:i})]}),d.jsx("div",{style:{display:"flex",alignItems:"center",gap:12},children:d.jsxs("div",{className:"np-streak-badge",children:[d.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:d.jsx("path",{d:"M12 2L15.09 8.26L22 9.27L17 14.14L18.18 21.02L12 17.77L5.82 21.02L7 14.14L2 9.27L8.91 8.26L12 2z"})}),d.jsx("span",{children:"0 day streak"})]})})]})}function uV(){const[s,e]=N.useState(navigator.onLine),t=Gl(i=>i.setIsOnline);return N.useEffect(()=>{const i=()=>{e(!0),t(!0)},a=()=>{e(!1),t(!1)};return window.addEventListener("online",i),window.addEventListener("offline",a),()=>{window.removeEventListener("online",i),window.removeEventListener("offline",a)}},[t]),s}function hV(){return uV()?null:d.jsx("div",{className:"fixed top-0 left-0 right-0 z-50 bg-[var(--warning)]/90 backdrop-blur-sm px-4 py-2 text-center animate-fade-in-down",children:d.jsxs("p",{className:"text-sm font-medium text-[var(--bg)] flex items-center justify-center gap-2",children:[d.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[d.jsx("line",{x1:"1",y1:"1",x2:"23",y2:"23"}),d.jsx("path",{d:"M16.72 11.06A10.94 10.94 0 0119 12.55"}),d.jsx("path",{d:"M5 12.55a10.94 10.94 0 015.17-2.39"}),d.jsx("path",{d:"M10.71 5.05A16 16 0 0122.56 9"}),d.jsx("path",{d:"M1.42 9a15.91 15.91 0 014.7-2.88"}),d.jsx("path",{d:"M8.53 16.11a6 6 0 016.95 0"}),d.jsx("line",{x1:"12",y1:"20",x2:"12.01",y2:"20"})]}),"You're offline  changes will sync when you reconnect"]})})}function dV(){const{sidebarCollapsed:s}=Gl(),[e,t]=N.useState(!1),i=N.useCallback(()=>{t(l=>!l)},[]),a=N.useCallback(()=>{t(!1)},[]);return d.jsxs("div",{style:{minHeight:"100vh",background:"var(--bg)"},children:[d.jsx(hV,{}),d.jsx(oV,{mobileOpen:e,onClose:a}),d.jsx(cV,{onMenuToggle:i}),d.jsx("main",{style:{marginLeft:s?"var(--sidebar-collapsed)":"var(--sidebar-width)",transition:"margin-left 0.3s cubic-bezier(0.4,0,0.2,1)",minHeight:"calc(100vh - 64px)",padding:"28px 32px"},children:d.jsx("div",{className:"np-page",style:{maxWidth:1200,margin:"0 auto"},children:d.jsx(LC,{})})})]})}const fV={0:"#8A8A9A",1:"#FF6B6B",2:"#FFB347",3:"#6C63FF",4:"#00D9A3"},mV=30,Fx=[{text:"The expert in anything was once a beginner.",author:"Helen Hayes"},{text:"Small daily improvements are the key to staggering long-term results.",author:"Unknown"},{text:"Don't watch the clock; do what it does. Keep going.",author:"Sam Levenson"},{text:"Success is the sum of small efforts repeated day in and day out.",author:"Robert Collier"},{text:"The only way to do great work is to love what you do.",author:"Steve Jobs"},{text:"It does not matter how slowly you go as long as you do not stop.",author:"Confucius"},{text:"The secret of getting ahead is getting started.",author:"Mark Twain"},{text:"Believe you can and you're halfway there.",author:"Theodore Roosevelt"},{text:"The mind is everything. What you think you become.",author:"Buddha"},{text:"Education is the most powerful weapon you can use to change the world.",author:"Nelson Mandela"}];function pV(s,e=2.5,t=0,i=0){const a=Math.max(0,Math.min(5,s));let l=e+(.1-(5-a)*(.08+(5-a)*.02));l=Math.max(1.3,l);let u,f;return a<3?(u=1,f=0):(f=i+1,f===1?u=1:f===2?u=6:u=Math.round(t*l)),{interval:Math.max(1,Math.min(365,u)),ef:Math.round(l*100)/100,repetitions:f}}function gV(s,e){if(!s)return 1;switch(e){case"guessed":return 2;case"unsure":return 3;case"sure":return 5;default:return 4}}function yV(s,e,t,i){return t===0?0:s<.4?1:s<.7?2:s<.9?3:s>=.9&&e>=3&&i!=="guessed"?4:3}function HA(s,e=mV){if(!s)return!1;const t=new Date(s);return(new Date().getTime()-t.getTime())/(1e3*60*60*24)>=e}function vV(s){if(!s)return null;const e=new Date(s);return Math.floor((new Date().getTime()-e.getTime())/(1e3*60*60*24))}async function Zv(s,e){const t=Ri(yt,"sessions");return(await Xv(t,{userId:s,status:"in_progress",type:e.type,scope:e.scope,config:e.config,questionIds:e.questionIds,startTime:li(),endTime:null,totalQuestions:e.totalQuestions,answered:0,correct:0,wrong:0,skipped:0,score:0,questionResults:[],templateId:e.templateId||null})).id}async function _V(s,e){await ah(Rn(yt,"sessions",s),e)}async function GA(s,e){await ah(Rn(yt,"sessions",s),{...e,status:"completed",endTime:li()})}async function QA(s){await ah(Rn(yt,"sessions",s),{status:"abandoned",endTime:li()})}async function bV(s){const e=await Wv(Rn(yt,"sessions",s));return e.exists()?{id:e.id,...e.data()}:null}async function EV(s){const e=Ri(yt,"sessions"),t=rh(e,VA("userId","==",s),Kv(10)),a=(await ho(t)).docs.map(u=>({id:u.id,...u.data()})).filter(u=>u.status==="in_progress");if(a.length===0)return null;a.sort((u,f)=>{const p=u.startTime?.toDate?u.startTime.toDate().getTime():0;return(f.startTime?.toDate?f.startTime.toDate().getTime():0)-p});const l=a[0];if(l.startTime){const u=l.startTime.toDate?l.startTime.toDate().getTime():l.startTime;if(Date.now()-u>1440*60*1e3)return await QA(l.id),null}return l}async function wm(s,e=5){const t=Ri(yt,"sessions"),i=rh(t,VA("userId","==",s),Kv(50)),l=(await ho(i)).docs.map(u=>({id:u.id,...u.data()})).filter(u=>u.status==="completed");return l.sort((u,f)=>{const p=u.endTime?.toDate?u.endTime.toDate().getTime():0;return(f.endTime?.toDate?f.endTime.toDate().getTime():0)-p}),l.slice(0,e)}async function TV(s){const e=Ri(yt,"users",s,"templates"),t=rh(e,Gv("createdAt","desc"),Kv(5));return(await ho(t)).docs.map(a=>({id:a.id,...a.data()}))}async function KA(s){const e=Ri(yt,"users",s,"performance"),t=await ho(e),i={};return t.docs.forEach(a=>{i[a.id]=a.data()}),i}async function $A(s,e){const t=LA(yt);for(const i of e){if(!i.questionId||i.userAnswer===null)continue;const a=Rn(yt,"users",s,"performance",i.questionId),l=await Wv(a),u=l.exists()?l.data():{timesAsked:0,timesCorrect:0,timesWrong:0,streak:0,intervalDays:1,easeFactor:2.5,repetitions:0,flagged:!1},f=(u.timesAsked||0)+1,p=(u.timesCorrect||0)+(i.isCorrect?1:0),y=(u.timesWrong||0)+(i.isCorrect?0:1);let _=u.streak||0;i.isCorrect&&i.confidence!=="guessed"?_+=1:i.isCorrect||(_=0);const b=gV(i.isCorrect,i.confidence),x=pV(b,u.easeFactor||2.5,u.intervalDays||0,u.repetitions||0),k=new Date;k.setHours(0,0,0,0);const M=new Date(k.getTime()+x.interval*24*60*60*1e3),j=f>0?p/f:0,V=yV(j,_,f,i.confidence),ee=i.flagged!==void 0?i.flagged:u.flagged||!1,ne={timesAsked:f,timesCorrect:p,timesWrong:y,streak:_,intervalDays:x.interval,easeFactor:x.ef,repetitions:x.repetitions,nextDue:M.toISOString(),lastAsked:new Date().toISOString(),lastConfidence:i.confidence||null,masteryLevel:V,flagged:ee};l.exists()?t.update(a,ne):t.set(a,ne)}await t.commit()}const Xs=Wf((s,e)=>({subjects:[],subjectsLoading:!1,chapters:{},chaptersLoading:!1,questions:{},questionsLoading:!1,performanceMap:{},performanceLoading:!1,fetchSubjects:async t=>{s({subjectsLoading:!0});try{const i=await Y6(t);s({subjects:i,subjectsLoading:!1})}catch(i){console.error("Failed to fetch subjects:",i),s({subjectsLoading:!1})}},addSubject:async(t,i)=>{const a=await W6(t,i);return await e().fetchSubjects(t),a},updateSubject:async(t,i,a)=>{await X6(t,i,a),await e().fetchSubjects(t)},deleteSubject:async(t,i)=>{await J6(t,i),s(a=>({subjects:a.subjects.filter(l=>l.id!==i)}))},fetchChapters:async(t,i)=>{s({chaptersLoading:!0});try{const a=await eV(t,i);s(l=>({chapters:{...l.chapters,[i]:a},chaptersLoading:!1}))}catch(a){console.error("Failed to fetch chapters:",a),s({chaptersLoading:!1})}},addChapter:async(t,i,a)=>{const l=await Z6(t,i,a);return await e().fetchChapters(t,i),l},deleteChapter:async(t,i,a)=>{await tV(t,i,a),await e().fetchChapters(t,i)},fetchQuestions:async(t,i,a)=>{s({questionsLoading:!0});try{const l=await iV(t,i,a);s(u=>({questions:{...u.questions,[a]:l},questionsLoading:!1}))}catch(l){console.error("Failed to fetch questions:",l),s({questionsLoading:!1})}},addQuestions:async(t,i,a,l)=>{await nV(t,i,a,l),await e().fetchQuestions(t,i,a)},deleteQuestion:async(t,i,a,l)=>{await sV(t,i,a,l),s(u=>({questions:{...u.questions,[a]:(u.questions[a]||[]).filter(f=>f.id!==l)}}))},fetchPerformance:async t=>{s({performanceLoading:!0});try{const i=await KA(t);return s({performanceMap:i,performanceLoading:!1}),i}catch(i){return console.error("Failed to fetch performance:",i),s({performanceLoading:!1}),{}}},clearData:()=>s({subjects:[],chapters:{},questions:{},performanceMap:{}})}));function xV(){const s=new Date().getHours();return s<12?"Good morning":s<17?"Good afternoon":s<21?"Good evening":"Burning the midnight oil"}function SV(){const s=an(),{user:e,userProfile:t}=vn(),{subjects:i,fetchSubjects:a,performanceMap:l,fetchPerformance:u}=Xs(),[f,p]=N.useState([]),[y,_]=N.useState(!0),[b]=N.useState(()=>{const F=Math.floor(Math.random()*Fx.length);return Fx[F]});N.useEffect(()=>{e?.uid&&(async()=>{_(!0);try{i.length===0&&await a(e.uid),await u(e.uid);const F=await wm(e.uid,5);p(F)}catch(F){console.error("Dashboard load error:",F)}finally{_(!1)}})()},[e?.uid]);const x=t?.displayName||e?.displayName||"Student",k=t?.dailyGoal||50,M=N.useMemo(()=>{if(!t?.examDate)return null;const F=Math.ceil((new Date(t.examDate)-new Date)/(1e3*60*60*24));return F>0?F:0},[t?.examDate]),j=N.useMemo(()=>{const F=new Date().toISOString().split("T")[0],J=f.filter(I=>I.endTime?(I.endTime?.toDate?I.endTime.toDate():new Date(I.endTime)).toISOString().split("T")[0]===F:!1),C=J.reduce((I,D)=>I+(D.answered||0),0),R=J.reduce((I,D)=>I+(D.correct||0),0),w=C>0?Math.round(R/C*100):0;return{sessions:J.length,answered:C,correct:R,accuracy:w}},[f]),V=N.useMemo(()=>{const F=Object.values(l||{}),J=F.filter(pe=>(pe.masteryLevel||0)>=4).length,C=F.filter(pe=>(pe.timesWrong||0)>0&&(pe.masteryLevel||0)<4).length,R=F.length,w=F.reduce((pe,G)=>pe+(G.timesCorrect||0),0),I=F.reduce((pe,G)=>pe+(G.timesAsked||0),0),D=I>0?Math.round(w/I*100):0,L=new Date;L.setHours(23,59,59,999);const O=F.filter(pe=>pe.nextDue?new Date(pe.nextDue)<=L:!1).length,Se=F.filter(pe=>pe.lastAsked?(Date.now()-new Date(pe.lastAsked).getTime())/(1e3*60*60*24)>=30:!1).length;return{mastered:J,wrongRemaining:C,totalTracked:R,overallAccuracy:D,dueToday:O,stale:Se}},[l]),ee=N.useMemo(()=>{const F=[];return V.dueToday>0&&F.push({icon:"",color:"#00D9A3",title:`${V.dueToday} question${V.dueToday!==1?"s":""} due today`,desc:"Spaced repetition reviews waiting",action:()=>s("/test?mode=due_today")}),V.wrongRemaining>0&&F.push({icon:"",color:"#FF6B6B",title:`${V.wrongRemaining} wrong question${V.wrongRemaining!==1?"s":""} to fix`,desc:"Focus on your mistakes",action:()=>s("/wrong-questions")}),V.stale>0&&F.push({icon:"",color:"#FFB347",title:`${V.stale} stale question${V.stale!==1?"s":""}`,desc:"Not reviewed in 30+ days",action:()=>s("/test?mode=unseen")}),F.length===0&&F.push({icon:"",color:"#6C63FF",title:"All caught up!",desc:"Start a practice session to keep learning",action:()=>s("/practice")}),F.slice(0,4)},[V]),ne=Math.min(100,Math.round(j.answered/k*100)),Y=N.useMemo(()=>{if(f.length===0)return 0;let F=0;const J=new Date;J.setHours(0,0,0,0);for(let C=0;C<30;C++){const R=new Date(J);R.setDate(R.getDate()-C);const w=R.toISOString().split("T")[0];if(f.some(D=>D.endTime?(D.endTime?.toDate?D.endTime.toDate():new Date(D.endTime)).toISOString().split("T")[0]===w:!1))F++;else if(C>0)break}return F},[f]),ie=i.reduce((F,J)=>F+(J.questionCount||0),0);return d.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:24},children:[d.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",flexWrap:"wrap",gap:16},children:[d.jsxs("div",{children:[d.jsxs("h2",{className:"np-page-greeting",children:[xV(),", ",x," "]}),d.jsx("p",{className:"np-page-greeting-sub",children:M!==null&&M>0?`${M} day${M!==1?"s":""} until ${t?.examName||"your exam"}. Keep going!`:"Ready to crush some questions today?"})]}),d.jsxs("div",{style:{display:"flex",alignItems:"center",gap:10,padding:"10px 20px",borderRadius:16,background:Y>0?"rgba(255,179,71,0.08)":"rgba(255,255,255,0.03)",border:`1px solid ${Y>0?"rgba(255,179,71,0.2)":"var(--border)"}`},children:[d.jsx("span",{style:{fontSize:"1.5rem"},children:Y>0?"":""}),d.jsxs("div",{children:[d.jsx("div",{style:{fontFamily:"var(--font-heading)",fontWeight:800,fontSize:"1.3rem",color:Y>0?"#FFB347":"var(--muted)"},children:Y}),d.jsx("div",{style:{fontSize:"0.68rem",color:"var(--muted)"},children:"day streak"})]})]})]}),d.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 2fr",gap:16},children:[d.jsxs("div",{className:"np-card-surface",style:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",padding:"28px 20px"},children:[d.jsx("div",{style:{position:"relative",display:"inline-flex",alignItems:"center",justifyContent:"center"},children:d.jsx(h1,{progress:ne,size:130,strokeWidth:10,color:ne>=100?"#00D9A3":"#6C63FF",children:d.jsxs("div",{style:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",textAlign:"center"},children:[d.jsx("div",{style:{fontFamily:"var(--font-heading)",fontWeight:800,fontSize:"1.5rem",color:ne>=100?"#00D9A3":"#6C63FF"},children:j.answered}),d.jsxs("div",{style:{fontSize:"0.65rem",color:"var(--muted)"},children:["/ ",k]})]})})}),d.jsxs("div",{style:{marginTop:12,textAlign:"center"},children:[d.jsx("div",{style:{fontSize:"0.82rem",fontWeight:600},children:"Daily Goal"}),d.jsx("div",{style:{fontSize:"0.7rem",color:"var(--muted)"},children:ne>=100?" Goal reached!":`${k-j.answered} more to go`})]})]}),d.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(2, 1fr)",gap:12},children:[d.jsx(Gd,{icon:"",label:"Today's Accuracy",value:`${j.accuracy}%`,color:"#6C63FF",sub:`${j.correct}/${j.answered} correct`}),d.jsx(Gd,{icon:"",label:"Mastered",value:V.mastered.toString(),color:"#00D9A3",sub:`of ${ie} questions`}),d.jsx(Gd,{icon:"",label:"Wrong Remaining",value:V.wrongRemaining.toString(),color:"#FF6B6B",sub:"need more practice"}),d.jsx(Gd,{icon:"",label:"Days Left",value:M!==null&&M>0?M.toString():"",color:"#FFB347",sub:t?.examName||"No exam set"})]})]}),d.jsxs("div",{className:"np-card-surface",children:[d.jsx("h3",{style:{fontFamily:"var(--font-heading)",fontWeight:700,fontSize:"1.05rem",marginBottom:16},children:" Focus Recommendations"}),d.jsx("div",{style:{display:"flex",flexDirection:"column",gap:10},children:ee.map((F,J)=>d.jsxs("div",{onClick:F.action,className:"np-dash-focus-item",style:{display:"flex",alignItems:"center",gap:14,padding:"14px 16px",borderRadius:12,background:"rgba(255,255,255,0.02)",border:"1px solid var(--border)",cursor:"pointer",transition:"all 0.2s"},onMouseEnter:C=>{C.currentTarget.style.background=`${F.color}08`,C.currentTarget.style.borderColor=`${F.color}30`},onMouseLeave:C=>{C.currentTarget.style.background="rgba(255,255,255,0.02)",C.currentTarget.style.borderColor="var(--border)"},children:[d.jsx("span",{style:{fontSize:"1.3rem",width:42,height:42,borderRadius:10,display:"flex",alignItems:"center",justifyContent:"center",background:`${F.color}15`,flexShrink:0},children:F.icon}),d.jsxs("div",{style:{flex:1},children:[d.jsx("div",{style:{fontSize:"0.88rem",fontWeight:600},children:F.title}),d.jsx("div",{style:{fontSize:"0.72rem",color:"var(--muted)"},children:F.desc})]}),d.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"var(--muted)",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",style:{flexShrink:0},children:d.jsx("polyline",{points:"9 18 15 12 9 6"})})]},J))})]}),d.jsxs("div",{style:{display:"grid",gridTemplateColumns:"3fr 2fr",gap:16},children:[d.jsxs("div",{className:"np-card-surface",children:[d.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:16},children:[d.jsx("h3",{style:{fontFamily:"var(--font-heading)",fontWeight:700,fontSize:"1.05rem"},children:" Recent Sessions"}),d.jsx("button",{className:"np-btn np-btn-ghost np-btn-sm",onClick:()=>s("/analytics"),style:{fontSize:"0.75rem"},children:"View all "})]}),f.length===0?d.jsxs("div",{className:"np-empty",style:{padding:"40px 16px"},children:[d.jsx("div",{style:{fontSize:"2rem",marginBottom:10,opacity:.5},children:""}),d.jsx("p",{style:{color:"var(--muted)",fontSize:"0.82rem"},children:"No sessions yet. Start practicing!"})]}):d.jsx("div",{style:{display:"flex",flexDirection:"column",gap:8},children:f.map(F=>{const J=F.score>=70?"#00D9A3":F.score>=40?"#FFB347":"#FF6B6B",C=F.endTime?.toDate?F.endTime.toDate():F.endTime?new Date(F.endTime):null,R=C?AV(C):"";return d.jsxs("div",{onClick:()=>s(`/test/results?session=${F.id}`),style:{display:"flex",alignItems:"center",justifyContent:"space-between",padding:"12px 14px",borderRadius:10,background:"rgba(255,255,255,0.02)",border:"1px solid var(--border)",cursor:"pointer",transition:"all 0.2s"},onMouseEnter:w=>{w.currentTarget.style.background="rgba(255,255,255,0.04)",w.currentTarget.style.borderColor="var(--border-hover)"},onMouseLeave:w=>{w.currentTarget.style.background="rgba(255,255,255,0.02)",w.currentTarget.style.borderColor="var(--border)"},children:[d.jsxs("div",{style:{display:"flex",alignItems:"center",gap:10},children:[d.jsxs("div",{style:{width:38,height:38,borderRadius:10,display:"flex",alignItems:"center",justifyContent:"center",background:`${J}12`,fontSize:"0.82rem",fontWeight:800,color:J,fontFamily:"var(--font-heading)"},children:[F.score,"%"]}),d.jsxs("div",{children:[d.jsx("div",{style:{fontSize:"0.82rem",fontWeight:600},children:F.scope?.subjectNames?.join(", ")||"All Subjects"}),d.jsxs("div",{style:{fontSize:"0.68rem",color:"var(--muted)"},children:[F.answered,"/",F.totalQuestions," answered  ",wV(F.type)]})]})]}),d.jsx("div",{style:{fontSize:"0.68rem",color:"var(--muted)",flexShrink:0},children:R})]},F.id)})})]}),d.jsxs("div",{className:"np-card-surface",children:[d.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:16},children:[d.jsx("h3",{style:{fontFamily:"var(--font-heading)",fontWeight:700,fontSize:"1.05rem"},children:" Subjects"}),d.jsx("button",{className:"np-btn np-btn-ghost np-btn-sm",onClick:()=>s("/subjects"),style:{fontSize:"0.75rem"},children:"Manage "})]}),i.length===0?d.jsxs("div",{className:"np-empty",style:{padding:"40px 16px"},children:[d.jsx("div",{style:{fontSize:"2rem",marginBottom:10,opacity:.5},children:""}),d.jsx("p",{style:{color:"var(--muted)",fontSize:"0.82rem"},children:"No subjects yet."}),d.jsx("button",{className:"np-btn np-btn-primary np-btn-sm",onClick:()=>s("/subjects"),style:{marginTop:12},children:"Add Subject"})]}):d.jsx("div",{style:{display:"flex",flexDirection:"column",gap:8},children:i.map(F=>{const J=F.questionCount?Math.round((F.masteredCount||0)/F.questionCount*100):0;return d.jsxs("div",{onClick:()=>s(`/subjects/${F.id}`),style:{display:"flex",alignItems:"center",gap:12,padding:"12px 14px",borderRadius:10,background:"rgba(255,255,255,0.02)",border:"1px solid var(--border)",cursor:"pointer",transition:"all 0.2s"},onMouseEnter:C=>{C.currentTarget.style.borderColor=F.color||"var(--border-hover)"},onMouseLeave:C=>{C.currentTarget.style.borderColor="var(--border)"},children:[d.jsx("span",{style:{fontSize:"1.2rem",width:38,height:38,borderRadius:10,display:"flex",alignItems:"center",justifyContent:"center",background:`${F.color||"#6C63FF"}15`},children:F.icon||""}),d.jsxs("div",{style:{flex:1,minWidth:0},children:[d.jsx("div",{style:{fontSize:"0.85rem",fontWeight:600,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:F.name}),d.jsxs("div",{style:{fontSize:"0.68rem",color:"var(--muted)"},children:[F.questionCount||0," Q  ",J,"% mastered"]})]}),d.jsx("div",{style:{width:50,height:4,borderRadius:999,background:"rgba(255,255,255,0.06)",overflow:"hidden",flexShrink:0},children:d.jsx("div",{style:{height:"100%",borderRadius:999,width:`${J}%`,background:F.color||"#6C63FF",transition:"width 0.3s ease"}})})]},F.id)})})]})]}),d.jsxs("div",{style:{textAlign:"center",padding:"24px 28px",borderRadius:16,background:"linear-gradient(135deg, rgba(108,99,255,0.06), rgba(0,217,163,0.04))",border:"1px solid rgba(108,99,255,0.12)"},children:[d.jsxs("p",{style:{fontStyle:"italic",color:"var(--text-secondary)",fontSize:"0.95rem",lineHeight:1.6},children:['"',b.text,'"']}),d.jsxs("p",{style:{color:"var(--muted)",fontSize:"0.75rem",marginTop:8},children:[" ",b.author]})]})]})}function Gd({icon:s,label:e,value:t,color:i,sub:a}){return d.jsxs("div",{className:"np-card-surface",style:{padding:"18px 16px",display:"flex",alignItems:"center",gap:14},children:[d.jsx("div",{style:{width:44,height:44,borderRadius:12,display:"flex",alignItems:"center",justifyContent:"center",background:`${i}12`,fontSize:"1.3rem",flexShrink:0},children:s}),d.jsxs("div",{children:[d.jsx("div",{style:{fontFamily:"var(--font-heading)",fontWeight:800,fontSize:"1.3rem",color:i,lineHeight:1},children:t}),d.jsx("div",{style:{fontSize:"0.72rem",color:"var(--muted)",marginTop:2},children:e}),a&&d.jsx("div",{style:{fontSize:"0.65rem",color:"var(--muted)",opacity:.7},children:a})]})]})}function wV(s){return{smart:"Smart",wrong:"Wrong Qs",due_today:"Due Today",unseen:"Unseen",flagged:"Flagged",random:"Quick Mix"}[s]||s}function AV(s){const t=new Date-s,i=Math.floor(t/6e4),a=Math.floor(t/36e5),l=Math.floor(t/864e5);return i<1?"just now":i<60?`${i}m ago`:a<24?`${a}h ago`:l===1?"yesterday":l<7?`${l}d ago`:s.toLocaleDateString("en-US",{month:"short",day:"numeric"})}function Fs(s){const e=[...s];for(let t=e.length-1;t>0;t--){const i=Math.floor(Math.random()*(t+1));[e[t],e[i]]=[e[i],e[t]]}return e}function IV(s,e,t){const i=s.filter(_=>_.important===!0),a=s.filter(_=>!_.important),l=Math.min(Math.ceil(t*.7),i.length),u=Math.min(t-l,a.length),f=Fs(i).slice(0,l);let p=Fs(a).slice(0,u);const y=t-f.length-p.length;if(y>0){const _=Fs(a.filter(b=>!p.includes(b))).slice(0,y);p=[...p,..._]}return jV(f,p)}function WA(s,e){return s.filter(i=>{const a=e[i.id];return a&&a.timesWrong>0&&(a.masteryLevel||0)<4}).sort((i,a)=>{const l=e[i.id]||{},u=e[a.id]||{},f=(l.timesWrong||0)*3-(l.timesCorrect||0)*1;return(u.timesWrong||0)*3-(u.timesCorrect||0)*1-f})}function YA(s,e){const t=new Date;t.setHours(23,59,59,999);const i=t.getTime();return s.filter(l=>{const u=e[l.id];return!u||!u.nextDue?!1:new Date(u.nextDue).getTime()<=i}).sort((l,u)=>{const f=new Date(e[l.id].nextDue).getTime(),p=new Date(e[u.id].nextDue).getTime();return f-p})}function CV(s,e){const t=s.filter(a=>{const l=e[a.id];return!l||(l.timesAsked||0)===0}),i=s.filter(a=>{const l=e[a.id];return l&&(l.timesAsked||0)>0});return i.sort((a,l)=>(e[a.id]?.timesAsked||0)-(e[l.id]?.timesAsked||0)),[...Fs(t),...i]}function XA(s,e){return s.filter(t=>{const i=e[t.id];return i&&i.flagged===!0})}function RV(s,e){return Fs(s).slice(0,e)}function DV(s,e,t=30){const i=Date.now(),a=t*24*60*60*1e3;return s.filter(u=>{const f=e[u.id];if(!f||!f.lastAsked)return!1;const p=new Date(f.lastAsked).getTime();return i-p>=a}).sort((u,f)=>{const p=new Date(e[u.id].lastAsked).getTime(),y=new Date(e[f.id].lastAsked).getTime();return p-y})}function NV(s){const e=Fs(s),t=e.map(i=>i.label);return{options:e,optionOrder:t}}function jV(s,e){const t=[],i=s.length+e.length;let a=0,l=0;for(let u=0;u<i;u++){const f=s.length/i;a<s.length&&(l>=e.length||Math.random()<f)?t.push(s[a++]):l<e.length?t.push(e[l++]):t.push(s[a++])}return t}async function ch(s,e,t){const{subjects:i,fetchChapters:a,fetchQuestions:l,chapters:u,questions:f}=t,p=e.subjectIds[0]==="all"?i:i.filter(_=>e.subjectIds.includes(_.id)),y=[];for(const _ of p){u[_.id]||await a(s,_.id);const b=t.chapters[_.id]||[],x=!e.chapterIds||e.chapterIds[0]==="all"?b:b.filter(k=>e.chapterIds.includes(k.id));for(const k of x){f[k.id]||await l(s,_.id,k.id);const M=t.questions[k.id]||[];for(const j of M)y.push({...j,subjectId:_.id,subjectName:_.name,subjectColor:_.color,chapterId:k.id,chapterName:k.name})}}return y}const kV=[{key:"smart",title:"Smart Session",icon:"",color:"#8B5CF6",desc:"70% important, 30% normal  optimized mix"},{key:"wrong",title:"Wrong Questions",icon:"",color:"#FF6B6B",desc:"Focus on your past mistakes"},{key:"due_today",title:"Due Today",icon:"",color:"#00D9A3",desc:"Spaced repetition reviews"},{key:"unseen",title:"Unseen First",icon:"",color:"#FFB347",desc:"Tackle new questions first"},{key:"flagged",title:"Flagged Only",icon:"",color:"#FF006E",desc:"Your bookmarked questions"},{key:"random",title:"Quick Mix",icon:"",color:"#6C63FF",desc:"Pure random selection"}];function OV(){const s=an(),{user:e}=vn(),t=Xs(),{subjects:i,fetchSubjects:a,performanceMap:l,fetchPerformance:u}=t,[f,p]=N.useState(null),[y,_]=N.useState([]),[b,x]=N.useState([]);N.useEffect(()=>{e?.uid&&(i.length===0&&a(e.uid),u(e.uid),wm(e.uid,1).then(M=>{M.length>0&&p(M[0])}),TV(e.uid).then(_))},[e?.uid]),N.useEffect(()=>{!e?.uid||i.length===0||(async()=>{const M=await ch(e.uid,{subjectIds:["all"]},t);x(M)})()},[e?.uid,i,t.chapters,t.questions]);const k=N.useMemo(()=>b.length===0||!l?{}:{wrong:WA(b,l).length,due_today:YA(b,l).length,flagged:XA(b,l).length,stale:DV(b,l).length},[b,l]);return d.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:28},children:[d.jsxs("div",{children:[d.jsx("h2",{className:"np-section-title",children:"Practice Hub"}),d.jsx("p",{className:"np-section-subtitle",children:"Choose your practice mode and start learning"})]}),i.length>0&&d.jsx("div",{style:{display:"flex",gap:8,overflowX:"auto",paddingBottom:4},children:i.map(M=>d.jsxs("button",{className:"np-pill",style:{borderColor:M.color,color:M.color,flexShrink:0},onClick:()=>s(`/test?subject=${M.id}`),children:[M.icon," ",M.name]},M.id))}),k.stale>0&&d.jsxs("div",{style:{display:"flex",alignItems:"center",gap:12,padding:"14px 20px",borderRadius:12,background:"rgba(255,179,71,0.08)",border:"1px solid rgba(255,179,71,0.2)",fontSize:"0.85rem"},children:[d.jsx("span",{style:{fontSize:"1.3rem"},children:""}),d.jsxs("div",{children:[d.jsxs("span",{style:{fontWeight:600,color:"#FFB347"},children:[k.stale," stale question",k.stale!==1?"s":""]}),d.jsx("span",{style:{color:"var(--muted)"},children:"  not reviewed in 30+ days. Consider revisiting!"})]})]}),d.jsx("div",{className:"np-stagger",style:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(280px, 1fr))",gap:16},children:kV.map(M=>{const j=k[M.key];return d.jsxs("div",{className:"np-mode-card",style:{"--accent-color":M.color,cursor:"pointer"},onClick:()=>s(`/test?mode=${M.key}`),children:[d.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[d.jsx("div",{className:"np-mode-icon",style:{background:`${M.color}18`},children:M.icon}),j>0&&d.jsx("span",{style:{padding:"3px 10px",borderRadius:20,background:`${M.color}15`,color:M.color,fontSize:"0.72rem",fontWeight:700},children:j})]}),d.jsx("div",{className:"np-mode-title",children:M.title}),d.jsx("div",{className:"np-mode-desc",children:M.desc}),d.jsxs("div",{style:{display:"flex",alignItems:"center",gap:6,marginTop:16,color:M.color,fontSize:"0.8rem",fontWeight:600},children:[d.jsx("span",{children:"Start session"}),d.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:d.jsx("polyline",{points:"9 18 15 12 9 6"})})]})]},M.key)})}),d.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",padding:"20px 28px",borderRadius:16,background:"linear-gradient(135deg, rgba(255,107,53,0.12), rgba(255,0,110,0.08))",border:"1px solid rgba(255,107,53,0.2)"},children:[d.jsxs("div",{style:{display:"flex",alignItems:"center",gap:16},children:[d.jsx("span",{style:{fontSize:"2rem"},children:""}),d.jsxs("div",{children:[d.jsx("div",{style:{fontFamily:"var(--font-heading)",fontWeight:700,fontSize:"1.05rem"},children:"Rapid Fire Mode"}),d.jsx("div",{style:{fontSize:"0.8rem",color:"var(--muted)",marginTop:2},children:"Speed drill with streak multipliers  test your reflexes"})]})]}),d.jsx("button",{className:"np-btn np-btn-outline np-btn-sm",onClick:()=>s("/rapid-fire"),style:{borderColor:"rgba(255,107,53,0.3)",color:"#FF6B35",flexShrink:0},children:"Try it "})]}),f&&d.jsx("div",{className:"np-card-surface",style:{padding:"20px 24px"},children:d.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[d.jsxs("div",{children:[d.jsx("h3",{style:{fontFamily:"var(--font-heading)",fontWeight:700,fontSize:"0.95rem",marginBottom:6},children:" Last Session"}),d.jsxs("div",{style:{display:"flex",gap:16,fontSize:"0.82rem",color:"var(--text-secondary)"},children:[d.jsx("span",{children:f.scope?.subjectNames?.join(", ")||"All Subjects"}),d.jsxs("span",{children:["Score: ",d.jsxs("strong",{style:{color:f.score>=70?"#00D9A3":f.score>=40?"#FFB347":"#FF6B6B"},children:[f.score,"%"]})]}),d.jsxs("span",{children:[f.answered,"/",f.totalQuestions," answered"]})]})]}),d.jsx("button",{className:"np-btn np-btn-outline np-btn-sm",onClick:()=>s(`/test?mode=${f.type}`),children:"Retry "})]})}),d.jsxs("div",{children:[d.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:16},children:[d.jsx("h3",{style:{fontFamily:"var(--font-heading)",fontWeight:700,fontSize:"1.1rem"},children:" Saved Templates"}),d.jsxs("span",{style:{fontSize:"0.75rem",color:"var(--muted)"},children:[y.length," / 5"]})]}),y.length===0?d.jsx("div",{className:"np-card-surface",children:d.jsxs("div",{className:"np-empty",style:{padding:"36px 16px"},children:[d.jsx("div",{style:{fontSize:"2.5rem",marginBottom:12,opacity:.6},children:""}),d.jsxs("p",{style:{color:"var(--muted)",fontSize:"0.85rem",lineHeight:1.5},children:["No saved templates yet.",d.jsx("br",{}),"Configure a session and save it for quick access."]})]})}):d.jsx("div",{style:{display:"flex",flexDirection:"column",gap:10},children:y.map(M=>d.jsx("div",{className:"np-card-surface",style:{padding:"14px 20px",cursor:"pointer"},onClick:()=>s(`/test?mode=${M.type}`),children:d.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[d.jsxs("div",{children:[d.jsx("div",{style:{fontWeight:600,fontSize:"0.9rem"},children:M.name||M.type}),d.jsxs("div",{style:{fontSize:"0.75rem",color:"var(--muted)"},children:[M.totalQuestions," Q  ",M.type]})]}),d.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"var(--muted)",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:d.jsx("polyline",{points:"9 18 15 12 9 6"})})]})},M.id))})]})]})}const Qd=["#6C63FF","#00D9A3","#FF6B6B","#FFB347","#00D4FF","#FF006E","#8B5CF6","#FF6B35","#7CFC00","#FFD700"],Kd=["","","","","","","","","","","",""];function MV(){const s=an(),{user:e}=vn(),{subjects:t,subjectsLoading:i,fetchSubjects:a,addSubject:l,updateSubject:u,deleteSubject:f}=Xs(),[p,y]=N.useState(!1),[_,b]=N.useState(null),[x,k]=N.useState(""),[M,j]=N.useState(Qd[0]),[V,ee]=N.useState(Kd[0]),[ne,Y]=N.useState(!1),[ie,F]=N.useState(null);N.useEffect(()=>{e?.uid&&a(e.uid)},[e?.uid,a]);const J=()=>{b(null),k(""),j(Qd[0]),ee(Kd[0]),y(!0)},C=I=>{b(I),k(I.name),j(I.color||Qd[0]),ee(I.icon||Kd[0]),y(!0)},R=async()=>{if(!(!x.trim()||!e?.uid)){Y(!0);try{_?await u(e.uid,_.id,{name:x.trim(),color:M,icon:V}):await l(e.uid,{name:x.trim(),color:M,icon:V}),y(!1)}catch(I){console.error("Failed to save subject:",I)}finally{Y(!1)}}},w=async I=>{if(e?.uid)try{await f(e.uid,I),F(null)}catch(D){console.error("Failed to delete subject:",D)}};return d.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:24},children:[d.jsxs("div",{className:"np-section-header",children:[d.jsxs("div",{children:[d.jsx("h2",{className:"np-section-title",children:"Subjects"}),d.jsx("p",{className:"np-section-subtitle",children:"Manage your study content"})]}),d.jsxs("button",{className:"np-btn np-btn-primary np-btn-md",onClick:J,children:[d.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:[d.jsx("line",{x1:"12",y1:"5",x2:"12",y2:"19"}),d.jsx("line",{x1:"5",y1:"12",x2:"19",y2:"12"})]}),"Add Subject"]})]}),i?d.jsxs("div",{className:"np-card-surface",style:{padding:60,textAlign:"center"},children:[d.jsx("div",{className:"np-auth-spinner",style:{width:32,height:32,borderWidth:3,margin:"0 auto"}}),d.jsx("p",{style:{color:"var(--muted)",marginTop:16,fontSize:"0.9rem"},children:"Loading subjects..."})]}):t.length===0?d.jsx("div",{className:"np-card-surface",children:d.jsxs("div",{className:"np-empty",children:[d.jsx("div",{className:"np-empty-icon",children:""}),d.jsx("div",{className:"np-empty-title",children:"No subjects yet"}),d.jsx("div",{className:"np-empty-desc",children:"Create your first subject to start organizing your questions. You can add chapters and questions within each subject."}),d.jsx("button",{className:"np-btn np-btn-primary np-btn-md",onClick:J,children:"Create First Subject"})]})}):d.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(300px, 1fr))",gap:16},children:t.map(I=>d.jsxs("div",{className:"np-subject-card",style:{"--subject-color":I.color||"#6C63FF",cursor:"pointer"},onClick:()=>s(`/subjects/${I.id}`),children:[d.jsxs("div",{style:{display:"flex",alignItems:"flex-start",justifyContent:"space-between"},children:[d.jsxs("div",{style:{display:"flex",alignItems:"center",gap:14},children:[d.jsx("div",{className:"np-subject-icon",style:{background:`${I.color||"#6C63FF"}18`},children:I.icon||""}),d.jsxs("div",{children:[d.jsx("div",{style:{fontFamily:"var(--font-heading)",fontWeight:700,fontSize:"1.05rem"},children:I.name}),d.jsxs("div",{style:{fontSize:"0.8rem",color:"var(--muted)",marginTop:2},children:[I.questionCount||0," questions  ",I.masteredCount||0," mastered"]})]})]}),d.jsxs("div",{style:{display:"flex",gap:4},onClick:D=>D.stopPropagation(),children:[d.jsx("button",{className:"np-icon-btn",title:"Edit",onClick:()=>C(I),children:d.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[d.jsx("path",{d:"M11 4H4a2 2 0 00-2 2v14a2 2 0 002 2h14a2 2 0 002-2v-7"}),d.jsx("path",{d:"M18.5 2.5a2.121 2.121 0 013 3L12 15l-4 1 1-4 9.5-9.5z"})]})}),d.jsx("button",{className:"np-icon-btn np-icon-btn-danger",title:"Delete",onClick:()=>F(I.id),children:d.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[d.jsx("polyline",{points:"3 6 5 6 21 6"}),d.jsx("path",{d:"M19 6v14a2 2 0 01-2 2H7a2 2 0 01-2-2V6m3 0V4a2 2 0 012-2h4a2 2 0 012 2v2"})]})})]})]}),d.jsx("div",{style:{marginTop:16},children:d.jsx("div",{style:{height:4,borderRadius:999,background:"rgba(255,255,255,0.06)",overflow:"hidden"},children:d.jsx("div",{style:{height:"100%",borderRadius:999,background:I.color||"#6C63FF",width:I.questionCount?`${Math.round((I.masteredCount||0)/I.questionCount*100)}%`:"0%",transition:"width 0.4s ease"}})})}),ie===I.id&&d.jsxs("div",{className:"np-delete-confirm",children:[d.jsx("span",{style:{fontSize:"0.8rem",color:"var(--error)"},children:"Delete this subject?"}),d.jsxs("div",{style:{display:"flex",gap:8},children:[d.jsx("button",{className:"np-btn np-btn-danger np-btn-sm",onClick:()=>w(I.id),children:"Delete"}),d.jsx("button",{className:"np-btn np-btn-outline np-btn-sm",onClick:()=>F(null),children:"Cancel"})]})]})]},I.id))}),d.jsx(Xd,{isOpen:p,onClose:()=>y(!1),title:_?"Edit Subject":"New Subject",children:d.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:20},children:[d.jsxs("div",{children:[d.jsx("label",{style:{display:"block",fontSize:"0.8rem",color:"var(--muted)",marginBottom:8,fontWeight:500},children:"Subject Name"}),d.jsx("input",{type:"text",placeholder:"e.g. Physics, Mathematics...",value:x,onChange:I=>k(I.target.value),autoFocus:!0})]}),d.jsxs("div",{children:[d.jsx("label",{style:{display:"block",fontSize:"0.8rem",color:"var(--muted)",marginBottom:8,fontWeight:500},children:"Icon"}),d.jsx("div",{style:{display:"flex",flexWrap:"wrap",gap:8},children:Kd.map(I=>d.jsx("button",{onClick:()=>ee(I),style:{width:42,height:42,borderRadius:10,fontSize:"1.3rem",display:"flex",alignItems:"center",justifyContent:"center",background:V===I?"rgba(108,99,255,0.2)":"rgba(255,255,255,0.04)",border:V===I?"2px solid var(--primary)":"1px solid var(--border)",cursor:"pointer",transition:"all 0.15s"},children:I},I))})]}),d.jsxs("div",{children:[d.jsx("label",{style:{display:"block",fontSize:"0.8rem",color:"var(--muted)",marginBottom:8,fontWeight:500},children:"Color"}),d.jsx("div",{style:{display:"flex",flexWrap:"wrap",gap:10},children:Qd.map(I=>d.jsx("button",{onClick:()=>j(I),className:`np-color-swatch ${M===I?"active":""}`,style:{background:I}},I))})]}),d.jsxs("div",{style:{display:"flex",gap:12,justifyContent:"flex-end",marginTop:8},children:[d.jsx("button",{className:"np-btn np-btn-outline np-btn-md",onClick:()=>y(!1),children:"Cancel"}),d.jsx("button",{className:"np-btn np-btn-primary np-btn-md",onClick:R,disabled:ne||!x.trim(),children:ne?"Saving...":_?"Save Changes":"Create Subject"})]})]})})]})}function Yg(s){const e=s.split(/\r?\n/).map(p=>p.trim()).filter(p=>p.length>0);if(e.length<2)return{valid:[],errors:["File must have a header row and at least one data row."]};const t=e[0].includes("	")?"	":",",i=qx(e[0],t).map(p=>p.trim().toLowerCase()),a={question:Vr(i,["question","text","q"]),optionA:Vr(i,["optiona","option_a","a","opt_a","option a"]),optionB:Vr(i,["optionb","option_b","b","opt_b","option b"]),optionC:Vr(i,["optionc","option_c","c","opt_c","option c"]),optionD:Vr(i,["optiond","option_d","d","opt_d","option d"]),correct:Vr(i,["correctoption","correct_option","correct","answer","correctanswer","correct_answer"]),explanation:Vr(i,["explanation","explain","solution"]),important:Vr(i,["important","imp","priority"])},l=[];if(a.question===-1&&l.push("question"),a.optionA===-1&&l.push("optionA"),a.optionB===-1&&l.push("optionB"),a.optionC===-1&&l.push("optionC"),a.optionD===-1&&l.push("optionD"),a.correct===-1&&l.push("correctOption"),l.length>0)return{valid:[],errors:[`Missing required columns: ${l.join(", ")}. Expected: question, optionA, optionB, optionC, optionD, correctOption`]};const u=[],f=[];for(let p=1;p<e.length;p++){const y=qx(e[p],t),_=p+1,b=(y[a.question]||"").trim(),x=(y[a.optionA]||"").trim(),k=(y[a.optionB]||"").trim(),M=(y[a.optionC]||"").trim(),j=(y[a.optionD]||"").trim(),V=(y[a.correct]||"").trim().toUpperCase(),ee=a.explanation!==-1?(y[a.explanation]||"").trim():"",ne=a.important!==-1?(y[a.important]||"false").trim().toLowerCase():"false",Y=["true","1","yes","y"].includes(ne);if(!b){f.push(`Row ${_}: Missing question text`);continue}if(!x||!k||!M||!j){f.push(`Row ${_}: Missing one or more options`);continue}if(!["A","B","C","D"].includes(V)){f.push(`Row ${_}: correctOption must be A, B, C, or D (got "${V}")`);continue}u.push({text:b,options:[{label:"A",text:x},{label:"B",text:k},{label:"C",text:M},{label:"D",text:j}],correctOption:V,explanation:ee,important:Y})}return{valid:u,errors:f}}function qx(s,e=","){const t=[];let i="",a=!1;for(let l=0;l<s.length;l++){const u=s[l];u==='"'?a&&s[l+1]==='"'?(i+='"',l++):a=!a:u===e&&!a?(t.push(i),i=""):i+=u}return t.push(i),t}function Vr(s,e){for(const t of e){const i=s.indexOf(t);if(i!==-1)return i}return-1}function VV(){return`question,optionA,optionB,optionC,optionD,correctOption,explanation,important
"What is the capital of France?","Berlin","Madrid","Paris","Rome","C","Paris is the capital of France","true"
"What is 2 + 2?","3","4","5","6","B","Basic arithmetic","false"`}function PV(){const{subjectId:s}=xC(),e=an(),{user:t}=vn(),{subjects:i,fetchSubjects:a,chapters:l,chaptersLoading:u,fetchChapters:f,addChapter:p,deleteChapter:y,questions:_,questionsLoading:b,fetchQuestions:x,addQuestions:k,deleteQuestion:M}=Xs(),[j,V]=N.useState(null),[ee,ne]=N.useState(!1),[Y,ie]=N.useState(""),[F,J]=N.useState(!1),[C,R]=N.useState(null),[w,I]=N.useState(null),[D,L]=N.useState(!1),[O,Se]=N.useState(null),[pe,G]=N.useState(""),[le,ye]=N.useState(""),[Te,Ve]=N.useState(""),[U,z]=N.useState(""),[ue,re]=N.useState(""),[ge,Ie]=N.useState("A"),[Ne,Qe]=N.useState(""),[$e,Di]=N.useState(!1),[ps,gs]=N.useState(!1),[Js,mn]=N.useState(!1),[Zs,ys]=N.useState(null),[Ni,ji]=N.useState(""),[He,ft]=N.useState(null),[hi,fo]=N.useState(!1),aa=N.useRef(null),vt=i.find(de=>de.id===s),Kn=l[s]||[];N.useEffect(()=>{t?.uid&&s&&(i.length===0&&a(t.uid),f(t.uid,s))},[t?.uid,s]);const oa=de=>{if(j===de){V(null);return}V(de),t?.uid&&!_[de]&&x(t.uid,s,de)},la=async()=>{if(!(!Y.trim()||!t?.uid)){J(!0);try{await p(t.uid,s,{name:Y.trim()}),ne(!1),ie("")}catch(de){console.error("Failed to add chapter:",de)}finally{J(!1)}}},ki=async de=>{if(t?.uid)try{await y(t.uid,s,de),R(null),j===de&&V(null)}catch(Jt){console.error("Failed to delete chapter:",Jt)}},mo=de=>{Se(de),G(""),ye(""),Ve(""),z(""),re(""),Ie("A"),Qe(""),Di(!1),L(!0)},po=async()=>{if(!(!pe.trim()||!le.trim()||!Te.trim()||!U.trim()||!ue.trim())&&!(!t?.uid||!O)){gs(!0);try{await k(t.uid,s,O,[{text:pe.trim(),options:[{label:"A",text:le.trim()},{label:"B",text:Te.trim()},{label:"C",text:U.trim()},{label:"D",text:ue.trim()}],correctOption:ge,explanation:Ne.trim(),important:$e}]),L(!1)}catch(de){console.error("Failed to add question:",de)}finally{gs(!1)}}},ca=de=>{ys(de),ji(""),ft(null),mn(!0)},go=de=>{const Jt=de.target.files?.[0];if(!Jt)return;const Nn=new FileReader;Nn.onload=er=>{const ht=er.target?.result;ji(ht),ft(Yg(ht))},Nn.readAsText(Jt),de.target.value=""},Dn=()=>{Ni.trim()&&ft(Yg(Ni))},qt=async()=>{if(!(!He?.valid?.length||!t?.uid||!Zs)){fo(!0);try{await k(t.uid,s,Zs,He.valid),mn(!1)}catch(de){console.error("Failed to import CSV:",de)}finally{fo(!1)}}},_n=()=>{const de=VV();ji(de),ft(Yg(de))};return!vt&&!u?d.jsx("div",{style:{display:"flex",flexDirection:"column",gap:24},children:d.jsx("div",{className:"np-card-surface",children:d.jsxs("div",{className:"np-empty",children:[d.jsx("div",{className:"np-empty-icon",children:""}),d.jsx("div",{className:"np-empty-title",children:"Subject not found"}),d.jsx("div",{className:"np-empty-desc",children:"This subject may have been deleted."}),d.jsx("button",{className:"np-btn np-btn-primary np-btn-md",onClick:()=>e("/subjects"),children:"Back to Subjects"})]})})}):d.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:24},children:[d.jsxs("div",{style:{display:"flex",alignItems:"center",gap:16},children:[d.jsx("button",{className:"np-icon-btn",onClick:()=>e("/subjects"),title:"Back",children:d.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:d.jsx("polyline",{points:"15 18 9 12 15 6"})})}),vt&&d.jsxs("div",{style:{display:"flex",alignItems:"center",gap:14,flex:1},children:[d.jsx("div",{className:"np-subject-icon",style:{background:`${vt.color||"#6C63FF"}18`},children:vt.icon||""}),d.jsxs("div",{children:[d.jsx("h2",{style:{fontFamily:"var(--font-heading)",fontWeight:800,fontSize:"1.5rem"},children:vt.name}),d.jsxs("p",{style:{fontSize:"0.85rem",color:"var(--muted)"},children:[Kn.length," chapter",Kn.length!==1?"s":"","  ",vt.questionCount||0," questions"]})]})]}),d.jsxs("button",{className:"np-btn np-btn-primary np-btn-md",onClick:()=>{ie(""),ne(!0)},children:[d.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:[d.jsx("line",{x1:"12",y1:"5",x2:"12",y2:"19"}),d.jsx("line",{x1:"5",y1:"12",x2:"19",y2:"12"})]}),"Add Chapter"]})]}),u?d.jsxs("div",{className:"np-card-surface",style:{padding:60,textAlign:"center"},children:[d.jsx("div",{className:"np-auth-spinner",style:{width:32,height:32,borderWidth:3,margin:"0 auto"}}),d.jsx("p",{style:{color:"var(--muted)",marginTop:16,fontSize:"0.9rem"},children:"Loading chapters..."})]}):Kn.length===0?d.jsx("div",{className:"np-card-surface",children:d.jsxs("div",{className:"np-empty",children:[d.jsx("div",{className:"np-empty-icon",children:""}),d.jsx("div",{className:"np-empty-title",children:"No chapters yet"}),d.jsx("div",{className:"np-empty-desc",children:"Create chapters to organize questions within this subject."}),d.jsx("button",{className:"np-btn np-btn-primary np-btn-md",onClick:()=>{ie(""),ne(!0)},children:"Create First Chapter"})]})}):d.jsx("div",{style:{display:"flex",flexDirection:"column",gap:12},children:Kn.map(de=>{const Jt=j===de.id,Nn=_[de.id]||[],er=b&&Jt&&!_[de.id];return d.jsxs("div",{className:"np-chapter-card",children:[d.jsxs("div",{className:"np-chapter-header",onClick:()=>oa(de.id),children:[d.jsxs("div",{style:{display:"flex",alignItems:"center",gap:12,flex:1},children:[d.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"var(--muted)",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",style:{transition:"transform 0.2s",transform:Jt?"rotate(90deg)":"none",flexShrink:0},children:d.jsx("polyline",{points:"9 18 15 12 9 6"})}),d.jsx("span",{style:{fontWeight:600,fontSize:"0.95rem"},children:de.name}),d.jsxs("span",{className:"np-badge",style:{background:`${vt?.color||"#6C63FF"}18`,color:vt?.color||"#6C63FF"},children:[de.questionCount||Nn.length||0," Q"]})]}),d.jsxs("div",{style:{display:"flex",gap:4},onClick:ht=>ht.stopPropagation(),children:[d.jsx("button",{className:"np-icon-btn",title:"Add Question",onClick:()=>mo(de.id),children:d.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[d.jsx("line",{x1:"12",y1:"5",x2:"12",y2:"19"}),d.jsx("line",{x1:"5",y1:"12",x2:"19",y2:"12"})]})}),d.jsx("button",{className:"np-icon-btn",title:"Import CSV",onClick:()=>ca(de.id),children:d.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[d.jsx("path",{d:"M21 15v4a2 2 0 01-2 2H5a2 2 0 01-2-2v-4"}),d.jsx("polyline",{points:"17 8 12 3 7 8"}),d.jsx("line",{x1:"12",y1:"3",x2:"12",y2:"15"})]})}),d.jsx("button",{className:"np-icon-btn np-icon-btn-danger",title:"Delete Chapter",onClick:()=>R(de.id),children:d.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[d.jsx("polyline",{points:"3 6 5 6 21 6"}),d.jsx("path",{d:"M19 6v14a2 2 0 01-2 2H7a2 2 0 01-2-2V6m3 0V4a2 2 0 012-2h4a2 2 0 012 2v2"})]})})]})]}),C===de.id&&d.jsxs("div",{className:"np-delete-confirm",style:{margin:"0 16px 12px"},children:[d.jsx("span",{style:{fontSize:"0.8rem",color:"var(--error)"},children:"Delete this chapter and all its questions?"}),d.jsxs("div",{style:{display:"flex",gap:8},children:[d.jsx("button",{className:"np-btn np-btn-danger np-btn-sm",onClick:()=>ki(de.id),children:"Delete"}),d.jsx("button",{className:"np-btn np-btn-outline np-btn-sm",onClick:()=>R(null),children:"Cancel"})]})]}),Jt&&d.jsx("div",{className:"np-chapter-questions",children:er?d.jsx("div",{style:{padding:24,textAlign:"center"},children:d.jsx("div",{className:"np-auth-spinner",style:{width:24,height:24,borderWidth:2,margin:"0 auto"}})}):Nn.length===0?d.jsxs("div",{style:{padding:"24px 16px",textAlign:"center",color:"var(--muted)",fontSize:"0.85rem"},children:["No questions in this chapter yet.",d.jsxs("div",{style:{display:"flex",gap:8,justifyContent:"center",marginTop:12},children:[d.jsx("button",{className:"np-btn np-btn-outline np-btn-sm",onClick:()=>mo(de.id),children:"Add Manually"}),d.jsx("button",{className:"np-btn np-btn-outline np-btn-sm",onClick:()=>ca(de.id),children:" Import CSV"})]})]}):d.jsx("div",{style:{display:"flex",flexDirection:"column",gap:8,padding:"8px 0"},children:Nn.map((ht,vs)=>d.jsx("div",{className:"np-question-item",children:d.jsxs("div",{style:{display:"flex",gap:10,alignItems:"flex-start"},children:[d.jsx("span",{className:"np-q-num",children:vs+1}),d.jsxs("div",{style:{flex:1},children:[d.jsx("p",{style:{fontSize:"0.9rem",fontWeight:500,marginBottom:8,lineHeight:1.5},children:ht.text}),d.jsx("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:6},children:ht.options?.map(mt=>d.jsxs("div",{className:`np-q-option ${mt.label===ht.correctOption?"np-q-option-correct":""}`,children:[d.jsx("span",{className:"np-q-option-label",children:mt.label}),d.jsx("span",{children:mt.text})]},mt.label))}),ht.explanation&&d.jsxs("p",{style:{fontSize:"0.78rem",color:"var(--muted)",marginTop:8,fontStyle:"italic"},children:[" ",ht.explanation]}),w===ht.id&&d.jsxs("div",{className:"np-delete-confirm",style:{marginTop:8,paddingTop:8},children:[d.jsx("span",{style:{fontSize:"0.78rem",color:"var(--error)"},children:"Delete this question?"}),d.jsxs("div",{style:{display:"flex",gap:8},children:[d.jsx("button",{className:"np-btn np-btn-danger np-btn-sm",onClick:()=>{M(t.uid,s,de.id,ht.id),I(null)},children:"Delete"}),d.jsx("button",{className:"np-btn np-btn-outline np-btn-sm",onClick:()=>I(null),children:"Cancel"})]})]})]}),d.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",gap:4,flexShrink:0},children:[ht.important&&d.jsx("span",{className:"np-badge",style:{background:"rgba(255,179,71,0.12)",color:"#FFB347",fontSize:"0.7rem"},children:" Important"}),d.jsx("button",{className:"np-icon-btn np-icon-btn-danger",title:"Delete Question",onClick:()=>I(ht.id),children:d.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[d.jsx("polyline",{points:"3 6 5 6 21 6"}),d.jsx("path",{d:"M19 6v14a2 2 0 01-2 2H7a2 2 0 01-2-2V6m3 0V4a2 2 0 012-2h4a2 2 0 012 2v2"})]})})]})]})},ht.id))})})]},de.id)})}),d.jsx(Xd,{isOpen:ee,onClose:()=>ne(!1),title:"New Chapter",children:d.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:16},children:[d.jsxs("div",{children:[d.jsx("label",{style:{display:"block",fontSize:"0.8rem",color:"var(--muted)",marginBottom:8,fontWeight:500},children:"Chapter Name"}),d.jsx("input",{type:"text",placeholder:"e.g. Newton's Laws, Trigonometry...",value:Y,onChange:de=>ie(de.target.value),autoFocus:!0})]}),d.jsxs("div",{style:{display:"flex",gap:12,justifyContent:"flex-end"},children:[d.jsx("button",{className:"np-btn np-btn-outline np-btn-md",onClick:()=>ne(!1),children:"Cancel"}),d.jsx("button",{className:"np-btn np-btn-primary np-btn-md",onClick:la,disabled:F||!Y.trim(),children:F?"Creating...":"Create Chapter"})]})]})}),d.jsx(Xd,{isOpen:D,onClose:()=>L(!1),title:"Add Question",size:"lg",children:d.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:16},children:[d.jsxs("div",{children:[d.jsx("label",{style:{display:"block",fontSize:"0.8rem",color:"var(--muted)",marginBottom:6,fontWeight:500},children:"Question"}),d.jsx("textarea",{rows:3,placeholder:"Enter question text...",value:pe,onChange:de=>G(de.target.value),style:{resize:"vertical",minHeight:80}})]}),d.jsx("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:12},children:[{label:"A",value:le,set:ye},{label:"B",value:Te,set:Ve},{label:"C",value:U,set:z},{label:"D",value:ue,set:re}].map(de=>d.jsxs("div",{children:[d.jsxs("label",{style:{display:"flex",alignItems:"center",gap:6,fontSize:"0.8rem",color:"var(--muted)",marginBottom:6,fontWeight:500},children:[d.jsx("span",{style:{width:20,height:20,borderRadius:6,fontSize:"0.7rem",fontWeight:700,display:"flex",alignItems:"center",justifyContent:"center",background:ge===de.label?"rgba(0,217,163,0.2)":"rgba(255,255,255,0.06)",color:ge===de.label?"#00D9A3":"var(--muted)"},children:de.label}),"Option ",de.label]}),d.jsx("input",{type:"text",placeholder:`Option ${de.label}`,value:de.value,onChange:Jt=>de.set(Jt.target.value)})]},de.label))}),d.jsxs("div",{style:{display:"flex",gap:16},children:[d.jsxs("div",{style:{flex:1},children:[d.jsx("label",{style:{display:"block",fontSize:"0.8rem",color:"var(--muted)",marginBottom:6,fontWeight:500},children:"Correct Answer"}),d.jsx("div",{style:{display:"flex",gap:8},children:["A","B","C","D"].map(de=>d.jsx("button",{className:`np-btn np-btn-sm ${ge===de?"np-btn-secondary":"np-btn-outline"}`,onClick:()=>Ie(de),style:{minWidth:42},children:de},de))})]}),d.jsxs("div",{style:{flex:1},children:[d.jsx("label",{style:{display:"block",fontSize:"0.8rem",color:"var(--muted)",marginBottom:6,fontWeight:500},children:"Mark as Important"}),d.jsx("button",{className:`np-btn np-btn-sm ${$e?"np-btn-primary":"np-btn-outline"}`,onClick:()=>Di(!$e),style:{display:"flex",alignItems:"center",gap:6},children:$e?" Important":" Not Important"})]})]}),d.jsxs("div",{children:[d.jsx("label",{style:{display:"block",fontSize:"0.8rem",color:"var(--muted)",marginBottom:6,fontWeight:500},children:"Explanation (optional)"}),d.jsx("textarea",{rows:2,placeholder:"Why is this the correct answer?",value:Ne,onChange:de=>Qe(de.target.value),style:{resize:"vertical"}})]}),d.jsxs("div",{style:{display:"flex",gap:12,justifyContent:"flex-end"},children:[d.jsx("button",{className:"np-btn np-btn-outline np-btn-md",onClick:()=>L(!1),children:"Cancel"}),d.jsx("button",{className:"np-btn np-btn-primary np-btn-md",onClick:po,disabled:ps||!pe.trim()||!le.trim()||!Te.trim()||!U.trim()||!ue.trim(),children:ps?"Adding...":"Add Question"})]})]})}),d.jsx(Xd,{isOpen:Js,onClose:()=>mn(!1),title:"Import Questions from CSV",size:"lg",children:d.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:16},children:[d.jsxs("div",{style:{fontSize:"0.85rem",color:"var(--text-secondary)",lineHeight:1.6},children:["Upload a CSV file or paste CSV content below. Required columns:",d.jsx("code",{style:{display:"block",marginTop:8,padding:"10px 14px",borderRadius:8,background:"rgba(255,255,255,0.04)",fontSize:"0.78rem",color:"var(--primary)"},children:"question, optionA, optionB, optionC, optionD, correctOption, explanation, important"})]}),d.jsxs("div",{style:{display:"flex",gap:8},children:[d.jsx("button",{className:"np-btn np-btn-outline np-btn-sm",onClick:()=>aa.current?.click(),children:" Choose File"}),d.jsx("button",{className:"np-btn np-btn-outline np-btn-sm",onClick:_n,children:" Load Sample"}),d.jsx("input",{ref:aa,type:"file",accept:".csv,.tsv,.txt",style:{display:"none"},onChange:go})]}),d.jsx("textarea",{rows:8,placeholder:"Paste CSV content here...",value:Ni,onChange:de=>{ji(de.target.value),ft(null)},style:{resize:"vertical",fontFamily:"monospace",fontSize:"0.8rem"}}),!He&&Ni.trim()&&d.jsx("button",{className:"np-btn np-btn-outline np-btn-md",onClick:Dn,children:" Preview Import"}),He&&d.jsxs("div",{style:{padding:16,borderRadius:12,background:"rgba(255,255,255,0.02)",border:"1px solid var(--border)"},children:[d.jsxs("div",{style:{display:"flex",gap:16,marginBottom:He.errors.length?12:0},children:[d.jsxs("span",{style:{fontSize:"0.85rem",fontWeight:600,color:"#00D9A3"},children:[" ",He.valid.length," valid question",He.valid.length!==1?"s":""]}),He.errors.length>0&&d.jsxs("span",{style:{fontSize:"0.85rem",fontWeight:600,color:"var(--error)"},children:[" ",He.errors.length," error",He.errors.length!==1?"s":""]})]}),He.errors.length>0&&d.jsx("div",{style:{maxHeight:120,overflowY:"auto",fontSize:"0.78rem",color:"var(--error)",lineHeight:1.6},children:He.errors.map((de,Jt)=>d.jsxs("div",{children:[" ",de]},Jt))})]}),d.jsxs("div",{style:{display:"flex",gap:12,justifyContent:"flex-end"},children:[d.jsx("button",{className:"np-btn np-btn-outline np-btn-md",onClick:()=>mn(!1),children:"Cancel"}),d.jsx("button",{className:"np-btn np-btn-primary np-btn-md",onClick:qt,disabled:hi||!He?.valid?.length,children:hi?"Importing...":`Import ${He?.valid?.length||0} Questions`})]})]})})]})}const Hx=[{key:"week",label:"This Week",days:7},{key:"month",label:"This Month",days:30},{key:"all",label:"All Time",days:9999}];function LV(){const s=an(),{user:e}=vn(),{subjects:t,fetchSubjects:i,performanceMap:a,fetchPerformance:l}=Xs(),[u,f]=N.useState([]),[p,y]=N.useState("month"),[_,b]=N.useState(!0);N.useEffect(()=>{e?.uid&&(async()=>{b(!0);try{t.length===0&&await i(e.uid),await l(e.uid);const w=await wm(e.uid,50);f(w)}catch(w){console.error("Analytics load error:",w)}finally{b(!1)}})()},[e?.uid]);const x=Hx.find(w=>w.key===p)?.days||9999,k=new Date(Date.now()-x*864e5),M=N.useMemo(()=>u.filter(w=>{const I=w.endTime?.toDate?w.endTime.toDate():w.endTime?new Date(w.endTime):null;return I&&I>=k}),[u,p]),j=N.useMemo(()=>{const w=Object.values(a||{}),I=w.length,D=w.reduce((ye,Te)=>ye+(Te.timesCorrect||0),0),L=w.reduce((ye,Te)=>ye+(Te.timesAsked||0),0),O=L>0?Math.round(D/L*100):0,Se=M.reduce((ye,Te)=>ye+(Te.durationSeconds||0),0)/60,pe=Se>=60?`${Math.floor(Se/60)}h ${Math.round(Se%60)}m`:`${Math.round(Se)}m`;let G=0;const le=new Date;le.setHours(0,0,0,0);for(let ye=0;ye<90;ye++){const Te=new Date(le);Te.setDate(Te.getDate()-ye);const Ve=Te.toISOString().split("T")[0];if(u.some(z=>{const ue=z.endTime?.toDate?z.endTime.toDate():z.endTime?new Date(z.endTime):null;return ue&&ue.toISOString().split("T")[0]===Ve}))G++;else if(ye>0)break}return{totalQ:I,accuracy:O,studyTime:pe,streak:G,totalSessions:M.length}},[a,M,u]),V=N.useMemo(()=>{const I=new Date;I.setHours(0,0,0,0);const D=I.getDay(),L=new Date(I);L.setDate(L.getDate()-D-77);const O=[],Se={};u.forEach(pe=>{const G=pe.endTime?.toDate?pe.endTime.toDate():pe.endTime?new Date(pe.endTime):null;if(!G)return;const le=G.toISOString().split("T")[0];Se[le]=(Se[le]||0)+(pe.answered||1)});for(let pe=0;pe<84;pe++){const G=new Date(L);if(G.setDate(G.getDate()+pe),G>I)break;const le=G.toISOString().split("T")[0];O.push({date:le,count:Se[le]||0,day:G.getDay(),week:Math.floor(pe/7)})}return O},[u]),ee=N.useMemo(()=>M.slice().reverse().map((w,I)=>({index:I,score:w.score||0,label:`S${I+1}`})),[M]),ne=N.useMemo(()=>{if(t.length===0)return[];const w={};return t.forEach(I=>{w[I.id]={name:I.name,icon:I.icon||"",color:I.color||"#6C63FF",correct:0,asked:0}}),M.forEach(I=>{(I.scope?.subjectIds||[]).forEach(L=>{w[L]&&(w[L].correct+=I.correct||0,w[L].asked+=I.answered||0)})}),Object.values(w).filter(I=>I.asked>0).map(I=>({...I,accuracy:Math.round(I.correct/I.asked*100)})).sort((I,D)=>D.accuracy-I.accuracy)},[t,M]),Y=N.useMemo(()=>{const w=Object.values(a||{}),I=[0,0,0,0,0];return w.forEach(D=>{I[D.masteryLevel||0]++}),I},[a]),ie=["Unseen","Struggling","Learning","Proficient","Mastered"],F=["#64748B","#FF6B6B","#FFB347","#6C63FF","#00D9A3"],J=Y.reduce((w,I)=>w+I,0),C=N.useMemo(()=>{const w=[];Object.values(a||{}),j.accuracy>0&&(j.accuracy>=80?w.push({icon:"",text:`Great accuracy of ${j.accuracy}%! You're performing well.`,color:"#00D9A3"}):j.accuracy<50&&w.push({icon:"",text:`Your overall accuracy is ${j.accuracy}%. Consider reviewing fundamentals.`,color:"#FF6B6B"})),j.streak>=7?w.push({icon:"",text:`${j.streak}-day streak! Consistency is key to mastery.`,color:"#FFB347"}):j.streak===0&&u.length>0&&w.push({icon:"",text:"Start a session today to build your streak!",color:"#6C63FF"});const I=J>0?Math.round(Y[4]/J*100):0;I>0&&w.push({icon:"",text:`${I}% of tracked questions are mastered. ${I>=50?"Excellent!":"Keep going!"}`,color:"#00D9A3"}),Y[1]>5&&w.push({icon:"",text:`${Y[1]} questions are in "Struggling"  focus on wrong questions mode.`,color:"#FF6B6B"});const D=ne.find(L=>L.accuracy<50&&L.asked>=5);return D&&w.push({icon:D.icon,text:`${D.name} accuracy is only ${D.accuracy}%. Practice this subject more.`,color:D.color}),w.length===0&&w.push({icon:"",text:"Complete more sessions to unlock personalized insights!",color:"#6C63FF"}),w.slice(0,5)},[j,Y,ne,u,J]),R=[{label:"TOTAL QUESTIONS",value:j.totalQ.toString(),color:"#6C63FF"},{label:"OVERALL ACCURACY",value:j.accuracy>0?`${j.accuracy}%`:"",color:"#00D9A3"},{label:"STUDY TIME",value:j.studyTime,color:"#FFB347"},{label:"CURRENT STREAK",value:`${j.streak} day${j.streak!==1?"s":""}`,color:"#FF6B6B"}];return _?d.jsx("div",{style:{display:"flex",flexDirection:"column",gap:24},children:d.jsxs("div",{className:"np-card-surface",style:{padding:60,textAlign:"center"},children:[d.jsx("div",{className:"np-auth-spinner",style:{width:32,height:32,borderWidth:3,margin:"0 auto"}}),d.jsx("p",{style:{color:"var(--muted)",marginTop:16},children:"Loading analytics..."})]})}):d.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:24},children:[d.jsxs("div",{children:[d.jsx("h2",{className:"np-section-title",children:"Analytics"}),d.jsx("p",{className:"np-section-subtitle",children:"Track your progress and find patterns"})]}),d.jsx("div",{style:{display:"flex",gap:8},children:Hx.map(w=>d.jsx("button",{onClick:()=>y(w.key),className:`np-btn ${p===w.key?"np-btn-primary":"np-btn-ghost"} np-btn-sm`,style:p!==w.key?{background:"rgba(255,255,255,0.04)",border:"1px solid var(--border)"}:{},children:w.label},w.key))}),d.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(4, 1fr)",gap:16},children:R.map(w=>d.jsxs("div",{className:"np-card",style:{borderLeft:`3px solid ${w.color}`},children:[d.jsx("p",{style:{fontSize:"0.7rem",color:"var(--muted)",fontWeight:600,letterSpacing:"0.05em",marginBottom:8},children:w.label}),d.jsx("p",{style:{fontFamily:"var(--font-heading)",fontWeight:800,fontSize:"1.75rem",color:w.color},children:w.value})]},w.label))}),d.jsxs("div",{style:{display:"grid",gridTemplateColumns:"2fr 1fr",gap:16},children:[d.jsx(UV,{data:V}),d.jsx(zV,{dist:Y,labels:ie,colors:F,total:J})]}),d.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:16},children:[d.jsx(BV,{data:ee}),d.jsx(FV,{data:ne})]}),d.jsxs("div",{className:"np-card-surface",children:[d.jsx("h3",{style:{fontFamily:"var(--font-heading)",fontWeight:700,fontSize:"1.05rem",marginBottom:16},children:" Insights"}),d.jsx("div",{style:{display:"flex",flexDirection:"column",gap:10},children:C.map((w,I)=>d.jsxs("div",{style:{display:"flex",alignItems:"center",gap:12,padding:"12px 16px",borderRadius:10,background:`${w.color}08`,border:`1px solid ${w.color}20`},children:[d.jsx("span",{style:{fontSize:"1.2rem"},children:w.icon}),d.jsx("span",{style:{fontSize:"0.85rem",color:"var(--text-secondary)"},children:w.text})]},I))})]}),d.jsxs("div",{className:"np-card-surface",children:[d.jsx("h3",{style:{fontFamily:"var(--font-heading)",fontWeight:700,fontSize:"1.05rem",marginBottom:16},children:" Session History"}),M.length===0?d.jsxs("div",{className:"np-empty",style:{padding:"40px 16px"},children:[d.jsx("div",{style:{fontSize:"2rem",marginBottom:10,opacity:.5},children:""}),d.jsx("p",{style:{color:"var(--muted)",fontSize:"0.82rem"},children:"No sessions in this period."})]}):d.jsx("div",{style:{display:"flex",flexDirection:"column",gap:8},children:M.map(w=>{const I=w.score>=70?"#00D9A3":w.score>=40?"#FFB347":"#FF6B6B",D=w.endTime?.toDate?w.endTime.toDate():w.endTime?new Date(w.endTime):null;return d.jsxs("div",{onClick:()=>s(`/test/results?session=${w.id}`),style:{display:"flex",alignItems:"center",justifyContent:"space-between",padding:"12px 14px",borderRadius:10,background:"rgba(255,255,255,0.02)",border:"1px solid var(--border)",cursor:"pointer",transition:"all 0.2s"},onMouseEnter:L=>{L.currentTarget.style.borderColor="var(--border-hover)"},onMouseLeave:L=>{L.currentTarget.style.borderColor="var(--border)"},children:[d.jsxs("div",{style:{display:"flex",alignItems:"center",gap:10},children:[d.jsxs("div",{style:{width:40,height:40,borderRadius:10,display:"flex",alignItems:"center",justifyContent:"center",background:`${I}12`,fontSize:"0.82rem",fontWeight:800,color:I,fontFamily:"var(--font-heading)"},children:[w.score,"%"]}),d.jsxs("div",{children:[d.jsx("div",{style:{fontSize:"0.82rem",fontWeight:600},children:w.scope?.subjectNames?.join(", ")||"All Subjects"}),d.jsxs("div",{style:{fontSize:"0.68rem",color:"var(--muted)"},children:[w.answered||0,"/",w.totalQuestions||0," answered  ",w.type||"practice"]})]})]}),d.jsx("div",{style:{fontSize:"0.68rem",color:"var(--muted)",flexShrink:0},children:D?D.toLocaleDateString("en-US",{month:"short",day:"numeric"}):""})]},w.id)})})]})]})}function UV({data:s}){if(s.length===0)return null;const e=Math.max(1,...s.map(a=>a.count)),t=["","Mon","","Wed","","Fri",""],i=[...new Set(s.map(a=>a.week))];return d.jsxs("div",{className:"np-card-surface",children:[d.jsx("h3",{style:{fontFamily:"var(--font-heading)",fontWeight:700,fontSize:"1.05rem",marginBottom:16},children:" Activity"}),d.jsxs("div",{style:{display:"flex",gap:6},children:[d.jsx("div",{style:{display:"flex",flexDirection:"column",gap:3,paddingTop:0},children:t.map((a,l)=>d.jsx("div",{style:{height:14,fontSize:"0.58rem",color:"var(--muted)",lineHeight:"14px",width:24,textAlign:"right"},children:a},l))}),d.jsx("div",{style:{display:"flex",gap:3,flex:1},children:i.map(a=>d.jsx("div",{style:{display:"flex",flexDirection:"column",gap:3,flex:1},children:[0,1,2,3,4,5,6].map(l=>{const u=s.find(y=>y.week===a&&y.day===l);if(!u)return d.jsx("div",{style:{height:14,borderRadius:3}},l);const f=u.count/e,p=u.count===0?"rgba(255,255,255,0.04)":`rgba(0, 217, 163, ${.15+f*.85})`;return d.jsx("div",{title:`${u.date}: ${u.count} questions`,style:{height:14,borderRadius:3,background:p,cursor:"default",transition:"background 0.2s"}},l)})},a))})]}),d.jsxs("div",{style:{display:"flex",alignItems:"center",gap:6,marginTop:12,justifyContent:"flex-end"},children:[d.jsx("span",{style:{fontSize:"0.6rem",color:"var(--muted)"},children:"Less"}),[0,.25,.5,.75,1].map((a,l)=>d.jsx("div",{style:{width:12,height:12,borderRadius:3,background:a===0?"rgba(255,255,255,0.04)":`rgba(0,217,163,${.15+a*.85})`}},l)),d.jsx("span",{style:{fontSize:"0.6rem",color:"var(--muted)"},children:"More"})]})]})}function zV({dist:s,labels:e,colors:t,total:i}){const f=2*Math.PI*59;let p=0;const y=s.map((_,b)=>{const x=i>0?_/i:0,k=x*f,M=p;return p+=k,{color:t[b],dashLength:k,gapLength:f-k,offset:M,count:_,label:e[b],pct:x}}).filter(_=>_.count>0);return d.jsxs("div",{className:"np-card-surface",style:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center"},children:[d.jsx("h3",{style:{fontFamily:"var(--font-heading)",fontWeight:700,fontSize:"1.05rem",marginBottom:16,alignSelf:"flex-start"},children:" Mastery"}),i===0?d.jsx("p",{style:{color:"var(--muted)",fontSize:"0.82rem"},children:"No data yet"}):d.jsxs(d.Fragment,{children:[d.jsxs("div",{style:{position:"relative",width:140,height:140},children:[d.jsxs("svg",{width:140,height:140,style:{transform:"rotate(-90deg)"},children:[d.jsx("circle",{cx:140/2,cy:140/2,r:59,fill:"none",stroke:"rgba(255,255,255,0.04)",strokeWidth:22}),y.map((_,b)=>d.jsx("circle",{cx:140/2,cy:140/2,r:59,fill:"none",stroke:_.color,strokeWidth:22,strokeDasharray:`${_.dashLength} ${f-_.dashLength}`,strokeDashoffset:-_.offset,strokeLinecap:"butt"},b))]}),d.jsxs("div",{style:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",textAlign:"center"},children:[d.jsxs("div",{style:{fontFamily:"var(--font-heading)",fontWeight:800,fontSize:"1.3rem",color:"#00D9A3"},children:[i>0?Math.round(s[4]/i*100):0,"%"]}),d.jsx("div",{style:{fontSize:"0.6rem",color:"var(--muted)"},children:"mastered"})]})]}),d.jsx("div",{style:{display:"flex",gap:10,flexWrap:"wrap",marginTop:14,justifyContent:"center"},children:s.map((_,b)=>_===0?null:d.jsxs("div",{style:{display:"flex",alignItems:"center",gap:4,fontSize:"0.65rem"},children:[d.jsx("span",{style:{width:8,height:8,borderRadius:"50%",background:t[b],display:"inline-block"}}),d.jsxs("span",{style:{color:"var(--muted)"},children:[e[b],": ",_]})]},b))})]})]})}function BV({data:s}){return d.jsxs("div",{className:"np-card-surface",children:[d.jsx("h3",{style:{fontFamily:"var(--font-heading)",fontWeight:700,fontSize:"1.05rem",marginBottom:16},children:" Accuracy Trend"}),s.length<2?d.jsx("p",{style:{color:"var(--muted)",fontSize:"0.82rem",textAlign:"center",padding:"30px 0"},children:"Need at least 2 sessions to show trend"}):d.jsx("div",{style:{width:"100%",overflowX:"auto"},children:d.jsxs("svg",{viewBox:"0 0 400 160",style:{width:"100%",maxHeight:200},children:[[0,25,50,75,100].map(l=>{const u=140-l/100*140;return d.jsxs("g",{children:[d.jsx("line",{x1:30,y1:u,x2:400,y2:u,stroke:"rgba(255,255,255,0.06)",strokeWidth:"1"}),d.jsxs("text",{x:26,y:u+4,fill:"var(--muted)",fontSize:"8",textAnchor:"end",children:[l,"%"]})]},l)}),d.jsx("polyline",{points:s.map(l=>{const u=30+l.index/(s.length-1)*360,f=140-l.score/100*140;return`${u},${f}`}).join(" "),fill:"none",stroke:"#6C63FF",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round"}),d.jsx("polygon",{points:[...s.map(l=>{const u=30+l.index/(s.length-1)*360,f=140-l.score/100*140;return`${u},${f}`}),`${30+(s.length-1)/(s.length-1)*360},140`,"30,140"].join(" "),fill:"url(#trendGrad)",opacity:"0.3"}),d.jsx("defs",{children:d.jsxs("linearGradient",{id:"trendGrad",x1:"0",y1:"0",x2:"0",y2:"1",children:[d.jsx("stop",{offset:"0%",stopColor:"#6C63FF"}),d.jsx("stop",{offset:"100%",stopColor:"#6C63FF",stopOpacity:"0"})]})}),s.map(l=>{const u=30+l.index/(s.length-1)*360,f=140-l.score/100*140;return d.jsxs("g",{children:[d.jsx("circle",{cx:u,cy:f,r:"4",fill:"#6C63FF"}),d.jsx("circle",{cx:u,cy:f,r:"2",fill:"#fff"})]},l.index)})]})})]})}function FV({data:s}){return d.jsxs("div",{className:"np-card-surface",children:[d.jsx("h3",{style:{fontFamily:"var(--font-heading)",fontWeight:700,fontSize:"1.05rem",marginBottom:16},children:" Subject Accuracy"}),s.length===0?d.jsx("p",{style:{color:"var(--muted)",fontSize:"0.82rem",textAlign:"center",padding:"30px 0"},children:"No subject data yet"}):d.jsx("div",{style:{display:"flex",flexDirection:"column",gap:14},children:s.map(t=>d.jsxs("div",{children:[d.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:6},children:[d.jsxs("span",{style:{fontSize:"0.78rem",fontWeight:600},children:[t.icon," ",t.name]}),d.jsxs("span",{style:{fontSize:"0.75rem",fontWeight:700,color:t.accuracy>=60?"#00D9A3":"#FF6B6B"},children:[t.accuracy,"%"]})]}),d.jsx("div",{style:{height:8,background:"rgba(255,255,255,0.06)",borderRadius:4,overflow:"hidden"},children:d.jsx("div",{style:{height:"100%",borderRadius:4,width:`${t.accuracy/100*100}%`,background:`linear-gradient(90deg, ${t.color}, ${t.color}AA)`,transition:"width 0.5s ease"}})}),d.jsxs("div",{style:{fontSize:"0.62rem",color:"var(--muted)",marginTop:3},children:[t.correct,"/",t.asked," correct"]})]},t.name))})]})}const uh=Wf((s,e)=>({sessionId:null,status:null,type:null,scope:null,config:null,questions:[],currentIndex:0,answers:{},questionOrder:{},totalQuestions:0,answered:0,correct:0,wrong:0,skipped:0,timerActive:!1,timeRemaining:0,questionStartTime:null,paused:!1,showingAnswer:!1,selectedOption:null,sessionStartTime:null,initSession:t=>s({sessionId:t.sessionId,status:"in_progress",type:t.type,scope:t.scope,config:t.config,questions:t.questions,currentIndex:0,answers:{},questionOrder:t.questionOrder||{},totalQuestions:t.questions.length,answered:0,correct:0,wrong:0,skipped:0,timerActive:t.config.timerType!=="none",timeRemaining:t.config.timerType==="per_question"?t.config.timerValue:t.config.timerType==="full_session"?t.config.timerValue*60:0,questionStartTime:Date.now(),paused:!1,showingAnswer:!1,selectedOption:null,sessionStartTime:Date.now()}),answerQuestion:(t,i,a)=>{const l=e(),u=i===a,f=Math.round((Date.now()-(l.questionStartTime||Date.now()))/1e3),p={questionId:t,questionText:l.questions[l.currentIndex]?.text||"",userAnswer:i,correctAnswer:a,isCorrect:u,timeSpent:f,confidence:null,flagged:!1,attemptedAt:new Date().toISOString(),optionOrder:l.questionOrder[t]||["A","B","C","D"]};s(_=>({answers:{..._.answers,[t]:p},answered:_.answered+1,correct:_.correct+(u?1:0),wrong:_.wrong+(u?0:1),showingAnswer:!0,selectedOption:i}));const y=l.answered+1;if(y%10===0&&l.sessionId){const _={...l.answers,[t]:p};_V(l.sessionId,{answered:y,correct:l.correct+(u?1:0),wrong:l.wrong+(u?0:1),questionResults:Object.values(_)}).catch(b=>console.error("Checkpoint save failed:",b))}},setConfidence:(t,i)=>{s(a=>({answers:{...a.answers,[t]:{...a.answers[t],confidence:i}}}))},skipQuestion:t=>{const i=e(),a=Math.round((Date.now()-(i.questionStartTime||Date.now()))/1e3),l={questionId:t,questionText:i.questions[i.currentIndex]?.text||"",userAnswer:null,correctAnswer:i.questions[i.currentIndex]?.correctOption||"",isCorrect:!1,timeSpent:a,confidence:null,flagged:!1,attemptedAt:new Date().toISOString(),optionOrder:i.questionOrder[t]||["A","B","C","D"]};s(u=>({answers:{...u.answers,[t]:l},skipped:u.skipped+1}))},flagQuestion:t=>{s(i=>{const a=i.answers[t];return a?{answers:{...i.answers,[t]:{...a,flagged:!a.flagged}}}:{answers:{...i.answers,[t]:{questionId:t,questionText:"",userAnswer:null,correctAnswer:"",isCorrect:!1,timeSpent:0,confidence:null,flagged:!0,attemptedAt:new Date().toISOString(),optionOrder:i.questionOrder[t]||["A","B","C","D"]}}}})},nextQuestion:()=>{const t=e(),i=t.currentIndex+1;i<t.questions.length&&s({currentIndex:i,showingAnswer:!1,selectedOption:null,questionStartTime:Date.now(),timeRemaining:t.config?.timerType==="per_question"?t.config.timerValue:t.timeRemaining})},goToQuestion:t=>{s({currentIndex:t,showingAnswer:!1,selectedOption:null,questionStartTime:Date.now()})},tickTimer:()=>{const t=e();if(!t.timerActive||t.paused)return;const i=t.timeRemaining-1;if(i<=0){if(t.config?.timerType==="per_question"){const a=t.questions[t.currentIndex];a&&!t.answers[a.id]&&e().skipQuestion(a.id),t.currentIndex<t.questions.length-1&&e().nextQuestion()}s({timeRemaining:Math.max(0,i)})}else s({timeRemaining:i})},pauseSession:()=>s({paused:!0}),resumeSession:()=>s({paused:!1}),endSession:async()=>{const t=e();if(!t.sessionId)return null;const i=t.answered>0?Math.round(t.correct/t.answered*100):0,a={answered:t.answered,correct:t.correct,wrong:t.wrong,skipped:t.skipped,score:i,questionResults:Object.values(t.answers)};return await GA(t.sessionId,a),s({status:"completed"}),{sessionId:t.sessionId,score:i,...a}},resetSession:()=>s({sessionId:null,status:null,type:null,scope:null,config:null,questions:[],currentIndex:0,answers:{},questionOrder:{},totalQuestions:0,answered:0,correct:0,wrong:0,skipped:0,timerActive:!1,timeRemaining:0,questionStartTime:null,paused:!1,showingAnswer:!1,selectedOption:null,sessionStartTime:null})}));function qV(){const s=an(),{user:e}=vn(),t=Xs(),{subjects:i}=t;uh(F=>F.initSession);const[a,l]=N.useState("all"),[u,f]=N.useState([]),[p,y]=N.useState(0),[_,b]=N.useState(!1),[x,k]=N.useState([]),[M,j]=N.useState(!1),[V,ee]=N.useState(!1);N.useEffect(()=>{e?.uid&&i.length===0&&t.fetchSubjects(e.uid)},[e?.uid]);const ne=async()=>{if(e?.uid){j(!0);try{const F={subjectIds:[a],chapterIds:["all"]},J=await ch(e.uid,F,t),C=Fs(J).slice(0,20);if(C.length===0){j(!1);return}const R=await Zv(e.uid,{type:"flashcard",scope:{subjectIds:[a],chapterIds:["all"],subjectNames:[a==="all"?"All":i.find(w=>w.id===a)?.name]},config:{totalQuestions:C.length,timerType:"none",timerValue:0,shuffled:!0,optionsShuffled:!1,showExplanation:!1},questionIds:C.map(w=>w.id),totalQuestions:C.length});f(C),y(0),b(!1),k([]),ee(!0)}catch(F){console.error(F)}finally{j(!1)}}},Y=async F=>{const J=u[p],C={questionId:J.id,questionText:J.text,userAnswer:F?"knew_it":null,correctAnswer:J.correctOption,isCorrect:F,timeSpent:0,confidence:null,flagged:!1,attemptedAt:new Date().toISOString(),optionOrder:["A","B","C","D"]},R=[...x,C];if(k(R),p<u.length-1)y(p+1),b(!1);else{const w=R.filter(D=>D.isCorrect).length,I=Math.round(w/R.length*100);if(e?.uid){await wm(e.uid,1);const D=await EV(e.uid);if(D){await GA(D.id,{answered:R.length,correct:w,wrong:R.length-w,skipped:0,score:I,questionResults:R}),await $A(e.uid,R),s(`/test/results?session=${D.id}`);return}}ee(!1)}};if(!V)return u.length>0&&u[p],d.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:24},children:[d.jsxs("div",{children:[d.jsx("h2",{className:"np-section-title",children:"Flashcards"}),d.jsx("p",{className:"np-section-subtitle",children:"Review questions with flip cards"})]}),d.jsxs("div",{className:"np-config-section",children:[d.jsx("h3",{className:"np-config-title",children:" Select Scope"}),d.jsxs("div",{style:{display:"flex",flexWrap:"wrap",gap:8},children:[d.jsx("button",{className:`np-pill ${a==="all"?"np-pill-active":""}`,onClick:()=>l("all"),children:"All Subjects"}),i.map(F=>d.jsxs("button",{className:`np-pill ${a===F.id?"np-pill-active":""}`,onClick:()=>l(F.id),children:[F.icon," ",F.name]},F.id))]})]}),d.jsx("button",{className:"np-btn np-btn-primary np-btn-lg",onClick:ne,disabled:M,style:{alignSelf:"center",minWidth:200},children:M?"Loading...":"Start Flashcards"})]});const ie=u[p];return d.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:24,maxWidth:600,margin:"0 auto"},children:[d.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[d.jsxs("span",{style:{fontFamily:"var(--font-heading)",fontWeight:700},children:["Card ",p+1," of ",u.length]}),d.jsx("button",{className:"np-btn np-btn-outline np-btn-sm",onClick:()=>ee(!1),children:"Exit"})]}),d.jsx("div",{className:"np-card-surface",style:{padding:"48px 32px",textAlign:"center",cursor:"pointer",minHeight:220,display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center"},onClick:()=>b(!_),children:_?d.jsxs(d.Fragment,{children:[d.jsxs("p",{style:{fontSize:"0.85rem",color:"var(--muted)",marginBottom:12},children:["Answer: ",d.jsx("strong",{style:{color:"#00D9A3"},children:ie.correctOption})]}),d.jsx("p",{style:{fontSize:"1rem",fontWeight:500,color:"#00D9A3"},children:ie.options?.find(F=>F.label===ie.correctOption)?.text}),ie.explanation&&d.jsxs("p",{style:{fontSize:"0.8rem",color:"var(--muted)",marginTop:12,fontStyle:"italic"},children:[" ",ie.explanation]})]}):d.jsxs(d.Fragment,{children:[d.jsx("p",{style:{fontSize:"1.1rem",fontWeight:500,lineHeight:1.6,marginBottom:16},children:ie.text}),d.jsx("span",{style:{fontSize:"0.75rem",color:"var(--muted)"},children:"Tap to reveal answer"})]})}),_&&d.jsxs("div",{style:{display:"flex",gap:12,justifyContent:"center"},children:[d.jsx("button",{className:"np-btn np-btn-danger np-btn-lg",style:{flex:1},onClick:()=>Y(!1),children:"Didn't Know"}),d.jsx("button",{className:"np-btn np-btn-secondary np-btn-lg",style:{flex:1},onClick:()=>Y(!0),children:" Knew It"})]})]})}function HV(){const s=an(),{user:e,userProfile:t,setUserProfile:i,logout:a}=vn(),{accentColor:l,setAccentColor:u,fontSize:f,setFontSize:p,addToast:y}=Gl(),[_,b]=N.useState(""),[x,k]=N.useState(""),[M,j]=N.useState(50),[V,ee]=N.useState(!1),[ne,Y]=N.useState(!1);N.useEffect(()=>{t&&(b(t.examName||""),k(t.examDate||""),j(t.dailyGoal||50))},[t]);const ie=async()=>{if(e?.uid){ee(!0);try{const J={examName:_,examDate:x,dailyGoal:M};await qA(e.uid,J),i({...t,...J}),y({type:"success",message:"Settings saved!"})}catch(J){console.error("Failed to save profile:",J),y({type:"error",message:"Failed to save settings"})}finally{ee(!1)}}},F=async()=>{Y(!0);try{await G6(),a(),s("/login")}catch(J){console.error("Failed to sign out:",J),Y(!1)}};return d.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:24,maxWidth:720},children:[d.jsxs("div",{children:[d.jsx("h2",{className:"np-section-title",children:"Settings"}),d.jsx("p",{className:"np-section-subtitle",children:"Customize your experience"})]}),d.jsxs("div",{className:"np-settings-section",children:[d.jsxs("div",{className:"np-settings-title",children:[d.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"var(--primary)",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[d.jsx("path",{d:"M20 21v-2a4 4 0 00-4-4H8a4 4 0 00-4 4v2"}),d.jsx("circle",{cx:"12",cy:"7",r:"4"})]}),"Account"]}),d.jsxs("div",{style:{display:"flex",alignItems:"center",gap:16,padding:"8px 0"},children:[d.jsx("div",{style:{width:48,height:48,borderRadius:14,background:"linear-gradient(135deg, #6C63FF, #8B5CF6)",display:"flex",alignItems:"center",justifyContent:"center",fontWeight:700,fontSize:"1.1rem",color:"white",flexShrink:0},children:(t?.displayName||e?.email||"?")[0].toUpperCase()}),d.jsxs("div",{children:[d.jsx("div",{style:{fontWeight:600,fontSize:"0.95rem"},children:t?.displayName||"User"}),d.jsx("div",{style:{fontSize:"0.8rem",color:"var(--muted)"},children:e?.email})]})]})]}),d.jsxs("div",{className:"np-settings-section",children:[d.jsxs("div",{className:"np-settings-title",children:[d.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"var(--primary)",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[d.jsx("rect",{x:"3",y:"4",width:"18",height:"18",rx:"2",ry:"2"}),d.jsx("line",{x1:"16",y1:"2",x2:"16",y2:"6"}),d.jsx("line",{x1:"8",y1:"2",x2:"8",y2:"6"}),d.jsx("line",{x1:"3",y1:"10",x2:"21",y2:"10"})]}),"Exam Information"]}),d.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:16},children:[d.jsxs("div",{children:[d.jsx("label",{children:"Exam Name"}),d.jsx("input",{type:"text",placeholder:"e.g. JEE Main 2026",value:_,onChange:J=>b(J.target.value)})]}),d.jsxs("div",{children:[d.jsx("label",{children:"Exam Date"}),d.jsx("input",{type:"date",value:x,onChange:J=>k(J.target.value)})]}),d.jsxs("div",{children:[d.jsx("label",{children:"Daily Question Goal"}),d.jsx("input",{type:"number",placeholder:"50",min:"1",max:"500",value:M,onChange:J=>j(Number(J.target.value))})]}),d.jsx("button",{className:"np-btn np-btn-primary np-btn-md",onClick:ie,disabled:V,style:{alignSelf:"flex-start"},children:V?"Saving...":"Save Changes"})]})]}),d.jsxs("div",{className:"np-settings-section",children:[d.jsxs("div",{className:"np-settings-title",children:[d.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"var(--secondary)",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[d.jsx("circle",{cx:"12",cy:"12",r:"5"}),d.jsx("line",{x1:"12",y1:"1",x2:"12",y2:"3"}),d.jsx("line",{x1:"12",y1:"21",x2:"12",y2:"23"}),d.jsx("line",{x1:"4.22",y1:"4.22",x2:"5.64",y2:"5.64"}),d.jsx("line",{x1:"18.36",y1:"18.36",x2:"19.78",y2:"19.78"}),d.jsx("line",{x1:"1",y1:"12",x2:"3",y2:"12"}),d.jsx("line",{x1:"21",y1:"12",x2:"23",y2:"12"}),d.jsx("line",{x1:"4.22",y1:"19.78",x2:"5.64",y2:"18.36"}),d.jsx("line",{x1:"18.36",y1:"5.64",x2:"19.78",y2:"4.22"})]}),"Appearance"]}),d.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:20},children:[d.jsxs("div",{children:[d.jsx("label",{children:"Accent Color"}),d.jsx("div",{style:{display:"flex",gap:12,marginTop:4},children:[{name:"Violet",value:"#6C63FF"},{name:"Cyan",value:"#00D4FF"},{name:"Pink",value:"#FF006E"},{name:"Orange",value:"#FF6B35"},{name:"Lime",value:"#7CFC00"},{name:"Gold",value:"#FFD700"}].map(J=>d.jsx("button",{className:`np-color-swatch ${J.value===l?"active":""}`,style:{background:J.value},title:J.name,onClick:()=>u(J.value)},J.value))})]}),d.jsxs("div",{children:[d.jsx("label",{children:"Font Size"}),d.jsx("div",{style:{display:"flex",gap:8,marginTop:4},children:[{label:"Small",value:"small"},{label:"Medium",value:"medium"},{label:"Large",value:"large"}].map(J=>d.jsx("button",{className:`np-btn np-btn-sm ${J.value===f?"np-btn-primary":"np-btn-outline"}`,onClick:()=>p(J.value),children:J.label},J.value))})]})]})]}),d.jsxs("div",{className:"np-settings-section",children:[d.jsxs("div",{className:"np-settings-title",children:[d.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"var(--warning)",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[d.jsx("ellipse",{cx:"12",cy:"5",rx:"9",ry:"3"}),d.jsx("path",{d:"M21 12c0 1.66-4 3-9 3s-9-1.34-9-3"}),d.jsx("path",{d:"M3 5v14c0 1.66 4 3 9 3s9-1.34 9-3V5"})]}),"Data Management"]}),d.jsxs("div",{style:{display:"flex",flexWrap:"wrap",gap:10},children:[d.jsx("button",{className:"np-btn np-btn-outline np-btn-sm",children:" Export Questions"}),d.jsx("button",{className:"np-btn np-btn-outline np-btn-sm",children:" Export Sessions"}),d.jsx("button",{className:"np-btn np-btn-outline np-btn-sm",children:" Import CSV"}),d.jsx("button",{className:"np-btn np-btn-danger np-btn-sm",children:" Clear Performance Data"})]})]}),d.jsxs("div",{className:"np-settings-section",style:{borderColor:"rgba(255,107,107,0.15)"},children:[d.jsxs("div",{className:"np-settings-title",children:[d.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"var(--error)",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[d.jsx("path",{d:"M9 21H5a2 2 0 01-2-2V5a2 2 0 012-2h4"}),d.jsx("polyline",{points:"16 17 21 12 16 7"}),d.jsx("line",{x1:"21",y1:"12",x2:"9",y2:"12"})]}),"Account Actions"]}),d.jsx("button",{className:"np-btn np-btn-danger np-btn-md",onClick:F,disabled:ne,children:ne?"Signing out...":"Sign Out"})]}),d.jsx("p",{style:{textAlign:"center",fontSize:"0.75rem",color:"var(--muted)",paddingBottom:8},children:"NeuralPrep v1.0.0"})]})}const GV=[{key:"smart",title:"Smart Session",icon:"",color:"#8B5CF6",desc:"70% important, 30% normal"},{key:"wrong",title:"Wrong Questions",icon:"",color:"#FF6B6B",desc:"Focus on past mistakes"},{key:"due_today",title:"Due Today",icon:"",color:"#00D9A3",desc:"Spaced repetition queue"},{key:"unseen",title:"Unseen First",icon:"",color:"#FFB347",desc:"New questions first"},{key:"flagged",title:"Flagged Only",icon:"",color:"#FF006E",desc:"Bookmarked questions"},{key:"random",title:"Quick Mix",icon:"",color:"#6C63FF",desc:"Pure random selection"}],QV=[10,25,50,100];function KV(){const s=an(),[e]=u1(),{user:t}=vn(),i=Xs(),{subjects:a}=i,l=uh(z=>z.initSession),[u,f]=N.useState(e.get("mode")||"smart"),[p,y]=N.useState(e.get("subject")?[e.get("subject")]:["all"]),[_,b]=N.useState(["all"]),[x,k]=N.useState(25),[M,j]=N.useState(""),[V,ee]=N.useState("none"),[ne,Y]=N.useState(60),[ie,F]=N.useState(!0),[J,C]=N.useState(!0),[R,w]=N.useState(!1),[I,D]=N.useState([]),[L,O]=N.useState({}),[Se,pe]=N.useState(!0),[G,le]=N.useState(!1);N.useEffect(()=>{t?.uid&&(async()=>{pe(!0);try{a.length===0&&await i.fetchSubjects(t.uid);const z=await KA(t.uid);O(z)}catch(z){console.error("Failed to load config data:",z)}finally{pe(!1)}})()},[t?.uid]),N.useEffect(()=>{!t?.uid||a.length===0||(async()=>{const z={subjectIds:p,chapterIds:_},ue=await ch(t.uid,z,i);D(ue)})()},[t?.uid,p,_,a,i.chapters,i.questions]);const ye=N.useMemo(()=>{if(p[0]==="all")return[];const z=p[0];return i.chapters[z]||[]},[p,i.chapters]);N.useEffect(()=>{if(p[0]!=="all"&&t?.uid){const z=p[0];i.chapters[z]||i.fetchChapters(t.uid,z)}},[p,t?.uid]);const Te=I.length,Ve=M?parseInt(M,10):x,U=async()=>{if(!(!t?.uid||Te===0)){le(!0);try{let z=[];const ue=Math.min(Ve,Te);switch(u){case"smart":z=IV(I,L,ue);break;case"wrong":z=WA(I,L).slice(0,ue);break;case"due_today":z=YA(I,L).slice(0,ue);break;case"unseen":z=CV(I,L).slice(0,ue);break;case"flagged":z=XA(I,L).slice(0,ue);break;default:z=RV(I,ue);break}if(z.length===0){le(!1);return}ie&&(z=Fs(z));const re={};J&&z.forEach(Qe=>{const{optionOrder:$e}=NV(Qe.options);re[Qe.id]=$e});const ge={subjectIds:p,chapterIds:_,subjectNames:p[0]==="all"?["All Subjects"]:a.filter(Qe=>p.includes(Qe.id)).map(Qe=>Qe.name)},Ie={totalQuestions:z.length,timerType:V,timerValue:ne,shuffled:ie,optionsShuffled:J,showExplanation:R},Ne=await Zv(t.uid,{type:u,scope:ge,config:Ie,questionIds:z.map(Qe=>Qe.id),totalQuestions:z.length});l({sessionId:Ne,type:u,scope:ge,config:Ie,questions:z,questionOrder:re}),s("/test/session")}catch(z){console.error("Failed to start session:",z),le(!1)}}};return Se?d.jsx("div",{style:{display:"flex",flexDirection:"column",gap:24,maxWidth:800,margin:"0 auto"},children:d.jsxs("div",{className:"np-card-surface",style:{padding:60,textAlign:"center"},children:[d.jsx("div",{className:"np-auth-spinner",style:{width:32,height:32,borderWidth:3,margin:"0 auto"}}),d.jsx("p",{style:{color:"var(--muted)",marginTop:16},children:"Loading..."})]})}):d.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:24,maxWidth:800,margin:"0 auto"},children:[d.jsxs("div",{children:[d.jsx("h2",{className:"np-section-title",children:"Configure Practice Session"}),d.jsx("p",{className:"np-section-subtitle",children:"Set up your test parameters"})]}),d.jsxs("div",{className:"np-config-section",children:[d.jsx("h3",{className:"np-config-title",children:" Scope"}),d.jsxs("div",{style:{display:"flex",flexWrap:"wrap",gap:8},children:[d.jsx("button",{className:`np-pill ${p[0]==="all"?"np-pill-active":""}`,onClick:()=>{y(["all"]),b(["all"])},children:"All Subjects"}),a.map(z=>d.jsxs("button",{className:`np-pill ${p.includes(z.id)?"np-pill-active":""}`,style:p.includes(z.id)?{borderColor:z.color,background:`${z.color}18`,color:z.color}:{},onClick:()=>{y([z.id]),b(["all"])},children:[z.icon," ",z.name]},z.id))]}),p[0]!=="all"&&ye.length>0&&d.jsxs("div",{style:{marginTop:12},children:[d.jsx("label",{style:{fontSize:"0.78rem",color:"var(--muted)",marginBottom:8,display:"block"},children:"Chapters"}),d.jsxs("div",{style:{display:"flex",flexWrap:"wrap",gap:6},children:[d.jsx("button",{className:`np-pill np-pill-sm ${_[0]==="all"?"np-pill-active":""}`,onClick:()=>b(["all"]),children:"All"}),ye.map(z=>d.jsx("button",{className:`np-pill np-pill-sm ${_.includes(z.id)?"np-pill-active":""}`,onClick:()=>{b(ue=>{if(ue[0]==="all")return[z.id];if(ue.includes(z.id)){const re=ue.filter(ge=>ge!==z.id);return re.length===0?["all"]:re}return[...ue,z.id]})},children:z.name},z.id))]})]}),d.jsxs("div",{className:"np-config-count",children:[Te," question",Te!==1?"s":""," available"]})]}),d.jsxs("div",{className:"np-config-section",children:[d.jsx("h3",{className:"np-config-title",children:" Practice Mode"}),d.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(220px, 1fr))",gap:10},children:GV.map(z=>d.jsxs("div",{className:`np-mode-select-card ${u===z.key?"np-mode-select-active":""}`,style:u===z.key?{borderColor:z.color,background:`${z.color}10`}:{},onClick:()=>f(z.key),children:[d.jsx("span",{style:{fontSize:"1.4rem"},children:z.icon}),d.jsxs("div",{children:[d.jsx("div",{style:{fontWeight:600,fontSize:"0.88rem"},children:z.title}),d.jsx("div",{style:{fontSize:"0.72rem",color:"var(--muted)"},children:z.desc})]})]},z.key))})]}),d.jsxs("div",{className:"np-config-section",children:[d.jsx("h3",{className:"np-config-title",children:" Question Count"}),d.jsxs("div",{style:{display:"flex",gap:8,flexWrap:"wrap",alignItems:"center"},children:[QV.map(z=>d.jsx("button",{className:`np-pill ${x===z&&!M?"np-pill-active":""}`,onClick:()=>{k(z),j("")},disabled:z>Te,children:z},z)),d.jsx("input",{type:"number",min:"1",max:Te,placeholder:"Custom",value:M,onChange:z=>j(z.target.value),style:{width:90,fontSize:"0.85rem"}}),d.jsxs("span",{style:{fontSize:"0.75rem",color:"var(--muted)"},children:["/ ",Te," available"]})]})]}),d.jsxs("div",{className:"np-config-section",children:[d.jsx("h3",{className:"np-config-title",children:" Timer"}),d.jsx("div",{style:{display:"flex",gap:8,marginBottom:12},children:[{key:"none",label:"Off"},{key:"per_question",label:"Per Question"},{key:"full_session",label:"Full Session"}].map(z=>d.jsx("button",{className:`np-pill ${V===z.key?"np-pill-active":""}`,onClick:()=>ee(z.key),children:z.label},z.key))}),V==="per_question"&&d.jsxs("div",{style:{display:"flex",alignItems:"center",gap:12},children:[d.jsx("input",{type:"range",min:30,max:180,step:15,value:ne,onChange:z=>Y(Number(z.target.value)),style:{flex:1}}),d.jsxs("span",{style:{fontSize:"0.85rem",fontWeight:600,minWidth:60},children:[ne,"s/Q"]})]}),V==="full_session"&&d.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8},children:[d.jsx("input",{type:"number",min:1,max:180,value:ne,onChange:z=>Y(Number(z.target.value)),style:{width:80}}),d.jsx("span",{style:{fontSize:"0.85rem",color:"var(--muted)"},children:"minutes"})]})]}),d.jsxs("div",{className:"np-config-section",children:[d.jsx("h3",{className:"np-config-title",children:" Options"}),d.jsx("div",{style:{display:"flex",flexDirection:"column",gap:12},children:[{label:"Shuffle Questions",value:ie,set:F},{label:"Shuffle Options",value:J,set:C},{label:"Show Explanation After Wrong",value:R,set:w}].map(z=>d.jsxs("label",{className:"np-toggle-row",children:[d.jsx("span",{children:z.label}),d.jsx("div",{className:`np-toggle ${z.value?"np-toggle-on":""}`,onClick:()=>z.set(!z.value),children:d.jsx("div",{className:"np-toggle-thumb"})})]},z.label))})]}),d.jsxs("div",{style:{display:"flex",gap:12,justifyContent:"flex-end",paddingBottom:32},children:[d.jsx("button",{className:"np-btn np-btn-outline np-btn-md",onClick:()=>s("/practice"),children:"Cancel"}),d.jsx("button",{className:"np-btn np-btn-primary np-btn-lg",onClick:U,disabled:G||Te===0||Ve<1,style:{minWidth:200},children:G?"Starting...":`Start Test  ${Math.min(Ve,Te)} Q`})]})]})}function $V(){const s=an(),{user:e}=vn(),t=uh(),i=N.useRef(null),[a,l]=N.useState(!1),[u,f]=N.useState(!1),[p,y]=N.useState(!1),[_,b]=N.useState(null),[x,k]=N.useState(new Set),[M,j]=N.useState(new Set),[V,ee]=N.useState(!1),[ne,Y]=N.useState(0),ie=t.questions[t.currentIndex],F=t.currentIndex>=t.questions.length-1;if(N.useEffect(()=>{(!t.sessionId||t.questions.length===0)&&s("/test")},[t.sessionId]),N.useEffect(()=>{if(ie){j(ge=>new Set(ge).add(ie.id));const re=t.answers[ie.id];b(re?.userAnswer||null)}},[t.currentIndex,ie?.id]),N.useEffect(()=>{if(!(t.paused||t.status!=="in_progress"))return i.current=setInterval(()=>{t.config?.timerType!=="none"&&t.tickTimer(),Y(re=>re+1)},1e3),()=>clearInterval(i.current)},[t.paused,t.status]),!ie)return null;const C=(t.questionOrder[ie.id]||["A","B","C","D"]).map(re=>ie.options.find(ge=>ge.label===re)).filter(Boolean),R=re=>{const ge=Math.floor(re/3600),Ie=Math.floor(re%3600/60),Ne=re%60;return ge>0?`${ge}:${String(Ie).padStart(2,"0")}:${String(Ne).padStart(2,"0")}`:`${String(Ie).padStart(2,"0")}:${String(Ne).padStart(2,"0")}`},w=re=>{const ge=t.questions[re],Ne=t.answers[ge.id]?.userAnswer!=null,Qe=x.has(ge.id),$e=M.has(ge.id);return re===t.currentIndex?"current":Qe&&Ne?"marked-answered":Qe?"marked":Ne?"answered":$e?"not-answered":"not-visited"},I=t.questions.filter(re=>t.answers[re.id]?.userAnswer!=null).length,D=x.size,L=t.questions.filter(re=>M.has(re.id)&&(!t.answers[re.id]||t.answers[re.id].userAnswer==null)).length,O=t.answers[ie.id]?.flagged||!1,Se=re=>{b(re),V&&(t.answerQuestion(ie.id,re,ie.correctOption),F||setTimeout(()=>t.nextQuestion(),150))},pe=()=>{_&&ie&&t.answerQuestion(ie.id,_,ie.correctOption),F||t.nextQuestion()},G=()=>{k(re=>new Set(re).add(ie.id)),_&&ie&&t.answerQuestion(ie.id,_,ie.correctOption),F||t.nextQuestion()},le=()=>{b(null)},ye=re=>{_&&ie&&!t.answers[ie.id]?.userAnswer&&t.answerQuestion(ie.id,_,ie.correctOption),t.goToQuestion(re)},Te=()=>{t.flagQuestion(ie.id)},Ve=async()=>{l(!0),_&&ie&&!t.answers[ie.id]?.userAnswer&&t.answerQuestion(ie.id,_,ie.correctOption),t.questions.forEach(re=>{(!t.answers[re.id]||t.answers[re.id].userAnswer==null)&&t.skipQuestion(re.id)});try{const re=await t.endSession();e?.uid&&re&&await $A(e.uid,re.questionResults),s(`/test/results?session=${re.sessionId}`)}catch(re){console.error("Failed to end session:",re),l(!1)}},U=async()=>{t.sessionId&&await QA(t.sessionId),t.resetSession(),s("/practice")},z=t.config?.timerType!=="none"?R(t.timeRemaining):R(ne),ue=t.config?.timerType==="per_question"?"Per Question":t.config?.timerType==="full_session"?"Time Left":"Elapsed";return d.jsxs("div",{className:"np-exam-layout",children:[d.jsxs("div",{className:"np-exam-main",children:[d.jsxs("div",{className:"np-exam-topbar",children:[d.jsxs("div",{className:"np-exam-topbar-left",children:[d.jsxs("span",{className:"np-exam-qnum",children:["Q",t.currentIndex+1]}),d.jsxs("span",{className:"np-exam-qcount",children:["of ",t.totalQuestions]}),ie.important&&d.jsx("span",{className:"np-exam-important-badge",children:" Important"}),d.jsxs("span",{className:"np-exam-mobile-timer",children:[" ",z]})]}),d.jsxs("div",{className:"np-exam-topbar-right",children:[d.jsxs("label",{className:"np-exam-autonext",children:[d.jsx("input",{type:"checkbox",checked:V,onChange:re=>ee(re.target.checked)}),d.jsx("span",{children:"Auto Next"})]}),d.jsx("button",{className:`np-exam-action-btn ${O?"np-exam-action-btn-active":""}`,onClick:Te,title:"Flag this question",children:d.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:O?"currentColor":"none",stroke:"currentColor",strokeWidth:"2",children:[d.jsx("path",{d:"M4 15s1-1 4-1 5 2 8 2 4-1 4-1V3s-1 1-4 1-5-2-8-2-4 1-4 1z"}),d.jsx("line",{x1:"4",y1:"22",x2:"4",y2:"15"})]})}),d.jsx("button",{className:"np-exam-action-btn",onClick:()=>{t.pauseSession(),f(!0)},title:"Pause",children:d.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",children:[d.jsx("rect",{x:"6",y:"4",width:"4",height:"16",rx:"1"}),d.jsx("rect",{x:"14",y:"4",width:"4",height:"16",rx:"1"})]})})]})]}),d.jsxs("div",{className:"np-exam-body",children:[d.jsxs("div",{className:"np-exam-breadcrumb",children:[ie.subjectName,ie.chapterName?`  ${ie.chapterName}`:""]}),d.jsx("div",{className:"np-exam-question-text",children:ie.text}),d.jsx("div",{className:"np-exam-options",children:C.map(re=>{const ge=_===re.label;return d.jsxs("div",{className:`np-exam-option ${ge?"np-exam-option-selected":""}`,onClick:()=>Se(re.label),children:[d.jsx("div",{className:`np-exam-option-letter ${ge?"np-exam-option-letter-active":""}`,children:re.label}),d.jsx("div",{className:"np-exam-option-text",children:re.text})]},re.label)})})]}),d.jsxs("div",{className:"np-exam-bottom",children:[d.jsxs("div",{className:"np-exam-bottom-left",children:[d.jsx("button",{className:"np-exam-btn np-exam-btn-mark",onClick:G,children:" Mark for Review & Next"}),d.jsx("button",{className:"np-exam-btn np-exam-btn-clear",onClick:le,children:"Clear Response"})]}),d.jsx("button",{className:"np-exam-btn np-exam-btn-save",onClick:pe,children:F?"Save":"Save & Next "}),d.jsx("button",{className:"np-exam-mobile-submit",onClick:()=>y(!0),children:"Submit"})]})]}),d.jsxs("div",{className:"np-exam-sidebar",children:[d.jsxs("div",{className:"np-exam-timer",children:[d.jsx("div",{className:"np-exam-timer-label",children:ue}),d.jsx("div",{className:"np-exam-timer-value",children:z})]}),d.jsx("div",{className:"np-exam-palette-header",children:d.jsx("div",{className:"np-exam-palette-title",children:"Question Palette"})}),d.jsxs("div",{className:"np-exam-legend",children:[d.jsxs("div",{className:"np-exam-legend-row",children:[d.jsx("span",{className:"np-exam-legend-dot np-dot-answered"}),d.jsxs("span",{children:["Answered (",I,")"]})]}),d.jsxs("div",{className:"np-exam-legend-row",children:[d.jsx("span",{className:"np-exam-legend-dot np-dot-not-answered"}),d.jsxs("span",{children:["Not Answered (",L,")"]})]}),d.jsxs("div",{className:"np-exam-legend-row",children:[d.jsx("span",{className:"np-exam-legend-dot np-dot-marked"}),d.jsxs("span",{children:["Marked (",D,")"]})]}),d.jsxs("div",{className:"np-exam-legend-row",children:[d.jsx("span",{className:"np-exam-legend-dot np-dot-not-visited"}),d.jsx("span",{children:"Not Visited"})]})]}),d.jsx("div",{className:"np-exam-palette-grid",children:t.questions.map((re,ge)=>{const Ie=w(ge);return d.jsx("button",{className:`np-exam-palette-btn np-pq-${Ie}`,onClick:()=>ye(ge),children:ge+1},re.id)})}),d.jsx("div",{className:"np-exam-sidebar-footer",children:d.jsx("button",{className:"np-exam-submit",onClick:()=>y(!0),children:"Submit Test"})})]}),u&&d.jsx("div",{className:"np-exam-overlay",children:d.jsxs("div",{className:"np-exam-modal",children:[d.jsx("div",{className:"np-exam-modal-icon",children:""}),d.jsx("h3",{className:"np-exam-modal-title",children:"Session Paused"}),d.jsxs("div",{className:"np-exam-modal-stats",children:[d.jsxs("div",{className:"np-exam-modal-stat",children:[d.jsx("span",{className:"np-exam-modal-stat-num",style:{color:"#10B981"},children:I}),d.jsx("span",{className:"np-exam-modal-stat-label",children:"Answered"})]}),d.jsxs("div",{className:"np-exam-modal-stat",children:[d.jsx("span",{className:"np-exam-modal-stat-num",style:{color:"#8B5CF6"},children:D}),d.jsx("span",{className:"np-exam-modal-stat-label",children:"Marked"})]}),d.jsxs("div",{className:"np-exam-modal-stat",children:[d.jsx("span",{className:"np-exam-modal-stat-num",style:{color:"#94A3B8"},children:t.totalQuestions-I}),d.jsx("span",{className:"np-exam-modal-stat-label",children:"Remaining"})]})]}),d.jsxs("div",{className:"np-exam-modal-actions",children:[d.jsx("button",{className:"np-exam-btn np-exam-btn-save",style:{flex:1},onClick:()=>{t.resumeSession(),f(!1)},children:" Resume"}),d.jsx("button",{className:"np-exam-btn np-exam-btn-clear",onClick:U,children:"Quit"})]})]})}),p&&d.jsx("div",{className:"np-exam-overlay",children:d.jsxs("div",{className:"np-exam-modal",children:[d.jsx("div",{className:"np-exam-modal-icon",children:""}),d.jsx("h3",{className:"np-exam-modal-title",children:"Submit Test?"}),d.jsxs("div",{className:"np-exam-modal-summary",children:[d.jsxs("div",{className:"np-exam-modal-summary-row",children:[d.jsx("span",{children:"Answered"}),d.jsx("strong",{style:{color:"#10B981"},children:I})]}),d.jsxs("div",{className:"np-exam-modal-summary-row",children:[d.jsx("span",{children:"Unanswered"}),d.jsx("strong",{style:{color:"#EF4444"},children:t.totalQuestions-I})]}),d.jsxs("div",{className:"np-exam-modal-summary-row",children:[d.jsx("span",{children:"Marked for Review"}),d.jsx("strong",{style:{color:"#8B5CF6"},children:D})]}),d.jsxs("div",{className:"np-exam-modal-summary-row np-exam-modal-summary-row-total",children:[d.jsx("span",{children:"Total"}),d.jsx("strong",{children:t.totalQuestions})]})]}),t.totalQuestions-I>0&&d.jsxs("p",{className:"np-exam-modal-warning",children:[" You have ",t.totalQuestions-I," unanswered question",t.totalQuestions-I>1?"s":"","."]}),d.jsxs("div",{className:"np-exam-modal-actions",children:[d.jsx("button",{className:"np-exam-btn np-exam-btn-clear",style:{flex:1},onClick:()=>y(!1),children:"Go Back"}),d.jsx("button",{className:"np-exam-btn np-exam-btn-save",style:{flex:1},onClick:Ve,disabled:a,children:a?"Submitting...":"Confirm Submit"})]})]})})]})}function WV(){const s=an(),[e]=u1(),t=e.get("session"),i=uh(j=>j.resetSession),[a,l]=N.useState(null),[u,f]=N.useState(!0),[p,y]=N.useState(null);if(N.useEffect(()=>{if(!t){s("/practice");return}(async()=>{const j=await bV(t);l(j),f(!1)})(),i()},[t]),u)return d.jsx("div",{style:{display:"flex",flexDirection:"column",gap:24,maxWidth:760,margin:"0 auto"},children:d.jsxs("div",{className:"np-card-surface",style:{padding:60,textAlign:"center"},children:[d.jsx("div",{className:"np-auth-spinner",style:{width:32,height:32,borderWidth:3,margin:"0 auto"}}),d.jsx("p",{style:{color:"var(--muted)",marginTop:16},children:"Loading results..."})]})});if(!a)return d.jsx("div",{style:{display:"flex",flexDirection:"column",gap:24,maxWidth:760,margin:"0 auto"},children:d.jsx("div",{className:"np-card-surface",children:d.jsxs("div",{className:"np-empty",children:[d.jsx("div",{className:"np-empty-icon",children:""}),d.jsx("div",{className:"np-empty-title",children:"Session not found"}),d.jsx("button",{className:"np-btn np-btn-primary np-btn-md",onClick:()=>s("/practice"),children:"Back to Practice"})]})})});const _=a.score>=70?"#00D9A3":a.score>=40?"#FFB347":"#FF6B6B",b=a.questionResults||[],x=b.reduce((j,V)=>j+(V.timeSpent||0),0),k=b.length>0?Math.round(x/b.length):0;a.answered>0&&Math.round(a.correct/a.answered*100);const M=[{label:"Correct",value:a.correct,color:"#00D9A3",bg:"rgba(0,217,163,0.08)",border:"rgba(0,217,163,0.15)"},{label:"Wrong",value:a.wrong,color:"#FF6B6B",bg:"rgba(255,107,107,0.08)",border:"rgba(255,107,107,0.15)"},{label:"Skipped",value:a.skipped,color:"#FFB347",bg:"rgba(255,179,71,0.08)",border:"rgba(255,179,71,0.15)"},{label:"Avg Time",value:`${k}s`,color:"#6C63FF",bg:"rgba(108,99,255,0.08)",border:"rgba(108,99,255,0.15)"}];return d.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:24,maxWidth:760,margin:"0 auto",paddingBottom:32},children:[d.jsxs("div",{className:"np-card-surface",style:{overflow:"hidden"},children:[d.jsxs("div",{style:{background:`linear-gradient(135deg, ${_}10, ${_}05)`,borderBottom:`1px solid ${_}20`,padding:"36px 24px",textAlign:"center"},children:[d.jsx(h1,{progress:a.score,size:140,strokeWidth:10,children:d.jsxs("div",{style:{textAlign:"center"},children:[d.jsxs("p",{style:{fontFamily:"var(--font-heading)",fontWeight:800,fontSize:"2.2rem",color:_},children:[a.score,"%"]}),d.jsx("p",{style:{fontSize:"0.75rem",color:"var(--muted)"},children:"Score"})]})}),d.jsxs("p",{style:{marginTop:16,fontSize:"0.85rem",color:"var(--text-secondary)"},children:[a.scope?.subjectNames?.join(", ")||"All Subjects","  ",a.totalQuestions," Questions  ",YV(x)]})]}),d.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(4, 1fr)",gap:0},children:M.map(j=>d.jsxs("div",{style:{textAlign:"center",padding:"20px 8px",borderRight:"1px solid var(--border)"},children:[d.jsx("div",{style:{fontSize:"1.4rem",fontWeight:800,color:j.color,fontFamily:"var(--font-heading)"},children:j.value}),d.jsx("div",{style:{fontSize:"0.72rem",color:"var(--muted)",marginTop:4},children:j.label})]},j.label))})]}),d.jsxs("div",{children:[d.jsxs("h3",{style:{fontFamily:"var(--font-heading)",fontWeight:700,fontSize:"1.05rem",marginBottom:16},children:[" Question Review (",b.length,")"]}),d.jsx("div",{style:{display:"flex",flexDirection:"column",gap:8},children:b.map((j,V)=>{const ee=p===V;return d.jsxs("div",{className:"np-result-item",onClick:()=>y(ee?null:V),style:{padding:ee?"16px 20px":"14px 16px"},children:[d.jsxs("div",{style:{display:"flex",alignItems:"center",gap:12},children:[d.jsx("span",{style:{width:30,height:30,borderRadius:"50%",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"0.75rem",fontWeight:700,flexShrink:0,background:j.isCorrect?"rgba(0,217,163,0.15)":j.userAnswer===null?"rgba(255,179,71,0.15)":"rgba(255,107,107,0.15)",color:j.isCorrect?"#00D9A3":j.userAnswer===null?"#FFB347":"#FF6B6B"},children:V+1}),d.jsx("div",{style:{flex:1,minWidth:0},children:d.jsx("p",{style:{fontSize:"0.85rem",lineHeight:1.4,overflow:ee?"visible":"hidden",textOverflow:ee?"unset":"ellipsis",whiteSpace:ee?"normal":"nowrap"},children:j.questionText})}),d.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8,flexShrink:0},children:[d.jsx("span",{style:{padding:"2px 8px",borderRadius:6,fontSize:"0.7rem",fontWeight:600,background:j.isCorrect?"rgba(0,217,163,0.1)":j.userAnswer===null?"rgba(255,179,71,0.1)":"rgba(255,107,107,0.1)",color:j.isCorrect?"#00D9A3":j.userAnswer===null?"#FFB347":"#FF6B6B"},children:j.isCorrect?"Correct":j.userAnswer===null?"Skipped":"Wrong"}),d.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"var(--muted)",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",style:{transition:"transform 0.2s",transform:ee?"rotate(180deg)":"none"},children:d.jsx("polyline",{points:"6 9 12 15 18 9"})})]})]}),ee&&d.jsxs("div",{style:{marginTop:16,paddingTop:16,borderTop:"1px solid var(--border)"},children:[d.jsxs("div",{style:{display:"flex",gap:24,fontSize:"0.82rem",marginBottom:12},children:[d.jsxs("div",{children:[d.jsx("span",{style:{color:"var(--muted)"},children:"Your answer: "}),d.jsx("strong",{style:{color:j.isCorrect?"#00D9A3":j.userAnswer===null?"#FFB347":"#FF6B6B"},children:j.userAnswer||"Skipped"})]}),!j.isCorrect&&j.userAnswer!==null&&d.jsxs("div",{children:[d.jsx("span",{style:{color:"var(--muted)"},children:"Correct: "}),d.jsx("strong",{style:{color:"#00D9A3"},children:j.correctAnswer})]}),d.jsxs("div",{children:[d.jsx("span",{style:{color:"var(--muted)"},children:"Time: "}),d.jsxs("strong",{children:[j.timeSpent,"s"]})]})]}),j.confidence&&d.jsxs("div",{style:{fontSize:"0.78rem",color:"var(--muted)",marginBottom:4},children:["Confidence: ",j.confidence==="guessed"?" Guessed":j.confidence==="unsure"?" Unsure":" Sure"]})]})]},j.questionId||V)})})]}),d.jsxs("div",{style:{display:"flex",gap:12,justifyContent:"center",paddingTop:8},children:[d.jsx("button",{className:"np-btn np-btn-outline np-btn-md",onClick:()=>s("/practice"),children:" Back to Practice"}),d.jsx("button",{className:"np-btn np-btn-primary np-btn-md",onClick:()=>s(`/test?mode=${a.type}`),children:"Retry this Mode"})]})]})}function YV(s){const e=Math.floor(s/60),t=s%60;return`${e}m ${t}s`}function XV(){const s=an(),{setError:e,clearError:t,error:i}=vn(),[a,l]=N.useState(!1),[u,f]=N.useState(!1),[p,y]=N.useState(""),[_,b]=N.useState(""),[x,k]=N.useState(""),[M,j]=N.useState(""),[V,ee]=N.useState(!1),[ne,Y]=N.useState(!1),ie=C=>({"auth/email-already-in-use":"An account with this email already exists","auth/invalid-email":"Please enter a valid email address","auth/weak-password":"Password should be at least 6 characters","auth/user-not-found":"No account found with this email","auth/wrong-password":"Incorrect password","auth/invalid-credential":"Invalid email or password","auth/too-many-requests":"Too many attempts. Please try again later","auth/network-request-failed":"Network error. Check your connection"})[C]||"Something went wrong. Please try again.",F=async C=>{if(C.preventDefault(),t(),a&&_!==x){e("Passwords do not match");return}if(a&&!M.trim()){e("Please enter your name");return}ee(!0);try{if(a){const R=await q6(p,_,M.trim());await $6(R.uid,{displayName:M.trim(),email:R.email,onboardingComplete:!1,examName:"",examDate:"",dailyGoal:50}),s("/onboarding")}else{const R=await H6(p,_),w=await FA(R.uid);w&&w.onboardingComplete?s("/"):s("/onboarding")}}catch(R){e(ie(R.code))}finally{ee(!1)}},J=async C=>{if(C.preventDefault(),t(),!p.trim()){e("Please enter your email address");return}ee(!0);try{await K6(p),Y(!0)}catch(R){e(ie(R.code))}finally{ee(!1)}};return u?d.jsx("div",{className:"np-login-container",children:d.jsxs("div",{className:"np-login-card",children:[d.jsx("div",{className:"np-login-logo",children:d.jsx("svg",{width:"32",height:"32",viewBox:"0 0 24 24",fill:"none",stroke:"white",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:d.jsx("polygon",{points:"13 2 3 14 12 14 11 22 21 10 12 10 13 2"})})}),d.jsx("h1",{className:"np-login-title",children:"Reset Password"}),d.jsx("p",{className:"np-login-desc",children:"We'll send you a link to reset your password"}),i&&d.jsx("div",{className:"np-auth-error",children:i}),ne?d.jsxs("div",{className:"np-auth-success",children:[d.jsxs("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[d.jsx("path",{d:"M22 11.08V12a10 10 0 11-5.93-9.14"}),d.jsx("polyline",{points:"22 4 12 14.01 9 11.01"})]}),d.jsx("span",{children:"Reset link sent! Check your email inbox."})]}):d.jsxs("form",{onSubmit:J,className:"np-auth-form",children:[d.jsxs("div",{className:"np-auth-field",children:[d.jsx("label",{htmlFor:"reset-email",children:"Email Address"}),d.jsxs("div",{className:"np-auth-input-wrap",children:[d.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"var(--muted)",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[d.jsx("path",{d:"M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z"}),d.jsx("polyline",{points:"22,6 12,13 2,6"})]}),d.jsx("input",{id:"reset-email",type:"email",placeholder:"you@example.com",value:p,onChange:C=>y(C.target.value),required:!0})]})]}),d.jsxs("button",{type:"submit",className:"np-login-btn",disabled:V,children:[V?d.jsx("span",{className:"np-auth-spinner"}):null,"Send Reset Link"]})]}),d.jsx("button",{className:"np-auth-link",onClick:()=>{f(!1),t(),Y(!1)},children:" Back to Sign In"})]})}):d.jsx("div",{className:"np-login-container",children:d.jsxs("div",{className:"np-login-card",children:[d.jsx("div",{className:"np-login-logo",children:d.jsx("svg",{width:"32",height:"32",viewBox:"0 0 24 24",fill:"none",stroke:"white",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:d.jsx("polygon",{points:"13 2 3 14 12 14 11 22 21 10 12 10 13 2"})})}),d.jsx("h1",{className:"np-login-title",children:"NeuralPrep"}),d.jsx("p",{className:"np-login-desc",children:a?"Create your account to get started":"Your personal MCQ practice companion"}),i&&d.jsx("div",{className:"np-auth-error",children:i}),d.jsxs("form",{onSubmit:F,className:"np-auth-form",children:[a&&d.jsxs("div",{className:"np-auth-field",children:[d.jsx("label",{htmlFor:"display-name",children:"Full Name"}),d.jsxs("div",{className:"np-auth-input-wrap",children:[d.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"var(--muted)",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[d.jsx("path",{d:"M20 21v-2a4 4 0 00-4-4H8a4 4 0 00-4 4v2"}),d.jsx("circle",{cx:"12",cy:"7",r:"4"})]}),d.jsx("input",{id:"display-name",type:"text",placeholder:"John Doe",value:M,onChange:C=>j(C.target.value)})]})]}),d.jsxs("div",{className:"np-auth-field",children:[d.jsx("label",{htmlFor:"email",children:"Email Address"}),d.jsxs("div",{className:"np-auth-input-wrap",children:[d.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"var(--muted)",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[d.jsx("path",{d:"M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z"}),d.jsx("polyline",{points:"22,6 12,13 2,6"})]}),d.jsx("input",{id:"email",type:"email",placeholder:"you@example.com",value:p,onChange:C=>y(C.target.value),required:!0})]})]}),d.jsxs("div",{className:"np-auth-field",children:[d.jsx("label",{htmlFor:"password",children:"Password"}),d.jsxs("div",{className:"np-auth-input-wrap",children:[d.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"var(--muted)",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[d.jsx("rect",{x:"3",y:"11",width:"18",height:"11",rx:"2",ry:"2"}),d.jsx("path",{d:"M7 11V7a5 5 0 0110 0v4"})]}),d.jsx("input",{id:"password",type:"password",placeholder:a?"At least 6 characters":"Enter your password",value:_,onChange:C=>b(C.target.value),required:!0,minLength:6})]})]}),a&&d.jsxs("div",{className:"np-auth-field",children:[d.jsx("label",{htmlFor:"confirm-password",children:"Confirm Password"}),d.jsxs("div",{className:"np-auth-input-wrap",children:[d.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"var(--muted)",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[d.jsx("rect",{x:"3",y:"11",width:"18",height:"11",rx:"2",ry:"2"}),d.jsx("path",{d:"M7 11V7a5 5 0 0110 0v4"})]}),d.jsx("input",{id:"confirm-password",type:"password",placeholder:"Repeat password",value:x,onChange:C=>k(C.target.value),required:!0,minLength:6})]})]}),!a&&d.jsx("div",{style:{textAlign:"right",marginTop:-4},children:d.jsx("button",{type:"button",className:"np-auth-link np-auth-link-sm",onClick:()=>{f(!0),t()},children:"Forgot password?"})}),d.jsxs("button",{type:"submit",className:"np-login-btn",disabled:V,children:[V?d.jsx("span",{className:"np-auth-spinner"}):null,a?"Create Account":"Sign In"]})]}),d.jsxs("div",{className:"np-auth-switch",children:[a?"Already have an account?":"Don't have an account?",d.jsx("button",{className:"np-auth-link",onClick:()=>{l(!a),t()},children:a?"Sign In":"Sign Up"})]}),d.jsx("p",{className:"np-login-footer",children:"Your data is encrypted and stays private."})]})})}const cl=[{icon:"",title:"Organize Your Content",description:"Create Subjects, add Chapters, and load your questions. A clean three-level hierarchy keeps everything organized."},{icon:"",title:"Upload Questions Easily",description:"Bulk import questions via CSV  just format them, upload, and the wizard handles validation, matching, and import."},{icon:"",title:"Practice Smarter",description:"Smart modes prioritize what matters  wrong questions, spaced repetition, and data-driven insights help you master every topic."}];function JV(){const s=an(),{user:e,setUserProfile:t}=vn(),[i,a]=N.useState(0),[l,u]=N.useState(""),[f,p]=N.useState(""),[y,_]=N.useState(50),[b,x]=N.useState(!1),k=i>=cl.length,M=async()=>{if(e){x(!0);try{const j={examName:l,examDate:f,dailyGoal:y,onboardingComplete:!0};await qA(e.uid,j),t(V=>({...V,...j})),s("/")}catch(j){console.error("Failed to save onboarding:",j)}finally{x(!1)}}};return d.jsx("div",{className:"np-onboarding",children:d.jsx("div",{style:{width:"100%",maxWidth:480},children:k?d.jsxs("div",{style:{animation:"fadeInUp 0.4s ease-out"},children:[d.jsx("h2",{style:{fontFamily:"var(--font-heading)",fontWeight:800,fontSize:"1.75rem",textAlign:"center",marginBottom:28},children:"Set Up Your Goal"}),d.jsx("div",{className:"np-setup-form",children:d.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:20},children:[d.jsxs("div",{children:[d.jsx("label",{children:"Exam Name"}),d.jsx("input",{type:"text",placeholder:"e.g. JEE Main 2026",value:l,onChange:j=>u(j.target.value)})]}),d.jsxs("div",{children:[d.jsx("label",{children:"Exam Date"}),d.jsx("input",{type:"date",value:f,onChange:j=>p(j.target.value)})]}),d.jsxs("div",{children:[d.jsxs("label",{children:["Daily Question Goal: ",d.jsx("span",{style:{color:"var(--primary)",fontWeight:700},children:y})]}),d.jsx("input",{type:"range",min:"10",max:"200",value:y,onChange:j=>_(Number(j.target.value))}),d.jsxs("div",{style:{display:"flex",justifyContent:"space-between",fontSize:"0.75rem",color:"var(--muted)",marginTop:4},children:[d.jsx("span",{children:"10"}),d.jsx("span",{children:"200"})]})]})]})}),d.jsx("div",{style:{textAlign:"center",marginTop:28},children:d.jsx("button",{className:"np-btn np-btn-primary np-btn-lg",onClick:M,disabled:b,children:b?"Saving...":"Start Practicing "})})]}):d.jsxs("div",{className:"np-onboarding-slide",children:[d.jsx("div",{className:"np-onboarding-icon",children:cl[i].icon}),d.jsx("h2",{className:"np-onboarding-title",children:cl[i].title}),d.jsx("p",{className:"np-onboarding-desc",children:cl[i].description}),d.jsx("div",{className:"np-onboarding-dots",children:cl.map((j,V)=>d.jsx("div",{className:`np-onboarding-dot ${V===i?"np-onboarding-dot-active":"np-onboarding-dot-inactive"}`},V))}),d.jsx("button",{className:"np-btn np-btn-primary np-btn-lg",onClick:()=>a(j=>j+1),children:i===cl.length-1?"Let's Set Up":"Next"})]},i)})})}const ZV=[{key:"active",label:"Active",icon:""},{key:"graduated",label:"Graduated",icon:""}];function eP(){const s=an(),{user:e}=vn(),t=Xs(),{subjects:i,fetchSubjects:a,fetchPerformance:l,performanceMap:u}=t,[f,p]=N.useState([]),[y,_]=N.useState(!0),[b,x]=N.useState("active"),[k,M]=N.useState(null);N.useEffect(()=>{e?.uid&&(async()=>{_(!0);try{i.length===0&&await a(e.uid),await l(e.uid)}catch(F){console.error("Failed to load wrong questions:",F)}finally{_(!1)}})()},[e?.uid]),N.useEffect(()=>{!e?.uid||i.length===0||(async()=>{const F={subjectIds:["all"]},J=await ch(e.uid,F,t);p(J)})()},[e?.uid,i,t.chapters,t.questions]);const{subjectGroups:j,totalWrong:V,totalGraduated:ee,overallStats:ne}=N.useMemo(()=>{const F={};let J=0,C=0,R=0,w=0;f.forEach(D=>{const L=u[D.id];if(!L||L.timesWrong===0)return;const O=(L.masteryLevel||0)>=4;O?C++:J++,R+=L.timesCorrect||0,w+=L.timesAsked||0;const Se=D.subjectId;F[Se]||(F[Se]={subjectId:Se,subjectName:D.subjectName,subjectColor:D.subjectColor,subjectIcon:i.find(G=>G.id===Se)?.icon||"",questions:[],chapters:{}}),F[Se].questions.push({...D,perf:L,isGraduated:O});const pe=D.chapterId;F[Se].chapters[pe]||(F[Se].chapters[pe]={chapterId:pe,chapterName:D.chapterName,questions:[]}),F[Se].chapters[pe].questions.push({...D,perf:L,isGraduated:O})}),Object.values(F).forEach(D=>{const L=D.questions.filter(G=>!G.isGraduated),O=D.questions.filter(G=>G.isGraduated),Se=D.questions.reduce((G,le)=>G+(le.perf.timesCorrect||0),0),pe=D.questions.reduce((G,le)=>G+(le.perf.timesAsked||0),0);D.stats={activeCount:L.length,graduatedCount:O.length,totalCount:D.questions.length,accuracy:pe>0?Math.round(Se/pe*100):0,staleCount:L.filter(G=>HA(G.perf.lastAsked)).length,masteryDistribution:[0,1,2,3,4].map(G=>D.questions.filter(le=>(le.perf.masteryLevel||0)===G).length)}});const I={accuracy:w>0?Math.round(R/w*100):0};return{subjectGroups:Object.values(F).sort((D,L)=>L.stats.activeCount-D.stats.activeCount),totalWrong:J,totalGraduated:C,overallStats:I}},[f,u,i]);if(y)return d.jsx("div",{style:{display:"flex",flexDirection:"column",gap:24},children:d.jsxs("div",{className:"np-card-surface",style:{padding:60,textAlign:"center"},children:[d.jsx("div",{className:"np-auth-spinner",style:{width:32,height:32,borderWidth:3,margin:"0 auto"}}),d.jsx("p",{style:{color:"var(--muted)",marginTop:16},children:"Loading wrong questions..."})]})});const Y=j.map(F=>({...F,filteredQuestions:F.questions.filter(J=>b==="graduated"?J.isGraduated:!J.isGraduated),filteredChapters:Object.values(F.chapters).map(J=>({...J,filteredQuestions:J.questions.filter(C=>b==="graduated"?C.isGraduated:!C.isGraduated)})).filter(J=>J.filteredQuestions.length>0)})).filter(F=>F.filteredQuestions.length>0),ie=b==="active"?V:ee;return d.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:24},children:[d.jsxs("div",{children:[d.jsx("h2",{className:"np-section-title",children:"Wrong Questions"}),d.jsx("p",{className:"np-section-subtitle",children:"Focus on your mistakes to improve faster"})]}),d.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(140px, 1fr))",gap:12},children:[d.jsx($d,{label:"Active Wrong",value:V,color:"#FF6B6B",icon:""}),d.jsx($d,{label:"Graduated",value:ee,color:"#00D9A3",icon:""}),d.jsx($d,{label:"Subjects",value:j.length,color:"#6C63FF",icon:""}),d.jsx($d,{label:"Accuracy",value:`${ne.accuracy}%`,color:"#FFB347",icon:""})]}),d.jsx("div",{style:{display:"flex",gap:4,background:"var(--surface-2)",borderRadius:12,padding:4},children:ZV.map(F=>d.jsxs("button",{onClick:()=>x(F.key),style:{flex:1,padding:"10px 16px",borderRadius:10,border:"none",background:b===F.key?"var(--surface)":"transparent",color:b===F.key?"var(--text)":"var(--muted)",fontWeight:600,fontSize:"0.85rem",cursor:"pointer",transition:"all 0.2s ease",boxShadow:b===F.key?"0 2px 8px rgba(0,0,0,0.15)":"none"},children:[F.icon," ",F.label," (",F.key==="active"?V:ee,")"]},F.key))}),ie===0?d.jsx("div",{className:"np-card-surface",children:d.jsxs("div",{className:"np-empty",children:[d.jsx("div",{className:"np-empty-icon",children:b==="active"?"":""}),d.jsx("div",{className:"np-empty-title",children:b==="active"?"No wrong questions!":"No graduated questions yet"}),d.jsx("div",{className:"np-empty-desc",children:b==="active"?"Great job! Complete practice sessions to track your mistakes here.":"Questions graduate when they reach Mastery Level 4. Keep practicing!"})]})}):d.jsx("div",{style:{display:"flex",flexDirection:"column",gap:16},children:Y.map(F=>d.jsx(tP,{group:F,activeTab:b,expanded:k===F.subjectId,onToggle:()=>M(k===F.subjectId?null:F.subjectId),onPractice:()=>s(`/test?mode=wrong&subject=${F.subjectId}`),masteryColors:fV},F.subjectId))})]})}function $d({label:s,value:e,color:t,icon:i}){return d.jsxs("div",{className:"np-card-surface",style:{padding:"16px 20px",textAlign:"center"},children:[d.jsx("div",{style:{fontSize:"1.5rem",marginBottom:4},children:i}),d.jsx("div",{style:{fontSize:"1.5rem",fontWeight:800,color:t,fontFamily:"var(--font-heading)"},children:e}),d.jsx("div",{style:{fontSize:"0.72rem",color:"var(--muted)",marginTop:2},children:s})]})}function tP({group:s,activeTab:e,expanded:t,onToggle:i,onPractice:a,masteryColors:l}){const u=s.filteredQuestions;return d.jsxs("div",{className:"np-card-surface",style:{overflow:"hidden"},children:[d.jsxs("div",{onClick:i,style:{display:"flex",alignItems:"center",justifyContent:"space-between",padding:"16px 20px",cursor:"pointer",borderBottom:t?"1px solid var(--border)":"none"},children:[d.jsxs("div",{style:{display:"flex",alignItems:"center",gap:14},children:[d.jsx("div",{style:{width:42,height:42,borderRadius:12,display:"flex",alignItems:"center",justifyContent:"center",fontSize:"1.3rem",background:`${s.subjectColor}15`},children:s.subjectIcon}),d.jsxs("div",{children:[d.jsx("div",{style:{fontFamily:"var(--font-heading)",fontWeight:700,fontSize:"0.95rem",marginBottom:4},children:s.subjectName}),d.jsxs("div",{style:{display:"flex",gap:12,fontSize:"0.75rem",color:"var(--muted)"},children:[d.jsxs("span",{children:[u.length," question",u.length!==1?"s":""]}),d.jsxs("span",{children:["Accuracy: ",d.jsxs("strong",{style:{color:s.stats.accuracy>=60?"#00D9A3":"#FF6B6B"},children:[s.stats.accuracy,"%"]})]}),s.stats.staleCount>0&&e==="active"&&d.jsxs("span",{style:{color:"#FFB347"},children:[" ",s.stats.staleCount," stale"]})]})]})]}),d.jsxs("div",{style:{display:"flex",alignItems:"center",gap:10},children:[e==="active"&&d.jsxs("button",{className:"np-btn np-btn-primary np-btn-sm",onClick:f=>{f.stopPropagation(),a()},style:{fontSize:"0.75rem"},children:["Practice (",u.length,")"]}),d.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"var(--muted)",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",style:{transition:"transform 0.2s",transform:t?"rotate(180deg)":"none"},children:d.jsx("polyline",{points:"6 9 12 15 18 9"})})]})]}),t&&d.jsxs("div",{style:{padding:"12px 20px",borderBottom:"1px solid var(--border)"},children:[d.jsx("div",{style:{fontSize:"0.72rem",color:"var(--muted)",marginBottom:6},children:"Mastery Distribution"}),d.jsx("div",{style:{display:"flex",height:6,borderRadius:3,overflow:"hidden",background:"var(--surface-2)"},children:s.stats.masteryDistribution.map((f,p)=>{const y=s.stats.totalCount>0?f/s.stats.totalCount*100:0;return y===0?null:d.jsx("div",{style:{width:`${y}%`,background:l?.[p]||["#64748B","#FF6B6B","#FFB347","#6C63FF","#00D9A3"][p],transition:"width 0.3s ease"},title:`Level ${p}: ${f}`},p)})}),d.jsx("div",{style:{display:"flex",gap:12,marginTop:8,flexWrap:"wrap"},children:s.stats.masteryDistribution.map((f,p)=>{if(f===0)return null;const y=l?.[p]||["#64748B","#FF6B6B","#FFB347","#6C63FF","#00D9A3"][p];return d.jsxs("div",{style:{display:"flex",alignItems:"center",gap:4,fontSize:"0.68rem"},children:[d.jsx("span",{style:{width:6,height:6,borderRadius:"50%",background:y,display:"inline-block"}}),d.jsxs("span",{style:{color:"var(--muted)"},children:["L",p,": ",f]})]},p)})})]}),t&&d.jsx("div",{style:{padding:"0 0 8px"},children:s.filteredChapters.map(f=>d.jsxs("div",{children:[d.jsxs("div",{style:{padding:"10px 20px",fontSize:"0.78rem",fontWeight:600,color:"var(--text-secondary)",background:"var(--surface-2)",borderBottom:"1px solid var(--border)"},children:[f.chapterName," (",f.filteredQuestions.length,")"]}),f.filteredQuestions.map(p=>d.jsx(nP,{question:p,masteryColors:l},p.id))]},f.chapterId))})]})}function nP({question:s,masteryColors:e}){const{perf:t,isGraduated:i}=s,a=t.timesAsked>0?Math.round(t.timesCorrect/t.timesAsked*100):0,l=HA(t.lastAsked),u=vV(t.lastAsked),f=t.masteryLevel||0,p=e?.[f]||["#64748B","#FF6B6B","#FFB347","#6C63FF","#00D9A3"][f];return d.jsxs("div",{style:{padding:"12px 20px",borderBottom:"1px solid var(--border)",display:"flex",alignItems:"center",justifyContent:"space-between",gap:12,opacity:i?.7:1},children:[d.jsx("div",{style:{flex:1,minWidth:0},children:d.jsx("p",{style:{fontSize:"0.82rem",lineHeight:1.4,whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},children:s.text})}),d.jsxs("div",{style:{display:"flex",alignItems:"center",gap:10,flexShrink:0,fontSize:"0.72rem"},children:[l&&d.jsxs("span",{style:{padding:"2px 6px",borderRadius:6,fontSize:"0.65rem",fontWeight:600,background:"rgba(255,179,71,0.12)",color:"#FFB347"},children:[" ",u,"d"]}),d.jsxs("span",{style:{color:"var(--muted)"},children:["W:",d.jsx("strong",{style:{color:"#FF6B6B"},children:t.timesWrong})]}),d.jsxs("span",{style:{color:"var(--muted)"},children:["C:",d.jsx("strong",{style:{color:"#00D9A3"},children:t.timesCorrect})]}),d.jsxs("span",{style:{color:"var(--muted)"},children:[a,"%"]}),d.jsxs("span",{style:{padding:"2px 8px",borderRadius:6,fontSize:"0.65rem",fontWeight:600,background:`${p}18`,color:p},children:[i?"":""," L",f]})]})]})}function iP(){const s=an(),{user:e}=vn(),t=Xs(),i=uh(_=>_.initSession),{subjects:a}=t,[l,u]=N.useState("all"),[f,p]=N.useState(!1);N.useEffect(()=>{e?.uid&&a.length===0&&t.fetchSubjects(e.uid)},[e?.uid]);const y=async()=>{if(e?.uid){p(!0);try{const _={subjectIds:[l],chapterIds:["all"]},b=await ch(e.uid,_,t),x=Fs(b).slice(0,30);if(x.length===0){p(!1);return}const k={subjectIds:[l],chapterIds:["all"],subjectNames:[l==="all"?"All Subjects":a.find(V=>V.id===l)?.name||"Rapid Fire"]},M={totalQuestions:x.length,timerType:"per_question",timerValue:15,shuffled:!0,optionsShuffled:!1,showExplanation:!1},j=await Zv(e.uid,{type:"rapid_fire",scope:k,config:M,questionIds:x.map(V=>V.id),totalQuestions:x.length});i({sessionId:j,type:"rapid_fire",scope:k,config:M,questions:x,questionOrder:{}}),s("/test/session")}catch(_){console.error(_)}finally{p(!1)}}};return d.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:24},children:[d.jsxs("div",{children:[d.jsx("h2",{className:"np-section-title",children:" Rapid Fire"}),d.jsx("p",{className:"np-section-subtitle",children:"Speed drill  15 seconds per question, no going back"})]}),d.jsxs("div",{className:"np-config-section",children:[d.jsx("h3",{className:"np-config-title",children:" Select Scope"}),d.jsxs("div",{style:{display:"flex",flexWrap:"wrap",gap:8},children:[d.jsx("button",{className:`np-pill ${l==="all"?"np-pill-active":""}`,onClick:()=>u("all"),children:"All Subjects"}),a.map(_=>d.jsxs("button",{className:`np-pill ${l===_.id?"np-pill-active":""}`,onClick:()=>u(_.id),children:[_.icon," ",_.name]},_.id))]})]}),d.jsxs("div",{className:"np-card-surface",style:{padding:"24px",textAlign:"center"},children:[d.jsx("div",{style:{fontSize:"3rem",marginBottom:12},children:""}),d.jsx("h3",{style:{fontFamily:"var(--font-heading)",fontWeight:700,marginBottom:8},children:"How it works"}),d.jsxs("ul",{style:{fontSize:"0.85rem",color:"var(--text-secondary)",lineHeight:1.8,listStyle:"none",padding:0},children:[d.jsx("li",{children:"15 seconds per question  auto-skips when time runs out"}),d.jsx("li",{children:"Uses the same exam interface for answering"}),d.jsx("li",{children:"Up to 30 questions per round"})]})]}),d.jsx("button",{className:"np-btn np-btn-primary np-btn-lg",onClick:y,disabled:f,style:{alignSelf:"center",minWidth:200},children:f?"Loading...":" Start Rapid Fire"})]})}function sP(){return d.jsx(rV,{children:d.jsxs(hR,{basename:"/quiz/",children:[d.jsx(SR,{}),d.jsxs(zC,{children:[d.jsx(cn,{path:"/login",element:d.jsx(XV,{})}),d.jsx(cn,{path:"/onboarding",element:d.jsx(Wg,{children:d.jsx(JV,{})})}),d.jsx(cn,{path:"/test/session",element:d.jsx(Wg,{children:d.jsx($V,{})})}),d.jsxs(cn,{element:d.jsx(Wg,{children:d.jsx(dV,{})}),children:[d.jsx(cn,{path:"/",element:d.jsx(SV,{})}),d.jsx(cn,{path:"/practice",element:d.jsx(OV,{})}),d.jsx(cn,{path:"/subjects",element:d.jsx(MV,{})}),d.jsx(cn,{path:"/subjects/:subjectId",element:d.jsx(PV,{})}),d.jsx(cn,{path:"/wrong-questions",element:d.jsx(eP,{})}),d.jsx(cn,{path:"/flashcards",element:d.jsx(qV,{})}),d.jsx(cn,{path:"/analytics",element:d.jsx(LV,{})}),d.jsx(cn,{path:"/settings",element:d.jsx(HV,{})}),d.jsx(cn,{path:"/test",element:d.jsx(KV,{})}),d.jsx(cn,{path:"/test/results",element:d.jsx(WV,{})}),d.jsx(cn,{path:"/rapid-fire",element:d.jsx(iP,{})})]})]})]})})}L2.createRoot(document.getElementById("root")).render(d.jsx(N.StrictMode,{children:d.jsx(sP,{})}));
