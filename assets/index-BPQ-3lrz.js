(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))i(a);new MutationObserver(a=>{for(const l of a)if(l.type==="childList")for(const c of l.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&i(c)}).observe(document,{childList:!0,subtree:!0});function t(a){const l={};return a.integrity&&(l.integrity=a.integrity),a.referrerPolicy&&(l.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?l.credentials="include":a.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function i(a){if(a.ep)return;a.ep=!0;const l=t(a);fetch(a.href,l)}})();function D2(s){return s&&s.__esModule&&Object.prototype.hasOwnProperty.call(s,"default")?s.default:s}var Ag={exports:{}},iu={};var RT;function N2(){if(RT)return iu;RT=1;var s=Symbol.for("react.transitional.element"),e=Symbol.for("react.fragment");function t(i,a,l){var c=null;if(l!==void 0&&(c=""+l),a.key!==void 0&&(c=""+a.key),"key"in a){l={};for(var f in a)f!=="key"&&(l[f]=a[f])}else l=a;return a=l.ref,{$$typeof:s,type:i,key:c,ref:a!==void 0?a:null,props:l}}return iu.Fragment=e,iu.jsx=t,iu.jsxs=t,iu}var DT;function j2(){return DT||(DT=1,Ag.exports=N2()),Ag.exports}var d=j2(),Ig={exports:{}},je={};var NT;function k2(){if(NT)return je;NT=1;var s=Symbol.for("react.transitional.element"),e=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),i=Symbol.for("react.strict_mode"),a=Symbol.for("react.profiler"),l=Symbol.for("react.consumer"),c=Symbol.for("react.context"),f=Symbol.for("react.forward_ref"),p=Symbol.for("react.suspense"),y=Symbol.for("react.memo"),v=Symbol.for("react.lazy"),b=Symbol.for("react.activity"),x=Symbol.iterator;function k(U){return U===null||typeof U!="object"?null:(U=x&&U[x]||U["@@iterator"],typeof U=="function"?U:null)}var O={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},D=Object.assign,M={};function Y(U,z,ue){this.props=U,this.context=z,this.refs=M,this.updater=ue||O}Y.prototype.isReactComponent={},Y.prototype.setState=function(U,z){if(typeof U!="object"&&typeof U!="function"&&U!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,U,z,"setState")},Y.prototype.forceUpdate=function(U){this.updater.enqueueForceUpdate(this,U,"forceUpdate")};function Z(){}Z.prototype=Y.prototype;function $(U,z,ue){this.props=U,this.context=z,this.refs=M,this.updater=ue||O}var ne=$.prototype=new Z;ne.constructor=$,D(ne,Y.prototype),ne.isPureReactComponent=!0;var ee=Array.isArray;function se(){}var w={H:null,A:null,T:null,S:null},C=Object.prototype.hasOwnProperty;function A(U,z,ue){var re=ue.ref;return{$$typeof:s,type:U,key:z,ref:re!==void 0?re:null,props:ue}}function R(U,z){return A(U.type,z,U.props)}function j(U){return typeof U=="object"&&U!==null&&U.$$typeof===s}function L(U){var z={"=":"=0",":":"=2"};return"$"+U.replace(/[=:]/g,function(ue){return z[ue]})}var V=/\/+/g;function we(U,z){return typeof U=="object"&&U!==null&&U.key!=null?L(""+U.key):z.toString(36)}function Te(U){switch(U.status){case"fulfilled":return U.value;case"rejected":throw U.reason;default:switch(typeof U.status=="string"?U.then(se,se):(U.status="pending",U.then(function(z){U.status==="pending"&&(U.status="fulfilled",U.value=z)},function(z){U.status==="pending"&&(U.status="rejected",U.reason=z)})),U.status){case"fulfilled":return U.value;case"rejected":throw U.reason}}throw U}function G(U,z,ue,re,ge){var Ie=typeof U;(Ie==="undefined"||Ie==="boolean")&&(U=null);var Ne=!1;if(U===null)Ne=!0;else switch(Ie){case"bigint":case"string":case"number":Ne=!0;break;case"object":switch(U.$$typeof){case s:case e:Ne=!0;break;case v:return Ne=U._init,G(Ne(U._payload),z,ue,re,ge)}}if(Ne)return ge=ge(U),Ne=re===""?"."+we(U,0):re,ee(ge)?(ue="",Ne!=null&&(ue=Ne.replace(V,"$&/")+"/"),G(ge,z,ue,"",function(Ni){return Ni})):ge!=null&&(j(ge)&&(ge=R(ge,ue+(ge.key==null||U&&U.key===ge.key?"":(""+ge.key).replace(V,"$&/")+"/")+Ne)),z.push(ge)),1;Ne=0;var Qe=re===""?".":re+":";if(ee(U))for(var $e=0;$e<U.length;$e++)re=U[$e],Ie=Qe+we(re,$e),Ne+=G(re,z,ue,Ie,ge);else if($e=k(U),typeof $e=="function")for(U=$e.call(U),$e=0;!(re=U.next()).done;)re=re.value,Ie=Qe+we(re,$e++),Ne+=G(re,z,ue,Ie,ge);else if(Ie==="object"){if(typeof U.then=="function")return G(Te(U),z,ue,re,ge);throw z=String(U),Error("Objects are not valid as a React child (found: "+(z==="[object Object]"?"object with keys {"+Object.keys(U).join(", ")+"}":z)+"). If you meant to render a collection of children, use an array instead.")}return Ne}function oe(U,z,ue){if(U==null)return U;var re=[],ge=0;return G(U,re,"","",function(Ie){return z.call(ue,Ie,ge++)}),re}function pe(U){if(U._status===-1){var z=U._result;z=z(),z.then(function(ue){(U._status===0||U._status===-1)&&(U._status=1,U._result=ue)},function(ue){(U._status===0||U._status===-1)&&(U._status=2,U._result=ue)}),U._status===-1&&(U._status=0,U._result=z)}if(U._status===1)return U._result.default;throw U._result}var xe=typeof reportError=="function"?reportError:function(U){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var z=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof U=="object"&&U!==null&&typeof U.message=="string"?String(U.message):String(U),error:U});if(!window.dispatchEvent(z))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",U);return}console.error(U)},Me={map:oe,forEach:function(U,z,ue){oe(U,function(){z.apply(this,arguments)},ue)},count:function(U){var z=0;return oe(U,function(){z++}),z},toArray:function(U){return oe(U,function(z){return z})||[]},only:function(U){if(!j(U))throw Error("React.Children.only expected to receive a single React element child.");return U}};return je.Activity=b,je.Children=Me,je.Component=Y,je.Fragment=t,je.Profiler=a,je.PureComponent=$,je.StrictMode=i,je.Suspense=p,je.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=w,je.__COMPILER_RUNTIME={__proto__:null,c:function(U){return w.H.useMemoCache(U)}},je.cache=function(U){return function(){return U.apply(null,arguments)}},je.cacheSignal=function(){return null},je.cloneElement=function(U,z,ue){if(U==null)throw Error("The argument must be a React element, but you passed "+U+".");var re=D({},U.props),ge=U.key;if(z!=null)for(Ie in z.key!==void 0&&(ge=""+z.key),z)!C.call(z,Ie)||Ie==="key"||Ie==="__self"||Ie==="__source"||Ie==="ref"&&z.ref===void 0||(re[Ie]=z[Ie]);var Ie=arguments.length-2;if(Ie===1)re.children=ue;else if(1<Ie){for(var Ne=Array(Ie),Qe=0;Qe<Ie;Qe++)Ne[Qe]=arguments[Qe+2];re.children=Ne}return A(U.type,ge,re)},je.createContext=function(U){return U={$$typeof:c,_currentValue:U,_currentValue2:U,_threadCount:0,Provider:null,Consumer:null},U.Provider=U,U.Consumer={$$typeof:l,_context:U},U},je.createElement=function(U,z,ue){var re,ge={},Ie=null;if(z!=null)for(re in z.key!==void 0&&(Ie=""+z.key),z)C.call(z,re)&&re!=="key"&&re!=="__self"&&re!=="__source"&&(ge[re]=z[re]);var Ne=arguments.length-2;if(Ne===1)ge.children=ue;else if(1<Ne){for(var Qe=Array(Ne),$e=0;$e<Ne;$e++)Qe[$e]=arguments[$e+2];ge.children=Qe}if(U&&U.defaultProps)for(re in Ne=U.defaultProps,Ne)ge[re]===void 0&&(ge[re]=Ne[re]);return A(U,Ie,ge)},je.createRef=function(){return{current:null}},je.forwardRef=function(U){return{$$typeof:f,render:U}},je.isValidElement=j,je.lazy=function(U){return{$$typeof:v,_payload:{_status:-1,_result:U},_init:pe}},je.memo=function(U,z){return{$$typeof:y,type:U,compare:z===void 0?null:z}},je.startTransition=function(U){var z=w.T,ue={};w.T=ue;try{var re=U(),ge=w.S;ge!==null&&ge(ue,re),typeof re=="object"&&re!==null&&typeof re.then=="function"&&re.then(se,xe)}catch(Ie){xe(Ie)}finally{z!==null&&ue.types!==null&&(z.types=ue.types),w.T=z}},je.unstable_useCacheRefresh=function(){return w.H.useCacheRefresh()},je.use=function(U){return w.H.use(U)},je.useActionState=function(U,z,ue){return w.H.useActionState(U,z,ue)},je.useCallback=function(U,z){return w.H.useCallback(U,z)},je.useContext=function(U){return w.H.useContext(U)},je.useDebugValue=function(){},je.useDeferredValue=function(U,z){return w.H.useDeferredValue(U,z)},je.useEffect=function(U,z){return w.H.useEffect(U,z)},je.useEffectEvent=function(U){return w.H.useEffectEvent(U)},je.useId=function(){return w.H.useId()},je.useImperativeHandle=function(U,z,ue){return w.H.useImperativeHandle(U,z,ue)},je.useInsertionEffect=function(U,z){return w.H.useInsertionEffect(U,z)},je.useLayoutEffect=function(U,z){return w.H.useLayoutEffect(U,z)},je.useMemo=function(U,z){return w.H.useMemo(U,z)},je.useOptimistic=function(U,z){return w.H.useOptimistic(U,z)},je.useReducer=function(U,z,ue){return w.H.useReducer(U,z,ue)},je.useRef=function(U){return w.H.useRef(U)},je.useState=function(U){return w.H.useState(U)},je.useSyncExternalStore=function(U,z,ue){return w.H.useSyncExternalStore(U,z,ue)},je.useTransition=function(){return w.H.useTransition()},je.version="19.2.4",je}var jT;function Py(){return jT||(jT=1,Ig.exports=k2()),Ig.exports}var N=Py();const zd=D2(N);var Cg={exports:{}},su={},Rg={exports:{}},Dg={};var kT;function O2(){return kT||(kT=1,(function(s){function e(G,oe){var pe=G.length;G.push(oe);e:for(;0<pe;){var xe=pe-1>>>1,Me=G[xe];if(0<a(Me,oe))G[xe]=oe,G[pe]=Me,pe=xe;else break e}}function t(G){return G.length===0?null:G[0]}function i(G){if(G.length===0)return null;var oe=G[0],pe=G.pop();if(pe!==oe){G[0]=pe;e:for(var xe=0,Me=G.length,U=Me>>>1;xe<U;){var z=2*(xe+1)-1,ue=G[z],re=z+1,ge=G[re];if(0>a(ue,pe))re<Me&&0>a(ge,ue)?(G[xe]=ge,G[re]=pe,xe=re):(G[xe]=ue,G[z]=pe,xe=z);else if(re<Me&&0>a(ge,pe))G[xe]=ge,G[re]=pe,xe=re;else break e}}return oe}function a(G,oe){var pe=G.sortIndex-oe.sortIndex;return pe!==0?pe:G.id-oe.id}if(s.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var l=performance;s.unstable_now=function(){return l.now()}}else{var c=Date,f=c.now();s.unstable_now=function(){return c.now()-f}}var p=[],y=[],v=1,b=null,x=3,k=!1,O=!1,D=!1,M=!1,Y=typeof setTimeout=="function"?setTimeout:null,Z=typeof clearTimeout=="function"?clearTimeout:null,$=typeof setImmediate<"u"?setImmediate:null;function ne(G){for(var oe=t(y);oe!==null;){if(oe.callback===null)i(y);else if(oe.startTime<=G)i(y),oe.sortIndex=oe.expirationTime,e(p,oe);else break;oe=t(y)}}function ee(G){if(D=!1,ne(G),!O)if(t(p)!==null)O=!0,se||(se=!0,L());else{var oe=t(y);oe!==null&&Te(ee,oe.startTime-G)}}var se=!1,w=-1,C=5,A=-1;function R(){return M?!0:!(s.unstable_now()-A<C)}function j(){if(M=!1,se){var G=s.unstable_now();A=G;var oe=!0;try{e:{O=!1,D&&(D=!1,Z(w),w=-1),k=!0;var pe=x;try{t:{for(ne(G),b=t(p);b!==null&&!(b.expirationTime>G&&R());){var xe=b.callback;if(typeof xe=="function"){b.callback=null,x=b.priorityLevel;var Me=xe(b.expirationTime<=G);if(G=s.unstable_now(),typeof Me=="function"){b.callback=Me,ne(G),oe=!0;break t}b===t(p)&&i(p),ne(G)}else i(p);b=t(p)}if(b!==null)oe=!0;else{var U=t(y);U!==null&&Te(ee,U.startTime-G),oe=!1}}break e}finally{b=null,x=pe,k=!1}oe=void 0}}finally{oe?L():se=!1}}}var L;if(typeof $=="function")L=function(){$(j)};else if(typeof MessageChannel<"u"){var V=new MessageChannel,we=V.port2;V.port1.onmessage=j,L=function(){we.postMessage(null)}}else L=function(){Y(j,0)};function Te(G,oe){w=Y(function(){G(s.unstable_now())},oe)}s.unstable_IdlePriority=5,s.unstable_ImmediatePriority=1,s.unstable_LowPriority=4,s.unstable_NormalPriority=3,s.unstable_Profiling=null,s.unstable_UserBlockingPriority=2,s.unstable_cancelCallback=function(G){G.callback=null},s.unstable_forceFrameRate=function(G){0>G||125<G?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):C=0<G?Math.floor(1e3/G):5},s.unstable_getCurrentPriorityLevel=function(){return x},s.unstable_next=function(G){switch(x){case 1:case 2:case 3:var oe=3;break;default:oe=x}var pe=x;x=oe;try{return G()}finally{x=pe}},s.unstable_requestPaint=function(){M=!0},s.unstable_runWithPriority=function(G,oe){switch(G){case 1:case 2:case 3:case 4:case 5:break;default:G=3}var pe=x;x=G;try{return oe()}finally{x=pe}},s.unstable_scheduleCallback=function(G,oe,pe){var xe=s.unstable_now();switch(typeof pe=="object"&&pe!==null?(pe=pe.delay,pe=typeof pe=="number"&&0<pe?xe+pe:xe):pe=xe,G){case 1:var Me=-1;break;case 2:Me=250;break;case 5:Me=1073741823;break;case 4:Me=1e4;break;default:Me=5e3}return Me=pe+Me,G={id:v++,callback:oe,priorityLevel:G,startTime:pe,expirationTime:Me,sortIndex:-1},pe>xe?(G.sortIndex=pe,e(y,G),t(p)===null&&G===t(y)&&(D?(Z(w),w=-1):D=!0,Te(ee,pe-xe))):(G.sortIndex=Me,e(p,G),O||k||(O=!0,se||(se=!0,L()))),G},s.unstable_shouldYield=R,s.unstable_wrapCallback=function(G){var oe=x;return function(){var pe=x;x=oe;try{return G.apply(this,arguments)}finally{x=pe}}}})(Dg)),Dg}var OT;function V2(){return OT||(OT=1,Rg.exports=O2()),Rg.exports}var Ng={exports:{}},cn={};var VT;function M2(){if(VT)return cn;VT=1;var s=Py();function e(p){var y="https://react.dev/errors/"+p;if(1<arguments.length){y+="?args[]="+encodeURIComponent(arguments[1]);for(var v=2;v<arguments.length;v++)y+="&args[]="+encodeURIComponent(arguments[v])}return"Minified React error #"+p+"; visit "+y+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function t(){}var i={d:{f:t,r:function(){throw Error(e(522))},D:t,C:t,L:t,m:t,X:t,S:t,M:t},p:0,findDOMNode:null},a=Symbol.for("react.portal");function l(p,y,v){var b=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:a,key:b==null?null:""+b,children:p,containerInfo:y,implementation:v}}var c=s.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function f(p,y){if(p==="font")return"";if(typeof y=="string")return y==="use-credentials"?y:""}return cn.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=i,cn.createPortal=function(p,y){var v=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!y||y.nodeType!==1&&y.nodeType!==9&&y.nodeType!==11)throw Error(e(299));return l(p,y,null,v)},cn.flushSync=function(p){var y=c.T,v=i.p;try{if(c.T=null,i.p=2,p)return p()}finally{c.T=y,i.p=v,i.d.f()}},cn.preconnect=function(p,y){typeof p=="string"&&(y?(y=y.crossOrigin,y=typeof y=="string"?y==="use-credentials"?y:"":void 0):y=null,i.d.C(p,y))},cn.prefetchDNS=function(p){typeof p=="string"&&i.d.D(p)},cn.preinit=function(p,y){if(typeof p=="string"&&y&&typeof y.as=="string"){var v=y.as,b=f(v,y.crossOrigin),x=typeof y.integrity=="string"?y.integrity:void 0,k=typeof y.fetchPriority=="string"?y.fetchPriority:void 0;v==="style"?i.d.S(p,typeof y.precedence=="string"?y.precedence:void 0,{crossOrigin:b,integrity:x,fetchPriority:k}):v==="script"&&i.d.X(p,{crossOrigin:b,integrity:x,fetchPriority:k,nonce:typeof y.nonce=="string"?y.nonce:void 0})}},cn.preinitModule=function(p,y){if(typeof p=="string")if(typeof y=="object"&&y!==null){if(y.as==null||y.as==="script"){var v=f(y.as,y.crossOrigin);i.d.M(p,{crossOrigin:v,integrity:typeof y.integrity=="string"?y.integrity:void 0,nonce:typeof y.nonce=="string"?y.nonce:void 0})}}else y==null&&i.d.M(p)},cn.preload=function(p,y){if(typeof p=="string"&&typeof y=="object"&&y!==null&&typeof y.as=="string"){var v=y.as,b=f(v,y.crossOrigin);i.d.L(p,v,{crossOrigin:b,integrity:typeof y.integrity=="string"?y.integrity:void 0,nonce:typeof y.nonce=="string"?y.nonce:void 0,type:typeof y.type=="string"?y.type:void 0,fetchPriority:typeof y.fetchPriority=="string"?y.fetchPriority:void 0,referrerPolicy:typeof y.referrerPolicy=="string"?y.referrerPolicy:void 0,imageSrcSet:typeof y.imageSrcSet=="string"?y.imageSrcSet:void 0,imageSizes:typeof y.imageSizes=="string"?y.imageSizes:void 0,media:typeof y.media=="string"?y.media:void 0})}},cn.preloadModule=function(p,y){if(typeof p=="string")if(y){var v=f(y.as,y.crossOrigin);i.d.m(p,{as:typeof y.as=="string"&&y.as!=="script"?y.as:void 0,crossOrigin:v,integrity:typeof y.integrity=="string"?y.integrity:void 0})}else i.d.m(p)},cn.requestFormReset=function(p){i.d.r(p)},cn.unstable_batchedUpdates=function(p,y){return p(y)},cn.useFormState=function(p,y,v){return c.H.useFormState(p,y,v)},cn.useFormStatus=function(){return c.H.useHostTransitionStatus()},cn.version="19.2.4",cn}var MT;function P2(){if(MT)return Ng.exports;MT=1;function s(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(s)}catch(e){console.error(e)}}return s(),Ng.exports=M2(),Ng.exports}var PT;function L2(){if(PT)return su;PT=1;var s=V2(),e=Py(),t=P2();function i(n){var r="https://react.dev/errors/"+n;if(1<arguments.length){r+="?args[]="+encodeURIComponent(arguments[1]);for(var o=2;o<arguments.length;o++)r+="&args[]="+encodeURIComponent(arguments[o])}return"Minified React error #"+n+"; visit "+r+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function a(n){return!(!n||n.nodeType!==1&&n.nodeType!==9&&n.nodeType!==11)}function l(n){var r=n,o=n;if(n.alternate)for(;r.return;)r=r.return;else{n=r;do r=n,(r.flags&4098)!==0&&(o=r.return),n=r.return;while(n)}return r.tag===3?o:null}function c(n){if(n.tag===13){var r=n.memoizedState;if(r===null&&(n=n.alternate,n!==null&&(r=n.memoizedState)),r!==null)return r.dehydrated}return null}function f(n){if(n.tag===31){var r=n.memoizedState;if(r===null&&(n=n.alternate,n!==null&&(r=n.memoizedState)),r!==null)return r.dehydrated}return null}function p(n){if(l(n)!==n)throw Error(i(188))}function y(n){var r=n.alternate;if(!r){if(r=l(n),r===null)throw Error(i(188));return r!==n?null:n}for(var o=n,u=r;;){var m=o.return;if(m===null)break;var g=m.alternate;if(g===null){if(u=m.return,u!==null){o=u;continue}break}if(m.child===g.child){for(g=m.child;g;){if(g===o)return p(m),n;if(g===u)return p(m),r;g=g.sibling}throw Error(i(188))}if(o.return!==u.return)o=m,u=g;else{for(var T=!1,S=m.child;S;){if(S===o){T=!0,o=m,u=g;break}if(S===u){T=!0,u=m,o=g;break}S=S.sibling}if(!T){for(S=g.child;S;){if(S===o){T=!0,o=g,u=m;break}if(S===u){T=!0,u=g,o=m;break}S=S.sibling}if(!T)throw Error(i(189))}}if(o.alternate!==u)throw Error(i(190))}if(o.tag!==3)throw Error(i(188));return o.stateNode.current===o?n:r}function v(n){var r=n.tag;if(r===5||r===26||r===27||r===6)return n;for(n=n.child;n!==null;){if(r=v(n),r!==null)return r;n=n.sibling}return null}var b=Object.assign,x=Symbol.for("react.element"),k=Symbol.for("react.transitional.element"),O=Symbol.for("react.portal"),D=Symbol.for("react.fragment"),M=Symbol.for("react.strict_mode"),Y=Symbol.for("react.profiler"),Z=Symbol.for("react.consumer"),$=Symbol.for("react.context"),ne=Symbol.for("react.forward_ref"),ee=Symbol.for("react.suspense"),se=Symbol.for("react.suspense_list"),w=Symbol.for("react.memo"),C=Symbol.for("react.lazy"),A=Symbol.for("react.activity"),R=Symbol.for("react.memo_cache_sentinel"),j=Symbol.iterator;function L(n){return n===null||typeof n!="object"?null:(n=j&&n[j]||n["@@iterator"],typeof n=="function"?n:null)}var V=Symbol.for("react.client.reference");function we(n){if(n==null)return null;if(typeof n=="function")return n.$$typeof===V?null:n.displayName||n.name||null;if(typeof n=="string")return n;switch(n){case D:return"Fragment";case Y:return"Profiler";case M:return"StrictMode";case ee:return"Suspense";case se:return"SuspenseList";case A:return"Activity"}if(typeof n=="object")switch(n.$$typeof){case O:return"Portal";case $:return n.displayName||"Context";case Z:return(n._context.displayName||"Context")+".Consumer";case ne:var r=n.render;return n=n.displayName,n||(n=r.displayName||r.name||"",n=n!==""?"ForwardRef("+n+")":"ForwardRef"),n;case w:return r=n.displayName||null,r!==null?r:we(n.type)||"Memo";case C:r=n._payload,n=n._init;try{return we(n(r))}catch{}}return null}var Te=Array.isArray,G=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,oe=t.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,pe={pending:!1,data:null,method:null,action:null},xe=[],Me=-1;function U(n){return{current:n}}function z(n){0>Me||(n.current=xe[Me],xe[Me]=null,Me--)}function ue(n,r){Me++,xe[Me]=n.current,n.current=r}var re=U(null),ge=U(null),Ie=U(null),Ne=U(null);function Qe(n,r){switch(ue(Ie,r),ue(ge,n),ue(re,null),r.nodeType){case 9:case 11:n=(n=r.documentElement)&&(n=n.namespaceURI)?Jb(n):0;break;default:if(n=r.tagName,r=r.namespaceURI)r=Jb(r),n=Zb(r,n);else switch(n){case"svg":n=1;break;case"math":n=2;break;default:n=0}}z(re),ue(re,n)}function $e(){z(re),z(ge),z(Ie)}function Ni(n){n.memoizedState!==null&&ue(Ne,n);var r=re.current,o=Zb(r,n.type);r!==o&&(ue(ge,n),ue(re,o))}function ps(n){ge.current===n&&(z(re),z(ge)),Ne.current===n&&(z(Ne),Zc._currentValue=pe)}var gs,er;function gn(n){if(gs===void 0)try{throw Error()}catch(o){var r=o.stack.trim().match(/\n( *(at )?)/);gs=r&&r[1]||"",er=-1<o.stack.indexOf(`
    at`)?" (<anonymous>)":-1<o.stack.indexOf("@")?"@unknown:0:0":""}return`
`+gs+n+er}var tr=!1;function ys(n,r){if(!n||tr)return"";tr=!0;var o=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var u={DetermineComponentFrameRoot:function(){try{if(r){var le=function(){throw Error()};if(Object.defineProperty(le.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(le,[])}catch(J){var W=J}Reflect.construct(n,[],le)}else{try{le.call()}catch(J){W=J}n.call(le.prototype)}}else{try{throw Error()}catch(J){W=J}(le=n())&&typeof le.catch=="function"&&le.catch(function(){})}}catch(J){if(J&&W&&typeof J.stack=="string")return[J.stack,W.stack]}return[null,null]}};u.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var m=Object.getOwnPropertyDescriptor(u.DetermineComponentFrameRoot,"name");m&&m.configurable&&Object.defineProperty(u.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var g=u.DetermineComponentFrameRoot(),T=g[0],S=g[1];if(T&&S){var P=T.split(`
`),K=S.split(`
`);for(m=u=0;u<P.length&&!P[u].includes("DetermineComponentFrameRoot");)u++;for(;m<K.length&&!K[m].includes("DetermineComponentFrameRoot");)m++;if(u===P.length||m===K.length)for(u=P.length-1,m=K.length-1;1<=u&&0<=m&&P[u]!==K[m];)m--;for(;1<=u&&0<=m;u--,m--)if(P[u]!==K[m]){if(u!==1||m!==1)do if(u--,m--,0>m||P[u]!==K[m]){var ie=`
`+P[u].replace(" at new "," at ");return n.displayName&&ie.includes("<anonymous>")&&(ie=ie.replace("<anonymous>",n.displayName)),ie}while(1<=u&&0<=m);break}}}finally{tr=!1,Error.prepareStackTrace=o}return(o=n?n.displayName||n.name:"")?gn(o):""}function ji(n,r){switch(n.tag){case 26:case 27:case 5:return gn(n.type);case 16:return gn("Lazy");case 13:return n.child!==r&&r!==null?gn("Suspense Fallback"):gn("Suspense");case 19:return gn("SuspenseList");case 0:case 15:return ys(n.type,!1);case 11:return ys(n.type.render,!1);case 1:return ys(n.type,!0);case 31:return gn("Activity");default:return""}}function ki(n){try{var r="",o=null;do r+=ji(n,o),o=n,n=n.return;while(n);return r}catch(u){return`
Error generating stack: `+u.message+`
`+u.stack}}var He=Object.prototype.hasOwnProperty,mt=s.unstable_scheduleCallback,fi=s.unstable_cancelCallback,mo=s.unstable_shouldYield,ua=s.unstable_requestPaint,vt=s.unstable_now,Wn=s.unstable_getCurrentPriorityLevel,ha=s.unstable_ImmediatePriority,da=s.unstable_UserBlockingPriority,Oi=s.unstable_NormalPriority,po=s.unstable_LowPriority,go=s.unstable_IdlePriority,fa=s.log,yo=s.unstable_setDisableYieldValue,Dn=null,Ht=null;function bn(n){if(typeof fa=="function"&&yo(n),Ht&&typeof Ht.setStrictMode=="function")try{Ht.setStrictMode(Dn,n)}catch{}}var de=Math.clz32?Math.clz32:nr,Zt=Math.log,Nn=Math.LN2;function nr(n){return n>>>=0,n===0?32:31-(Zt(n)/Nn|0)|0}var dt=256,vs=262144,pt=4194304;function Vi(n){var r=n&42;if(r!==0)return r;switch(n&-n){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return n&261888;case 262144:case 524288:case 1048576:case 2097152:return n&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return n&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return n}}function Mi(n,r,o){var u=n.pendingLanes;if(u===0)return 0;var m=0,g=n.suspendedLanes,T=n.pingedLanes;n=n.warmLanes;var S=u&134217727;return S!==0?(u=S&~g,u!==0?m=Vi(u):(T&=S,T!==0?m=Vi(T):o||(o=S&~n,o!==0&&(m=Vi(o))))):(S=u&~g,S!==0?m=Vi(S):T!==0?m=Vi(T):o||(o=u&~n,o!==0&&(m=Vi(o)))),m===0?0:r!==0&&r!==m&&(r&g)===0&&(g=m&-m,o=r&-r,g>=o||g===32&&(o&4194048)!==0)?r:m}function mi(n,r){return(n.pendingLanes&~(n.suspendedLanes&~n.pingedLanes)&r)===0}function Dm(n,r){switch(n){case 1:case 2:case 4:case 8:case 64:return r+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return r+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function yh(){var n=pt;return pt<<=1,(pt&62914560)===0&&(pt=4194304),n}function Pi(n){for(var r=[],o=0;31>o;o++)r.push(n);return r}function ma(n,r){n.pendingLanes|=r,r!==268435456&&(n.suspendedLanes=0,n.pingedLanes=0,n.warmLanes=0)}function Nm(n,r,o,u,m,g){var T=n.pendingLanes;n.pendingLanes=o,n.suspendedLanes=0,n.pingedLanes=0,n.warmLanes=0,n.expiredLanes&=o,n.entangledLanes&=o,n.errorRecoveryDisabledLanes&=o,n.shellSuspendCounter=0;var S=n.entanglements,P=n.expirationTimes,K=n.hiddenUpdates;for(o=T&~o;0<o;){var ie=31-de(o),le=1<<ie;S[ie]=0,P[ie]=-1;var W=K[ie];if(W!==null)for(K[ie]=null,ie=0;ie<W.length;ie++){var J=W[ie];J!==null&&(J.lane&=-536870913)}o&=~le}u!==0&&pa(n,u,0),g!==0&&m===0&&n.tag!==0&&(n.suspendedLanes|=g&~(T&~r))}function pa(n,r,o){n.pendingLanes|=r,n.suspendedLanes&=~r;var u=31-de(r);n.entangledLanes|=r,n.entanglements[u]=n.entanglements[u]|1073741824|o&261930}function sc(n,r){var o=n.entangledLanes|=r;for(n=n.entanglements;o;){var u=31-de(o),m=1<<u;m&r|n[u]&r&&(n[u]|=r),o&=~m}}function rc(n,r){var o=r&-r;return o=(o&42)!==0?1:ga(o),(o&(n.suspendedLanes|r))!==0?0:o}function ga(n){switch(n){case 2:n=1;break;case 8:n=4;break;case 32:n=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:n=128;break;case 268435456:n=134217728;break;default:n=0}return n}function _s(n){return n&=-n,2<n?8<n?(n&134217727)!==0?32:268435456:8:2}function vh(){var n=oe.p;return n!==0?n:(n=window.event,n===void 0?32:ET(n.type))}function pi(n,r){var o=oe.p;try{return oe.p=n,r()}finally{oe.p=o}}var gi=Math.random().toString(36).slice(2),Vt="__reactFiber$"+gi,$t="__reactProps$"+gi,Li="__reactContainer$"+gi,vo="__reactEvents$"+gi,jm="__reactListeners$"+gi,_h="__reactHandles$"+gi,bh="__reactResources$"+gi,Ui="__reactMarker$"+gi;function _o(n){delete n[Vt],delete n[$t],delete n[vo],delete n[jm],delete n[_h]}function zi(n){var r=n[Vt];if(r)return r;for(var o=n.parentNode;o;){if(r=o[Li]||o[Vt]){if(o=r.alternate,r.child!==null||o!==null&&o.child!==null)for(n=aT(n);n!==null;){if(o=n[Vt])return o;n=aT(n)}return r}n=o,o=n.parentNode}return null}function Yn(n){if(n=n[Vt]||n[Li]){var r=n.tag;if(r===5||r===6||r===13||r===31||r===26||r===27||r===3)return n}return null}function jn(n){var r=n.tag;if(r===5||r===26||r===27||r===6)return n.stateNode;throw Error(i(33))}function Bi(n){var r=n[bh];return r||(r=n[bh]={hoistableStyles:new Map,hoistableScripts:new Map}),r}function Mt(n){n[Ui]=!0}var ac=new Set,oc={};function Fi(n,r){qi(n,r),qi(n+"Capture",r)}function qi(n,r){for(oc[n]=r,n=0;n<r.length;n++)ac.add(r[n])}var lc=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),cc={},uc={};function Th(n){return He.call(uc,n)?!0:He.call(cc,n)?!1:lc.test(n)?uc[n]=!0:(cc[n]=!0,!1)}function bo(n,r,o){if(Th(r))if(o===null)n.removeAttribute(r);else{switch(typeof o){case"undefined":case"function":case"symbol":n.removeAttribute(r);return;case"boolean":var u=r.toLowerCase().slice(0,5);if(u!=="data-"&&u!=="aria-"){n.removeAttribute(r);return}}n.setAttribute(r,""+o)}}function kn(n,r,o){if(o===null)n.removeAttribute(r);else{switch(typeof o){case"undefined":case"function":case"symbol":case"boolean":n.removeAttribute(r);return}n.setAttribute(r,""+o)}}function Pt(n,r,o,u){if(u===null)n.removeAttribute(o);else{switch(typeof u){case"undefined":case"function":case"symbol":case"boolean":n.removeAttribute(o);return}n.setAttributeNS(r,o,""+u)}}function Wt(n){switch(typeof n){case"bigint":case"boolean":case"number":case"string":case"undefined":return n;case"object":return n;default:return""}}function ir(n){var r=n.type;return(n=n.nodeName)&&n.toLowerCase()==="input"&&(r==="checkbox"||r==="radio")}function hc(n,r,o){var u=Object.getOwnPropertyDescriptor(n.constructor.prototype,r);if(!n.hasOwnProperty(r)&&typeof u<"u"&&typeof u.get=="function"&&typeof u.set=="function"){var m=u.get,g=u.set;return Object.defineProperty(n,r,{configurable:!0,get:function(){return m.call(this)},set:function(T){o=""+T,g.call(this,T)}}),Object.defineProperty(n,r,{enumerable:u.enumerable}),{getValue:function(){return o},setValue:function(T){o=""+T},stopTracking:function(){n._valueTracker=null,delete n[r]}}}}function et(n){if(!n._valueTracker){var r=ir(n)?"checked":"value";n._valueTracker=hc(n,r,""+n[r])}}function ya(n){if(!n)return!1;var r=n._valueTracker;if(!r)return!0;var o=r.getValue(),u="";return n&&(u=ir(n)?n.checked?"true":"false":n.value),n=u,n!==o?(r.setValue(n),!0):!1}function Hi(n){if(n=n||(typeof document<"u"?document:void 0),typeof n>"u")return null;try{return n.activeElement||n.body}catch{return n.body}}var va=/[\n"\\]/g;function Tn(n){return n.replace(va,function(r){return"\\"+r.charCodeAt(0).toString(16)+" "})}function To(n,r,o,u,m,g,T,S){n.name="",T!=null&&typeof T!="function"&&typeof T!="symbol"&&typeof T!="boolean"?n.type=T:n.removeAttribute("type"),r!=null?T==="number"?(r===0&&n.value===""||n.value!=r)&&(n.value=""+Wt(r)):n.value!==""+Wt(r)&&(n.value=""+Wt(r)):T!=="submit"&&T!=="reset"||n.removeAttribute("value"),r!=null?dc(n,T,Wt(r)):o!=null?dc(n,T,Wt(o)):u!=null&&n.removeAttribute("value"),m==null&&g!=null&&(n.defaultChecked=!!g),m!=null&&(n.checked=m&&typeof m!="function"&&typeof m!="symbol"),S!=null&&typeof S!="function"&&typeof S!="symbol"&&typeof S!="boolean"?n.name=""+Wt(S):n.removeAttribute("name")}function Eh(n,r,o,u,m,g,T,S){if(g!=null&&typeof g!="function"&&typeof g!="symbol"&&typeof g!="boolean"&&(n.type=g),r!=null||o!=null){if(!(g!=="submit"&&g!=="reset"||r!=null)){et(n);return}o=o!=null?""+Wt(o):"",r=r!=null?""+Wt(r):o,S||r===n.value||(n.value=r),n.defaultValue=r}u=u??m,u=typeof u!="function"&&typeof u!="symbol"&&!!u,n.checked=S?n.checked:!!u,n.defaultChecked=!!u,T!=null&&typeof T!="function"&&typeof T!="symbol"&&typeof T!="boolean"&&(n.name=T),et(n)}function dc(n,r,o){r==="number"&&Hi(n.ownerDocument)===n||n.defaultValue===""+o||(n.defaultValue=""+o)}function sr(n,r,o,u){if(n=n.options,r){r={};for(var m=0;m<o.length;m++)r["$"+o[m]]=!0;for(o=0;o<n.length;o++)m=r.hasOwnProperty("$"+n[o].value),n[o].selected!==m&&(n[o].selected=m),m&&u&&(n[o].defaultSelected=!0)}else{for(o=""+Wt(o),r=null,m=0;m<n.length;m++){if(n[m].value===o){n[m].selected=!0,u&&(n[m].defaultSelected=!0);return}r!==null||n[m].disabled||(r=n[m])}r!==null&&(r.selected=!0)}}function xh(n,r,o){if(r!=null&&(r=""+Wt(r),r!==n.value&&(n.value=r),o==null)){n.defaultValue!==r&&(n.defaultValue=r);return}n.defaultValue=o!=null?""+Wt(o):""}function rr(n,r,o,u){if(r==null){if(u!=null){if(o!=null)throw Error(i(92));if(Te(u)){if(1<u.length)throw Error(i(93));u=u[0]}o=u}o==null&&(o=""),r=o}o=Wt(r),n.defaultValue=o,u=n.textContent,u===o&&u!==""&&u!==null&&(n.value=u),et(n)}function En(n,r){if(r){var o=n.firstChild;if(o&&o===n.lastChild&&o.nodeType===3){o.nodeValue=r;return}}n.textContent=r}var Sh=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function fc(n,r,o){var u=r.indexOf("--")===0;o==null||typeof o=="boolean"||o===""?u?n.setProperty(r,""):r==="float"?n.cssFloat="":n[r]="":u?n.setProperty(r,o):typeof o!="number"||o===0||Sh.has(r)?r==="float"?n.cssFloat=o:n[r]=(""+o).trim():n[r]=o+"px"}function mc(n,r,o){if(r!=null&&typeof r!="object")throw Error(i(62));if(n=n.style,o!=null){for(var u in o)!o.hasOwnProperty(u)||r!=null&&r.hasOwnProperty(u)||(u.indexOf("--")===0?n.setProperty(u,""):u==="float"?n.cssFloat="":n[u]="");for(var m in r)u=r[m],r.hasOwnProperty(m)&&o[m]!==u&&fc(n,m,u)}else for(var g in r)r.hasOwnProperty(g)&&fc(n,g,r[g])}function Eo(n){if(n.indexOf("-")===-1)return!1;switch(n){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var wh=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),ar=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function xo(n){return ar.test(""+n)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":n}function yi(){}var pc=null;function Xn(n){return n=n.target||n.srcElement||window,n.correspondingUseElement&&(n=n.correspondingUseElement),n.nodeType===3?n.parentNode:n}var or=null,Gi=null;function _a(n){var r=Yn(n);if(r&&(n=r.stateNode)){var o=n[$t]||null;e:switch(n=r.stateNode,r.type){case"input":if(To(n,o.value,o.defaultValue,o.defaultValue,o.checked,o.defaultChecked,o.type,o.name),r=o.name,o.type==="radio"&&r!=null){for(o=n;o.parentNode;)o=o.parentNode;for(o=o.querySelectorAll('input[name="'+Tn(""+r)+'"][type="radio"]'),r=0;r<o.length;r++){var u=o[r];if(u!==n&&u.form===n.form){var m=u[$t]||null;if(!m)throw Error(i(90));To(u,m.value,m.defaultValue,m.defaultValue,m.checked,m.defaultChecked,m.type,m.name)}}for(r=0;r<o.length;r++)u=o[r],u.form===n.form&&ya(u)}break e;case"textarea":xh(n,o.value,o.defaultValue);break e;case"select":r=o.value,r!=null&&sr(n,!!o.multiple,r,!1)}}}var So=!1;function lr(n,r,o){if(So)return n(r,o);So=!0;try{var u=n(r);return u}finally{if(So=!1,(or!==null||Gi!==null)&&(vd(),or&&(r=or,n=Gi,Gi=or=null,_a(r),n)))for(r=0;r<n.length;r++)_a(n[r])}}function vi(n,r){var o=n.stateNode;if(o===null)return null;var u=o[$t]||null;if(u===null)return null;o=u[r];e:switch(r){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(u=!u.disabled)||(n=n.type,u=!(n==="button"||n==="input"||n==="select"||n==="textarea")),n=!u;break e;default:n=!1}if(n)return null;if(o&&typeof o!="function")throw Error(i(231,r,typeof o));return o}var Jn=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),ba=!1;if(Jn)try{var at={};Object.defineProperty(at,"passive",{get:function(){ba=!0}}),window.addEventListener("test",at,at),window.removeEventListener("test",at,at)}catch{ba=!1}var Qi=null,gc=null,Ta=null;function yc(){if(Ta)return Ta;var n,r=gc,o=r.length,u,m="value"in Qi?Qi.value:Qi.textContent,g=m.length;for(n=0;n<o&&r[n]===m[n];n++);var T=o-n;for(u=1;u<=T&&r[o-u]===m[g-u];u++);return Ta=m.slice(n,1<u?1-u:void 0)}function Ea(n){var r=n.keyCode;return"charCode"in n?(n=n.charCode,n===0&&r===13&&(n=13)):n=r,n===10&&(n=13),32<=n||n===13?n:0}function bs(){return!0}function _i(){return!1}function en(n){function r(o,u,m,g,T){this._reactName=o,this._targetInst=m,this.type=u,this.nativeEvent=g,this.target=T,this.currentTarget=null;for(var S in n)n.hasOwnProperty(S)&&(o=n[S],this[S]=o?o(g):g[S]);return this.isDefaultPrevented=(g.defaultPrevented!=null?g.defaultPrevented:g.returnValue===!1)?bs:_i,this.isPropagationStopped=_i,this}return b(r.prototype,{preventDefault:function(){this.defaultPrevented=!0;var o=this.nativeEvent;o&&(o.preventDefault?o.preventDefault():typeof o.returnValue!="unknown"&&(o.returnValue=!1),this.isDefaultPrevented=bs)},stopPropagation:function(){var o=this.nativeEvent;o&&(o.stopPropagation?o.stopPropagation():typeof o.cancelBubble!="unknown"&&(o.cancelBubble=!0),this.isPropagationStopped=bs)},persist:function(){},isPersistent:bs}),r}var Ts={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(n){return n.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Ki=en(Ts),cr=b({},Ts,{view:0,detail:0}),vc=en(cr),ur,wo,$i,Ao=b({},cr,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:hr,button:0,buttons:0,relatedTarget:function(n){return n.relatedTarget===void 0?n.fromElement===n.srcElement?n.toElement:n.fromElement:n.relatedTarget},movementX:function(n){return"movementX"in n?n.movementX:(n!==$i&&($i&&n.type==="mousemove"?(ur=n.screenX-$i.screenX,wo=n.screenY-$i.screenY):wo=ur=0,$i=n),ur)},movementY:function(n){return"movementY"in n?n.movementY:wo}}),_c=en(Ao),xa=b({},Ao,{dataTransfer:0}),Ah=en(xa),Ih=b({},cr,{relatedTarget:0}),Sa=en(Ih),bc=b({},Ts,{animationName:0,elapsedTime:0,pseudoElement:0}),Ch=en(bc),Io=b({},Ts,{clipboardData:function(n){return"clipboardData"in n?n.clipboardData:window.clipboardData}}),Rh=en(Io),Dh=b({},Ts,{data:0}),Wi=en(Dh),Nh={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},jh={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},kh={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Oh(n){var r=this.nativeEvent;return r.getModifierState?r.getModifierState(n):(n=kh[n])?!!r[n]:!1}function hr(){return Oh}var yn=b({},cr,{key:function(n){if(n.key){var r=Nh[n.key]||n.key;if(r!=="Unidentified")return r}return n.type==="keypress"?(n=Ea(n),n===13?"Enter":String.fromCharCode(n)):n.type==="keydown"||n.type==="keyup"?jh[n.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:hr,charCode:function(n){return n.type==="keypress"?Ea(n):0},keyCode:function(n){return n.type==="keydown"||n.type==="keyup"?n.keyCode:0},which:function(n){return n.type==="keypress"?Ea(n):n.type==="keydown"||n.type==="keyup"?n.keyCode:0}}),Vh=en(yn),Mh=b({},Ao,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Es=en(Mh),h=b({},cr,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:hr}),_=en(h),E=b({},Ts,{propertyName:0,elapsedTime:0,pseudoElement:0}),I=en(E),H=b({},Ao,{deltaX:function(n){return"deltaX"in n?n.deltaX:"wheelDeltaX"in n?-n.wheelDeltaX:0},deltaY:function(n){return"deltaY"in n?n.deltaY:"wheelDeltaY"in n?-n.wheelDeltaY:"wheelDelta"in n?-n.wheelDelta:0},deltaZ:0,deltaMode:0}),X=en(H),fe=b({},Ts,{newState:0,oldState:0}),ke=en(fe),Dt=[9,13,27,32],Je=Jn&&"CompositionEvent"in window,_t=null;Jn&&"documentMode"in document&&(_t=document.documentMode);var Zn=Jn&&"TextEvent"in window&&!_t,Yi=Jn&&(!Je||_t&&8<_t&&11>=_t),bi=" ",Ti=!1;function wa(n,r){switch(n){case"keyup":return Dt.indexOf(r.keyCode)!==-1;case"keydown":return r.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Co(n){return n=n.detail,typeof n=="object"&&"data"in n?n.data:null}var Ro=!1;function eI(n,r){switch(n){case"compositionend":return Co(r);case"keypress":return r.which!==32?null:(Ti=!0,bi);case"textInput":return n=r.data,n===bi&&Ti?null:n;default:return null}}function tI(n,r){if(Ro)return n==="compositionend"||!Je&&wa(n,r)?(n=yc(),Ta=gc=Qi=null,Ro=!1,n):null;switch(n){case"paste":return null;case"keypress":if(!(r.ctrlKey||r.altKey||r.metaKey)||r.ctrlKey&&r.altKey){if(r.char&&1<r.char.length)return r.char;if(r.which)return String.fromCharCode(r.which)}return null;case"compositionend":return Yi&&r.locale!=="ko"?null:r.data;default:return null}}var nI={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function c_(n){var r=n&&n.nodeName&&n.nodeName.toLowerCase();return r==="input"?!!nI[n.type]:r==="textarea"}function u_(n,r,o,u){or?Gi?Gi.push(u):Gi=[u]:or=u,r=wd(r,"onChange"),0<r.length&&(o=new Ki("onChange","change",null,o,u),n.push({event:o,listeners:r}))}var Tc=null,Ec=null;function iI(n){Qb(n,0)}function Ph(n){var r=jn(n);if(ya(r))return n}function h_(n,r){if(n==="change")return r}var d_=!1;if(Jn){var km;if(Jn){var Om="oninput"in document;if(!Om){var f_=document.createElement("div");f_.setAttribute("oninput","return;"),Om=typeof f_.oninput=="function"}km=Om}else km=!1;d_=km&&(!document.documentMode||9<document.documentMode)}function m_(){Tc&&(Tc.detachEvent("onpropertychange",p_),Ec=Tc=null)}function p_(n){if(n.propertyName==="value"&&Ph(Ec)){var r=[];u_(r,Ec,n,Xn(n)),lr(iI,r)}}function sI(n,r,o){n==="focusin"?(m_(),Tc=r,Ec=o,Tc.attachEvent("onpropertychange",p_)):n==="focusout"&&m_()}function rI(n){if(n==="selectionchange"||n==="keyup"||n==="keydown")return Ph(Ec)}function aI(n,r){if(n==="click")return Ph(r)}function oI(n,r){if(n==="input"||n==="change")return Ph(r)}function lI(n,r){return n===r&&(n!==0||1/n===1/r)||n!==n&&r!==r}var On=typeof Object.is=="function"?Object.is:lI;function xc(n,r){if(On(n,r))return!0;if(typeof n!="object"||n===null||typeof r!="object"||r===null)return!1;var o=Object.keys(n),u=Object.keys(r);if(o.length!==u.length)return!1;for(u=0;u<o.length;u++){var m=o[u];if(!He.call(r,m)||!On(n[m],r[m]))return!1}return!0}function g_(n){for(;n&&n.firstChild;)n=n.firstChild;return n}function y_(n,r){var o=g_(n);n=0;for(var u;o;){if(o.nodeType===3){if(u=n+o.textContent.length,n<=r&&u>=r)return{node:o,offset:r-n};n=u}e:{for(;o;){if(o.nextSibling){o=o.nextSibling;break e}o=o.parentNode}o=void 0}o=g_(o)}}function v_(n,r){return n&&r?n===r?!0:n&&n.nodeType===3?!1:r&&r.nodeType===3?v_(n,r.parentNode):"contains"in n?n.contains(r):n.compareDocumentPosition?!!(n.compareDocumentPosition(r)&16):!1:!1}function __(n){n=n!=null&&n.ownerDocument!=null&&n.ownerDocument.defaultView!=null?n.ownerDocument.defaultView:window;for(var r=Hi(n.document);r instanceof n.HTMLIFrameElement;){try{var o=typeof r.contentWindow.location.href=="string"}catch{o=!1}if(o)n=r.contentWindow;else break;r=Hi(n.document)}return r}function Vm(n){var r=n&&n.nodeName&&n.nodeName.toLowerCase();return r&&(r==="input"&&(n.type==="text"||n.type==="search"||n.type==="tel"||n.type==="url"||n.type==="password")||r==="textarea"||n.contentEditable==="true")}var cI=Jn&&"documentMode"in document&&11>=document.documentMode,Do=null,Mm=null,Sc=null,Pm=!1;function b_(n,r,o){var u=o.window===o?o.document:o.nodeType===9?o:o.ownerDocument;Pm||Do==null||Do!==Hi(u)||(u=Do,"selectionStart"in u&&Vm(u)?u={start:u.selectionStart,end:u.selectionEnd}:(u=(u.ownerDocument&&u.ownerDocument.defaultView||window).getSelection(),u={anchorNode:u.anchorNode,anchorOffset:u.anchorOffset,focusNode:u.focusNode,focusOffset:u.focusOffset}),Sc&&xc(Sc,u)||(Sc=u,u=wd(Mm,"onSelect"),0<u.length&&(r=new Ki("onSelect","select",null,r,o),n.push({event:r,listeners:u}),r.target=Do)))}function Aa(n,r){var o={};return o[n.toLowerCase()]=r.toLowerCase(),o["Webkit"+n]="webkit"+r,o["Moz"+n]="moz"+r,o}var No={animationend:Aa("Animation","AnimationEnd"),animationiteration:Aa("Animation","AnimationIteration"),animationstart:Aa("Animation","AnimationStart"),transitionrun:Aa("Transition","TransitionRun"),transitionstart:Aa("Transition","TransitionStart"),transitioncancel:Aa("Transition","TransitionCancel"),transitionend:Aa("Transition","TransitionEnd")},Lm={},T_={};Jn&&(T_=document.createElement("div").style,"AnimationEvent"in window||(delete No.animationend.animation,delete No.animationiteration.animation,delete No.animationstart.animation),"TransitionEvent"in window||delete No.transitionend.transition);function Ia(n){if(Lm[n])return Lm[n];if(!No[n])return n;var r=No[n],o;for(o in r)if(r.hasOwnProperty(o)&&o in T_)return Lm[n]=r[o];return n}var E_=Ia("animationend"),x_=Ia("animationiteration"),S_=Ia("animationstart"),uI=Ia("transitionrun"),hI=Ia("transitionstart"),dI=Ia("transitioncancel"),w_=Ia("transitionend"),A_=new Map,Um="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");Um.push("scrollEnd");function Ei(n,r){A_.set(n,r),Fi(r,[n])}var Lh=typeof reportError=="function"?reportError:function(n){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var r=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof n=="object"&&n!==null&&typeof n.message=="string"?String(n.message):String(n),error:n});if(!window.dispatchEvent(r))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",n);return}console.error(n)},ei=[],jo=0,zm=0;function Uh(){for(var n=jo,r=zm=jo=0;r<n;){var o=ei[r];ei[r++]=null;var u=ei[r];ei[r++]=null;var m=ei[r];ei[r++]=null;var g=ei[r];if(ei[r++]=null,u!==null&&m!==null){var T=u.pending;T===null?m.next=m:(m.next=T.next,T.next=m),u.pending=m}g!==0&&I_(o,m,g)}}function zh(n,r,o,u){ei[jo++]=n,ei[jo++]=r,ei[jo++]=o,ei[jo++]=u,zm|=u,n.lanes|=u,n=n.alternate,n!==null&&(n.lanes|=u)}function Bm(n,r,o,u){return zh(n,r,o,u),Bh(n)}function Ca(n,r){return zh(n,null,null,r),Bh(n)}function I_(n,r,o){n.lanes|=o;var u=n.alternate;u!==null&&(u.lanes|=o);for(var m=!1,g=n.return;g!==null;)g.childLanes|=o,u=g.alternate,u!==null&&(u.childLanes|=o),g.tag===22&&(n=g.stateNode,n===null||n._visibility&1||(m=!0)),n=g,g=g.return;return n.tag===3?(g=n.stateNode,m&&r!==null&&(m=31-de(o),n=g.hiddenUpdates,u=n[m],u===null?n[m]=[r]:u.push(r),r.lane=o|536870912),g):null}function Bh(n){if(50<Qc)throw Qc=0,Yp=null,Error(i(185));for(var r=n.return;r!==null;)n=r,r=n.return;return n.tag===3?n.stateNode:null}var ko={};function fI(n,r,o,u){this.tag=n,this.key=o,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=r,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=u,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Vn(n,r,o,u){return new fI(n,r,o,u)}function Fm(n){return n=n.prototype,!(!n||!n.isReactComponent)}function xs(n,r){var o=n.alternate;return o===null?(o=Vn(n.tag,r,n.key,n.mode),o.elementType=n.elementType,o.type=n.type,o.stateNode=n.stateNode,o.alternate=n,n.alternate=o):(o.pendingProps=r,o.type=n.type,o.flags=0,o.subtreeFlags=0,o.deletions=null),o.flags=n.flags&65011712,o.childLanes=n.childLanes,o.lanes=n.lanes,o.child=n.child,o.memoizedProps=n.memoizedProps,o.memoizedState=n.memoizedState,o.updateQueue=n.updateQueue,r=n.dependencies,o.dependencies=r===null?null:{lanes:r.lanes,firstContext:r.firstContext},o.sibling=n.sibling,o.index=n.index,o.ref=n.ref,o.refCleanup=n.refCleanup,o}function C_(n,r){n.flags&=65011714;var o=n.alternate;return o===null?(n.childLanes=0,n.lanes=r,n.child=null,n.subtreeFlags=0,n.memoizedProps=null,n.memoizedState=null,n.updateQueue=null,n.dependencies=null,n.stateNode=null):(n.childLanes=o.childLanes,n.lanes=o.lanes,n.child=o.child,n.subtreeFlags=0,n.deletions=null,n.memoizedProps=o.memoizedProps,n.memoizedState=o.memoizedState,n.updateQueue=o.updateQueue,n.type=o.type,r=o.dependencies,n.dependencies=r===null?null:{lanes:r.lanes,firstContext:r.firstContext}),n}function Fh(n,r,o,u,m,g){var T=0;if(u=n,typeof n=="function")Fm(n)&&(T=1);else if(typeof n=="string")T=v2(n,o,re.current)?26:n==="html"||n==="head"||n==="body"?27:5;else e:switch(n){case A:return n=Vn(31,o,r,m),n.elementType=A,n.lanes=g,n;case D:return Ra(o.children,m,g,r);case M:T=8,m|=24;break;case Y:return n=Vn(12,o,r,m|2),n.elementType=Y,n.lanes=g,n;case ee:return n=Vn(13,o,r,m),n.elementType=ee,n.lanes=g,n;case se:return n=Vn(19,o,r,m),n.elementType=se,n.lanes=g,n;default:if(typeof n=="object"&&n!==null)switch(n.$$typeof){case $:T=10;break e;case Z:T=9;break e;case ne:T=11;break e;case w:T=14;break e;case C:T=16,u=null;break e}T=29,o=Error(i(130,n===null?"null":typeof n,"")),u=null}return r=Vn(T,o,r,m),r.elementType=n,r.type=u,r.lanes=g,r}function Ra(n,r,o,u){return n=Vn(7,n,u,r),n.lanes=o,n}function qm(n,r,o){return n=Vn(6,n,null,r),n.lanes=o,n}function R_(n){var r=Vn(18,null,null,0);return r.stateNode=n,r}function Hm(n,r,o){return r=Vn(4,n.children!==null?n.children:[],n.key,r),r.lanes=o,r.stateNode={containerInfo:n.containerInfo,pendingChildren:null,implementation:n.implementation},r}var D_=new WeakMap;function ti(n,r){if(typeof n=="object"&&n!==null){var o=D_.get(n);return o!==void 0?o:(r={value:n,source:r,stack:ki(r)},D_.set(n,r),r)}return{value:n,source:r,stack:ki(r)}}var Oo=[],Vo=0,qh=null,wc=0,ni=[],ii=0,dr=null,Xi=1,Ji="";function Ss(n,r){Oo[Vo++]=wc,Oo[Vo++]=qh,qh=n,wc=r}function N_(n,r,o){ni[ii++]=Xi,ni[ii++]=Ji,ni[ii++]=dr,dr=n;var u=Xi;n=Ji;var m=32-de(u)-1;u&=~(1<<m),o+=1;var g=32-de(r)+m;if(30<g){var T=m-m%5;g=(u&(1<<T)-1).toString(32),u>>=T,m-=T,Xi=1<<32-de(r)+m|o<<m|u,Ji=g+n}else Xi=1<<g|o<<m|u,Ji=n}function Gm(n){n.return!==null&&(Ss(n,1),N_(n,1,0))}function Qm(n){for(;n===qh;)qh=Oo[--Vo],Oo[Vo]=null,wc=Oo[--Vo],Oo[Vo]=null;for(;n===dr;)dr=ni[--ii],ni[ii]=null,Ji=ni[--ii],ni[ii]=null,Xi=ni[--ii],ni[ii]=null}function j_(n,r){ni[ii++]=Xi,ni[ii++]=Ji,ni[ii++]=dr,Xi=r.id,Ji=r.overflow,dr=n}var tn=null,gt=null,Ge=!1,fr=null,si=!1,Km=Error(i(519));function mr(n){var r=Error(i(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw Ac(ti(r,n)),Km}function k_(n){var r=n.stateNode,o=n.type,u=n.memoizedProps;switch(r[Vt]=n,r[$t]=u,o){case"dialog":Ue("cancel",r),Ue("close",r);break;case"iframe":case"object":case"embed":Ue("load",r);break;case"video":case"audio":for(o=0;o<$c.length;o++)Ue($c[o],r);break;case"source":Ue("error",r);break;case"img":case"image":case"link":Ue("error",r),Ue("load",r);break;case"details":Ue("toggle",r);break;case"input":Ue("invalid",r),Eh(r,u.value,u.defaultValue,u.checked,u.defaultChecked,u.type,u.name,!0);break;case"select":Ue("invalid",r);break;case"textarea":Ue("invalid",r),rr(r,u.value,u.defaultValue,u.children)}o=u.children,typeof o!="string"&&typeof o!="number"&&typeof o!="bigint"||r.textContent===""+o||u.suppressHydrationWarning===!0||Yb(r.textContent,o)?(u.popover!=null&&(Ue("beforetoggle",r),Ue("toggle",r)),u.onScroll!=null&&Ue("scroll",r),u.onScrollEnd!=null&&Ue("scrollend",r),u.onClick!=null&&(r.onclick=yi),r=!0):r=!1,r||mr(n,!0)}function O_(n){for(tn=n.return;tn;)switch(tn.tag){case 5:case 31:case 13:si=!1;return;case 27:case 3:si=!0;return;default:tn=tn.return}}function Mo(n){if(n!==tn)return!1;if(!Ge)return O_(n),Ge=!0,!1;var r=n.tag,o;if((o=r!==3&&r!==27)&&((o=r===5)&&(o=n.type,o=!(o!=="form"&&o!=="button")||hg(n.type,n.memoizedProps)),o=!o),o&&gt&&mr(n),O_(n),r===13){if(n=n.memoizedState,n=n!==null?n.dehydrated:null,!n)throw Error(i(317));gt=rT(n)}else if(r===31){if(n=n.memoizedState,n=n!==null?n.dehydrated:null,!n)throw Error(i(317));gt=rT(n)}else r===27?(r=gt,Cr(n.type)?(n=gg,gg=null,gt=n):gt=r):gt=tn?ai(n.stateNode.nextSibling):null;return!0}function Da(){gt=tn=null,Ge=!1}function $m(){var n=fr;return n!==null&&(An===null?An=n:An.push.apply(An,n),fr=null),n}function Ac(n){fr===null?fr=[n]:fr.push(n)}var Wm=U(null),Na=null,ws=null;function pr(n,r,o){ue(Wm,r._currentValue),r._currentValue=o}function As(n){n._currentValue=Wm.current,z(Wm)}function Ym(n,r,o){for(;n!==null;){var u=n.alternate;if((n.childLanes&r)!==r?(n.childLanes|=r,u!==null&&(u.childLanes|=r)):u!==null&&(u.childLanes&r)!==r&&(u.childLanes|=r),n===o)break;n=n.return}}function Xm(n,r,o,u){var m=n.child;for(m!==null&&(m.return=n);m!==null;){var g=m.dependencies;if(g!==null){var T=m.child;g=g.firstContext;e:for(;g!==null;){var S=g;g=m;for(var P=0;P<r.length;P++)if(S.context===r[P]){g.lanes|=o,S=g.alternate,S!==null&&(S.lanes|=o),Ym(g.return,o,n),u||(T=null);break e}g=S.next}}else if(m.tag===18){if(T=m.return,T===null)throw Error(i(341));T.lanes|=o,g=T.alternate,g!==null&&(g.lanes|=o),Ym(T,o,n),T=null}else T=m.child;if(T!==null)T.return=m;else for(T=m;T!==null;){if(T===n){T=null;break}if(m=T.sibling,m!==null){m.return=T.return,T=m;break}T=T.return}m=T}}function Po(n,r,o,u){n=null;for(var m=r,g=!1;m!==null;){if(!g){if((m.flags&524288)!==0)g=!0;else if((m.flags&262144)!==0)break}if(m.tag===10){var T=m.alternate;if(T===null)throw Error(i(387));if(T=T.memoizedProps,T!==null){var S=m.type;On(m.pendingProps.value,T.value)||(n!==null?n.push(S):n=[S])}}else if(m===Ne.current){if(T=m.alternate,T===null)throw Error(i(387));T.memoizedState.memoizedState!==m.memoizedState.memoizedState&&(n!==null?n.push(Zc):n=[Zc])}m=m.return}n!==null&&Xm(r,n,o,u),r.flags|=262144}function Hh(n){for(n=n.firstContext;n!==null;){if(!On(n.context._currentValue,n.memoizedValue))return!0;n=n.next}return!1}function ja(n){Na=n,ws=null,n=n.dependencies,n!==null&&(n.firstContext=null)}function nn(n){return V_(Na,n)}function Gh(n,r){return Na===null&&ja(n),V_(n,r)}function V_(n,r){var o=r._currentValue;if(r={context:r,memoizedValue:o,next:null},ws===null){if(n===null)throw Error(i(308));ws=r,n.dependencies={lanes:0,firstContext:r},n.flags|=524288}else ws=ws.next=r;return o}var mI=typeof AbortController<"u"?AbortController:function(){var n=[],r=this.signal={aborted:!1,addEventListener:function(o,u){n.push(u)}};this.abort=function(){r.aborted=!0,n.forEach(function(o){return o()})}},pI=s.unstable_scheduleCallback,gI=s.unstable_NormalPriority,Lt={$$typeof:$,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function Jm(){return{controller:new mI,data:new Map,refCount:0}}function Ic(n){n.refCount--,n.refCount===0&&pI(gI,function(){n.controller.abort()})}var Cc=null,Zm=0,Lo=0,Uo=null;function yI(n,r){if(Cc===null){var o=Cc=[];Zm=0,Lo=ng(),Uo={status:"pending",value:void 0,then:function(u){o.push(u)}}}return Zm++,r.then(M_,M_),r}function M_(){if(--Zm===0&&Cc!==null){Uo!==null&&(Uo.status="fulfilled");var n=Cc;Cc=null,Lo=0,Uo=null;for(var r=0;r<n.length;r++)(0,n[r])()}}function vI(n,r){var o=[],u={status:"pending",value:null,reason:null,then:function(m){o.push(m)}};return n.then(function(){u.status="fulfilled",u.value=r;for(var m=0;m<o.length;m++)(0,o[m])(r)},function(m){for(u.status="rejected",u.reason=m,m=0;m<o.length;m++)(0,o[m])(void 0)}),u}var P_=G.S;G.S=function(n,r){bb=vt(),typeof r=="object"&&r!==null&&typeof r.then=="function"&&yI(n,r),P_!==null&&P_(n,r)};var ka=U(null);function ep(){var n=ka.current;return n!==null?n:ht.pooledCache}function Qh(n,r){r===null?ue(ka,ka.current):ue(ka,r.pool)}function L_(){var n=ep();return n===null?null:{parent:Lt._currentValue,pool:n}}var zo=Error(i(460)),tp=Error(i(474)),Kh=Error(i(542)),$h={then:function(){}};function U_(n){return n=n.status,n==="fulfilled"||n==="rejected"}function z_(n,r,o){switch(o=n[o],o===void 0?n.push(r):o!==r&&(r.then(yi,yi),r=o),r.status){case"fulfilled":return r.value;case"rejected":throw n=r.reason,F_(n),n;default:if(typeof r.status=="string")r.then(yi,yi);else{if(n=ht,n!==null&&100<n.shellSuspendCounter)throw Error(i(482));n=r,n.status="pending",n.then(function(u){if(r.status==="pending"){var m=r;m.status="fulfilled",m.value=u}},function(u){if(r.status==="pending"){var m=r;m.status="rejected",m.reason=u}})}switch(r.status){case"fulfilled":return r.value;case"rejected":throw n=r.reason,F_(n),n}throw Va=r,zo}}function Oa(n){try{var r=n._init;return r(n._payload)}catch(o){throw o!==null&&typeof o=="object"&&typeof o.then=="function"?(Va=o,zo):o}}var Va=null;function B_(){if(Va===null)throw Error(i(459));var n=Va;return Va=null,n}function F_(n){if(n===zo||n===Kh)throw Error(i(483))}var Bo=null,Rc=0;function Wh(n){var r=Rc;return Rc+=1,Bo===null&&(Bo=[]),z_(Bo,n,r)}function Dc(n,r){r=r.props.ref,n.ref=r!==void 0?r:null}function Yh(n,r){throw r.$$typeof===x?Error(i(525)):(n=Object.prototype.toString.call(r),Error(i(31,n==="[object Object]"?"object with keys {"+Object.keys(r).join(", ")+"}":n)))}function q_(n){function r(F,B){if(n){var Q=F.deletions;Q===null?(F.deletions=[B],F.flags|=16):Q.push(B)}}function o(F,B){if(!n)return null;for(;B!==null;)r(F,B),B=B.sibling;return null}function u(F){for(var B=new Map;F!==null;)F.key!==null?B.set(F.key,F):B.set(F.index,F),F=F.sibling;return B}function m(F,B){return F=xs(F,B),F.index=0,F.sibling=null,F}function g(F,B,Q){return F.index=Q,n?(Q=F.alternate,Q!==null?(Q=Q.index,Q<B?(F.flags|=67108866,B):Q):(F.flags|=67108866,B)):(F.flags|=1048576,B)}function T(F){return n&&F.alternate===null&&(F.flags|=67108866),F}function S(F,B,Q,ae){return B===null||B.tag!==6?(B=qm(Q,F.mode,ae),B.return=F,B):(B=m(B,Q),B.return=F,B)}function P(F,B,Q,ae){var Ae=Q.type;return Ae===D?ie(F,B,Q.props.children,ae,Q.key):B!==null&&(B.elementType===Ae||typeof Ae=="object"&&Ae!==null&&Ae.$$typeof===C&&Oa(Ae)===B.type)?(B=m(B,Q.props),Dc(B,Q),B.return=F,B):(B=Fh(Q.type,Q.key,Q.props,null,F.mode,ae),Dc(B,Q),B.return=F,B)}function K(F,B,Q,ae){return B===null||B.tag!==4||B.stateNode.containerInfo!==Q.containerInfo||B.stateNode.implementation!==Q.implementation?(B=Hm(Q,F.mode,ae),B.return=F,B):(B=m(B,Q.children||[]),B.return=F,B)}function ie(F,B,Q,ae,Ae){return B===null||B.tag!==7?(B=Ra(Q,F.mode,ae,Ae),B.return=F,B):(B=m(B,Q),B.return=F,B)}function le(F,B,Q){if(typeof B=="string"&&B!==""||typeof B=="number"||typeof B=="bigint")return B=qm(""+B,F.mode,Q),B.return=F,B;if(typeof B=="object"&&B!==null){switch(B.$$typeof){case k:return Q=Fh(B.type,B.key,B.props,null,F.mode,Q),Dc(Q,B),Q.return=F,Q;case O:return B=Hm(B,F.mode,Q),B.return=F,B;case C:return B=Oa(B),le(F,B,Q)}if(Te(B)||L(B))return B=Ra(B,F.mode,Q,null),B.return=F,B;if(typeof B.then=="function")return le(F,Wh(B),Q);if(B.$$typeof===$)return le(F,Gh(F,B),Q);Yh(F,B)}return null}function W(F,B,Q,ae){var Ae=B!==null?B.key:null;if(typeof Q=="string"&&Q!==""||typeof Q=="number"||typeof Q=="bigint")return Ae!==null?null:S(F,B,""+Q,ae);if(typeof Q=="object"&&Q!==null){switch(Q.$$typeof){case k:return Q.key===Ae?P(F,B,Q,ae):null;case O:return Q.key===Ae?K(F,B,Q,ae):null;case C:return Q=Oa(Q),W(F,B,Q,ae)}if(Te(Q)||L(Q))return Ae!==null?null:ie(F,B,Q,ae,null);if(typeof Q.then=="function")return W(F,B,Wh(Q),ae);if(Q.$$typeof===$)return W(F,B,Gh(F,Q),ae);Yh(F,Q)}return null}function J(F,B,Q,ae,Ae){if(typeof ae=="string"&&ae!==""||typeof ae=="number"||typeof ae=="bigint")return F=F.get(Q)||null,S(B,F,""+ae,Ae);if(typeof ae=="object"&&ae!==null){switch(ae.$$typeof){case k:return F=F.get(ae.key===null?Q:ae.key)||null,P(B,F,ae,Ae);case O:return F=F.get(ae.key===null?Q:ae.key)||null,K(B,F,ae,Ae);case C:return ae=Oa(ae),J(F,B,Q,ae,Ae)}if(Te(ae)||L(ae))return F=F.get(Q)||null,ie(B,F,ae,Ae,null);if(typeof ae.then=="function")return J(F,B,Q,Wh(ae),Ae);if(ae.$$typeof===$)return J(F,B,Q,Gh(B,ae),Ae);Yh(B,ae)}return null}function ve(F,B,Q,ae){for(var Ae=null,Ye=null,Ee=B,Ve=B=0,Be=null;Ee!==null&&Ve<Q.length;Ve++){Ee.index>Ve?(Be=Ee,Ee=null):Be=Ee.sibling;var Xe=W(F,Ee,Q[Ve],ae);if(Xe===null){Ee===null&&(Ee=Be);break}n&&Ee&&Xe.alternate===null&&r(F,Ee),B=g(Xe,B,Ve),Ye===null?Ae=Xe:Ye.sibling=Xe,Ye=Xe,Ee=Be}if(Ve===Q.length)return o(F,Ee),Ge&&Ss(F,Ve),Ae;if(Ee===null){for(;Ve<Q.length;Ve++)Ee=le(F,Q[Ve],ae),Ee!==null&&(B=g(Ee,B,Ve),Ye===null?Ae=Ee:Ye.sibling=Ee,Ye=Ee);return Ge&&Ss(F,Ve),Ae}for(Ee=u(Ee);Ve<Q.length;Ve++)Be=J(Ee,F,Ve,Q[Ve],ae),Be!==null&&(n&&Be.alternate!==null&&Ee.delete(Be.key===null?Ve:Be.key),B=g(Be,B,Ve),Ye===null?Ae=Be:Ye.sibling=Be,Ye=Be);return n&&Ee.forEach(function(kr){return r(F,kr)}),Ge&&Ss(F,Ve),Ae}function Ce(F,B,Q,ae){if(Q==null)throw Error(i(151));for(var Ae=null,Ye=null,Ee=B,Ve=B=0,Be=null,Xe=Q.next();Ee!==null&&!Xe.done;Ve++,Xe=Q.next()){Ee.index>Ve?(Be=Ee,Ee=null):Be=Ee.sibling;var kr=W(F,Ee,Xe.value,ae);if(kr===null){Ee===null&&(Ee=Be);break}n&&Ee&&kr.alternate===null&&r(F,Ee),B=g(kr,B,Ve),Ye===null?Ae=kr:Ye.sibling=kr,Ye=kr,Ee=Be}if(Xe.done)return o(F,Ee),Ge&&Ss(F,Ve),Ae;if(Ee===null){for(;!Xe.done;Ve++,Xe=Q.next())Xe=le(F,Xe.value,ae),Xe!==null&&(B=g(Xe,B,Ve),Ye===null?Ae=Xe:Ye.sibling=Xe,Ye=Xe);return Ge&&Ss(F,Ve),Ae}for(Ee=u(Ee);!Xe.done;Ve++,Xe=Q.next())Xe=J(Ee,F,Ve,Xe.value,ae),Xe!==null&&(n&&Xe.alternate!==null&&Ee.delete(Xe.key===null?Ve:Xe.key),B=g(Xe,B,Ve),Ye===null?Ae=Xe:Ye.sibling=Xe,Ye=Xe);return n&&Ee.forEach(function(R2){return r(F,R2)}),Ge&&Ss(F,Ve),Ae}function ct(F,B,Q,ae){if(typeof Q=="object"&&Q!==null&&Q.type===D&&Q.key===null&&(Q=Q.props.children),typeof Q=="object"&&Q!==null){switch(Q.$$typeof){case k:e:{for(var Ae=Q.key;B!==null;){if(B.key===Ae){if(Ae=Q.type,Ae===D){if(B.tag===7){o(F,B.sibling),ae=m(B,Q.props.children),ae.return=F,F=ae;break e}}else if(B.elementType===Ae||typeof Ae=="object"&&Ae!==null&&Ae.$$typeof===C&&Oa(Ae)===B.type){o(F,B.sibling),ae=m(B,Q.props),Dc(ae,Q),ae.return=F,F=ae;break e}o(F,B);break}else r(F,B);B=B.sibling}Q.type===D?(ae=Ra(Q.props.children,F.mode,ae,Q.key),ae.return=F,F=ae):(ae=Fh(Q.type,Q.key,Q.props,null,F.mode,ae),Dc(ae,Q),ae.return=F,F=ae)}return T(F);case O:e:{for(Ae=Q.key;B!==null;){if(B.key===Ae)if(B.tag===4&&B.stateNode.containerInfo===Q.containerInfo&&B.stateNode.implementation===Q.implementation){o(F,B.sibling),ae=m(B,Q.children||[]),ae.return=F,F=ae;break e}else{o(F,B);break}else r(F,B);B=B.sibling}ae=Hm(Q,F.mode,ae),ae.return=F,F=ae}return T(F);case C:return Q=Oa(Q),ct(F,B,Q,ae)}if(Te(Q))return ve(F,B,Q,ae);if(L(Q)){if(Ae=L(Q),typeof Ae!="function")throw Error(i(150));return Q=Ae.call(Q),Ce(F,B,Q,ae)}if(typeof Q.then=="function")return ct(F,B,Wh(Q),ae);if(Q.$$typeof===$)return ct(F,B,Gh(F,Q),ae);Yh(F,Q)}return typeof Q=="string"&&Q!==""||typeof Q=="number"||typeof Q=="bigint"?(Q=""+Q,B!==null&&B.tag===6?(o(F,B.sibling),ae=m(B,Q),ae.return=F,F=ae):(o(F,B),ae=qm(Q,F.mode,ae),ae.return=F,F=ae),T(F)):o(F,B)}return function(F,B,Q,ae){try{Rc=0;var Ae=ct(F,B,Q,ae);return Bo=null,Ae}catch(Ee){if(Ee===zo||Ee===Kh)throw Ee;var Ye=Vn(29,Ee,null,F.mode);return Ye.lanes=ae,Ye.return=F,Ye}}}var Ma=q_(!0),H_=q_(!1),gr=!1;function np(n){n.updateQueue={baseState:n.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function ip(n,r){n=n.updateQueue,r.updateQueue===n&&(r.updateQueue={baseState:n.baseState,firstBaseUpdate:n.firstBaseUpdate,lastBaseUpdate:n.lastBaseUpdate,shared:n.shared,callbacks:null})}function yr(n){return{lane:n,tag:0,payload:null,callback:null,next:null}}function vr(n,r,o){var u=n.updateQueue;if(u===null)return null;if(u=u.shared,(Ze&2)!==0){var m=u.pending;return m===null?r.next=r:(r.next=m.next,m.next=r),u.pending=r,r=Bh(n),I_(n,null,o),r}return zh(n,u,r,o),Bh(n)}function Nc(n,r,o){if(r=r.updateQueue,r!==null&&(r=r.shared,(o&4194048)!==0)){var u=r.lanes;u&=n.pendingLanes,o|=u,r.lanes=o,sc(n,o)}}function sp(n,r){var o=n.updateQueue,u=n.alternate;if(u!==null&&(u=u.updateQueue,o===u)){var m=null,g=null;if(o=o.firstBaseUpdate,o!==null){do{var T={lane:o.lane,tag:o.tag,payload:o.payload,callback:null,next:null};g===null?m=g=T:g=g.next=T,o=o.next}while(o!==null);g===null?m=g=r:g=g.next=r}else m=g=r;o={baseState:u.baseState,firstBaseUpdate:m,lastBaseUpdate:g,shared:u.shared,callbacks:u.callbacks},n.updateQueue=o;return}n=o.lastBaseUpdate,n===null?o.firstBaseUpdate=r:n.next=r,o.lastBaseUpdate=r}var rp=!1;function jc(){if(rp){var n=Uo;if(n!==null)throw n}}function kc(n,r,o,u){rp=!1;var m=n.updateQueue;gr=!1;var g=m.firstBaseUpdate,T=m.lastBaseUpdate,S=m.shared.pending;if(S!==null){m.shared.pending=null;var P=S,K=P.next;P.next=null,T===null?g=K:T.next=K,T=P;var ie=n.alternate;ie!==null&&(ie=ie.updateQueue,S=ie.lastBaseUpdate,S!==T&&(S===null?ie.firstBaseUpdate=K:S.next=K,ie.lastBaseUpdate=P))}if(g!==null){var le=m.baseState;T=0,ie=K=P=null,S=g;do{var W=S.lane&-536870913,J=W!==S.lane;if(J?(ze&W)===W:(u&W)===W){W!==0&&W===Lo&&(rp=!0),ie!==null&&(ie=ie.next={lane:0,tag:S.tag,payload:S.payload,callback:null,next:null});e:{var ve=n,Ce=S;W=r;var ct=o;switch(Ce.tag){case 1:if(ve=Ce.payload,typeof ve=="function"){le=ve.call(ct,le,W);break e}le=ve;break e;case 3:ve.flags=ve.flags&-65537|128;case 0:if(ve=Ce.payload,W=typeof ve=="function"?ve.call(ct,le,W):ve,W==null)break e;le=b({},le,W);break e;case 2:gr=!0}}W=S.callback,W!==null&&(n.flags|=64,J&&(n.flags|=8192),J=m.callbacks,J===null?m.callbacks=[W]:J.push(W))}else J={lane:W,tag:S.tag,payload:S.payload,callback:S.callback,next:null},ie===null?(K=ie=J,P=le):ie=ie.next=J,T|=W;if(S=S.next,S===null){if(S=m.shared.pending,S===null)break;J=S,S=J.next,J.next=null,m.lastBaseUpdate=J,m.shared.pending=null}}while(!0);ie===null&&(P=le),m.baseState=P,m.firstBaseUpdate=K,m.lastBaseUpdate=ie,g===null&&(m.shared.lanes=0),xr|=T,n.lanes=T,n.memoizedState=le}}function G_(n,r){if(typeof n!="function")throw Error(i(191,n));n.call(r)}function Q_(n,r){var o=n.callbacks;if(o!==null)for(n.callbacks=null,n=0;n<o.length;n++)G_(o[n],r)}var Fo=U(null),Xh=U(0);function K_(n,r){n=Vs,ue(Xh,n),ue(Fo,r),Vs=n|r.baseLanes}function ap(){ue(Xh,Vs),ue(Fo,Fo.current)}function op(){Vs=Xh.current,z(Fo),z(Xh)}var Mn=U(null),ri=null;function _r(n){var r=n.alternate;ue(Nt,Nt.current&1),ue(Mn,n),ri===null&&(r===null||Fo.current!==null||r.memoizedState!==null)&&(ri=n)}function lp(n){ue(Nt,Nt.current),ue(Mn,n),ri===null&&(ri=n)}function $_(n){n.tag===22?(ue(Nt,Nt.current),ue(Mn,n),ri===null&&(ri=n)):br()}function br(){ue(Nt,Nt.current),ue(Mn,Mn.current)}function Pn(n){z(Mn),ri===n&&(ri=null),z(Nt)}var Nt=U(0);function Jh(n){for(var r=n;r!==null;){if(r.tag===13){var o=r.memoizedState;if(o!==null&&(o=o.dehydrated,o===null||mg(o)||pg(o)))return r}else if(r.tag===19&&(r.memoizedProps.revealOrder==="forwards"||r.memoizedProps.revealOrder==="backwards"||r.memoizedProps.revealOrder==="unstable_legacy-backwards"||r.memoizedProps.revealOrder==="together")){if((r.flags&128)!==0)return r}else if(r.child!==null){r.child.return=r,r=r.child;continue}if(r===n)break;for(;r.sibling===null;){if(r.return===null||r.return===n)return null;r=r.return}r.sibling.return=r.return,r=r.sibling}return null}var Is=0,Oe=null,ot=null,Ut=null,Zh=!1,qo=!1,Pa=!1,ed=0,Oc=0,Ho=null,_I=0;function It(){throw Error(i(321))}function cp(n,r){if(r===null)return!1;for(var o=0;o<r.length&&o<n.length;o++)if(!On(n[o],r[o]))return!1;return!0}function up(n,r,o,u,m,g){return Is=g,Oe=r,r.memoizedState=null,r.updateQueue=null,r.lanes=0,G.H=n===null||n.memoizedState===null?N0:wp,Pa=!1,g=o(u,m),Pa=!1,qo&&(g=Y_(r,o,u,m)),W_(n),g}function W_(n){G.H=Pc;var r=ot!==null&&ot.next!==null;if(Is=0,Ut=ot=Oe=null,Zh=!1,Oc=0,Ho=null,r)throw Error(i(300));n===null||zt||(n=n.dependencies,n!==null&&Hh(n)&&(zt=!0))}function Y_(n,r,o,u){Oe=n;var m=0;do{if(qo&&(Ho=null),Oc=0,qo=!1,25<=m)throw Error(i(301));if(m+=1,Ut=ot=null,n.updateQueue!=null){var g=n.updateQueue;g.lastEffect=null,g.events=null,g.stores=null,g.memoCache!=null&&(g.memoCache.index=0)}G.H=j0,g=r(o,u)}while(qo);return g}function bI(){var n=G.H,r=n.useState()[0];return r=typeof r.then=="function"?Vc(r):r,n=n.useState()[0],(ot!==null?ot.memoizedState:null)!==n&&(Oe.flags|=1024),r}function hp(){var n=ed!==0;return ed=0,n}function dp(n,r,o){r.updateQueue=n.updateQueue,r.flags&=-2053,n.lanes&=~o}function fp(n){if(Zh){for(n=n.memoizedState;n!==null;){var r=n.queue;r!==null&&(r.pending=null),n=n.next}Zh=!1}Is=0,Ut=ot=Oe=null,qo=!1,Oc=ed=0,Ho=null}function vn(){var n={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Ut===null?Oe.memoizedState=Ut=n:Ut=Ut.next=n,Ut}function jt(){if(ot===null){var n=Oe.alternate;n=n!==null?n.memoizedState:null}else n=ot.next;var r=Ut===null?Oe.memoizedState:Ut.next;if(r!==null)Ut=r,ot=n;else{if(n===null)throw Oe.alternate===null?Error(i(467)):Error(i(310));ot=n,n={memoizedState:ot.memoizedState,baseState:ot.baseState,baseQueue:ot.baseQueue,queue:ot.queue,next:null},Ut===null?Oe.memoizedState=Ut=n:Ut=Ut.next=n}return Ut}function td(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function Vc(n){var r=Oc;return Oc+=1,Ho===null&&(Ho=[]),n=z_(Ho,n,r),r=Oe,(Ut===null?r.memoizedState:Ut.next)===null&&(r=r.alternate,G.H=r===null||r.memoizedState===null?N0:wp),n}function nd(n){if(n!==null&&typeof n=="object"){if(typeof n.then=="function")return Vc(n);if(n.$$typeof===$)return nn(n)}throw Error(i(438,String(n)))}function mp(n){var r=null,o=Oe.updateQueue;if(o!==null&&(r=o.memoCache),r==null){var u=Oe.alternate;u!==null&&(u=u.updateQueue,u!==null&&(u=u.memoCache,u!=null&&(r={data:u.data.map(function(m){return m.slice()}),index:0})))}if(r==null&&(r={data:[],index:0}),o===null&&(o=td(),Oe.updateQueue=o),o.memoCache=r,o=r.data[r.index],o===void 0)for(o=r.data[r.index]=Array(n),u=0;u<n;u++)o[u]=R;return r.index++,o}function Cs(n,r){return typeof r=="function"?r(n):r}function id(n){var r=jt();return pp(r,ot,n)}function pp(n,r,o){var u=n.queue;if(u===null)throw Error(i(311));u.lastRenderedReducer=o;var m=n.baseQueue,g=u.pending;if(g!==null){if(m!==null){var T=m.next;m.next=g.next,g.next=T}r.baseQueue=m=g,u.pending=null}if(g=n.baseState,m===null)n.memoizedState=g;else{r=m.next;var S=T=null,P=null,K=r,ie=!1;do{var le=K.lane&-536870913;if(le!==K.lane?(ze&le)===le:(Is&le)===le){var W=K.revertLane;if(W===0)P!==null&&(P=P.next={lane:0,revertLane:0,gesture:null,action:K.action,hasEagerState:K.hasEagerState,eagerState:K.eagerState,next:null}),le===Lo&&(ie=!0);else if((Is&W)===W){K=K.next,W===Lo&&(ie=!0);continue}else le={lane:0,revertLane:K.revertLane,gesture:null,action:K.action,hasEagerState:K.hasEagerState,eagerState:K.eagerState,next:null},P===null?(S=P=le,T=g):P=P.next=le,Oe.lanes|=W,xr|=W;le=K.action,Pa&&o(g,le),g=K.hasEagerState?K.eagerState:o(g,le)}else W={lane:le,revertLane:K.revertLane,gesture:K.gesture,action:K.action,hasEagerState:K.hasEagerState,eagerState:K.eagerState,next:null},P===null?(S=P=W,T=g):P=P.next=W,Oe.lanes|=le,xr|=le;K=K.next}while(K!==null&&K!==r);if(P===null?T=g:P.next=S,!On(g,n.memoizedState)&&(zt=!0,ie&&(o=Uo,o!==null)))throw o;n.memoizedState=g,n.baseState=T,n.baseQueue=P,u.lastRenderedState=g}return m===null&&(u.lanes=0),[n.memoizedState,u.dispatch]}function gp(n){var r=jt(),o=r.queue;if(o===null)throw Error(i(311));o.lastRenderedReducer=n;var u=o.dispatch,m=o.pending,g=r.memoizedState;if(m!==null){o.pending=null;var T=m=m.next;do g=n(g,T.action),T=T.next;while(T!==m);On(g,r.memoizedState)||(zt=!0),r.memoizedState=g,r.baseQueue===null&&(r.baseState=g),o.lastRenderedState=g}return[g,u]}function X_(n,r,o){var u=Oe,m=jt(),g=Ge;if(g){if(o===void 0)throw Error(i(407));o=o()}else o=r();var T=!On((ot||m).memoizedState,o);if(T&&(m.memoizedState=o,zt=!0),m=m.queue,_p(e0.bind(null,u,m,n),[n]),m.getSnapshot!==r||T||Ut!==null&&Ut.memoizedState.tag&1){if(u.flags|=2048,Go(9,{destroy:void 0},Z_.bind(null,u,m,o,r),null),ht===null)throw Error(i(349));g||(Is&127)!==0||J_(u,r,o)}return o}function J_(n,r,o){n.flags|=16384,n={getSnapshot:r,value:o},r=Oe.updateQueue,r===null?(r=td(),Oe.updateQueue=r,r.stores=[n]):(o=r.stores,o===null?r.stores=[n]:o.push(n))}function Z_(n,r,o,u){r.value=o,r.getSnapshot=u,t0(r)&&n0(n)}function e0(n,r,o){return o(function(){t0(r)&&n0(n)})}function t0(n){var r=n.getSnapshot;n=n.value;try{var o=r();return!On(n,o)}catch{return!0}}function n0(n){var r=Ca(n,2);r!==null&&In(r,n,2)}function yp(n){var r=vn();if(typeof n=="function"){var o=n;if(n=o(),Pa){bn(!0);try{o()}finally{bn(!1)}}}return r.memoizedState=r.baseState=n,r.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Cs,lastRenderedState:n},r}function i0(n,r,o,u){return n.baseState=o,pp(n,ot,typeof u=="function"?u:Cs)}function TI(n,r,o,u,m){if(ad(n))throw Error(i(485));if(n=r.action,n!==null){var g={payload:m,action:n,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(T){g.listeners.push(T)}};G.T!==null?o(!0):g.isTransition=!1,u(g),o=r.pending,o===null?(g.next=r.pending=g,s0(r,g)):(g.next=o.next,r.pending=o.next=g)}}function s0(n,r){var o=r.action,u=r.payload,m=n.state;if(r.isTransition){var g=G.T,T={};G.T=T;try{var S=o(m,u),P=G.S;P!==null&&P(T,S),r0(n,r,S)}catch(K){vp(n,r,K)}finally{g!==null&&T.types!==null&&(g.types=T.types),G.T=g}}else try{g=o(m,u),r0(n,r,g)}catch(K){vp(n,r,K)}}function r0(n,r,o){o!==null&&typeof o=="object"&&typeof o.then=="function"?o.then(function(u){a0(n,r,u)},function(u){return vp(n,r,u)}):a0(n,r,o)}function a0(n,r,o){r.status="fulfilled",r.value=o,o0(r),n.state=o,r=n.pending,r!==null&&(o=r.next,o===r?n.pending=null:(o=o.next,r.next=o,s0(n,o)))}function vp(n,r,o){var u=n.pending;if(n.pending=null,u!==null){u=u.next;do r.status="rejected",r.reason=o,o0(r),r=r.next;while(r!==u)}n.action=null}function o0(n){n=n.listeners;for(var r=0;r<n.length;r++)(0,n[r])()}function l0(n,r){return r}function c0(n,r){if(Ge){var o=ht.formState;if(o!==null){e:{var u=Oe;if(Ge){if(gt){t:{for(var m=gt,g=si;m.nodeType!==8;){if(!g){m=null;break t}if(m=ai(m.nextSibling),m===null){m=null;break t}}g=m.data,m=g==="F!"||g==="F"?m:null}if(m){gt=ai(m.nextSibling),u=m.data==="F!";break e}}mr(u)}u=!1}u&&(r=o[0])}}return o=vn(),o.memoizedState=o.baseState=r,u={pending:null,lanes:0,dispatch:null,lastRenderedReducer:l0,lastRenderedState:r},o.queue=u,o=C0.bind(null,Oe,u),u.dispatch=o,u=yp(!1),g=Sp.bind(null,Oe,!1,u.queue),u=vn(),m={state:r,dispatch:null,action:n,pending:null},u.queue=m,o=TI.bind(null,Oe,m,g,o),m.dispatch=o,u.memoizedState=n,[r,o,!1]}function u0(n){var r=jt();return h0(r,ot,n)}function h0(n,r,o){if(r=pp(n,r,l0)[0],n=id(Cs)[0],typeof r=="object"&&r!==null&&typeof r.then=="function")try{var u=Vc(r)}catch(T){throw T===zo?Kh:T}else u=r;r=jt();var m=r.queue,g=m.dispatch;return o!==r.memoizedState&&(Oe.flags|=2048,Go(9,{destroy:void 0},EI.bind(null,m,o),null)),[u,g,n]}function EI(n,r){n.action=r}function d0(n){var r=jt(),o=ot;if(o!==null)return h0(r,o,n);jt(),r=r.memoizedState,o=jt();var u=o.queue.dispatch;return o.memoizedState=n,[r,u,!1]}function Go(n,r,o,u){return n={tag:n,create:o,deps:u,inst:r,next:null},r=Oe.updateQueue,r===null&&(r=td(),Oe.updateQueue=r),o=r.lastEffect,o===null?r.lastEffect=n.next=n:(u=o.next,o.next=n,n.next=u,r.lastEffect=n),n}function f0(){return jt().memoizedState}function sd(n,r,o,u){var m=vn();Oe.flags|=n,m.memoizedState=Go(1|r,{destroy:void 0},o,u===void 0?null:u)}function rd(n,r,o,u){var m=jt();u=u===void 0?null:u;var g=m.memoizedState.inst;ot!==null&&u!==null&&cp(u,ot.memoizedState.deps)?m.memoizedState=Go(r,g,o,u):(Oe.flags|=n,m.memoizedState=Go(1|r,g,o,u))}function m0(n,r){sd(8390656,8,n,r)}function _p(n,r){rd(2048,8,n,r)}function xI(n){Oe.flags|=4;var r=Oe.updateQueue;if(r===null)r=td(),Oe.updateQueue=r,r.events=[n];else{var o=r.events;o===null?r.events=[n]:o.push(n)}}function p0(n){var r=jt().memoizedState;return xI({ref:r,nextImpl:n}),function(){if((Ze&2)!==0)throw Error(i(440));return r.impl.apply(void 0,arguments)}}function g0(n,r){return rd(4,2,n,r)}function y0(n,r){return rd(4,4,n,r)}function v0(n,r){if(typeof r=="function"){n=n();var o=r(n);return function(){typeof o=="function"?o():r(null)}}if(r!=null)return n=n(),r.current=n,function(){r.current=null}}function _0(n,r,o){o=o!=null?o.concat([n]):null,rd(4,4,v0.bind(null,r,n),o)}function bp(){}function b0(n,r){var o=jt();r=r===void 0?null:r;var u=o.memoizedState;return r!==null&&cp(r,u[1])?u[0]:(o.memoizedState=[n,r],n)}function T0(n,r){var o=jt();r=r===void 0?null:r;var u=o.memoizedState;if(r!==null&&cp(r,u[1]))return u[0];if(u=n(),Pa){bn(!0);try{n()}finally{bn(!1)}}return o.memoizedState=[u,r],u}function Tp(n,r,o){return o===void 0||(Is&1073741824)!==0&&(ze&261930)===0?n.memoizedState=r:(n.memoizedState=o,n=Eb(),Oe.lanes|=n,xr|=n,o)}function E0(n,r,o,u){return On(o,r)?o:Fo.current!==null?(n=Tp(n,o,u),On(n,r)||(zt=!0),n):(Is&42)===0||(Is&1073741824)!==0&&(ze&261930)===0?(zt=!0,n.memoizedState=o):(n=Eb(),Oe.lanes|=n,xr|=n,r)}function x0(n,r,o,u,m){var g=oe.p;oe.p=g!==0&&8>g?g:8;var T=G.T,S={};G.T=S,Sp(n,!1,r,o);try{var P=m(),K=G.S;if(K!==null&&K(S,P),P!==null&&typeof P=="object"&&typeof P.then=="function"){var ie=vI(P,u);Mc(n,r,ie,zn(n))}else Mc(n,r,u,zn(n))}catch(le){Mc(n,r,{then:function(){},status:"rejected",reason:le},zn())}finally{oe.p=g,T!==null&&S.types!==null&&(T.types=S.types),G.T=T}}function SI(){}function Ep(n,r,o,u){if(n.tag!==5)throw Error(i(476));var m=S0(n).queue;x0(n,m,r,pe,o===null?SI:function(){return w0(n),o(u)})}function S0(n){var r=n.memoizedState;if(r!==null)return r;r={memoizedState:pe,baseState:pe,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Cs,lastRenderedState:pe},next:null};var o={};return r.next={memoizedState:o,baseState:o,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Cs,lastRenderedState:o},next:null},n.memoizedState=r,n=n.alternate,n!==null&&(n.memoizedState=r),r}function w0(n){var r=S0(n);r.next===null&&(r=n.alternate.memoizedState),Mc(n,r.next.queue,{},zn())}function xp(){return nn(Zc)}function A0(){return jt().memoizedState}function I0(){return jt().memoizedState}function wI(n){for(var r=n.return;r!==null;){switch(r.tag){case 24:case 3:var o=zn();n=yr(o);var u=vr(r,n,o);u!==null&&(In(u,r,o),Nc(u,r,o)),r={cache:Jm()},n.payload=r;return}r=r.return}}function AI(n,r,o){var u=zn();o={lane:u,revertLane:0,gesture:null,action:o,hasEagerState:!1,eagerState:null,next:null},ad(n)?R0(r,o):(o=Bm(n,r,o,u),o!==null&&(In(o,n,u),D0(o,r,u)))}function C0(n,r,o){var u=zn();Mc(n,r,o,u)}function Mc(n,r,o,u){var m={lane:u,revertLane:0,gesture:null,action:o,hasEagerState:!1,eagerState:null,next:null};if(ad(n))R0(r,m);else{var g=n.alternate;if(n.lanes===0&&(g===null||g.lanes===0)&&(g=r.lastRenderedReducer,g!==null))try{var T=r.lastRenderedState,S=g(T,o);if(m.hasEagerState=!0,m.eagerState=S,On(S,T))return zh(n,r,m,0),ht===null&&Uh(),!1}catch{}if(o=Bm(n,r,m,u),o!==null)return In(o,n,u),D0(o,r,u),!0}return!1}function Sp(n,r,o,u){if(u={lane:2,revertLane:ng(),gesture:null,action:u,hasEagerState:!1,eagerState:null,next:null},ad(n)){if(r)throw Error(i(479))}else r=Bm(n,o,u,2),r!==null&&In(r,n,2)}function ad(n){var r=n.alternate;return n===Oe||r!==null&&r===Oe}function R0(n,r){qo=Zh=!0;var o=n.pending;o===null?r.next=r:(r.next=o.next,o.next=r),n.pending=r}function D0(n,r,o){if((o&4194048)!==0){var u=r.lanes;u&=n.pendingLanes,o|=u,r.lanes=o,sc(n,o)}}var Pc={readContext:nn,use:nd,useCallback:It,useContext:It,useEffect:It,useImperativeHandle:It,useLayoutEffect:It,useInsertionEffect:It,useMemo:It,useReducer:It,useRef:It,useState:It,useDebugValue:It,useDeferredValue:It,useTransition:It,useSyncExternalStore:It,useId:It,useHostTransitionStatus:It,useFormState:It,useActionState:It,useOptimistic:It,useMemoCache:It,useCacheRefresh:It};Pc.useEffectEvent=It;var N0={readContext:nn,use:nd,useCallback:function(n,r){return vn().memoizedState=[n,r===void 0?null:r],n},useContext:nn,useEffect:m0,useImperativeHandle:function(n,r,o){o=o!=null?o.concat([n]):null,sd(4194308,4,v0.bind(null,r,n),o)},useLayoutEffect:function(n,r){return sd(4194308,4,n,r)},useInsertionEffect:function(n,r){sd(4,2,n,r)},useMemo:function(n,r){var o=vn();r=r===void 0?null:r;var u=n();if(Pa){bn(!0);try{n()}finally{bn(!1)}}return o.memoizedState=[u,r],u},useReducer:function(n,r,o){var u=vn();if(o!==void 0){var m=o(r);if(Pa){bn(!0);try{o(r)}finally{bn(!1)}}}else m=r;return u.memoizedState=u.baseState=m,n={pending:null,lanes:0,dispatch:null,lastRenderedReducer:n,lastRenderedState:m},u.queue=n,n=n.dispatch=AI.bind(null,Oe,n),[u.memoizedState,n]},useRef:function(n){var r=vn();return n={current:n},r.memoizedState=n},useState:function(n){n=yp(n);var r=n.queue,o=C0.bind(null,Oe,r);return r.dispatch=o,[n.memoizedState,o]},useDebugValue:bp,useDeferredValue:function(n,r){var o=vn();return Tp(o,n,r)},useTransition:function(){var n=yp(!1);return n=x0.bind(null,Oe,n.queue,!0,!1),vn().memoizedState=n,[!1,n]},useSyncExternalStore:function(n,r,o){var u=Oe,m=vn();if(Ge){if(o===void 0)throw Error(i(407));o=o()}else{if(o=r(),ht===null)throw Error(i(349));(ze&127)!==0||J_(u,r,o)}m.memoizedState=o;var g={value:o,getSnapshot:r};return m.queue=g,m0(e0.bind(null,u,g,n),[n]),u.flags|=2048,Go(9,{destroy:void 0},Z_.bind(null,u,g,o,r),null),o},useId:function(){var n=vn(),r=ht.identifierPrefix;if(Ge){var o=Ji,u=Xi;o=(u&~(1<<32-de(u)-1)).toString(32)+o,r="_"+r+"R_"+o,o=ed++,0<o&&(r+="H"+o.toString(32)),r+="_"}else o=_I++,r="_"+r+"r_"+o.toString(32)+"_";return n.memoizedState=r},useHostTransitionStatus:xp,useFormState:c0,useActionState:c0,useOptimistic:function(n){var r=vn();r.memoizedState=r.baseState=n;var o={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return r.queue=o,r=Sp.bind(null,Oe,!0,o),o.dispatch=r,[n,r]},useMemoCache:mp,useCacheRefresh:function(){return vn().memoizedState=wI.bind(null,Oe)},useEffectEvent:function(n){var r=vn(),o={impl:n};return r.memoizedState=o,function(){if((Ze&2)!==0)throw Error(i(440));return o.impl.apply(void 0,arguments)}}},wp={readContext:nn,use:nd,useCallback:b0,useContext:nn,useEffect:_p,useImperativeHandle:_0,useInsertionEffect:g0,useLayoutEffect:y0,useMemo:T0,useReducer:id,useRef:f0,useState:function(){return id(Cs)},useDebugValue:bp,useDeferredValue:function(n,r){var o=jt();return E0(o,ot.memoizedState,n,r)},useTransition:function(){var n=id(Cs)[0],r=jt().memoizedState;return[typeof n=="boolean"?n:Vc(n),r]},useSyncExternalStore:X_,useId:A0,useHostTransitionStatus:xp,useFormState:u0,useActionState:u0,useOptimistic:function(n,r){var o=jt();return i0(o,ot,n,r)},useMemoCache:mp,useCacheRefresh:I0};wp.useEffectEvent=p0;var j0={readContext:nn,use:nd,useCallback:b0,useContext:nn,useEffect:_p,useImperativeHandle:_0,useInsertionEffect:g0,useLayoutEffect:y0,useMemo:T0,useReducer:gp,useRef:f0,useState:function(){return gp(Cs)},useDebugValue:bp,useDeferredValue:function(n,r){var o=jt();return ot===null?Tp(o,n,r):E0(o,ot.memoizedState,n,r)},useTransition:function(){var n=gp(Cs)[0],r=jt().memoizedState;return[typeof n=="boolean"?n:Vc(n),r]},useSyncExternalStore:X_,useId:A0,useHostTransitionStatus:xp,useFormState:d0,useActionState:d0,useOptimistic:function(n,r){var o=jt();return ot!==null?i0(o,ot,n,r):(o.baseState=n,[n,o.queue.dispatch])},useMemoCache:mp,useCacheRefresh:I0};j0.useEffectEvent=p0;function Ap(n,r,o,u){r=n.memoizedState,o=o(u,r),o=o==null?r:b({},r,o),n.memoizedState=o,n.lanes===0&&(n.updateQueue.baseState=o)}var Ip={enqueueSetState:function(n,r,o){n=n._reactInternals;var u=zn(),m=yr(u);m.payload=r,o!=null&&(m.callback=o),r=vr(n,m,u),r!==null&&(In(r,n,u),Nc(r,n,u))},enqueueReplaceState:function(n,r,o){n=n._reactInternals;var u=zn(),m=yr(u);m.tag=1,m.payload=r,o!=null&&(m.callback=o),r=vr(n,m,u),r!==null&&(In(r,n,u),Nc(r,n,u))},enqueueForceUpdate:function(n,r){n=n._reactInternals;var o=zn(),u=yr(o);u.tag=2,r!=null&&(u.callback=r),r=vr(n,u,o),r!==null&&(In(r,n,o),Nc(r,n,o))}};function k0(n,r,o,u,m,g,T){return n=n.stateNode,typeof n.shouldComponentUpdate=="function"?n.shouldComponentUpdate(u,g,T):r.prototype&&r.prototype.isPureReactComponent?!xc(o,u)||!xc(m,g):!0}function O0(n,r,o,u){n=r.state,typeof r.componentWillReceiveProps=="function"&&r.componentWillReceiveProps(o,u),typeof r.UNSAFE_componentWillReceiveProps=="function"&&r.UNSAFE_componentWillReceiveProps(o,u),r.state!==n&&Ip.enqueueReplaceState(r,r.state,null)}function La(n,r){var o=r;if("ref"in r){o={};for(var u in r)u!=="ref"&&(o[u]=r[u])}if(n=n.defaultProps){o===r&&(o=b({},o));for(var m in n)o[m]===void 0&&(o[m]=n[m])}return o}function V0(n){Lh(n)}function M0(n){console.error(n)}function P0(n){Lh(n)}function od(n,r){try{var o=n.onUncaughtError;o(r.value,{componentStack:r.stack})}catch(u){setTimeout(function(){throw u})}}function L0(n,r,o){try{var u=n.onCaughtError;u(o.value,{componentStack:o.stack,errorBoundary:r.tag===1?r.stateNode:null})}catch(m){setTimeout(function(){throw m})}}function Cp(n,r,o){return o=yr(o),o.tag=3,o.payload={element:null},o.callback=function(){od(n,r)},o}function U0(n){return n=yr(n),n.tag=3,n}function z0(n,r,o,u){var m=o.type.getDerivedStateFromError;if(typeof m=="function"){var g=u.value;n.payload=function(){return m(g)},n.callback=function(){L0(r,o,u)}}var T=o.stateNode;T!==null&&typeof T.componentDidCatch=="function"&&(n.callback=function(){L0(r,o,u),typeof m!="function"&&(Sr===null?Sr=new Set([this]):Sr.add(this));var S=u.stack;this.componentDidCatch(u.value,{componentStack:S!==null?S:""})})}function II(n,r,o,u,m){if(o.flags|=32768,u!==null&&typeof u=="object"&&typeof u.then=="function"){if(r=o.alternate,r!==null&&Po(r,o,m,!0),o=Mn.current,o!==null){switch(o.tag){case 31:case 13:return ri===null?_d():o.alternate===null&&Ct===0&&(Ct=3),o.flags&=-257,o.flags|=65536,o.lanes=m,u===$h?o.flags|=16384:(r=o.updateQueue,r===null?o.updateQueue=new Set([u]):r.add(u),Zp(n,u,m)),!1;case 22:return o.flags|=65536,u===$h?o.flags|=16384:(r=o.updateQueue,r===null?(r={transitions:null,markerInstances:null,retryQueue:new Set([u])},o.updateQueue=r):(o=r.retryQueue,o===null?r.retryQueue=new Set([u]):o.add(u)),Zp(n,u,m)),!1}throw Error(i(435,o.tag))}return Zp(n,u,m),_d(),!1}if(Ge)return r=Mn.current,r!==null?((r.flags&65536)===0&&(r.flags|=256),r.flags|=65536,r.lanes=m,u!==Km&&(n=Error(i(422),{cause:u}),Ac(ti(n,o)))):(u!==Km&&(r=Error(i(423),{cause:u}),Ac(ti(r,o))),n=n.current.alternate,n.flags|=65536,m&=-m,n.lanes|=m,u=ti(u,o),m=Cp(n.stateNode,u,m),sp(n,m),Ct!==4&&(Ct=2)),!1;var g=Error(i(520),{cause:u});if(g=ti(g,o),Gc===null?Gc=[g]:Gc.push(g),Ct!==4&&(Ct=2),r===null)return!0;u=ti(u,o),o=r;do{switch(o.tag){case 3:return o.flags|=65536,n=m&-m,o.lanes|=n,n=Cp(o.stateNode,u,n),sp(o,n),!1;case 1:if(r=o.type,g=o.stateNode,(o.flags&128)===0&&(typeof r.getDerivedStateFromError=="function"||g!==null&&typeof g.componentDidCatch=="function"&&(Sr===null||!Sr.has(g))))return o.flags|=65536,m&=-m,o.lanes|=m,m=U0(m),z0(m,n,o,u),sp(o,m),!1}o=o.return}while(o!==null);return!1}var Rp=Error(i(461)),zt=!1;function sn(n,r,o,u){r.child=n===null?H_(r,null,o,u):Ma(r,n.child,o,u)}function B0(n,r,o,u,m){o=o.render;var g=r.ref;if("ref"in u){var T={};for(var S in u)S!=="ref"&&(T[S]=u[S])}else T=u;return ja(r),u=up(n,r,o,T,g,m),S=hp(),n!==null&&!zt?(dp(n,r,m),Rs(n,r,m)):(Ge&&S&&Gm(r),r.flags|=1,sn(n,r,u,m),r.child)}function F0(n,r,o,u,m){if(n===null){var g=o.type;return typeof g=="function"&&!Fm(g)&&g.defaultProps===void 0&&o.compare===null?(r.tag=15,r.type=g,q0(n,r,g,u,m)):(n=Fh(o.type,null,u,r,r.mode,m),n.ref=r.ref,n.return=r,r.child=n)}if(g=n.child,!Pp(n,m)){var T=g.memoizedProps;if(o=o.compare,o=o!==null?o:xc,o(T,u)&&n.ref===r.ref)return Rs(n,r,m)}return r.flags|=1,n=xs(g,u),n.ref=r.ref,n.return=r,r.child=n}function q0(n,r,o,u,m){if(n!==null){var g=n.memoizedProps;if(xc(g,u)&&n.ref===r.ref)if(zt=!1,r.pendingProps=u=g,Pp(n,m))(n.flags&131072)!==0&&(zt=!0);else return r.lanes=n.lanes,Rs(n,r,m)}return Dp(n,r,o,u,m)}function H0(n,r,o,u){var m=u.children,g=n!==null?n.memoizedState:null;if(n===null&&r.stateNode===null&&(r.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),u.mode==="hidden"){if((r.flags&128)!==0){if(g=g!==null?g.baseLanes|o:o,n!==null){for(u=r.child=n.child,m=0;u!==null;)m=m|u.lanes|u.childLanes,u=u.sibling;u=m&~g}else u=0,r.child=null;return G0(n,r,g,o,u)}if((o&536870912)!==0)r.memoizedState={baseLanes:0,cachePool:null},n!==null&&Qh(r,g!==null?g.cachePool:null),g!==null?K_(r,g):ap(),$_(r);else return u=r.lanes=536870912,G0(n,r,g!==null?g.baseLanes|o:o,o,u)}else g!==null?(Qh(r,g.cachePool),K_(r,g),br(),r.memoizedState=null):(n!==null&&Qh(r,null),ap(),br());return sn(n,r,m,o),r.child}function Lc(n,r){return n!==null&&n.tag===22||r.stateNode!==null||(r.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),r.sibling}function G0(n,r,o,u,m){var g=ep();return g=g===null?null:{parent:Lt._currentValue,pool:g},r.memoizedState={baseLanes:o,cachePool:g},n!==null&&Qh(r,null),ap(),$_(r),n!==null&&Po(n,r,u,!0),r.childLanes=m,null}function ld(n,r){return r=ud({mode:r.mode,children:r.children},n.mode),r.ref=n.ref,n.child=r,r.return=n,r}function Q0(n,r,o){return Ma(r,n.child,null,o),n=ld(r,r.pendingProps),n.flags|=2,Pn(r),r.memoizedState=null,n}function CI(n,r,o){var u=r.pendingProps,m=(r.flags&128)!==0;if(r.flags&=-129,n===null){if(Ge){if(u.mode==="hidden")return n=ld(r,u),r.lanes=536870912,Lc(null,n);if(lp(r),(n=gt)?(n=sT(n,si),n=n!==null&&n.data==="&"?n:null,n!==null&&(r.memoizedState={dehydrated:n,treeContext:dr!==null?{id:Xi,overflow:Ji}:null,retryLane:536870912,hydrationErrors:null},o=R_(n),o.return=r,r.child=o,tn=r,gt=null)):n=null,n===null)throw mr(r);return r.lanes=536870912,null}return ld(r,u)}var g=n.memoizedState;if(g!==null){var T=g.dehydrated;if(lp(r),m)if(r.flags&256)r.flags&=-257,r=Q0(n,r,o);else if(r.memoizedState!==null)r.child=n.child,r.flags|=128,r=null;else throw Error(i(558));else if(zt||Po(n,r,o,!1),m=(o&n.childLanes)!==0,zt||m){if(u=ht,u!==null&&(T=rc(u,o),T!==0&&T!==g.retryLane))throw g.retryLane=T,Ca(n,T),In(u,n,T),Rp;_d(),r=Q0(n,r,o)}else n=g.treeContext,gt=ai(T.nextSibling),tn=r,Ge=!0,fr=null,si=!1,n!==null&&j_(r,n),r=ld(r,u),r.flags|=4096;return r}return n=xs(n.child,{mode:u.mode,children:u.children}),n.ref=r.ref,r.child=n,n.return=r,n}function cd(n,r){var o=r.ref;if(o===null)n!==null&&n.ref!==null&&(r.flags|=4194816);else{if(typeof o!="function"&&typeof o!="object")throw Error(i(284));(n===null||n.ref!==o)&&(r.flags|=4194816)}}function Dp(n,r,o,u,m){return ja(r),o=up(n,r,o,u,void 0,m),u=hp(),n!==null&&!zt?(dp(n,r,m),Rs(n,r,m)):(Ge&&u&&Gm(r),r.flags|=1,sn(n,r,o,m),r.child)}function K0(n,r,o,u,m,g){return ja(r),r.updateQueue=null,o=Y_(r,u,o,m),W_(n),u=hp(),n!==null&&!zt?(dp(n,r,g),Rs(n,r,g)):(Ge&&u&&Gm(r),r.flags|=1,sn(n,r,o,g),r.child)}function $0(n,r,o,u,m){if(ja(r),r.stateNode===null){var g=ko,T=o.contextType;typeof T=="object"&&T!==null&&(g=nn(T)),g=new o(u,g),r.memoizedState=g.state!==null&&g.state!==void 0?g.state:null,g.updater=Ip,r.stateNode=g,g._reactInternals=r,g=r.stateNode,g.props=u,g.state=r.memoizedState,g.refs={},np(r),T=o.contextType,g.context=typeof T=="object"&&T!==null?nn(T):ko,g.state=r.memoizedState,T=o.getDerivedStateFromProps,typeof T=="function"&&(Ap(r,o,T,u),g.state=r.memoizedState),typeof o.getDerivedStateFromProps=="function"||typeof g.getSnapshotBeforeUpdate=="function"||typeof g.UNSAFE_componentWillMount!="function"&&typeof g.componentWillMount!="function"||(T=g.state,typeof g.componentWillMount=="function"&&g.componentWillMount(),typeof g.UNSAFE_componentWillMount=="function"&&g.UNSAFE_componentWillMount(),T!==g.state&&Ip.enqueueReplaceState(g,g.state,null),kc(r,u,g,m),jc(),g.state=r.memoizedState),typeof g.componentDidMount=="function"&&(r.flags|=4194308),u=!0}else if(n===null){g=r.stateNode;var S=r.memoizedProps,P=La(o,S);g.props=P;var K=g.context,ie=o.contextType;T=ko,typeof ie=="object"&&ie!==null&&(T=nn(ie));var le=o.getDerivedStateFromProps;ie=typeof le=="function"||typeof g.getSnapshotBeforeUpdate=="function",S=r.pendingProps!==S,ie||typeof g.UNSAFE_componentWillReceiveProps!="function"&&typeof g.componentWillReceiveProps!="function"||(S||K!==T)&&O0(r,g,u,T),gr=!1;var W=r.memoizedState;g.state=W,kc(r,u,g,m),jc(),K=r.memoizedState,S||W!==K||gr?(typeof le=="function"&&(Ap(r,o,le,u),K=r.memoizedState),(P=gr||k0(r,o,P,u,W,K,T))?(ie||typeof g.UNSAFE_componentWillMount!="function"&&typeof g.componentWillMount!="function"||(typeof g.componentWillMount=="function"&&g.componentWillMount(),typeof g.UNSAFE_componentWillMount=="function"&&g.UNSAFE_componentWillMount()),typeof g.componentDidMount=="function"&&(r.flags|=4194308)):(typeof g.componentDidMount=="function"&&(r.flags|=4194308),r.memoizedProps=u,r.memoizedState=K),g.props=u,g.state=K,g.context=T,u=P):(typeof g.componentDidMount=="function"&&(r.flags|=4194308),u=!1)}else{g=r.stateNode,ip(n,r),T=r.memoizedProps,ie=La(o,T),g.props=ie,le=r.pendingProps,W=g.context,K=o.contextType,P=ko,typeof K=="object"&&K!==null&&(P=nn(K)),S=o.getDerivedStateFromProps,(K=typeof S=="function"||typeof g.getSnapshotBeforeUpdate=="function")||typeof g.UNSAFE_componentWillReceiveProps!="function"&&typeof g.componentWillReceiveProps!="function"||(T!==le||W!==P)&&O0(r,g,u,P),gr=!1,W=r.memoizedState,g.state=W,kc(r,u,g,m),jc();var J=r.memoizedState;T!==le||W!==J||gr||n!==null&&n.dependencies!==null&&Hh(n.dependencies)?(typeof S=="function"&&(Ap(r,o,S,u),J=r.memoizedState),(ie=gr||k0(r,o,ie,u,W,J,P)||n!==null&&n.dependencies!==null&&Hh(n.dependencies))?(K||typeof g.UNSAFE_componentWillUpdate!="function"&&typeof g.componentWillUpdate!="function"||(typeof g.componentWillUpdate=="function"&&g.componentWillUpdate(u,J,P),typeof g.UNSAFE_componentWillUpdate=="function"&&g.UNSAFE_componentWillUpdate(u,J,P)),typeof g.componentDidUpdate=="function"&&(r.flags|=4),typeof g.getSnapshotBeforeUpdate=="function"&&(r.flags|=1024)):(typeof g.componentDidUpdate!="function"||T===n.memoizedProps&&W===n.memoizedState||(r.flags|=4),typeof g.getSnapshotBeforeUpdate!="function"||T===n.memoizedProps&&W===n.memoizedState||(r.flags|=1024),r.memoizedProps=u,r.memoizedState=J),g.props=u,g.state=J,g.context=P,u=ie):(typeof g.componentDidUpdate!="function"||T===n.memoizedProps&&W===n.memoizedState||(r.flags|=4),typeof g.getSnapshotBeforeUpdate!="function"||T===n.memoizedProps&&W===n.memoizedState||(r.flags|=1024),u=!1)}return g=u,cd(n,r),u=(r.flags&128)!==0,g||u?(g=r.stateNode,o=u&&typeof o.getDerivedStateFromError!="function"?null:g.render(),r.flags|=1,n!==null&&u?(r.child=Ma(r,n.child,null,m),r.child=Ma(r,null,o,m)):sn(n,r,o,m),r.memoizedState=g.state,n=r.child):n=Rs(n,r,m),n}function W0(n,r,o,u){return Da(),r.flags|=256,sn(n,r,o,u),r.child}var Np={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function jp(n){return{baseLanes:n,cachePool:L_()}}function kp(n,r,o){return n=n!==null?n.childLanes&~o:0,r&&(n|=Un),n}function Y0(n,r,o){var u=r.pendingProps,m=!1,g=(r.flags&128)!==0,T;if((T=g)||(T=n!==null&&n.memoizedState===null?!1:(Nt.current&2)!==0),T&&(m=!0,r.flags&=-129),T=(r.flags&32)!==0,r.flags&=-33,n===null){if(Ge){if(m?_r(r):br(),(n=gt)?(n=sT(n,si),n=n!==null&&n.data!=="&"?n:null,n!==null&&(r.memoizedState={dehydrated:n,treeContext:dr!==null?{id:Xi,overflow:Ji}:null,retryLane:536870912,hydrationErrors:null},o=R_(n),o.return=r,r.child=o,tn=r,gt=null)):n=null,n===null)throw mr(r);return pg(n)?r.lanes=32:r.lanes=536870912,null}var S=u.children;return u=u.fallback,m?(br(),m=r.mode,S=ud({mode:"hidden",children:S},m),u=Ra(u,m,o,null),S.return=r,u.return=r,S.sibling=u,r.child=S,u=r.child,u.memoizedState=jp(o),u.childLanes=kp(n,T,o),r.memoizedState=Np,Lc(null,u)):(_r(r),Op(r,S))}var P=n.memoizedState;if(P!==null&&(S=P.dehydrated,S!==null)){if(g)r.flags&256?(_r(r),r.flags&=-257,r=Vp(n,r,o)):r.memoizedState!==null?(br(),r.child=n.child,r.flags|=128,r=null):(br(),S=u.fallback,m=r.mode,u=ud({mode:"visible",children:u.children},m),S=Ra(S,m,o,null),S.flags|=2,u.return=r,S.return=r,u.sibling=S,r.child=u,Ma(r,n.child,null,o),u=r.child,u.memoizedState=jp(o),u.childLanes=kp(n,T,o),r.memoizedState=Np,r=Lc(null,u));else if(_r(r),pg(S)){if(T=S.nextSibling&&S.nextSibling.dataset,T)var K=T.dgst;T=K,u=Error(i(419)),u.stack="",u.digest=T,Ac({value:u,source:null,stack:null}),r=Vp(n,r,o)}else if(zt||Po(n,r,o,!1),T=(o&n.childLanes)!==0,zt||T){if(T=ht,T!==null&&(u=rc(T,o),u!==0&&u!==P.retryLane))throw P.retryLane=u,Ca(n,u),In(T,n,u),Rp;mg(S)||_d(),r=Vp(n,r,o)}else mg(S)?(r.flags|=192,r.child=n.child,r=null):(n=P.treeContext,gt=ai(S.nextSibling),tn=r,Ge=!0,fr=null,si=!1,n!==null&&j_(r,n),r=Op(r,u.children),r.flags|=4096);return r}return m?(br(),S=u.fallback,m=r.mode,P=n.child,K=P.sibling,u=xs(P,{mode:"hidden",children:u.children}),u.subtreeFlags=P.subtreeFlags&65011712,K!==null?S=xs(K,S):(S=Ra(S,m,o,null),S.flags|=2),S.return=r,u.return=r,u.sibling=S,r.child=u,Lc(null,u),u=r.child,S=n.child.memoizedState,S===null?S=jp(o):(m=S.cachePool,m!==null?(P=Lt._currentValue,m=m.parent!==P?{parent:P,pool:P}:m):m=L_(),S={baseLanes:S.baseLanes|o,cachePool:m}),u.memoizedState=S,u.childLanes=kp(n,T,o),r.memoizedState=Np,Lc(n.child,u)):(_r(r),o=n.child,n=o.sibling,o=xs(o,{mode:"visible",children:u.children}),o.return=r,o.sibling=null,n!==null&&(T=r.deletions,T===null?(r.deletions=[n],r.flags|=16):T.push(n)),r.child=o,r.memoizedState=null,o)}function Op(n,r){return r=ud({mode:"visible",children:r},n.mode),r.return=n,n.child=r}function ud(n,r){return n=Vn(22,n,null,r),n.lanes=0,n}function Vp(n,r,o){return Ma(r,n.child,null,o),n=Op(r,r.pendingProps.children),n.flags|=2,r.memoizedState=null,n}function X0(n,r,o){n.lanes|=r;var u=n.alternate;u!==null&&(u.lanes|=r),Ym(n.return,r,o)}function Mp(n,r,o,u,m,g){var T=n.memoizedState;T===null?n.memoizedState={isBackwards:r,rendering:null,renderingStartTime:0,last:u,tail:o,tailMode:m,treeForkCount:g}:(T.isBackwards=r,T.rendering=null,T.renderingStartTime=0,T.last=u,T.tail=o,T.tailMode=m,T.treeForkCount=g)}function J0(n,r,o){var u=r.pendingProps,m=u.revealOrder,g=u.tail;u=u.children;var T=Nt.current,S=(T&2)!==0;if(S?(T=T&1|2,r.flags|=128):T&=1,ue(Nt,T),sn(n,r,u,o),u=Ge?wc:0,!S&&n!==null&&(n.flags&128)!==0)e:for(n=r.child;n!==null;){if(n.tag===13)n.memoizedState!==null&&X0(n,o,r);else if(n.tag===19)X0(n,o,r);else if(n.child!==null){n.child.return=n,n=n.child;continue}if(n===r)break e;for(;n.sibling===null;){if(n.return===null||n.return===r)break e;n=n.return}n.sibling.return=n.return,n=n.sibling}switch(m){case"forwards":for(o=r.child,m=null;o!==null;)n=o.alternate,n!==null&&Jh(n)===null&&(m=o),o=o.sibling;o=m,o===null?(m=r.child,r.child=null):(m=o.sibling,o.sibling=null),Mp(r,!1,m,o,g,u);break;case"backwards":case"unstable_legacy-backwards":for(o=null,m=r.child,r.child=null;m!==null;){if(n=m.alternate,n!==null&&Jh(n)===null){r.child=m;break}n=m.sibling,m.sibling=o,o=m,m=n}Mp(r,!0,o,null,g,u);break;case"together":Mp(r,!1,null,null,void 0,u);break;default:r.memoizedState=null}return r.child}function Rs(n,r,o){if(n!==null&&(r.dependencies=n.dependencies),xr|=r.lanes,(o&r.childLanes)===0)if(n!==null){if(Po(n,r,o,!1),(o&r.childLanes)===0)return null}else return null;if(n!==null&&r.child!==n.child)throw Error(i(153));if(r.child!==null){for(n=r.child,o=xs(n,n.pendingProps),r.child=o,o.return=r;n.sibling!==null;)n=n.sibling,o=o.sibling=xs(n,n.pendingProps),o.return=r;o.sibling=null}return r.child}function Pp(n,r){return(n.lanes&r)!==0?!0:(n=n.dependencies,!!(n!==null&&Hh(n)))}function RI(n,r,o){switch(r.tag){case 3:Qe(r,r.stateNode.containerInfo),pr(r,Lt,n.memoizedState.cache),Da();break;case 27:case 5:Ni(r);break;case 4:Qe(r,r.stateNode.containerInfo);break;case 10:pr(r,r.type,r.memoizedProps.value);break;case 31:if(r.memoizedState!==null)return r.flags|=128,lp(r),null;break;case 13:var u=r.memoizedState;if(u!==null)return u.dehydrated!==null?(_r(r),r.flags|=128,null):(o&r.child.childLanes)!==0?Y0(n,r,o):(_r(r),n=Rs(n,r,o),n!==null?n.sibling:null);_r(r);break;case 19:var m=(n.flags&128)!==0;if(u=(o&r.childLanes)!==0,u||(Po(n,r,o,!1),u=(o&r.childLanes)!==0),m){if(u)return J0(n,r,o);r.flags|=128}if(m=r.memoizedState,m!==null&&(m.rendering=null,m.tail=null,m.lastEffect=null),ue(Nt,Nt.current),u)break;return null;case 22:return r.lanes=0,H0(n,r,o,r.pendingProps);case 24:pr(r,Lt,n.memoizedState.cache)}return Rs(n,r,o)}function Z0(n,r,o){if(n!==null)if(n.memoizedProps!==r.pendingProps)zt=!0;else{if(!Pp(n,o)&&(r.flags&128)===0)return zt=!1,RI(n,r,o);zt=(n.flags&131072)!==0}else zt=!1,Ge&&(r.flags&1048576)!==0&&N_(r,wc,r.index);switch(r.lanes=0,r.tag){case 16:e:{var u=r.pendingProps;if(n=Oa(r.elementType),r.type=n,typeof n=="function")Fm(n)?(u=La(n,u),r.tag=1,r=$0(null,r,n,u,o)):(r.tag=0,r=Dp(null,r,n,u,o));else{if(n!=null){var m=n.$$typeof;if(m===ne){r.tag=11,r=B0(null,r,n,u,o);break e}else if(m===w){r.tag=14,r=F0(null,r,n,u,o);break e}}throw r=we(n)||n,Error(i(306,r,""))}}return r;case 0:return Dp(n,r,r.type,r.pendingProps,o);case 1:return u=r.type,m=La(u,r.pendingProps),$0(n,r,u,m,o);case 3:e:{if(Qe(r,r.stateNode.containerInfo),n===null)throw Error(i(387));u=r.pendingProps;var g=r.memoizedState;m=g.element,ip(n,r),kc(r,u,null,o);var T=r.memoizedState;if(u=T.cache,pr(r,Lt,u),u!==g.cache&&Xm(r,[Lt],o,!0),jc(),u=T.element,g.isDehydrated)if(g={element:u,isDehydrated:!1,cache:T.cache},r.updateQueue.baseState=g,r.memoizedState=g,r.flags&256){r=W0(n,r,u,o);break e}else if(u!==m){m=ti(Error(i(424)),r),Ac(m),r=W0(n,r,u,o);break e}else for(n=r.stateNode.containerInfo,n.nodeType===9?n=n.body:n=n.nodeName==="HTML"?n.ownerDocument.body:n,gt=ai(n.firstChild),tn=r,Ge=!0,fr=null,si=!0,o=H_(r,null,u,o),r.child=o;o;)o.flags=o.flags&-3|4096,o=o.sibling;else{if(Da(),u===m){r=Rs(n,r,o);break e}sn(n,r,u,o)}r=r.child}return r;case 26:return cd(n,r),n===null?(o=uT(r.type,null,r.pendingProps,null))?r.memoizedState=o:Ge||(o=r.type,n=r.pendingProps,u=Ad(Ie.current).createElement(o),u[Vt]=r,u[$t]=n,rn(u,o,n),Mt(u),r.stateNode=u):r.memoizedState=uT(r.type,n.memoizedProps,r.pendingProps,n.memoizedState),null;case 27:return Ni(r),n===null&&Ge&&(u=r.stateNode=oT(r.type,r.pendingProps,Ie.current),tn=r,si=!0,m=gt,Cr(r.type)?(gg=m,gt=ai(u.firstChild)):gt=m),sn(n,r,r.pendingProps.children,o),cd(n,r),n===null&&(r.flags|=4194304),r.child;case 5:return n===null&&Ge&&((m=u=gt)&&(u=r2(u,r.type,r.pendingProps,si),u!==null?(r.stateNode=u,tn=r,gt=ai(u.firstChild),si=!1,m=!0):m=!1),m||mr(r)),Ni(r),m=r.type,g=r.pendingProps,T=n!==null?n.memoizedProps:null,u=g.children,hg(m,g)?u=null:T!==null&&hg(m,T)&&(r.flags|=32),r.memoizedState!==null&&(m=up(n,r,bI,null,null,o),Zc._currentValue=m),cd(n,r),sn(n,r,u,o),r.child;case 6:return n===null&&Ge&&((n=o=gt)&&(o=a2(o,r.pendingProps,si),o!==null?(r.stateNode=o,tn=r,gt=null,n=!0):n=!1),n||mr(r)),null;case 13:return Y0(n,r,o);case 4:return Qe(r,r.stateNode.containerInfo),u=r.pendingProps,n===null?r.child=Ma(r,null,u,o):sn(n,r,u,o),r.child;case 11:return B0(n,r,r.type,r.pendingProps,o);case 7:return sn(n,r,r.pendingProps,o),r.child;case 8:return sn(n,r,r.pendingProps.children,o),r.child;case 12:return sn(n,r,r.pendingProps.children,o),r.child;case 10:return u=r.pendingProps,pr(r,r.type,u.value),sn(n,r,u.children,o),r.child;case 9:return m=r.type._context,u=r.pendingProps.children,ja(r),m=nn(m),u=u(m),r.flags|=1,sn(n,r,u,o),r.child;case 14:return F0(n,r,r.type,r.pendingProps,o);case 15:return q0(n,r,r.type,r.pendingProps,o);case 19:return J0(n,r,o);case 31:return CI(n,r,o);case 22:return H0(n,r,o,r.pendingProps);case 24:return ja(r),u=nn(Lt),n===null?(m=ep(),m===null&&(m=ht,g=Jm(),m.pooledCache=g,g.refCount++,g!==null&&(m.pooledCacheLanes|=o),m=g),r.memoizedState={parent:u,cache:m},np(r),pr(r,Lt,m)):((n.lanes&o)!==0&&(ip(n,r),kc(r,null,null,o),jc()),m=n.memoizedState,g=r.memoizedState,m.parent!==u?(m={parent:u,cache:u},r.memoizedState=m,r.lanes===0&&(r.memoizedState=r.updateQueue.baseState=m),pr(r,Lt,u)):(u=g.cache,pr(r,Lt,u),u!==m.cache&&Xm(r,[Lt],o,!0))),sn(n,r,r.pendingProps.children,o),r.child;case 29:throw r.pendingProps}throw Error(i(156,r.tag))}function Ds(n){n.flags|=4}function Lp(n,r,o,u,m){if((r=(n.mode&32)!==0)&&(r=!1),r){if(n.flags|=16777216,(m&335544128)===m)if(n.stateNode.complete)n.flags|=8192;else if(Ab())n.flags|=8192;else throw Va=$h,tp}else n.flags&=-16777217}function eb(n,r){if(r.type!=="stylesheet"||(r.state.loading&4)!==0)n.flags&=-16777217;else if(n.flags|=16777216,!pT(r))if(Ab())n.flags|=8192;else throw Va=$h,tp}function hd(n,r){r!==null&&(n.flags|=4),n.flags&16384&&(r=n.tag!==22?yh():536870912,n.lanes|=r,Wo|=r)}function Uc(n,r){if(!Ge)switch(n.tailMode){case"hidden":r=n.tail;for(var o=null;r!==null;)r.alternate!==null&&(o=r),r=r.sibling;o===null?n.tail=null:o.sibling=null;break;case"collapsed":o=n.tail;for(var u=null;o!==null;)o.alternate!==null&&(u=o),o=o.sibling;u===null?r||n.tail===null?n.tail=null:n.tail.sibling=null:u.sibling=null}}function yt(n){var r=n.alternate!==null&&n.alternate.child===n.child,o=0,u=0;if(r)for(var m=n.child;m!==null;)o|=m.lanes|m.childLanes,u|=m.subtreeFlags&65011712,u|=m.flags&65011712,m.return=n,m=m.sibling;else for(m=n.child;m!==null;)o|=m.lanes|m.childLanes,u|=m.subtreeFlags,u|=m.flags,m.return=n,m=m.sibling;return n.subtreeFlags|=u,n.childLanes=o,r}function DI(n,r,o){var u=r.pendingProps;switch(Qm(r),r.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return yt(r),null;case 1:return yt(r),null;case 3:return o=r.stateNode,u=null,n!==null&&(u=n.memoizedState.cache),r.memoizedState.cache!==u&&(r.flags|=2048),As(Lt),$e(),o.pendingContext&&(o.context=o.pendingContext,o.pendingContext=null),(n===null||n.child===null)&&(Mo(r)?Ds(r):n===null||n.memoizedState.isDehydrated&&(r.flags&256)===0||(r.flags|=1024,$m())),yt(r),null;case 26:var m=r.type,g=r.memoizedState;return n===null?(Ds(r),g!==null?(yt(r),eb(r,g)):(yt(r),Lp(r,m,null,u,o))):g?g!==n.memoizedState?(Ds(r),yt(r),eb(r,g)):(yt(r),r.flags&=-16777217):(n=n.memoizedProps,n!==u&&Ds(r),yt(r),Lp(r,m,n,u,o)),null;case 27:if(ps(r),o=Ie.current,m=r.type,n!==null&&r.stateNode!=null)n.memoizedProps!==u&&Ds(r);else{if(!u){if(r.stateNode===null)throw Error(i(166));return yt(r),null}n=re.current,Mo(r)?k_(r):(n=oT(m,u,o),r.stateNode=n,Ds(r))}return yt(r),null;case 5:if(ps(r),m=r.type,n!==null&&r.stateNode!=null)n.memoizedProps!==u&&Ds(r);else{if(!u){if(r.stateNode===null)throw Error(i(166));return yt(r),null}if(g=re.current,Mo(r))k_(r);else{var T=Ad(Ie.current);switch(g){case 1:g=T.createElementNS("http://www.w3.org/2000/svg",m);break;case 2:g=T.createElementNS("http://www.w3.org/1998/Math/MathML",m);break;default:switch(m){case"svg":g=T.createElementNS("http://www.w3.org/2000/svg",m);break;case"math":g=T.createElementNS("http://www.w3.org/1998/Math/MathML",m);break;case"script":g=T.createElement("div"),g.innerHTML="<script><\/script>",g=g.removeChild(g.firstChild);break;case"select":g=typeof u.is=="string"?T.createElement("select",{is:u.is}):T.createElement("select"),u.multiple?g.multiple=!0:u.size&&(g.size=u.size);break;default:g=typeof u.is=="string"?T.createElement(m,{is:u.is}):T.createElement(m)}}g[Vt]=r,g[$t]=u;e:for(T=r.child;T!==null;){if(T.tag===5||T.tag===6)g.appendChild(T.stateNode);else if(T.tag!==4&&T.tag!==27&&T.child!==null){T.child.return=T,T=T.child;continue}if(T===r)break e;for(;T.sibling===null;){if(T.return===null||T.return===r)break e;T=T.return}T.sibling.return=T.return,T=T.sibling}r.stateNode=g;e:switch(rn(g,m,u),m){case"button":case"input":case"select":case"textarea":u=!!u.autoFocus;break e;case"img":u=!0;break e;default:u=!1}u&&Ds(r)}}return yt(r),Lp(r,r.type,n===null?null:n.memoizedProps,r.pendingProps,o),null;case 6:if(n&&r.stateNode!=null)n.memoizedProps!==u&&Ds(r);else{if(typeof u!="string"&&r.stateNode===null)throw Error(i(166));if(n=Ie.current,Mo(r)){if(n=r.stateNode,o=r.memoizedProps,u=null,m=tn,m!==null)switch(m.tag){case 27:case 5:u=m.memoizedProps}n[Vt]=r,n=!!(n.nodeValue===o||u!==null&&u.suppressHydrationWarning===!0||Yb(n.nodeValue,o)),n||mr(r,!0)}else n=Ad(n).createTextNode(u),n[Vt]=r,r.stateNode=n}return yt(r),null;case 31:if(o=r.memoizedState,n===null||n.memoizedState!==null){if(u=Mo(r),o!==null){if(n===null){if(!u)throw Error(i(318));if(n=r.memoizedState,n=n!==null?n.dehydrated:null,!n)throw Error(i(557));n[Vt]=r}else Da(),(r.flags&128)===0&&(r.memoizedState=null),r.flags|=4;yt(r),n=!1}else o=$m(),n!==null&&n.memoizedState!==null&&(n.memoizedState.hydrationErrors=o),n=!0;if(!n)return r.flags&256?(Pn(r),r):(Pn(r),null);if((r.flags&128)!==0)throw Error(i(558))}return yt(r),null;case 13:if(u=r.memoizedState,n===null||n.memoizedState!==null&&n.memoizedState.dehydrated!==null){if(m=Mo(r),u!==null&&u.dehydrated!==null){if(n===null){if(!m)throw Error(i(318));if(m=r.memoizedState,m=m!==null?m.dehydrated:null,!m)throw Error(i(317));m[Vt]=r}else Da(),(r.flags&128)===0&&(r.memoizedState=null),r.flags|=4;yt(r),m=!1}else m=$m(),n!==null&&n.memoizedState!==null&&(n.memoizedState.hydrationErrors=m),m=!0;if(!m)return r.flags&256?(Pn(r),r):(Pn(r),null)}return Pn(r),(r.flags&128)!==0?(r.lanes=o,r):(o=u!==null,n=n!==null&&n.memoizedState!==null,o&&(u=r.child,m=null,u.alternate!==null&&u.alternate.memoizedState!==null&&u.alternate.memoizedState.cachePool!==null&&(m=u.alternate.memoizedState.cachePool.pool),g=null,u.memoizedState!==null&&u.memoizedState.cachePool!==null&&(g=u.memoizedState.cachePool.pool),g!==m&&(u.flags|=2048)),o!==n&&o&&(r.child.flags|=8192),hd(r,r.updateQueue),yt(r),null);case 4:return $e(),n===null&&ag(r.stateNode.containerInfo),yt(r),null;case 10:return As(r.type),yt(r),null;case 19:if(z(Nt),u=r.memoizedState,u===null)return yt(r),null;if(m=(r.flags&128)!==0,g=u.rendering,g===null)if(m)Uc(u,!1);else{if(Ct!==0||n!==null&&(n.flags&128)!==0)for(n=r.child;n!==null;){if(g=Jh(n),g!==null){for(r.flags|=128,Uc(u,!1),n=g.updateQueue,r.updateQueue=n,hd(r,n),r.subtreeFlags=0,n=o,o=r.child;o!==null;)C_(o,n),o=o.sibling;return ue(Nt,Nt.current&1|2),Ge&&Ss(r,u.treeForkCount),r.child}n=n.sibling}u.tail!==null&&vt()>gd&&(r.flags|=128,m=!0,Uc(u,!1),r.lanes=4194304)}else{if(!m)if(n=Jh(g),n!==null){if(r.flags|=128,m=!0,n=n.updateQueue,r.updateQueue=n,hd(r,n),Uc(u,!0),u.tail===null&&u.tailMode==="hidden"&&!g.alternate&&!Ge)return yt(r),null}else 2*vt()-u.renderingStartTime>gd&&o!==536870912&&(r.flags|=128,m=!0,Uc(u,!1),r.lanes=4194304);u.isBackwards?(g.sibling=r.child,r.child=g):(n=u.last,n!==null?n.sibling=g:r.child=g,u.last=g)}return u.tail!==null?(n=u.tail,u.rendering=n,u.tail=n.sibling,u.renderingStartTime=vt(),n.sibling=null,o=Nt.current,ue(Nt,m?o&1|2:o&1),Ge&&Ss(r,u.treeForkCount),n):(yt(r),null);case 22:case 23:return Pn(r),op(),u=r.memoizedState!==null,n!==null?n.memoizedState!==null!==u&&(r.flags|=8192):u&&(r.flags|=8192),u?(o&536870912)!==0&&(r.flags&128)===0&&(yt(r),r.subtreeFlags&6&&(r.flags|=8192)):yt(r),o=r.updateQueue,o!==null&&hd(r,o.retryQueue),o=null,n!==null&&n.memoizedState!==null&&n.memoizedState.cachePool!==null&&(o=n.memoizedState.cachePool.pool),u=null,r.memoizedState!==null&&r.memoizedState.cachePool!==null&&(u=r.memoizedState.cachePool.pool),u!==o&&(r.flags|=2048),n!==null&&z(ka),null;case 24:return o=null,n!==null&&(o=n.memoizedState.cache),r.memoizedState.cache!==o&&(r.flags|=2048),As(Lt),yt(r),null;case 25:return null;case 30:return null}throw Error(i(156,r.tag))}function NI(n,r){switch(Qm(r),r.tag){case 1:return n=r.flags,n&65536?(r.flags=n&-65537|128,r):null;case 3:return As(Lt),$e(),n=r.flags,(n&65536)!==0&&(n&128)===0?(r.flags=n&-65537|128,r):null;case 26:case 27:case 5:return ps(r),null;case 31:if(r.memoizedState!==null){if(Pn(r),r.alternate===null)throw Error(i(340));Da()}return n=r.flags,n&65536?(r.flags=n&-65537|128,r):null;case 13:if(Pn(r),n=r.memoizedState,n!==null&&n.dehydrated!==null){if(r.alternate===null)throw Error(i(340));Da()}return n=r.flags,n&65536?(r.flags=n&-65537|128,r):null;case 19:return z(Nt),null;case 4:return $e(),null;case 10:return As(r.type),null;case 22:case 23:return Pn(r),op(),n!==null&&z(ka),n=r.flags,n&65536?(r.flags=n&-65537|128,r):null;case 24:return As(Lt),null;case 25:return null;default:return null}}function tb(n,r){switch(Qm(r),r.tag){case 3:As(Lt),$e();break;case 26:case 27:case 5:ps(r);break;case 4:$e();break;case 31:r.memoizedState!==null&&Pn(r);break;case 13:Pn(r);break;case 19:z(Nt);break;case 10:As(r.type);break;case 22:case 23:Pn(r),op(),n!==null&&z(ka);break;case 24:As(Lt)}}function zc(n,r){try{var o=r.updateQueue,u=o!==null?o.lastEffect:null;if(u!==null){var m=u.next;o=m;do{if((o.tag&n)===n){u=void 0;var g=o.create,T=o.inst;u=g(),T.destroy=u}o=o.next}while(o!==m)}}catch(S){nt(r,r.return,S)}}function Tr(n,r,o){try{var u=r.updateQueue,m=u!==null?u.lastEffect:null;if(m!==null){var g=m.next;u=g;do{if((u.tag&n)===n){var T=u.inst,S=T.destroy;if(S!==void 0){T.destroy=void 0,m=r;var P=o,K=S;try{K()}catch(ie){nt(m,P,ie)}}}u=u.next}while(u!==g)}}catch(ie){nt(r,r.return,ie)}}function nb(n){var r=n.updateQueue;if(r!==null){var o=n.stateNode;try{Q_(r,o)}catch(u){nt(n,n.return,u)}}}function ib(n,r,o){o.props=La(n.type,n.memoizedProps),o.state=n.memoizedState;try{o.componentWillUnmount()}catch(u){nt(n,r,u)}}function Bc(n,r){try{var o=n.ref;if(o!==null){switch(n.tag){case 26:case 27:case 5:var u=n.stateNode;break;case 30:u=n.stateNode;break;default:u=n.stateNode}typeof o=="function"?n.refCleanup=o(u):o.current=u}}catch(m){nt(n,r,m)}}function Zi(n,r){var o=n.ref,u=n.refCleanup;if(o!==null)if(typeof u=="function")try{u()}catch(m){nt(n,r,m)}finally{n.refCleanup=null,n=n.alternate,n!=null&&(n.refCleanup=null)}else if(typeof o=="function")try{o(null)}catch(m){nt(n,r,m)}else o.current=null}function sb(n){var r=n.type,o=n.memoizedProps,u=n.stateNode;try{e:switch(r){case"button":case"input":case"select":case"textarea":o.autoFocus&&u.focus();break e;case"img":o.src?u.src=o.src:o.srcSet&&(u.srcset=o.srcSet)}}catch(m){nt(n,n.return,m)}}function Up(n,r,o){try{var u=n.stateNode;ZI(u,n.type,o,r),u[$t]=r}catch(m){nt(n,n.return,m)}}function rb(n){return n.tag===5||n.tag===3||n.tag===26||n.tag===27&&Cr(n.type)||n.tag===4}function zp(n){e:for(;;){for(;n.sibling===null;){if(n.return===null||rb(n.return))return null;n=n.return}for(n.sibling.return=n.return,n=n.sibling;n.tag!==5&&n.tag!==6&&n.tag!==18;){if(n.tag===27&&Cr(n.type)||n.flags&2||n.child===null||n.tag===4)continue e;n.child.return=n,n=n.child}if(!(n.flags&2))return n.stateNode}}function Bp(n,r,o){var u=n.tag;if(u===5||u===6)n=n.stateNode,r?(o.nodeType===9?o.body:o.nodeName==="HTML"?o.ownerDocument.body:o).insertBefore(n,r):(r=o.nodeType===9?o.body:o.nodeName==="HTML"?o.ownerDocument.body:o,r.appendChild(n),o=o._reactRootContainer,o!=null||r.onclick!==null||(r.onclick=yi));else if(u!==4&&(u===27&&Cr(n.type)&&(o=n.stateNode,r=null),n=n.child,n!==null))for(Bp(n,r,o),n=n.sibling;n!==null;)Bp(n,r,o),n=n.sibling}function dd(n,r,o){var u=n.tag;if(u===5||u===6)n=n.stateNode,r?o.insertBefore(n,r):o.appendChild(n);else if(u!==4&&(u===27&&Cr(n.type)&&(o=n.stateNode),n=n.child,n!==null))for(dd(n,r,o),n=n.sibling;n!==null;)dd(n,r,o),n=n.sibling}function ab(n){var r=n.stateNode,o=n.memoizedProps;try{for(var u=n.type,m=r.attributes;m.length;)r.removeAttributeNode(m[0]);rn(r,u,o),r[Vt]=n,r[$t]=o}catch(g){nt(n,n.return,g)}}var Ns=!1,Bt=!1,Fp=!1,ob=typeof WeakSet=="function"?WeakSet:Set,Yt=null;function jI(n,r){if(n=n.containerInfo,cg=kd,n=__(n),Vm(n)){if("selectionStart"in n)var o={start:n.selectionStart,end:n.selectionEnd};else e:{o=(o=n.ownerDocument)&&o.defaultView||window;var u=o.getSelection&&o.getSelection();if(u&&u.rangeCount!==0){o=u.anchorNode;var m=u.anchorOffset,g=u.focusNode;u=u.focusOffset;try{o.nodeType,g.nodeType}catch{o=null;break e}var T=0,S=-1,P=-1,K=0,ie=0,le=n,W=null;t:for(;;){for(var J;le!==o||m!==0&&le.nodeType!==3||(S=T+m),le!==g||u!==0&&le.nodeType!==3||(P=T+u),le.nodeType===3&&(T+=le.nodeValue.length),(J=le.firstChild)!==null;)W=le,le=J;for(;;){if(le===n)break t;if(W===o&&++K===m&&(S=T),W===g&&++ie===u&&(P=T),(J=le.nextSibling)!==null)break;le=W,W=le.parentNode}le=J}o=S===-1||P===-1?null:{start:S,end:P}}else o=null}o=o||{start:0,end:0}}else o=null;for(ug={focusedElem:n,selectionRange:o},kd=!1,Yt=r;Yt!==null;)if(r=Yt,n=r.child,(r.subtreeFlags&1028)!==0&&n!==null)n.return=r,Yt=n;else for(;Yt!==null;){switch(r=Yt,g=r.alternate,n=r.flags,r.tag){case 0:if((n&4)!==0&&(n=r.updateQueue,n=n!==null?n.events:null,n!==null))for(o=0;o<n.length;o++)m=n[o],m.ref.impl=m.nextImpl;break;case 11:case 15:break;case 1:if((n&1024)!==0&&g!==null){n=void 0,o=r,m=g.memoizedProps,g=g.memoizedState,u=o.stateNode;try{var ve=La(o.type,m);n=u.getSnapshotBeforeUpdate(ve,g),u.__reactInternalSnapshotBeforeUpdate=n}catch(Ce){nt(o,o.return,Ce)}}break;case 3:if((n&1024)!==0){if(n=r.stateNode.containerInfo,o=n.nodeType,o===9)fg(n);else if(o===1)switch(n.nodeName){case"HEAD":case"HTML":case"BODY":fg(n);break;default:n.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((n&1024)!==0)throw Error(i(163))}if(n=r.sibling,n!==null){n.return=r.return,Yt=n;break}Yt=r.return}}function lb(n,r,o){var u=o.flags;switch(o.tag){case 0:case 11:case 15:ks(n,o),u&4&&zc(5,o);break;case 1:if(ks(n,o),u&4)if(n=o.stateNode,r===null)try{n.componentDidMount()}catch(T){nt(o,o.return,T)}else{var m=La(o.type,r.memoizedProps);r=r.memoizedState;try{n.componentDidUpdate(m,r,n.__reactInternalSnapshotBeforeUpdate)}catch(T){nt(o,o.return,T)}}u&64&&nb(o),u&512&&Bc(o,o.return);break;case 3:if(ks(n,o),u&64&&(n=o.updateQueue,n!==null)){if(r=null,o.child!==null)switch(o.child.tag){case 27:case 5:r=o.child.stateNode;break;case 1:r=o.child.stateNode}try{Q_(n,r)}catch(T){nt(o,o.return,T)}}break;case 27:r===null&&u&4&&ab(o);case 26:case 5:ks(n,o),r===null&&u&4&&sb(o),u&512&&Bc(o,o.return);break;case 12:ks(n,o);break;case 31:ks(n,o),u&4&&hb(n,o);break;case 13:ks(n,o),u&4&&db(n,o),u&64&&(n=o.memoizedState,n!==null&&(n=n.dehydrated,n!==null&&(o=BI.bind(null,o),o2(n,o))));break;case 22:if(u=o.memoizedState!==null||Ns,!u){r=r!==null&&r.memoizedState!==null||Bt,m=Ns;var g=Bt;Ns=u,(Bt=r)&&!g?Os(n,o,(o.subtreeFlags&8772)!==0):ks(n,o),Ns=m,Bt=g}break;case 30:break;default:ks(n,o)}}function cb(n){var r=n.alternate;r!==null&&(n.alternate=null,cb(r)),n.child=null,n.deletions=null,n.sibling=null,n.tag===5&&(r=n.stateNode,r!==null&&_o(r)),n.stateNode=null,n.return=null,n.dependencies=null,n.memoizedProps=null,n.memoizedState=null,n.pendingProps=null,n.stateNode=null,n.updateQueue=null}var bt=null,xn=!1;function js(n,r,o){for(o=o.child;o!==null;)ub(n,r,o),o=o.sibling}function ub(n,r,o){if(Ht&&typeof Ht.onCommitFiberUnmount=="function")try{Ht.onCommitFiberUnmount(Dn,o)}catch{}switch(o.tag){case 26:Bt||Zi(o,r),js(n,r,o),o.memoizedState?o.memoizedState.count--:o.stateNode&&(o=o.stateNode,o.parentNode.removeChild(o));break;case 27:Bt||Zi(o,r);var u=bt,m=xn;Cr(o.type)&&(bt=o.stateNode,xn=!1),js(n,r,o),Yc(o.stateNode),bt=u,xn=m;break;case 5:Bt||Zi(o,r);case 6:if(u=bt,m=xn,bt=null,js(n,r,o),bt=u,xn=m,bt!==null)if(xn)try{(bt.nodeType===9?bt.body:bt.nodeName==="HTML"?bt.ownerDocument.body:bt).removeChild(o.stateNode)}catch(g){nt(o,r,g)}else try{bt.removeChild(o.stateNode)}catch(g){nt(o,r,g)}break;case 18:bt!==null&&(xn?(n=bt,nT(n.nodeType===9?n.body:n.nodeName==="HTML"?n.ownerDocument.body:n,o.stateNode),il(n)):nT(bt,o.stateNode));break;case 4:u=bt,m=xn,bt=o.stateNode.containerInfo,xn=!0,js(n,r,o),bt=u,xn=m;break;case 0:case 11:case 14:case 15:Tr(2,o,r),Bt||Tr(4,o,r),js(n,r,o);break;case 1:Bt||(Zi(o,r),u=o.stateNode,typeof u.componentWillUnmount=="function"&&ib(o,r,u)),js(n,r,o);break;case 21:js(n,r,o);break;case 22:Bt=(u=Bt)||o.memoizedState!==null,js(n,r,o),Bt=u;break;default:js(n,r,o)}}function hb(n,r){if(r.memoizedState===null&&(n=r.alternate,n!==null&&(n=n.memoizedState,n!==null))){n=n.dehydrated;try{il(n)}catch(o){nt(r,r.return,o)}}}function db(n,r){if(r.memoizedState===null&&(n=r.alternate,n!==null&&(n=n.memoizedState,n!==null&&(n=n.dehydrated,n!==null))))try{il(n)}catch(o){nt(r,r.return,o)}}function kI(n){switch(n.tag){case 31:case 13:case 19:var r=n.stateNode;return r===null&&(r=n.stateNode=new ob),r;case 22:return n=n.stateNode,r=n._retryCache,r===null&&(r=n._retryCache=new ob),r;default:throw Error(i(435,n.tag))}}function fd(n,r){var o=kI(n);r.forEach(function(u){if(!o.has(u)){o.add(u);var m=FI.bind(null,n,u);u.then(m,m)}})}function Sn(n,r){var o=r.deletions;if(o!==null)for(var u=0;u<o.length;u++){var m=o[u],g=n,T=r,S=T;e:for(;S!==null;){switch(S.tag){case 27:if(Cr(S.type)){bt=S.stateNode,xn=!1;break e}break;case 5:bt=S.stateNode,xn=!1;break e;case 3:case 4:bt=S.stateNode.containerInfo,xn=!0;break e}S=S.return}if(bt===null)throw Error(i(160));ub(g,T,m),bt=null,xn=!1,g=m.alternate,g!==null&&(g.return=null),m.return=null}if(r.subtreeFlags&13886)for(r=r.child;r!==null;)fb(r,n),r=r.sibling}var xi=null;function fb(n,r){var o=n.alternate,u=n.flags;switch(n.tag){case 0:case 11:case 14:case 15:Sn(r,n),wn(n),u&4&&(Tr(3,n,n.return),zc(3,n),Tr(5,n,n.return));break;case 1:Sn(r,n),wn(n),u&512&&(Bt||o===null||Zi(o,o.return)),u&64&&Ns&&(n=n.updateQueue,n!==null&&(u=n.callbacks,u!==null&&(o=n.shared.hiddenCallbacks,n.shared.hiddenCallbacks=o===null?u:o.concat(u))));break;case 26:var m=xi;if(Sn(r,n),wn(n),u&512&&(Bt||o===null||Zi(o,o.return)),u&4){var g=o!==null?o.memoizedState:null;if(u=n.memoizedState,o===null)if(u===null)if(n.stateNode===null){e:{u=n.type,o=n.memoizedProps,m=m.ownerDocument||m;t:switch(u){case"title":g=m.getElementsByTagName("title")[0],(!g||g[Ui]||g[Vt]||g.namespaceURI==="http://www.w3.org/2000/svg"||g.hasAttribute("itemprop"))&&(g=m.createElement(u),m.head.insertBefore(g,m.querySelector("head > title"))),rn(g,u,o),g[Vt]=n,Mt(g),u=g;break e;case"link":var T=fT("link","href",m).get(u+(o.href||""));if(T){for(var S=0;S<T.length;S++)if(g=T[S],g.getAttribute("href")===(o.href==null||o.href===""?null:o.href)&&g.getAttribute("rel")===(o.rel==null?null:o.rel)&&g.getAttribute("title")===(o.title==null?null:o.title)&&g.getAttribute("crossorigin")===(o.crossOrigin==null?null:o.crossOrigin)){T.splice(S,1);break t}}g=m.createElement(u),rn(g,u,o),m.head.appendChild(g);break;case"meta":if(T=fT("meta","content",m).get(u+(o.content||""))){for(S=0;S<T.length;S++)if(g=T[S],g.getAttribute("content")===(o.content==null?null:""+o.content)&&g.getAttribute("name")===(o.name==null?null:o.name)&&g.getAttribute("property")===(o.property==null?null:o.property)&&g.getAttribute("http-equiv")===(o.httpEquiv==null?null:o.httpEquiv)&&g.getAttribute("charset")===(o.charSet==null?null:o.charSet)){T.splice(S,1);break t}}g=m.createElement(u),rn(g,u,o),m.head.appendChild(g);break;default:throw Error(i(468,u))}g[Vt]=n,Mt(g),u=g}n.stateNode=u}else mT(m,n.type,n.stateNode);else n.stateNode=dT(m,u,n.memoizedProps);else g!==u?(g===null?o.stateNode!==null&&(o=o.stateNode,o.parentNode.removeChild(o)):g.count--,u===null?mT(m,n.type,n.stateNode):dT(m,u,n.memoizedProps)):u===null&&n.stateNode!==null&&Up(n,n.memoizedProps,o.memoizedProps)}break;case 27:Sn(r,n),wn(n),u&512&&(Bt||o===null||Zi(o,o.return)),o!==null&&u&4&&Up(n,n.memoizedProps,o.memoizedProps);break;case 5:if(Sn(r,n),wn(n),u&512&&(Bt||o===null||Zi(o,o.return)),n.flags&32){m=n.stateNode;try{En(m,"")}catch(ve){nt(n,n.return,ve)}}u&4&&n.stateNode!=null&&(m=n.memoizedProps,Up(n,m,o!==null?o.memoizedProps:m)),u&1024&&(Fp=!0);break;case 6:if(Sn(r,n),wn(n),u&4){if(n.stateNode===null)throw Error(i(162));u=n.memoizedProps,o=n.stateNode;try{o.nodeValue=u}catch(ve){nt(n,n.return,ve)}}break;case 3:if(Rd=null,m=xi,xi=Id(r.containerInfo),Sn(r,n),xi=m,wn(n),u&4&&o!==null&&o.memoizedState.isDehydrated)try{il(r.containerInfo)}catch(ve){nt(n,n.return,ve)}Fp&&(Fp=!1,mb(n));break;case 4:u=xi,xi=Id(n.stateNode.containerInfo),Sn(r,n),wn(n),xi=u;break;case 12:Sn(r,n),wn(n);break;case 31:Sn(r,n),wn(n),u&4&&(u=n.updateQueue,u!==null&&(n.updateQueue=null,fd(n,u)));break;case 13:Sn(r,n),wn(n),n.child.flags&8192&&n.memoizedState!==null!=(o!==null&&o.memoizedState!==null)&&(pd=vt()),u&4&&(u=n.updateQueue,u!==null&&(n.updateQueue=null,fd(n,u)));break;case 22:m=n.memoizedState!==null;var P=o!==null&&o.memoizedState!==null,K=Ns,ie=Bt;if(Ns=K||m,Bt=ie||P,Sn(r,n),Bt=ie,Ns=K,wn(n),u&8192)e:for(r=n.stateNode,r._visibility=m?r._visibility&-2:r._visibility|1,m&&(o===null||P||Ns||Bt||Ua(n)),o=null,r=n;;){if(r.tag===5||r.tag===26){if(o===null){P=o=r;try{if(g=P.stateNode,m)T=g.style,typeof T.setProperty=="function"?T.setProperty("display","none","important"):T.display="none";else{S=P.stateNode;var le=P.memoizedProps.style,W=le!=null&&le.hasOwnProperty("display")?le.display:null;S.style.display=W==null||typeof W=="boolean"?"":(""+W).trim()}}catch(ve){nt(P,P.return,ve)}}}else if(r.tag===6){if(o===null){P=r;try{P.stateNode.nodeValue=m?"":P.memoizedProps}catch(ve){nt(P,P.return,ve)}}}else if(r.tag===18){if(o===null){P=r;try{var J=P.stateNode;m?iT(J,!0):iT(P.stateNode,!1)}catch(ve){nt(P,P.return,ve)}}}else if((r.tag!==22&&r.tag!==23||r.memoizedState===null||r===n)&&r.child!==null){r.child.return=r,r=r.child;continue}if(r===n)break e;for(;r.sibling===null;){if(r.return===null||r.return===n)break e;o===r&&(o=null),r=r.return}o===r&&(o=null),r.sibling.return=r.return,r=r.sibling}u&4&&(u=n.updateQueue,u!==null&&(o=u.retryQueue,o!==null&&(u.retryQueue=null,fd(n,o))));break;case 19:Sn(r,n),wn(n),u&4&&(u=n.updateQueue,u!==null&&(n.updateQueue=null,fd(n,u)));break;case 30:break;case 21:break;default:Sn(r,n),wn(n)}}function wn(n){var r=n.flags;if(r&2){try{for(var o,u=n.return;u!==null;){if(rb(u)){o=u;break}u=u.return}if(o==null)throw Error(i(160));switch(o.tag){case 27:var m=o.stateNode,g=zp(n);dd(n,g,m);break;case 5:var T=o.stateNode;o.flags&32&&(En(T,""),o.flags&=-33);var S=zp(n);dd(n,S,T);break;case 3:case 4:var P=o.stateNode.containerInfo,K=zp(n);Bp(n,K,P);break;default:throw Error(i(161))}}catch(ie){nt(n,n.return,ie)}n.flags&=-3}r&4096&&(n.flags&=-4097)}function mb(n){if(n.subtreeFlags&1024)for(n=n.child;n!==null;){var r=n;mb(r),r.tag===5&&r.flags&1024&&r.stateNode.reset(),n=n.sibling}}function ks(n,r){if(r.subtreeFlags&8772)for(r=r.child;r!==null;)lb(n,r.alternate,r),r=r.sibling}function Ua(n){for(n=n.child;n!==null;){var r=n;switch(r.tag){case 0:case 11:case 14:case 15:Tr(4,r,r.return),Ua(r);break;case 1:Zi(r,r.return);var o=r.stateNode;typeof o.componentWillUnmount=="function"&&ib(r,r.return,o),Ua(r);break;case 27:Yc(r.stateNode);case 26:case 5:Zi(r,r.return),Ua(r);break;case 22:r.memoizedState===null&&Ua(r);break;case 30:Ua(r);break;default:Ua(r)}n=n.sibling}}function Os(n,r,o){for(o=o&&(r.subtreeFlags&8772)!==0,r=r.child;r!==null;){var u=r.alternate,m=n,g=r,T=g.flags;switch(g.tag){case 0:case 11:case 15:Os(m,g,o),zc(4,g);break;case 1:if(Os(m,g,o),u=g,m=u.stateNode,typeof m.componentDidMount=="function")try{m.componentDidMount()}catch(K){nt(u,u.return,K)}if(u=g,m=u.updateQueue,m!==null){var S=u.stateNode;try{var P=m.shared.hiddenCallbacks;if(P!==null)for(m.shared.hiddenCallbacks=null,m=0;m<P.length;m++)G_(P[m],S)}catch(K){nt(u,u.return,K)}}o&&T&64&&nb(g),Bc(g,g.return);break;case 27:ab(g);case 26:case 5:Os(m,g,o),o&&u===null&&T&4&&sb(g),Bc(g,g.return);break;case 12:Os(m,g,o);break;case 31:Os(m,g,o),o&&T&4&&hb(m,g);break;case 13:Os(m,g,o),o&&T&4&&db(m,g);break;case 22:g.memoizedState===null&&Os(m,g,o),Bc(g,g.return);break;case 30:break;default:Os(m,g,o)}r=r.sibling}}function qp(n,r){var o=null;n!==null&&n.memoizedState!==null&&n.memoizedState.cachePool!==null&&(o=n.memoizedState.cachePool.pool),n=null,r.memoizedState!==null&&r.memoizedState.cachePool!==null&&(n=r.memoizedState.cachePool.pool),n!==o&&(n!=null&&n.refCount++,o!=null&&Ic(o))}function Hp(n,r){n=null,r.alternate!==null&&(n=r.alternate.memoizedState.cache),r=r.memoizedState.cache,r!==n&&(r.refCount++,n!=null&&Ic(n))}function Si(n,r,o,u){if(r.subtreeFlags&10256)for(r=r.child;r!==null;)pb(n,r,o,u),r=r.sibling}function pb(n,r,o,u){var m=r.flags;switch(r.tag){case 0:case 11:case 15:Si(n,r,o,u),m&2048&&zc(9,r);break;case 1:Si(n,r,o,u);break;case 3:Si(n,r,o,u),m&2048&&(n=null,r.alternate!==null&&(n=r.alternate.memoizedState.cache),r=r.memoizedState.cache,r!==n&&(r.refCount++,n!=null&&Ic(n)));break;case 12:if(m&2048){Si(n,r,o,u),n=r.stateNode;try{var g=r.memoizedProps,T=g.id,S=g.onPostCommit;typeof S=="function"&&S(T,r.alternate===null?"mount":"update",n.passiveEffectDuration,-0)}catch(P){nt(r,r.return,P)}}else Si(n,r,o,u);break;case 31:Si(n,r,o,u);break;case 13:Si(n,r,o,u);break;case 23:break;case 22:g=r.stateNode,T=r.alternate,r.memoizedState!==null?g._visibility&2?Si(n,r,o,u):Fc(n,r):g._visibility&2?Si(n,r,o,u):(g._visibility|=2,Qo(n,r,o,u,(r.subtreeFlags&10256)!==0||!1)),m&2048&&qp(T,r);break;case 24:Si(n,r,o,u),m&2048&&Hp(r.alternate,r);break;default:Si(n,r,o,u)}}function Qo(n,r,o,u,m){for(m=m&&((r.subtreeFlags&10256)!==0||!1),r=r.child;r!==null;){var g=n,T=r,S=o,P=u,K=T.flags;switch(T.tag){case 0:case 11:case 15:Qo(g,T,S,P,m),zc(8,T);break;case 23:break;case 22:var ie=T.stateNode;T.memoizedState!==null?ie._visibility&2?Qo(g,T,S,P,m):Fc(g,T):(ie._visibility|=2,Qo(g,T,S,P,m)),m&&K&2048&&qp(T.alternate,T);break;case 24:Qo(g,T,S,P,m),m&&K&2048&&Hp(T.alternate,T);break;default:Qo(g,T,S,P,m)}r=r.sibling}}function Fc(n,r){if(r.subtreeFlags&10256)for(r=r.child;r!==null;){var o=n,u=r,m=u.flags;switch(u.tag){case 22:Fc(o,u),m&2048&&qp(u.alternate,u);break;case 24:Fc(o,u),m&2048&&Hp(u.alternate,u);break;default:Fc(o,u)}r=r.sibling}}var qc=8192;function Ko(n,r,o){if(n.subtreeFlags&qc)for(n=n.child;n!==null;)gb(n,r,o),n=n.sibling}function gb(n,r,o){switch(n.tag){case 26:Ko(n,r,o),n.flags&qc&&n.memoizedState!==null&&_2(o,xi,n.memoizedState,n.memoizedProps);break;case 5:Ko(n,r,o);break;case 3:case 4:var u=xi;xi=Id(n.stateNode.containerInfo),Ko(n,r,o),xi=u;break;case 22:n.memoizedState===null&&(u=n.alternate,u!==null&&u.memoizedState!==null?(u=qc,qc=16777216,Ko(n,r,o),qc=u):Ko(n,r,o));break;default:Ko(n,r,o)}}function yb(n){var r=n.alternate;if(r!==null&&(n=r.child,n!==null)){r.child=null;do r=n.sibling,n.sibling=null,n=r;while(n!==null)}}function Hc(n){var r=n.deletions;if((n.flags&16)!==0){if(r!==null)for(var o=0;o<r.length;o++){var u=r[o];Yt=u,_b(u,n)}yb(n)}if(n.subtreeFlags&10256)for(n=n.child;n!==null;)vb(n),n=n.sibling}function vb(n){switch(n.tag){case 0:case 11:case 15:Hc(n),n.flags&2048&&Tr(9,n,n.return);break;case 3:Hc(n);break;case 12:Hc(n);break;case 22:var r=n.stateNode;n.memoizedState!==null&&r._visibility&2&&(n.return===null||n.return.tag!==13)?(r._visibility&=-3,md(n)):Hc(n);break;default:Hc(n)}}function md(n){var r=n.deletions;if((n.flags&16)!==0){if(r!==null)for(var o=0;o<r.length;o++){var u=r[o];Yt=u,_b(u,n)}yb(n)}for(n=n.child;n!==null;){switch(r=n,r.tag){case 0:case 11:case 15:Tr(8,r,r.return),md(r);break;case 22:o=r.stateNode,o._visibility&2&&(o._visibility&=-3,md(r));break;default:md(r)}n=n.sibling}}function _b(n,r){for(;Yt!==null;){var o=Yt;switch(o.tag){case 0:case 11:case 15:Tr(8,o,r);break;case 23:case 22:if(o.memoizedState!==null&&o.memoizedState.cachePool!==null){var u=o.memoizedState.cachePool.pool;u!=null&&u.refCount++}break;case 24:Ic(o.memoizedState.cache)}if(u=o.child,u!==null)u.return=o,Yt=u;else e:for(o=n;Yt!==null;){u=Yt;var m=u.sibling,g=u.return;if(cb(u),u===o){Yt=null;break e}if(m!==null){m.return=g,Yt=m;break e}Yt=g}}}var OI={getCacheForType:function(n){var r=nn(Lt),o=r.data.get(n);return o===void 0&&(o=n(),r.data.set(n,o)),o},cacheSignal:function(){return nn(Lt).controller.signal}},VI=typeof WeakMap=="function"?WeakMap:Map,Ze=0,ht=null,Le=null,ze=0,tt=0,Ln=null,Er=!1,$o=!1,Gp=!1,Vs=0,Ct=0,xr=0,za=0,Qp=0,Un=0,Wo=0,Gc=null,An=null,Kp=!1,pd=0,bb=0,gd=1/0,yd=null,Sr=null,Gt=0,wr=null,Yo=null,Ms=0,$p=0,Wp=null,Tb=null,Qc=0,Yp=null;function zn(){return(Ze&2)!==0&&ze!==0?ze&-ze:G.T!==null?ng():vh()}function Eb(){if(Un===0)if((ze&536870912)===0||Ge){var n=vs;vs<<=1,(vs&3932160)===0&&(vs=262144),Un=n}else Un=536870912;return n=Mn.current,n!==null&&(n.flags|=32),Un}function In(n,r,o){(n===ht&&(tt===2||tt===9)||n.cancelPendingCommit!==null)&&(Xo(n,0),Ar(n,ze,Un,!1)),ma(n,o),((Ze&2)===0||n!==ht)&&(n===ht&&((Ze&2)===0&&(za|=o),Ct===4&&Ar(n,ze,Un,!1)),es(n))}function xb(n,r,o){if((Ze&6)!==0)throw Error(i(327));var u=!o&&(r&127)===0&&(r&n.expiredLanes)===0||mi(n,r),m=u?LI(n,r):Jp(n,r,!0),g=u;do{if(m===0){$o&&!u&&Ar(n,r,0,!1);break}else{if(o=n.current.alternate,g&&!MI(o)){m=Jp(n,r,!1),g=!1;continue}if(m===2){if(g=r,n.errorRecoveryDisabledLanes&g)var T=0;else T=n.pendingLanes&-536870913,T=T!==0?T:T&536870912?536870912:0;if(T!==0){r=T;e:{var S=n;m=Gc;var P=S.current.memoizedState.isDehydrated;if(P&&(Xo(S,T).flags|=256),T=Jp(S,T,!1),T!==2){if(Gp&&!P){S.errorRecoveryDisabledLanes|=g,za|=g,m=4;break e}g=An,An=m,g!==null&&(An===null?An=g:An.push.apply(An,g))}m=T}if(g=!1,m!==2)continue}}if(m===1){Xo(n,0),Ar(n,r,0,!0);break}e:{switch(u=n,g=m,g){case 0:case 1:throw Error(i(345));case 4:if((r&4194048)!==r)break;case 6:Ar(u,r,Un,!Er);break e;case 2:An=null;break;case 3:case 5:break;default:throw Error(i(329))}if((r&62914560)===r&&(m=pd+300-vt(),10<m)){if(Ar(u,r,Un,!Er),Mi(u,0,!0)!==0)break e;Ms=r,u.timeoutHandle=eT(Sb.bind(null,u,o,An,yd,Kp,r,Un,za,Wo,Er,g,"Throttled",-0,0),m);break e}Sb(u,o,An,yd,Kp,r,Un,za,Wo,Er,g,null,-0,0)}}break}while(!0);es(n)}function Sb(n,r,o,u,m,g,T,S,P,K,ie,le,W,J){if(n.timeoutHandle=-1,le=r.subtreeFlags,le&8192||(le&16785408)===16785408){le={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:yi},gb(r,g,le);var ve=(g&62914560)===g?pd-vt():(g&4194048)===g?bb-vt():0;if(ve=b2(le,ve),ve!==null){Ms=g,n.cancelPendingCommit=ve(jb.bind(null,n,r,g,o,u,m,T,S,P,ie,le,null,W,J)),Ar(n,g,T,!K);return}}jb(n,r,g,o,u,m,T,S,P)}function MI(n){for(var r=n;;){var o=r.tag;if((o===0||o===11||o===15)&&r.flags&16384&&(o=r.updateQueue,o!==null&&(o=o.stores,o!==null)))for(var u=0;u<o.length;u++){var m=o[u],g=m.getSnapshot;m=m.value;try{if(!On(g(),m))return!1}catch{return!1}}if(o=r.child,r.subtreeFlags&16384&&o!==null)o.return=r,r=o;else{if(r===n)break;for(;r.sibling===null;){if(r.return===null||r.return===n)return!0;r=r.return}r.sibling.return=r.return,r=r.sibling}}return!0}function Ar(n,r,o,u){r&=~Qp,r&=~za,n.suspendedLanes|=r,n.pingedLanes&=~r,u&&(n.warmLanes|=r),u=n.expirationTimes;for(var m=r;0<m;){var g=31-de(m),T=1<<g;u[g]=-1,m&=~T}o!==0&&pa(n,o,r)}function vd(){return(Ze&6)===0?(Kc(0),!1):!0}function Xp(){if(Le!==null){if(tt===0)var n=Le.return;else n=Le,ws=Na=null,fp(n),Bo=null,Rc=0,n=Le;for(;n!==null;)tb(n.alternate,n),n=n.return;Le=null}}function Xo(n,r){var o=n.timeoutHandle;o!==-1&&(n.timeoutHandle=-1,n2(o)),o=n.cancelPendingCommit,o!==null&&(n.cancelPendingCommit=null,o()),Ms=0,Xp(),ht=n,Le=o=xs(n.current,null),ze=r,tt=0,Ln=null,Er=!1,$o=mi(n,r),Gp=!1,Wo=Un=Qp=za=xr=Ct=0,An=Gc=null,Kp=!1,(r&8)!==0&&(r|=r&32);var u=n.entangledLanes;if(u!==0)for(n=n.entanglements,u&=r;0<u;){var m=31-de(u),g=1<<m;r|=n[m],u&=~g}return Vs=r,Uh(),o}function wb(n,r){Oe=null,G.H=Pc,r===zo||r===Kh?(r=B_(),tt=3):r===tp?(r=B_(),tt=4):tt=r===Rp?8:r!==null&&typeof r=="object"&&typeof r.then=="function"?6:1,Ln=r,Le===null&&(Ct=1,od(n,ti(r,n.current)))}function Ab(){var n=Mn.current;return n===null?!0:(ze&4194048)===ze?ri===null:(ze&62914560)===ze||(ze&536870912)!==0?n===ri:!1}function Ib(){var n=G.H;return G.H=Pc,n===null?Pc:n}function Cb(){var n=G.A;return G.A=OI,n}function _d(){Ct=4,Er||(ze&4194048)!==ze&&Mn.current!==null||($o=!0),(xr&134217727)===0&&(za&134217727)===0||ht===null||Ar(ht,ze,Un,!1)}function Jp(n,r,o){var u=Ze;Ze|=2;var m=Ib(),g=Cb();(ht!==n||ze!==r)&&(yd=null,Xo(n,r)),r=!1;var T=Ct;e:do try{if(tt!==0&&Le!==null){var S=Le,P=Ln;switch(tt){case 8:Xp(),T=6;break e;case 3:case 2:case 9:case 6:Mn.current===null&&(r=!0);var K=tt;if(tt=0,Ln=null,Jo(n,S,P,K),o&&$o){T=0;break e}break;default:K=tt,tt=0,Ln=null,Jo(n,S,P,K)}}PI(),T=Ct;break}catch(ie){wb(n,ie)}while(!0);return r&&n.shellSuspendCounter++,ws=Na=null,Ze=u,G.H=m,G.A=g,Le===null&&(ht=null,ze=0,Uh()),T}function PI(){for(;Le!==null;)Rb(Le)}function LI(n,r){var o=Ze;Ze|=2;var u=Ib(),m=Cb();ht!==n||ze!==r?(yd=null,gd=vt()+500,Xo(n,r)):$o=mi(n,r);e:do try{if(tt!==0&&Le!==null){r=Le;var g=Ln;t:switch(tt){case 1:tt=0,Ln=null,Jo(n,r,g,1);break;case 2:case 9:if(U_(g)){tt=0,Ln=null,Db(r);break}r=function(){tt!==2&&tt!==9||ht!==n||(tt=7),es(n)},g.then(r,r);break e;case 3:tt=7;break e;case 4:tt=5;break e;case 7:U_(g)?(tt=0,Ln=null,Db(r)):(tt=0,Ln=null,Jo(n,r,g,7));break;case 5:var T=null;switch(Le.tag){case 26:T=Le.memoizedState;case 5:case 27:var S=Le;if(T?pT(T):S.stateNode.complete){tt=0,Ln=null;var P=S.sibling;if(P!==null)Le=P;else{var K=S.return;K!==null?(Le=K,bd(K)):Le=null}break t}}tt=0,Ln=null,Jo(n,r,g,5);break;case 6:tt=0,Ln=null,Jo(n,r,g,6);break;case 8:Xp(),Ct=6;break e;default:throw Error(i(462))}}UI();break}catch(ie){wb(n,ie)}while(!0);return ws=Na=null,G.H=u,G.A=m,Ze=o,Le!==null?0:(ht=null,ze=0,Uh(),Ct)}function UI(){for(;Le!==null&&!mo();)Rb(Le)}function Rb(n){var r=Z0(n.alternate,n,Vs);n.memoizedProps=n.pendingProps,r===null?bd(n):Le=r}function Db(n){var r=n,o=r.alternate;switch(r.tag){case 15:case 0:r=K0(o,r,r.pendingProps,r.type,void 0,ze);break;case 11:r=K0(o,r,r.pendingProps,r.type.render,r.ref,ze);break;case 5:fp(r);default:tb(o,r),r=Le=C_(r,Vs),r=Z0(o,r,Vs)}n.memoizedProps=n.pendingProps,r===null?bd(n):Le=r}function Jo(n,r,o,u){ws=Na=null,fp(r),Bo=null,Rc=0;var m=r.return;try{if(II(n,m,r,o,ze)){Ct=1,od(n,ti(o,n.current)),Le=null;return}}catch(g){if(m!==null)throw Le=m,g;Ct=1,od(n,ti(o,n.current)),Le=null;return}r.flags&32768?(Ge||u===1?n=!0:$o||(ze&536870912)!==0?n=!1:(Er=n=!0,(u===2||u===9||u===3||u===6)&&(u=Mn.current,u!==null&&u.tag===13&&(u.flags|=16384))),Nb(r,n)):bd(r)}function bd(n){var r=n;do{if((r.flags&32768)!==0){Nb(r,Er);return}n=r.return;var o=DI(r.alternate,r,Vs);if(o!==null){Le=o;return}if(r=r.sibling,r!==null){Le=r;return}Le=r=n}while(r!==null);Ct===0&&(Ct=5)}function Nb(n,r){do{var o=NI(n.alternate,n);if(o!==null){o.flags&=32767,Le=o;return}if(o=n.return,o!==null&&(o.flags|=32768,o.subtreeFlags=0,o.deletions=null),!r&&(n=n.sibling,n!==null)){Le=n;return}Le=n=o}while(n!==null);Ct=6,Le=null}function jb(n,r,o,u,m,g,T,S,P){n.cancelPendingCommit=null;do Td();while(Gt!==0);if((Ze&6)!==0)throw Error(i(327));if(r!==null){if(r===n.current)throw Error(i(177));if(g=r.lanes|r.childLanes,g|=zm,Nm(n,o,g,T,S,P),n===ht&&(Le=ht=null,ze=0),Yo=r,wr=n,Ms=o,$p=g,Wp=m,Tb=u,(r.subtreeFlags&10256)!==0||(r.flags&10256)!==0?(n.callbackNode=null,n.callbackPriority=0,qI(Oi,function(){return Pb(),null})):(n.callbackNode=null,n.callbackPriority=0),u=(r.flags&13878)!==0,(r.subtreeFlags&13878)!==0||u){u=G.T,G.T=null,m=oe.p,oe.p=2,T=Ze,Ze|=4;try{jI(n,r,o)}finally{Ze=T,oe.p=m,G.T=u}}Gt=1,kb(),Ob(),Vb()}}function kb(){if(Gt===1){Gt=0;var n=wr,r=Yo,o=(r.flags&13878)!==0;if((r.subtreeFlags&13878)!==0||o){o=G.T,G.T=null;var u=oe.p;oe.p=2;var m=Ze;Ze|=4;try{fb(r,n);var g=ug,T=__(n.containerInfo),S=g.focusedElem,P=g.selectionRange;if(T!==S&&S&&S.ownerDocument&&v_(S.ownerDocument.documentElement,S)){if(P!==null&&Vm(S)){var K=P.start,ie=P.end;if(ie===void 0&&(ie=K),"selectionStart"in S)S.selectionStart=K,S.selectionEnd=Math.min(ie,S.value.length);else{var le=S.ownerDocument||document,W=le&&le.defaultView||window;if(W.getSelection){var J=W.getSelection(),ve=S.textContent.length,Ce=Math.min(P.start,ve),ct=P.end===void 0?Ce:Math.min(P.end,ve);!J.extend&&Ce>ct&&(T=ct,ct=Ce,Ce=T);var F=y_(S,Ce),B=y_(S,ct);if(F&&B&&(J.rangeCount!==1||J.anchorNode!==F.node||J.anchorOffset!==F.offset||J.focusNode!==B.node||J.focusOffset!==B.offset)){var Q=le.createRange();Q.setStart(F.node,F.offset),J.removeAllRanges(),Ce>ct?(J.addRange(Q),J.extend(B.node,B.offset)):(Q.setEnd(B.node,B.offset),J.addRange(Q))}}}}for(le=[],J=S;J=J.parentNode;)J.nodeType===1&&le.push({element:J,left:J.scrollLeft,top:J.scrollTop});for(typeof S.focus=="function"&&S.focus(),S=0;S<le.length;S++){var ae=le[S];ae.element.scrollLeft=ae.left,ae.element.scrollTop=ae.top}}kd=!!cg,ug=cg=null}finally{Ze=m,oe.p=u,G.T=o}}n.current=r,Gt=2}}function Ob(){if(Gt===2){Gt=0;var n=wr,r=Yo,o=(r.flags&8772)!==0;if((r.subtreeFlags&8772)!==0||o){o=G.T,G.T=null;var u=oe.p;oe.p=2;var m=Ze;Ze|=4;try{lb(n,r.alternate,r)}finally{Ze=m,oe.p=u,G.T=o}}Gt=3}}function Vb(){if(Gt===4||Gt===3){Gt=0,ua();var n=wr,r=Yo,o=Ms,u=Tb;(r.subtreeFlags&10256)!==0||(r.flags&10256)!==0?Gt=5:(Gt=0,Yo=wr=null,Mb(n,n.pendingLanes));var m=n.pendingLanes;if(m===0&&(Sr=null),_s(o),r=r.stateNode,Ht&&typeof Ht.onCommitFiberRoot=="function")try{Ht.onCommitFiberRoot(Dn,r,void 0,(r.current.flags&128)===128)}catch{}if(u!==null){r=G.T,m=oe.p,oe.p=2,G.T=null;try{for(var g=n.onRecoverableError,T=0;T<u.length;T++){var S=u[T];g(S.value,{componentStack:S.stack})}}finally{G.T=r,oe.p=m}}(Ms&3)!==0&&Td(),es(n),m=n.pendingLanes,(o&261930)!==0&&(m&42)!==0?n===Yp?Qc++:(Qc=0,Yp=n):Qc=0,Kc(0)}}function Mb(n,r){(n.pooledCacheLanes&=r)===0&&(r=n.pooledCache,r!=null&&(n.pooledCache=null,Ic(r)))}function Td(){return kb(),Ob(),Vb(),Pb()}function Pb(){if(Gt!==5)return!1;var n=wr,r=$p;$p=0;var o=_s(Ms),u=G.T,m=oe.p;try{oe.p=32>o?32:o,G.T=null,o=Wp,Wp=null;var g=wr,T=Ms;if(Gt=0,Yo=wr=null,Ms=0,(Ze&6)!==0)throw Error(i(331));var S=Ze;if(Ze|=4,vb(g.current),pb(g,g.current,T,o),Ze=S,Kc(0,!1),Ht&&typeof Ht.onPostCommitFiberRoot=="function")try{Ht.onPostCommitFiberRoot(Dn,g)}catch{}return!0}finally{oe.p=m,G.T=u,Mb(n,r)}}function Lb(n,r,o){r=ti(o,r),r=Cp(n.stateNode,r,2),n=vr(n,r,2),n!==null&&(ma(n,2),es(n))}function nt(n,r,o){if(n.tag===3)Lb(n,n,o);else for(;r!==null;){if(r.tag===3){Lb(r,n,o);break}else if(r.tag===1){var u=r.stateNode;if(typeof r.type.getDerivedStateFromError=="function"||typeof u.componentDidCatch=="function"&&(Sr===null||!Sr.has(u))){n=ti(o,n),o=U0(2),u=vr(r,o,2),u!==null&&(z0(o,u,r,n),ma(u,2),es(u));break}}r=r.return}}function Zp(n,r,o){var u=n.pingCache;if(u===null){u=n.pingCache=new VI;var m=new Set;u.set(r,m)}else m=u.get(r),m===void 0&&(m=new Set,u.set(r,m));m.has(o)||(Gp=!0,m.add(o),n=zI.bind(null,n,r,o),r.then(n,n))}function zI(n,r,o){var u=n.pingCache;u!==null&&u.delete(r),n.pingedLanes|=n.suspendedLanes&o,n.warmLanes&=~o,ht===n&&(ze&o)===o&&(Ct===4||Ct===3&&(ze&62914560)===ze&&300>vt()-pd?(Ze&2)===0&&Xo(n,0):Qp|=o,Wo===ze&&(Wo=0)),es(n)}function Ub(n,r){r===0&&(r=yh()),n=Ca(n,r),n!==null&&(ma(n,r),es(n))}function BI(n){var r=n.memoizedState,o=0;r!==null&&(o=r.retryLane),Ub(n,o)}function FI(n,r){var o=0;switch(n.tag){case 31:case 13:var u=n.stateNode,m=n.memoizedState;m!==null&&(o=m.retryLane);break;case 19:u=n.stateNode;break;case 22:u=n.stateNode._retryCache;break;default:throw Error(i(314))}u!==null&&u.delete(r),Ub(n,o)}function qI(n,r){return mt(n,r)}var Ed=null,Zo=null,eg=!1,xd=!1,tg=!1,Ir=0;function es(n){n!==Zo&&n.next===null&&(Zo===null?Ed=Zo=n:Zo=Zo.next=n),xd=!0,eg||(eg=!0,GI())}function Kc(n,r){if(!tg&&xd){tg=!0;do for(var o=!1,u=Ed;u!==null;){if(n!==0){var m=u.pendingLanes;if(m===0)var g=0;else{var T=u.suspendedLanes,S=u.pingedLanes;g=(1<<31-de(42|n)+1)-1,g&=m&~(T&~S),g=g&201326741?g&201326741|1:g?g|2:0}g!==0&&(o=!0,qb(u,g))}else g=ze,g=Mi(u,u===ht?g:0,u.cancelPendingCommit!==null||u.timeoutHandle!==-1),(g&3)===0||mi(u,g)||(o=!0,qb(u,g));u=u.next}while(o);tg=!1}}function HI(){zb()}function zb(){xd=eg=!1;var n=0;Ir!==0&&t2()&&(n=Ir);for(var r=vt(),o=null,u=Ed;u!==null;){var m=u.next,g=Bb(u,r);g===0?(u.next=null,o===null?Ed=m:o.next=m,m===null&&(Zo=o)):(o=u,(n!==0||(g&3)!==0)&&(xd=!0)),u=m}Gt!==0&&Gt!==5||Kc(n),Ir!==0&&(Ir=0)}function Bb(n,r){for(var o=n.suspendedLanes,u=n.pingedLanes,m=n.expirationTimes,g=n.pendingLanes&-62914561;0<g;){var T=31-de(g),S=1<<T,P=m[T];P===-1?((S&o)===0||(S&u)!==0)&&(m[T]=Dm(S,r)):P<=r&&(n.expiredLanes|=S),g&=~S}if(r=ht,o=ze,o=Mi(n,n===r?o:0,n.cancelPendingCommit!==null||n.timeoutHandle!==-1),u=n.callbackNode,o===0||n===r&&(tt===2||tt===9)||n.cancelPendingCommit!==null)return u!==null&&u!==null&&fi(u),n.callbackNode=null,n.callbackPriority=0;if((o&3)===0||mi(n,o)){if(r=o&-o,r===n.callbackPriority)return r;switch(u!==null&&fi(u),_s(o)){case 2:case 8:o=da;break;case 32:o=Oi;break;case 268435456:o=go;break;default:o=Oi}return u=Fb.bind(null,n),o=mt(o,u),n.callbackPriority=r,n.callbackNode=o,r}return u!==null&&u!==null&&fi(u),n.callbackPriority=2,n.callbackNode=null,2}function Fb(n,r){if(Gt!==0&&Gt!==5)return n.callbackNode=null,n.callbackPriority=0,null;var o=n.callbackNode;if(Td()&&n.callbackNode!==o)return null;var u=ze;return u=Mi(n,n===ht?u:0,n.cancelPendingCommit!==null||n.timeoutHandle!==-1),u===0?null:(xb(n,u,r),Bb(n,vt()),n.callbackNode!=null&&n.callbackNode===o?Fb.bind(null,n):null)}function qb(n,r){if(Td())return null;xb(n,r,!0)}function GI(){i2(function(){(Ze&6)!==0?mt(ha,HI):zb()})}function ng(){if(Ir===0){var n=Lo;n===0&&(n=dt,dt<<=1,(dt&261888)===0&&(dt=256)),Ir=n}return Ir}function Hb(n){return n==null||typeof n=="symbol"||typeof n=="boolean"?null:typeof n=="function"?n:xo(""+n)}function Gb(n,r){var o=r.ownerDocument.createElement("input");return o.name=r.name,o.value=r.value,n.id&&o.setAttribute("form",n.id),r.parentNode.insertBefore(o,r),n=new FormData(n),o.parentNode.removeChild(o),n}function QI(n,r,o,u,m){if(r==="submit"&&o&&o.stateNode===m){var g=Hb((m[$t]||null).action),T=u.submitter;T&&(r=(r=T[$t]||null)?Hb(r.formAction):T.getAttribute("formAction"),r!==null&&(g=r,T=null));var S=new Ki("action","action",null,u,m);n.push({event:S,listeners:[{instance:null,listener:function(){if(u.defaultPrevented){if(Ir!==0){var P=T?Gb(m,T):new FormData(m);Ep(o,{pending:!0,data:P,method:m.method,action:g},null,P)}}else typeof g=="function"&&(S.preventDefault(),P=T?Gb(m,T):new FormData(m),Ep(o,{pending:!0,data:P,method:m.method,action:g},g,P))},currentTarget:m}]})}}for(var ig=0;ig<Um.length;ig++){var sg=Um[ig],KI=sg.toLowerCase(),$I=sg[0].toUpperCase()+sg.slice(1);Ei(KI,"on"+$I)}Ei(E_,"onAnimationEnd"),Ei(x_,"onAnimationIteration"),Ei(S_,"onAnimationStart"),Ei("dblclick","onDoubleClick"),Ei("focusin","onFocus"),Ei("focusout","onBlur"),Ei(uI,"onTransitionRun"),Ei(hI,"onTransitionStart"),Ei(dI,"onTransitionCancel"),Ei(w_,"onTransitionEnd"),qi("onMouseEnter",["mouseout","mouseover"]),qi("onMouseLeave",["mouseout","mouseover"]),qi("onPointerEnter",["pointerout","pointerover"]),qi("onPointerLeave",["pointerout","pointerover"]),Fi("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),Fi("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),Fi("onBeforeInput",["compositionend","keypress","textInput","paste"]),Fi("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),Fi("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),Fi("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var $c="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),WI=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat($c));function Qb(n,r){r=(r&4)!==0;for(var o=0;o<n.length;o++){var u=n[o],m=u.event;u=u.listeners;e:{var g=void 0;if(r)for(var T=u.length-1;0<=T;T--){var S=u[T],P=S.instance,K=S.currentTarget;if(S=S.listener,P!==g&&m.isPropagationStopped())break e;g=S,m.currentTarget=K;try{g(m)}catch(ie){Lh(ie)}m.currentTarget=null,g=P}else for(T=0;T<u.length;T++){if(S=u[T],P=S.instance,K=S.currentTarget,S=S.listener,P!==g&&m.isPropagationStopped())break e;g=S,m.currentTarget=K;try{g(m)}catch(ie){Lh(ie)}m.currentTarget=null,g=P}}}}function Ue(n,r){var o=r[vo];o===void 0&&(o=r[vo]=new Set);var u=n+"__bubble";o.has(u)||(Kb(r,n,2,!1),o.add(u))}function rg(n,r,o){var u=0;r&&(u|=4),Kb(o,n,u,r)}var Sd="_reactListening"+Math.random().toString(36).slice(2);function ag(n){if(!n[Sd]){n[Sd]=!0,ac.forEach(function(o){o!=="selectionchange"&&(WI.has(o)||rg(o,!1,n),rg(o,!0,n))});var r=n.nodeType===9?n:n.ownerDocument;r===null||r[Sd]||(r[Sd]=!0,rg("selectionchange",!1,r))}}function Kb(n,r,o,u){switch(ET(r)){case 2:var m=x2;break;case 8:m=S2;break;default:m=Tg}o=m.bind(null,r,o,n),m=void 0,!ba||r!=="touchstart"&&r!=="touchmove"&&r!=="wheel"||(m=!0),u?m!==void 0?n.addEventListener(r,o,{capture:!0,passive:m}):n.addEventListener(r,o,!0):m!==void 0?n.addEventListener(r,o,{passive:m}):n.addEventListener(r,o,!1)}function og(n,r,o,u,m){var g=u;if((r&1)===0&&(r&2)===0&&u!==null)e:for(;;){if(u===null)return;var T=u.tag;if(T===3||T===4){var S=u.stateNode.containerInfo;if(S===m)break;if(T===4)for(T=u.return;T!==null;){var P=T.tag;if((P===3||P===4)&&T.stateNode.containerInfo===m)return;T=T.return}for(;S!==null;){if(T=zi(S),T===null)return;if(P=T.tag,P===5||P===6||P===26||P===27){u=g=T;continue e}S=S.parentNode}}u=u.return}lr(function(){var K=g,ie=Xn(o),le=[];e:{var W=A_.get(n);if(W!==void 0){var J=Ki,ve=n;switch(n){case"keypress":if(Ea(o)===0)break e;case"keydown":case"keyup":J=Vh;break;case"focusin":ve="focus",J=Sa;break;case"focusout":ve="blur",J=Sa;break;case"beforeblur":case"afterblur":J=Sa;break;case"click":if(o.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":J=_c;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":J=Ah;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":J=_;break;case E_:case x_:case S_:J=Ch;break;case w_:J=I;break;case"scroll":case"scrollend":J=vc;break;case"wheel":J=X;break;case"copy":case"cut":case"paste":J=Rh;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":J=Es;break;case"toggle":case"beforetoggle":J=ke}var Ce=(r&4)!==0,ct=!Ce&&(n==="scroll"||n==="scrollend"),F=Ce?W!==null?W+"Capture":null:W;Ce=[];for(var B=K,Q;B!==null;){var ae=B;if(Q=ae.stateNode,ae=ae.tag,ae!==5&&ae!==26&&ae!==27||Q===null||F===null||(ae=vi(B,F),ae!=null&&Ce.push(Wc(B,ae,Q))),ct)break;B=B.return}0<Ce.length&&(W=new J(W,ve,null,o,ie),le.push({event:W,listeners:Ce}))}}if((r&7)===0){e:{if(W=n==="mouseover"||n==="pointerover",J=n==="mouseout"||n==="pointerout",W&&o!==pc&&(ve=o.relatedTarget||o.fromElement)&&(zi(ve)||ve[Li]))break e;if((J||W)&&(W=ie.window===ie?ie:(W=ie.ownerDocument)?W.defaultView||W.parentWindow:window,J?(ve=o.relatedTarget||o.toElement,J=K,ve=ve?zi(ve):null,ve!==null&&(ct=l(ve),Ce=ve.tag,ve!==ct||Ce!==5&&Ce!==27&&Ce!==6)&&(ve=null)):(J=null,ve=K),J!==ve)){if(Ce=_c,ae="onMouseLeave",F="onMouseEnter",B="mouse",(n==="pointerout"||n==="pointerover")&&(Ce=Es,ae="onPointerLeave",F="onPointerEnter",B="pointer"),ct=J==null?W:jn(J),Q=ve==null?W:jn(ve),W=new Ce(ae,B+"leave",J,o,ie),W.target=ct,W.relatedTarget=Q,ae=null,zi(ie)===K&&(Ce=new Ce(F,B+"enter",ve,o,ie),Ce.target=Q,Ce.relatedTarget=ct,ae=Ce),ct=ae,J&&ve)t:{for(Ce=YI,F=J,B=ve,Q=0,ae=F;ae;ae=Ce(ae))Q++;ae=0;for(var Ae=B;Ae;Ae=Ce(Ae))ae++;for(;0<Q-ae;)F=Ce(F),Q--;for(;0<ae-Q;)B=Ce(B),ae--;for(;Q--;){if(F===B||B!==null&&F===B.alternate){Ce=F;break t}F=Ce(F),B=Ce(B)}Ce=null}else Ce=null;J!==null&&$b(le,W,J,Ce,!1),ve!==null&&ct!==null&&$b(le,ct,ve,Ce,!0)}}e:{if(W=K?jn(K):window,J=W.nodeName&&W.nodeName.toLowerCase(),J==="select"||J==="input"&&W.type==="file")var Ye=h_;else if(c_(W))if(d_)Ye=oI;else{Ye=rI;var Ee=sI}else J=W.nodeName,!J||J.toLowerCase()!=="input"||W.type!=="checkbox"&&W.type!=="radio"?K&&Eo(K.elementType)&&(Ye=h_):Ye=aI;if(Ye&&(Ye=Ye(n,K))){u_(le,Ye,o,ie);break e}Ee&&Ee(n,W,K),n==="focusout"&&K&&W.type==="number"&&K.memoizedProps.value!=null&&dc(W,"number",W.value)}switch(Ee=K?jn(K):window,n){case"focusin":(c_(Ee)||Ee.contentEditable==="true")&&(Do=Ee,Mm=K,Sc=null);break;case"focusout":Sc=Mm=Do=null;break;case"mousedown":Pm=!0;break;case"contextmenu":case"mouseup":case"dragend":Pm=!1,b_(le,o,ie);break;case"selectionchange":if(cI)break;case"keydown":case"keyup":b_(le,o,ie)}var Ve;if(Je)e:{switch(n){case"compositionstart":var Be="onCompositionStart";break e;case"compositionend":Be="onCompositionEnd";break e;case"compositionupdate":Be="onCompositionUpdate";break e}Be=void 0}else Ro?wa(n,o)&&(Be="onCompositionEnd"):n==="keydown"&&o.keyCode===229&&(Be="onCompositionStart");Be&&(Yi&&o.locale!=="ko"&&(Ro||Be!=="onCompositionStart"?Be==="onCompositionEnd"&&Ro&&(Ve=yc()):(Qi=ie,gc="value"in Qi?Qi.value:Qi.textContent,Ro=!0)),Ee=wd(K,Be),0<Ee.length&&(Be=new Wi(Be,n,null,o,ie),le.push({event:Be,listeners:Ee}),Ve?Be.data=Ve:(Ve=Co(o),Ve!==null&&(Be.data=Ve)))),(Ve=Zn?eI(n,o):tI(n,o))&&(Be=wd(K,"onBeforeInput"),0<Be.length&&(Ee=new Wi("onBeforeInput","beforeinput",null,o,ie),le.push({event:Ee,listeners:Be}),Ee.data=Ve)),QI(le,n,K,o,ie)}Qb(le,r)})}function Wc(n,r,o){return{instance:n,listener:r,currentTarget:o}}function wd(n,r){for(var o=r+"Capture",u=[];n!==null;){var m=n,g=m.stateNode;if(m=m.tag,m!==5&&m!==26&&m!==27||g===null||(m=vi(n,o),m!=null&&u.unshift(Wc(n,m,g)),m=vi(n,r),m!=null&&u.push(Wc(n,m,g))),n.tag===3)return u;n=n.return}return[]}function YI(n){if(n===null)return null;do n=n.return;while(n&&n.tag!==5&&n.tag!==27);return n||null}function $b(n,r,o,u,m){for(var g=r._reactName,T=[];o!==null&&o!==u;){var S=o,P=S.alternate,K=S.stateNode;if(S=S.tag,P!==null&&P===u)break;S!==5&&S!==26&&S!==27||K===null||(P=K,m?(K=vi(o,g),K!=null&&T.unshift(Wc(o,K,P))):m||(K=vi(o,g),K!=null&&T.push(Wc(o,K,P)))),o=o.return}T.length!==0&&n.push({event:r,listeners:T})}var XI=/\r\n?/g,JI=/\u0000|\uFFFD/g;function Wb(n){return(typeof n=="string"?n:""+n).replace(XI,`
`).replace(JI,"")}function Yb(n,r){return r=Wb(r),Wb(n)===r}function lt(n,r,o,u,m,g){switch(o){case"children":typeof u=="string"?r==="body"||r==="textarea"&&u===""||En(n,u):(typeof u=="number"||typeof u=="bigint")&&r!=="body"&&En(n,""+u);break;case"className":kn(n,"class",u);break;case"tabIndex":kn(n,"tabindex",u);break;case"dir":case"role":case"viewBox":case"width":case"height":kn(n,o,u);break;case"style":mc(n,u,g);break;case"data":if(r!=="object"){kn(n,"data",u);break}case"src":case"href":if(u===""&&(r!=="a"||o!=="href")){n.removeAttribute(o);break}if(u==null||typeof u=="function"||typeof u=="symbol"||typeof u=="boolean"){n.removeAttribute(o);break}u=xo(""+u),n.setAttribute(o,u);break;case"action":case"formAction":if(typeof u=="function"){n.setAttribute(o,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof g=="function"&&(o==="formAction"?(r!=="input"&&lt(n,r,"name",m.name,m,null),lt(n,r,"formEncType",m.formEncType,m,null),lt(n,r,"formMethod",m.formMethod,m,null),lt(n,r,"formTarget",m.formTarget,m,null)):(lt(n,r,"encType",m.encType,m,null),lt(n,r,"method",m.method,m,null),lt(n,r,"target",m.target,m,null)));if(u==null||typeof u=="symbol"||typeof u=="boolean"){n.removeAttribute(o);break}u=xo(""+u),n.setAttribute(o,u);break;case"onClick":u!=null&&(n.onclick=yi);break;case"onScroll":u!=null&&Ue("scroll",n);break;case"onScrollEnd":u!=null&&Ue("scrollend",n);break;case"dangerouslySetInnerHTML":if(u!=null){if(typeof u!="object"||!("__html"in u))throw Error(i(61));if(o=u.__html,o!=null){if(m.children!=null)throw Error(i(60));n.innerHTML=o}}break;case"multiple":n.multiple=u&&typeof u!="function"&&typeof u!="symbol";break;case"muted":n.muted=u&&typeof u!="function"&&typeof u!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(u==null||typeof u=="function"||typeof u=="boolean"||typeof u=="symbol"){n.removeAttribute("xlink:href");break}o=xo(""+u),n.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",o);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":u!=null&&typeof u!="function"&&typeof u!="symbol"?n.setAttribute(o,""+u):n.removeAttribute(o);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":u&&typeof u!="function"&&typeof u!="symbol"?n.setAttribute(o,""):n.removeAttribute(o);break;case"capture":case"download":u===!0?n.setAttribute(o,""):u!==!1&&u!=null&&typeof u!="function"&&typeof u!="symbol"?n.setAttribute(o,u):n.removeAttribute(o);break;case"cols":case"rows":case"size":case"span":u!=null&&typeof u!="function"&&typeof u!="symbol"&&!isNaN(u)&&1<=u?n.setAttribute(o,u):n.removeAttribute(o);break;case"rowSpan":case"start":u==null||typeof u=="function"||typeof u=="symbol"||isNaN(u)?n.removeAttribute(o):n.setAttribute(o,u);break;case"popover":Ue("beforetoggle",n),Ue("toggle",n),bo(n,"popover",u);break;case"xlinkActuate":Pt(n,"http://www.w3.org/1999/xlink","xlink:actuate",u);break;case"xlinkArcrole":Pt(n,"http://www.w3.org/1999/xlink","xlink:arcrole",u);break;case"xlinkRole":Pt(n,"http://www.w3.org/1999/xlink","xlink:role",u);break;case"xlinkShow":Pt(n,"http://www.w3.org/1999/xlink","xlink:show",u);break;case"xlinkTitle":Pt(n,"http://www.w3.org/1999/xlink","xlink:title",u);break;case"xlinkType":Pt(n,"http://www.w3.org/1999/xlink","xlink:type",u);break;case"xmlBase":Pt(n,"http://www.w3.org/XML/1998/namespace","xml:base",u);break;case"xmlLang":Pt(n,"http://www.w3.org/XML/1998/namespace","xml:lang",u);break;case"xmlSpace":Pt(n,"http://www.w3.org/XML/1998/namespace","xml:space",u);break;case"is":bo(n,"is",u);break;case"innerText":case"textContent":break;default:(!(2<o.length)||o[0]!=="o"&&o[0]!=="O"||o[1]!=="n"&&o[1]!=="N")&&(o=wh.get(o)||o,bo(n,o,u))}}function lg(n,r,o,u,m,g){switch(o){case"style":mc(n,u,g);break;case"dangerouslySetInnerHTML":if(u!=null){if(typeof u!="object"||!("__html"in u))throw Error(i(61));if(o=u.__html,o!=null){if(m.children!=null)throw Error(i(60));n.innerHTML=o}}break;case"children":typeof u=="string"?En(n,u):(typeof u=="number"||typeof u=="bigint")&&En(n,""+u);break;case"onScroll":u!=null&&Ue("scroll",n);break;case"onScrollEnd":u!=null&&Ue("scrollend",n);break;case"onClick":u!=null&&(n.onclick=yi);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!oc.hasOwnProperty(o))e:{if(o[0]==="o"&&o[1]==="n"&&(m=o.endsWith("Capture"),r=o.slice(2,m?o.length-7:void 0),g=n[$t]||null,g=g!=null?g[o]:null,typeof g=="function"&&n.removeEventListener(r,g,m),typeof u=="function")){typeof g!="function"&&g!==null&&(o in n?n[o]=null:n.hasAttribute(o)&&n.removeAttribute(o)),n.addEventListener(r,u,m);break e}o in n?n[o]=u:u===!0?n.setAttribute(o,""):bo(n,o,u)}}}function rn(n,r,o){switch(r){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":Ue("error",n),Ue("load",n);var u=!1,m=!1,g;for(g in o)if(o.hasOwnProperty(g)){var T=o[g];if(T!=null)switch(g){case"src":u=!0;break;case"srcSet":m=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(i(137,r));default:lt(n,r,g,T,o,null)}}m&&lt(n,r,"srcSet",o.srcSet,o,null),u&&lt(n,r,"src",o.src,o,null);return;case"input":Ue("invalid",n);var S=g=T=m=null,P=null,K=null;for(u in o)if(o.hasOwnProperty(u)){var ie=o[u];if(ie!=null)switch(u){case"name":m=ie;break;case"type":T=ie;break;case"checked":P=ie;break;case"defaultChecked":K=ie;break;case"value":g=ie;break;case"defaultValue":S=ie;break;case"children":case"dangerouslySetInnerHTML":if(ie!=null)throw Error(i(137,r));break;default:lt(n,r,u,ie,o,null)}}Eh(n,g,S,P,K,T,m,!1);return;case"select":Ue("invalid",n),u=T=g=null;for(m in o)if(o.hasOwnProperty(m)&&(S=o[m],S!=null))switch(m){case"value":g=S;break;case"defaultValue":T=S;break;case"multiple":u=S;default:lt(n,r,m,S,o,null)}r=g,o=T,n.multiple=!!u,r!=null?sr(n,!!u,r,!1):o!=null&&sr(n,!!u,o,!0);return;case"textarea":Ue("invalid",n),g=m=u=null;for(T in o)if(o.hasOwnProperty(T)&&(S=o[T],S!=null))switch(T){case"value":u=S;break;case"defaultValue":m=S;break;case"children":g=S;break;case"dangerouslySetInnerHTML":if(S!=null)throw Error(i(91));break;default:lt(n,r,T,S,o,null)}rr(n,u,m,g);return;case"option":for(P in o)o.hasOwnProperty(P)&&(u=o[P],u!=null)&&(P==="selected"?n.selected=u&&typeof u!="function"&&typeof u!="symbol":lt(n,r,P,u,o,null));return;case"dialog":Ue("beforetoggle",n),Ue("toggle",n),Ue("cancel",n),Ue("close",n);break;case"iframe":case"object":Ue("load",n);break;case"video":case"audio":for(u=0;u<$c.length;u++)Ue($c[u],n);break;case"image":Ue("error",n),Ue("load",n);break;case"details":Ue("toggle",n);break;case"embed":case"source":case"link":Ue("error",n),Ue("load",n);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(K in o)if(o.hasOwnProperty(K)&&(u=o[K],u!=null))switch(K){case"children":case"dangerouslySetInnerHTML":throw Error(i(137,r));default:lt(n,r,K,u,o,null)}return;default:if(Eo(r)){for(ie in o)o.hasOwnProperty(ie)&&(u=o[ie],u!==void 0&&lg(n,r,ie,u,o,void 0));return}}for(S in o)o.hasOwnProperty(S)&&(u=o[S],u!=null&&lt(n,r,S,u,o,null))}function ZI(n,r,o,u){switch(r){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var m=null,g=null,T=null,S=null,P=null,K=null,ie=null;for(J in o){var le=o[J];if(o.hasOwnProperty(J)&&le!=null)switch(J){case"checked":break;case"value":break;case"defaultValue":P=le;default:u.hasOwnProperty(J)||lt(n,r,J,null,u,le)}}for(var W in u){var J=u[W];if(le=o[W],u.hasOwnProperty(W)&&(J!=null||le!=null))switch(W){case"type":g=J;break;case"name":m=J;break;case"checked":K=J;break;case"defaultChecked":ie=J;break;case"value":T=J;break;case"defaultValue":S=J;break;case"children":case"dangerouslySetInnerHTML":if(J!=null)throw Error(i(137,r));break;default:J!==le&&lt(n,r,W,J,u,le)}}To(n,T,S,P,K,ie,g,m);return;case"select":J=T=S=W=null;for(g in o)if(P=o[g],o.hasOwnProperty(g)&&P!=null)switch(g){case"value":break;case"multiple":J=P;default:u.hasOwnProperty(g)||lt(n,r,g,null,u,P)}for(m in u)if(g=u[m],P=o[m],u.hasOwnProperty(m)&&(g!=null||P!=null))switch(m){case"value":W=g;break;case"defaultValue":S=g;break;case"multiple":T=g;default:g!==P&&lt(n,r,m,g,u,P)}r=S,o=T,u=J,W!=null?sr(n,!!o,W,!1):!!u!=!!o&&(r!=null?sr(n,!!o,r,!0):sr(n,!!o,o?[]:"",!1));return;case"textarea":J=W=null;for(S in o)if(m=o[S],o.hasOwnProperty(S)&&m!=null&&!u.hasOwnProperty(S))switch(S){case"value":break;case"children":break;default:lt(n,r,S,null,u,m)}for(T in u)if(m=u[T],g=o[T],u.hasOwnProperty(T)&&(m!=null||g!=null))switch(T){case"value":W=m;break;case"defaultValue":J=m;break;case"children":break;case"dangerouslySetInnerHTML":if(m!=null)throw Error(i(91));break;default:m!==g&&lt(n,r,T,m,u,g)}xh(n,W,J);return;case"option":for(var ve in o)W=o[ve],o.hasOwnProperty(ve)&&W!=null&&!u.hasOwnProperty(ve)&&(ve==="selected"?n.selected=!1:lt(n,r,ve,null,u,W));for(P in u)W=u[P],J=o[P],u.hasOwnProperty(P)&&W!==J&&(W!=null||J!=null)&&(P==="selected"?n.selected=W&&typeof W!="function"&&typeof W!="symbol":lt(n,r,P,W,u,J));return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var Ce in o)W=o[Ce],o.hasOwnProperty(Ce)&&W!=null&&!u.hasOwnProperty(Ce)&&lt(n,r,Ce,null,u,W);for(K in u)if(W=u[K],J=o[K],u.hasOwnProperty(K)&&W!==J&&(W!=null||J!=null))switch(K){case"children":case"dangerouslySetInnerHTML":if(W!=null)throw Error(i(137,r));break;default:lt(n,r,K,W,u,J)}return;default:if(Eo(r)){for(var ct in o)W=o[ct],o.hasOwnProperty(ct)&&W!==void 0&&!u.hasOwnProperty(ct)&&lg(n,r,ct,void 0,u,W);for(ie in u)W=u[ie],J=o[ie],!u.hasOwnProperty(ie)||W===J||W===void 0&&J===void 0||lg(n,r,ie,W,u,J);return}}for(var F in o)W=o[F],o.hasOwnProperty(F)&&W!=null&&!u.hasOwnProperty(F)&&lt(n,r,F,null,u,W);for(le in u)W=u[le],J=o[le],!u.hasOwnProperty(le)||W===J||W==null&&J==null||lt(n,r,le,W,u,J)}function Xb(n){switch(n){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function e2(){if(typeof performance.getEntriesByType=="function"){for(var n=0,r=0,o=performance.getEntriesByType("resource"),u=0;u<o.length;u++){var m=o[u],g=m.transferSize,T=m.initiatorType,S=m.duration;if(g&&S&&Xb(T)){for(T=0,S=m.responseEnd,u+=1;u<o.length;u++){var P=o[u],K=P.startTime;if(K>S)break;var ie=P.transferSize,le=P.initiatorType;ie&&Xb(le)&&(P=P.responseEnd,T+=ie*(P<S?1:(S-K)/(P-K)))}if(--u,r+=8*(g+T)/(m.duration/1e3),n++,10<n)break}}if(0<n)return r/n/1e6}return navigator.connection&&(n=navigator.connection.downlink,typeof n=="number")?n:5}var cg=null,ug=null;function Ad(n){return n.nodeType===9?n:n.ownerDocument}function Jb(n){switch(n){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function Zb(n,r){if(n===0)switch(r){case"svg":return 1;case"math":return 2;default:return 0}return n===1&&r==="foreignObject"?0:n}function hg(n,r){return n==="textarea"||n==="noscript"||typeof r.children=="string"||typeof r.children=="number"||typeof r.children=="bigint"||typeof r.dangerouslySetInnerHTML=="object"&&r.dangerouslySetInnerHTML!==null&&r.dangerouslySetInnerHTML.__html!=null}var dg=null;function t2(){var n=window.event;return n&&n.type==="popstate"?n===dg?!1:(dg=n,!0):(dg=null,!1)}var eT=typeof setTimeout=="function"?setTimeout:void 0,n2=typeof clearTimeout=="function"?clearTimeout:void 0,tT=typeof Promise=="function"?Promise:void 0,i2=typeof queueMicrotask=="function"?queueMicrotask:typeof tT<"u"?function(n){return tT.resolve(null).then(n).catch(s2)}:eT;function s2(n){setTimeout(function(){throw n})}function Cr(n){return n==="head"}function nT(n,r){var o=r,u=0;do{var m=o.nextSibling;if(n.removeChild(o),m&&m.nodeType===8)if(o=m.data,o==="/$"||o==="/&"){if(u===0){n.removeChild(m),il(r);return}u--}else if(o==="$"||o==="$?"||o==="$~"||o==="$!"||o==="&")u++;else if(o==="html")Yc(n.ownerDocument.documentElement);else if(o==="head"){o=n.ownerDocument.head,Yc(o);for(var g=o.firstChild;g;){var T=g.nextSibling,S=g.nodeName;g[Ui]||S==="SCRIPT"||S==="STYLE"||S==="LINK"&&g.rel.toLowerCase()==="stylesheet"||o.removeChild(g),g=T}}else o==="body"&&Yc(n.ownerDocument.body);o=m}while(o);il(r)}function iT(n,r){var o=n;n=0;do{var u=o.nextSibling;if(o.nodeType===1?r?(o._stashedDisplay=o.style.display,o.style.display="none"):(o.style.display=o._stashedDisplay||"",o.getAttribute("style")===""&&o.removeAttribute("style")):o.nodeType===3&&(r?(o._stashedText=o.nodeValue,o.nodeValue=""):o.nodeValue=o._stashedText||""),u&&u.nodeType===8)if(o=u.data,o==="/$"){if(n===0)break;n--}else o!=="$"&&o!=="$?"&&o!=="$~"&&o!=="$!"||n++;o=u}while(o)}function fg(n){var r=n.firstChild;for(r&&r.nodeType===10&&(r=r.nextSibling);r;){var o=r;switch(r=r.nextSibling,o.nodeName){case"HTML":case"HEAD":case"BODY":fg(o),_o(o);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(o.rel.toLowerCase()==="stylesheet")continue}n.removeChild(o)}}function r2(n,r,o,u){for(;n.nodeType===1;){var m=o;if(n.nodeName.toLowerCase()!==r.toLowerCase()){if(!u&&(n.nodeName!=="INPUT"||n.type!=="hidden"))break}else if(u){if(!n[Ui])switch(r){case"meta":if(!n.hasAttribute("itemprop"))break;return n;case"link":if(g=n.getAttribute("rel"),g==="stylesheet"&&n.hasAttribute("data-precedence"))break;if(g!==m.rel||n.getAttribute("href")!==(m.href==null||m.href===""?null:m.href)||n.getAttribute("crossorigin")!==(m.crossOrigin==null?null:m.crossOrigin)||n.getAttribute("title")!==(m.title==null?null:m.title))break;return n;case"style":if(n.hasAttribute("data-precedence"))break;return n;case"script":if(g=n.getAttribute("src"),(g!==(m.src==null?null:m.src)||n.getAttribute("type")!==(m.type==null?null:m.type)||n.getAttribute("crossorigin")!==(m.crossOrigin==null?null:m.crossOrigin))&&g&&n.hasAttribute("async")&&!n.hasAttribute("itemprop"))break;return n;default:return n}}else if(r==="input"&&n.type==="hidden"){var g=m.name==null?null:""+m.name;if(m.type==="hidden"&&n.getAttribute("name")===g)return n}else return n;if(n=ai(n.nextSibling),n===null)break}return null}function a2(n,r,o){if(r==="")return null;for(;n.nodeType!==3;)if((n.nodeType!==1||n.nodeName!=="INPUT"||n.type!=="hidden")&&!o||(n=ai(n.nextSibling),n===null))return null;return n}function sT(n,r){for(;n.nodeType!==8;)if((n.nodeType!==1||n.nodeName!=="INPUT"||n.type!=="hidden")&&!r||(n=ai(n.nextSibling),n===null))return null;return n}function mg(n){return n.data==="$?"||n.data==="$~"}function pg(n){return n.data==="$!"||n.data==="$?"&&n.ownerDocument.readyState!=="loading"}function o2(n,r){var o=n.ownerDocument;if(n.data==="$~")n._reactRetry=r;else if(n.data!=="$?"||o.readyState!=="loading")r();else{var u=function(){r(),o.removeEventListener("DOMContentLoaded",u)};o.addEventListener("DOMContentLoaded",u),n._reactRetry=u}}function ai(n){for(;n!=null;n=n.nextSibling){var r=n.nodeType;if(r===1||r===3)break;if(r===8){if(r=n.data,r==="$"||r==="$!"||r==="$?"||r==="$~"||r==="&"||r==="F!"||r==="F")break;if(r==="/$"||r==="/&")return null}}return n}var gg=null;function rT(n){n=n.nextSibling;for(var r=0;n;){if(n.nodeType===8){var o=n.data;if(o==="/$"||o==="/&"){if(r===0)return ai(n.nextSibling);r--}else o!=="$"&&o!=="$!"&&o!=="$?"&&o!=="$~"&&o!=="&"||r++}n=n.nextSibling}return null}function aT(n){n=n.previousSibling;for(var r=0;n;){if(n.nodeType===8){var o=n.data;if(o==="$"||o==="$!"||o==="$?"||o==="$~"||o==="&"){if(r===0)return n;r--}else o!=="/$"&&o!=="/&"||r++}n=n.previousSibling}return null}function oT(n,r,o){switch(r=Ad(o),n){case"html":if(n=r.documentElement,!n)throw Error(i(452));return n;case"head":if(n=r.head,!n)throw Error(i(453));return n;case"body":if(n=r.body,!n)throw Error(i(454));return n;default:throw Error(i(451))}}function Yc(n){for(var r=n.attributes;r.length;)n.removeAttributeNode(r[0]);_o(n)}var oi=new Map,lT=new Set;function Id(n){return typeof n.getRootNode=="function"?n.getRootNode():n.nodeType===9?n:n.ownerDocument}var Ps=oe.d;oe.d={f:l2,r:c2,D:u2,C:h2,L:d2,m:f2,X:p2,S:m2,M:g2};function l2(){var n=Ps.f(),r=vd();return n||r}function c2(n){var r=Yn(n);r!==null&&r.tag===5&&r.type==="form"?w0(r):Ps.r(n)}var el=typeof document>"u"?null:document;function cT(n,r,o){var u=el;if(u&&typeof r=="string"&&r){var m=Tn(r);m='link[rel="'+n+'"][href="'+m+'"]',typeof o=="string"&&(m+='[crossorigin="'+o+'"]'),lT.has(m)||(lT.add(m),n={rel:n,crossOrigin:o,href:r},u.querySelector(m)===null&&(r=u.createElement("link"),rn(r,"link",n),Mt(r),u.head.appendChild(r)))}}function u2(n){Ps.D(n),cT("dns-prefetch",n,null)}function h2(n,r){Ps.C(n,r),cT("preconnect",n,r)}function d2(n,r,o){Ps.L(n,r,o);var u=el;if(u&&n&&r){var m='link[rel="preload"][as="'+Tn(r)+'"]';r==="image"&&o&&o.imageSrcSet?(m+='[imagesrcset="'+Tn(o.imageSrcSet)+'"]',typeof o.imageSizes=="string"&&(m+='[imagesizes="'+Tn(o.imageSizes)+'"]')):m+='[href="'+Tn(n)+'"]';var g=m;switch(r){case"style":g=tl(n);break;case"script":g=nl(n)}oi.has(g)||(n=b({rel:"preload",href:r==="image"&&o&&o.imageSrcSet?void 0:n,as:r},o),oi.set(g,n),u.querySelector(m)!==null||r==="style"&&u.querySelector(Xc(g))||r==="script"&&u.querySelector(Jc(g))||(r=u.createElement("link"),rn(r,"link",n),Mt(r),u.head.appendChild(r)))}}function f2(n,r){Ps.m(n,r);var o=el;if(o&&n){var u=r&&typeof r.as=="string"?r.as:"script",m='link[rel="modulepreload"][as="'+Tn(u)+'"][href="'+Tn(n)+'"]',g=m;switch(u){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":g=nl(n)}if(!oi.has(g)&&(n=b({rel:"modulepreload",href:n},r),oi.set(g,n),o.querySelector(m)===null)){switch(u){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(o.querySelector(Jc(g)))return}u=o.createElement("link"),rn(u,"link",n),Mt(u),o.head.appendChild(u)}}}function m2(n,r,o){Ps.S(n,r,o);var u=el;if(u&&n){var m=Bi(u).hoistableStyles,g=tl(n);r=r||"default";var T=m.get(g);if(!T){var S={loading:0,preload:null};if(T=u.querySelector(Xc(g)))S.loading=5;else{n=b({rel:"stylesheet",href:n,"data-precedence":r},o),(o=oi.get(g))&&yg(n,o);var P=T=u.createElement("link");Mt(P),rn(P,"link",n),P._p=new Promise(function(K,ie){P.onload=K,P.onerror=ie}),P.addEventListener("load",function(){S.loading|=1}),P.addEventListener("error",function(){S.loading|=2}),S.loading|=4,Cd(T,r,u)}T={type:"stylesheet",instance:T,count:1,state:S},m.set(g,T)}}}function p2(n,r){Ps.X(n,r);var o=el;if(o&&n){var u=Bi(o).hoistableScripts,m=nl(n),g=u.get(m);g||(g=o.querySelector(Jc(m)),g||(n=b({src:n,async:!0},r),(r=oi.get(m))&&vg(n,r),g=o.createElement("script"),Mt(g),rn(g,"link",n),o.head.appendChild(g)),g={type:"script",instance:g,count:1,state:null},u.set(m,g))}}function g2(n,r){Ps.M(n,r);var o=el;if(o&&n){var u=Bi(o).hoistableScripts,m=nl(n),g=u.get(m);g||(g=o.querySelector(Jc(m)),g||(n=b({src:n,async:!0,type:"module"},r),(r=oi.get(m))&&vg(n,r),g=o.createElement("script"),Mt(g),rn(g,"link",n),o.head.appendChild(g)),g={type:"script",instance:g,count:1,state:null},u.set(m,g))}}function uT(n,r,o,u){var m=(m=Ie.current)?Id(m):null;if(!m)throw Error(i(446));switch(n){case"meta":case"title":return null;case"style":return typeof o.precedence=="string"&&typeof o.href=="string"?(r=tl(o.href),o=Bi(m).hoistableStyles,u=o.get(r),u||(u={type:"style",instance:null,count:0,state:null},o.set(r,u)),u):{type:"void",instance:null,count:0,state:null};case"link":if(o.rel==="stylesheet"&&typeof o.href=="string"&&typeof o.precedence=="string"){n=tl(o.href);var g=Bi(m).hoistableStyles,T=g.get(n);if(T||(m=m.ownerDocument||m,T={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},g.set(n,T),(g=m.querySelector(Xc(n)))&&!g._p&&(T.instance=g,T.state.loading=5),oi.has(n)||(o={rel:"preload",as:"style",href:o.href,crossOrigin:o.crossOrigin,integrity:o.integrity,media:o.media,hrefLang:o.hrefLang,referrerPolicy:o.referrerPolicy},oi.set(n,o),g||y2(m,n,o,T.state))),r&&u===null)throw Error(i(528,""));return T}if(r&&u!==null)throw Error(i(529,""));return null;case"script":return r=o.async,o=o.src,typeof o=="string"&&r&&typeof r!="function"&&typeof r!="symbol"?(r=nl(o),o=Bi(m).hoistableScripts,u=o.get(r),u||(u={type:"script",instance:null,count:0,state:null},o.set(r,u)),u):{type:"void",instance:null,count:0,state:null};default:throw Error(i(444,n))}}function tl(n){return'href="'+Tn(n)+'"'}function Xc(n){return'link[rel="stylesheet"]['+n+"]"}function hT(n){return b({},n,{"data-precedence":n.precedence,precedence:null})}function y2(n,r,o,u){n.querySelector('link[rel="preload"][as="style"]['+r+"]")?u.loading=1:(r=n.createElement("link"),u.preload=r,r.addEventListener("load",function(){return u.loading|=1}),r.addEventListener("error",function(){return u.loading|=2}),rn(r,"link",o),Mt(r),n.head.appendChild(r))}function nl(n){return'[src="'+Tn(n)+'"]'}function Jc(n){return"script[async]"+n}function dT(n,r,o){if(r.count++,r.instance===null)switch(r.type){case"style":var u=n.querySelector('style[data-href~="'+Tn(o.href)+'"]');if(u)return r.instance=u,Mt(u),u;var m=b({},o,{"data-href":o.href,"data-precedence":o.precedence,href:null,precedence:null});return u=(n.ownerDocument||n).createElement("style"),Mt(u),rn(u,"style",m),Cd(u,o.precedence,n),r.instance=u;case"stylesheet":m=tl(o.href);var g=n.querySelector(Xc(m));if(g)return r.state.loading|=4,r.instance=g,Mt(g),g;u=hT(o),(m=oi.get(m))&&yg(u,m),g=(n.ownerDocument||n).createElement("link"),Mt(g);var T=g;return T._p=new Promise(function(S,P){T.onload=S,T.onerror=P}),rn(g,"link",u),r.state.loading|=4,Cd(g,o.precedence,n),r.instance=g;case"script":return g=nl(o.src),(m=n.querySelector(Jc(g)))?(r.instance=m,Mt(m),m):(u=o,(m=oi.get(g))&&(u=b({},o),vg(u,m)),n=n.ownerDocument||n,m=n.createElement("script"),Mt(m),rn(m,"link",u),n.head.appendChild(m),r.instance=m);case"void":return null;default:throw Error(i(443,r.type))}else r.type==="stylesheet"&&(r.state.loading&4)===0&&(u=r.instance,r.state.loading|=4,Cd(u,o.precedence,n));return r.instance}function Cd(n,r,o){for(var u=o.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),m=u.length?u[u.length-1]:null,g=m,T=0;T<u.length;T++){var S=u[T];if(S.dataset.precedence===r)g=S;else if(g!==m)break}g?g.parentNode.insertBefore(n,g.nextSibling):(r=o.nodeType===9?o.head:o,r.insertBefore(n,r.firstChild))}function yg(n,r){n.crossOrigin==null&&(n.crossOrigin=r.crossOrigin),n.referrerPolicy==null&&(n.referrerPolicy=r.referrerPolicy),n.title==null&&(n.title=r.title)}function vg(n,r){n.crossOrigin==null&&(n.crossOrigin=r.crossOrigin),n.referrerPolicy==null&&(n.referrerPolicy=r.referrerPolicy),n.integrity==null&&(n.integrity=r.integrity)}var Rd=null;function fT(n,r,o){if(Rd===null){var u=new Map,m=Rd=new Map;m.set(o,u)}else m=Rd,u=m.get(o),u||(u=new Map,m.set(o,u));if(u.has(n))return u;for(u.set(n,null),o=o.getElementsByTagName(n),m=0;m<o.length;m++){var g=o[m];if(!(g[Ui]||g[Vt]||n==="link"&&g.getAttribute("rel")==="stylesheet")&&g.namespaceURI!=="http://www.w3.org/2000/svg"){var T=g.getAttribute(r)||"";T=n+T;var S=u.get(T);S?S.push(g):u.set(T,[g])}}return u}function mT(n,r,o){n=n.ownerDocument||n,n.head.insertBefore(o,r==="title"?n.querySelector("head > title"):null)}function v2(n,r,o){if(o===1||r.itemProp!=null)return!1;switch(n){case"meta":case"title":return!0;case"style":if(typeof r.precedence!="string"||typeof r.href!="string"||r.href==="")break;return!0;case"link":if(typeof r.rel!="string"||typeof r.href!="string"||r.href===""||r.onLoad||r.onError)break;return r.rel==="stylesheet"?(n=r.disabled,typeof r.precedence=="string"&&n==null):!0;case"script":if(r.async&&typeof r.async!="function"&&typeof r.async!="symbol"&&!r.onLoad&&!r.onError&&r.src&&typeof r.src=="string")return!0}return!1}function pT(n){return!(n.type==="stylesheet"&&(n.state.loading&3)===0)}function _2(n,r,o,u){if(o.type==="stylesheet"&&(typeof u.media!="string"||matchMedia(u.media).matches!==!1)&&(o.state.loading&4)===0){if(o.instance===null){var m=tl(u.href),g=r.querySelector(Xc(m));if(g){r=g._p,r!==null&&typeof r=="object"&&typeof r.then=="function"&&(n.count++,n=Dd.bind(n),r.then(n,n)),o.state.loading|=4,o.instance=g,Mt(g);return}g=r.ownerDocument||r,u=hT(u),(m=oi.get(m))&&yg(u,m),g=g.createElement("link"),Mt(g);var T=g;T._p=new Promise(function(S,P){T.onload=S,T.onerror=P}),rn(g,"link",u),o.instance=g}n.stylesheets===null&&(n.stylesheets=new Map),n.stylesheets.set(o,r),(r=o.state.preload)&&(o.state.loading&3)===0&&(n.count++,o=Dd.bind(n),r.addEventListener("load",o),r.addEventListener("error",o))}}var _g=0;function b2(n,r){return n.stylesheets&&n.count===0&&jd(n,n.stylesheets),0<n.count||0<n.imgCount?function(o){var u=setTimeout(function(){if(n.stylesheets&&jd(n,n.stylesheets),n.unsuspend){var g=n.unsuspend;n.unsuspend=null,g()}},6e4+r);0<n.imgBytes&&_g===0&&(_g=62500*e2());var m=setTimeout(function(){if(n.waitingForImages=!1,n.count===0&&(n.stylesheets&&jd(n,n.stylesheets),n.unsuspend)){var g=n.unsuspend;n.unsuspend=null,g()}},(n.imgBytes>_g?50:800)+r);return n.unsuspend=o,function(){n.unsuspend=null,clearTimeout(u),clearTimeout(m)}}:null}function Dd(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)jd(this,this.stylesheets);else if(this.unsuspend){var n=this.unsuspend;this.unsuspend=null,n()}}}var Nd=null;function jd(n,r){n.stylesheets=null,n.unsuspend!==null&&(n.count++,Nd=new Map,r.forEach(T2,n),Nd=null,Dd.call(n))}function T2(n,r){if(!(r.state.loading&4)){var o=Nd.get(n);if(o)var u=o.get(null);else{o=new Map,Nd.set(n,o);for(var m=n.querySelectorAll("link[data-precedence],style[data-precedence]"),g=0;g<m.length;g++){var T=m[g];(T.nodeName==="LINK"||T.getAttribute("media")!=="not all")&&(o.set(T.dataset.precedence,T),u=T)}u&&o.set(null,u)}m=r.instance,T=m.getAttribute("data-precedence"),g=o.get(T)||u,g===u&&o.set(null,m),o.set(T,m),this.count++,u=Dd.bind(this),m.addEventListener("load",u),m.addEventListener("error",u),g?g.parentNode.insertBefore(m,g.nextSibling):(n=n.nodeType===9?n.head:n,n.insertBefore(m,n.firstChild)),r.state.loading|=4}}var Zc={$$typeof:$,Provider:null,Consumer:null,_currentValue:pe,_currentValue2:pe,_threadCount:0};function E2(n,r,o,u,m,g,T,S,P){this.tag=1,this.containerInfo=n,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=Pi(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Pi(0),this.hiddenUpdates=Pi(null),this.identifierPrefix=u,this.onUncaughtError=m,this.onCaughtError=g,this.onRecoverableError=T,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=P,this.incompleteTransitions=new Map}function gT(n,r,o,u,m,g,T,S,P,K,ie,le){return n=new E2(n,r,o,T,P,K,ie,le,S),r=1,g===!0&&(r|=24),g=Vn(3,null,null,r),n.current=g,g.stateNode=n,r=Jm(),r.refCount++,n.pooledCache=r,r.refCount++,g.memoizedState={element:u,isDehydrated:o,cache:r},np(g),n}function yT(n){return n?(n=ko,n):ko}function vT(n,r,o,u,m,g){m=yT(m),u.context===null?u.context=m:u.pendingContext=m,u=yr(r),u.payload={element:o},g=g===void 0?null:g,g!==null&&(u.callback=g),o=vr(n,u,r),o!==null&&(In(o,n,r),Nc(o,n,r))}function _T(n,r){if(n=n.memoizedState,n!==null&&n.dehydrated!==null){var o=n.retryLane;n.retryLane=o!==0&&o<r?o:r}}function bg(n,r){_T(n,r),(n=n.alternate)&&_T(n,r)}function bT(n){if(n.tag===13||n.tag===31){var r=Ca(n,67108864);r!==null&&In(r,n,67108864),bg(n,67108864)}}function TT(n){if(n.tag===13||n.tag===31){var r=zn();r=ga(r);var o=Ca(n,r);o!==null&&In(o,n,r),bg(n,r)}}var kd=!0;function x2(n,r,o,u){var m=G.T;G.T=null;var g=oe.p;try{oe.p=2,Tg(n,r,o,u)}finally{oe.p=g,G.T=m}}function S2(n,r,o,u){var m=G.T;G.T=null;var g=oe.p;try{oe.p=8,Tg(n,r,o,u)}finally{oe.p=g,G.T=m}}function Tg(n,r,o,u){if(kd){var m=Eg(u);if(m===null)og(n,r,u,Od,o),xT(n,u);else if(A2(m,n,r,o,u))u.stopPropagation();else if(xT(n,u),r&4&&-1<w2.indexOf(n)){for(;m!==null;){var g=Yn(m);if(g!==null)switch(g.tag){case 3:if(g=g.stateNode,g.current.memoizedState.isDehydrated){var T=Vi(g.pendingLanes);if(T!==0){var S=g;for(S.pendingLanes|=2,S.entangledLanes|=2;T;){var P=1<<31-de(T);S.entanglements[1]|=P,T&=~P}es(g),(Ze&6)===0&&(gd=vt()+500,Kc(0))}}break;case 31:case 13:S=Ca(g,2),S!==null&&In(S,g,2),vd(),bg(g,2)}if(g=Eg(u),g===null&&og(n,r,u,Od,o),g===m)break;m=g}m!==null&&u.stopPropagation()}else og(n,r,u,null,o)}}function Eg(n){return n=Xn(n),xg(n)}var Od=null;function xg(n){if(Od=null,n=zi(n),n!==null){var r=l(n);if(r===null)n=null;else{var o=r.tag;if(o===13){if(n=c(r),n!==null)return n;n=null}else if(o===31){if(n=f(r),n!==null)return n;n=null}else if(o===3){if(r.stateNode.current.memoizedState.isDehydrated)return r.tag===3?r.stateNode.containerInfo:null;n=null}else r!==n&&(n=null)}}return Od=n,null}function ET(n){switch(n){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(Wn()){case ha:return 2;case da:return 8;case Oi:case po:return 32;case go:return 268435456;default:return 32}default:return 32}}var Sg=!1,Rr=null,Dr=null,Nr=null,eu=new Map,tu=new Map,jr=[],w2="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function xT(n,r){switch(n){case"focusin":case"focusout":Rr=null;break;case"dragenter":case"dragleave":Dr=null;break;case"mouseover":case"mouseout":Nr=null;break;case"pointerover":case"pointerout":eu.delete(r.pointerId);break;case"gotpointercapture":case"lostpointercapture":tu.delete(r.pointerId)}}function nu(n,r,o,u,m,g){return n===null||n.nativeEvent!==g?(n={blockedOn:r,domEventName:o,eventSystemFlags:u,nativeEvent:g,targetContainers:[m]},r!==null&&(r=Yn(r),r!==null&&bT(r)),n):(n.eventSystemFlags|=u,r=n.targetContainers,m!==null&&r.indexOf(m)===-1&&r.push(m),n)}function A2(n,r,o,u,m){switch(r){case"focusin":return Rr=nu(Rr,n,r,o,u,m),!0;case"dragenter":return Dr=nu(Dr,n,r,o,u,m),!0;case"mouseover":return Nr=nu(Nr,n,r,o,u,m),!0;case"pointerover":var g=m.pointerId;return eu.set(g,nu(eu.get(g)||null,n,r,o,u,m)),!0;case"gotpointercapture":return g=m.pointerId,tu.set(g,nu(tu.get(g)||null,n,r,o,u,m)),!0}return!1}function ST(n){var r=zi(n.target);if(r!==null){var o=l(r);if(o!==null){if(r=o.tag,r===13){if(r=c(o),r!==null){n.blockedOn=r,pi(n.priority,function(){TT(o)});return}}else if(r===31){if(r=f(o),r!==null){n.blockedOn=r,pi(n.priority,function(){TT(o)});return}}else if(r===3&&o.stateNode.current.memoizedState.isDehydrated){n.blockedOn=o.tag===3?o.stateNode.containerInfo:null;return}}}n.blockedOn=null}function Vd(n){if(n.blockedOn!==null)return!1;for(var r=n.targetContainers;0<r.length;){var o=Eg(n.nativeEvent);if(o===null){o=n.nativeEvent;var u=new o.constructor(o.type,o);pc=u,o.target.dispatchEvent(u),pc=null}else return r=Yn(o),r!==null&&bT(r),n.blockedOn=o,!1;r.shift()}return!0}function wT(n,r,o){Vd(n)&&o.delete(r)}function I2(){Sg=!1,Rr!==null&&Vd(Rr)&&(Rr=null),Dr!==null&&Vd(Dr)&&(Dr=null),Nr!==null&&Vd(Nr)&&(Nr=null),eu.forEach(wT),tu.forEach(wT)}function Md(n,r){n.blockedOn===r&&(n.blockedOn=null,Sg||(Sg=!0,s.unstable_scheduleCallback(s.unstable_NormalPriority,I2)))}var Pd=null;function AT(n){Pd!==n&&(Pd=n,s.unstable_scheduleCallback(s.unstable_NormalPriority,function(){Pd===n&&(Pd=null);for(var r=0;r<n.length;r+=3){var o=n[r],u=n[r+1],m=n[r+2];if(typeof u!="function"){if(xg(u||o)===null)continue;break}var g=Yn(o);g!==null&&(n.splice(r,3),r-=3,Ep(g,{pending:!0,data:m,method:o.method,action:u},u,m))}}))}function il(n){function r(P){return Md(P,n)}Rr!==null&&Md(Rr,n),Dr!==null&&Md(Dr,n),Nr!==null&&Md(Nr,n),eu.forEach(r),tu.forEach(r);for(var o=0;o<jr.length;o++){var u=jr[o];u.blockedOn===n&&(u.blockedOn=null)}for(;0<jr.length&&(o=jr[0],o.blockedOn===null);)ST(o),o.blockedOn===null&&jr.shift();if(o=(n.ownerDocument||n).$$reactFormReplay,o!=null)for(u=0;u<o.length;u+=3){var m=o[u],g=o[u+1],T=m[$t]||null;if(typeof g=="function")T||AT(o);else if(T){var S=null;if(g&&g.hasAttribute("formAction")){if(m=g,T=g[$t]||null)S=T.formAction;else if(xg(m)!==null)continue}else S=T.action;typeof S=="function"?o[u+1]=S:(o.splice(u,3),u-=3),AT(o)}}}function IT(){function n(g){g.canIntercept&&g.info==="react-transition"&&g.intercept({handler:function(){return new Promise(function(T){return m=T})},focusReset:"manual",scroll:"manual"})}function r(){m!==null&&(m(),m=null),u||setTimeout(o,20)}function o(){if(!u&&!navigation.transition){var g=navigation.currentEntry;g&&g.url!=null&&navigation.navigate(g.url,{state:g.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var u=!1,m=null;return navigation.addEventListener("navigate",n),navigation.addEventListener("navigatesuccess",r),navigation.addEventListener("navigateerror",r),setTimeout(o,100),function(){u=!0,navigation.removeEventListener("navigate",n),navigation.removeEventListener("navigatesuccess",r),navigation.removeEventListener("navigateerror",r),m!==null&&(m(),m=null)}}}function wg(n){this._internalRoot=n}Ld.prototype.render=wg.prototype.render=function(n){var r=this._internalRoot;if(r===null)throw Error(i(409));var o=r.current,u=zn();vT(o,u,n,r,null,null)},Ld.prototype.unmount=wg.prototype.unmount=function(){var n=this._internalRoot;if(n!==null){this._internalRoot=null;var r=n.containerInfo;vT(n.current,2,null,n,null,null),vd(),r[Li]=null}};function Ld(n){this._internalRoot=n}Ld.prototype.unstable_scheduleHydration=function(n){if(n){var r=vh();n={blockedOn:null,target:n,priority:r};for(var o=0;o<jr.length&&r!==0&&r<jr[o].priority;o++);jr.splice(o,0,n),o===0&&ST(n)}};var CT=e.version;if(CT!=="19.2.4")throw Error(i(527,CT,"19.2.4"));oe.findDOMNode=function(n){var r=n._reactInternals;if(r===void 0)throw typeof n.render=="function"?Error(i(188)):(n=Object.keys(n).join(","),Error(i(268,n)));return n=y(r),n=n!==null?v(n):null,n=n===null?null:n.stateNode,n};var C2={bundleType:0,version:"19.2.4",rendererPackageName:"react-dom",currentDispatcherRef:G,reconcilerVersion:"19.2.4"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Ud=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Ud.isDisabled&&Ud.supportsFiber)try{Dn=Ud.inject(C2),Ht=Ud}catch{}}return su.createRoot=function(n,r){if(!a(n))throw Error(i(299));var o=!1,u="",m=V0,g=M0,T=P0;return r!=null&&(r.unstable_strictMode===!0&&(o=!0),r.identifierPrefix!==void 0&&(u=r.identifierPrefix),r.onUncaughtError!==void 0&&(m=r.onUncaughtError),r.onCaughtError!==void 0&&(g=r.onCaughtError),r.onRecoverableError!==void 0&&(T=r.onRecoverableError)),r=gT(n,1,!1,null,null,o,u,null,m,g,T,IT),n[Li]=r.current,ag(n),new wg(r)},su.hydrateRoot=function(n,r,o){if(!a(n))throw Error(i(299));var u=!1,m="",g=V0,T=M0,S=P0,P=null;return o!=null&&(o.unstable_strictMode===!0&&(u=!0),o.identifierPrefix!==void 0&&(m=o.identifierPrefix),o.onUncaughtError!==void 0&&(g=o.onUncaughtError),o.onCaughtError!==void 0&&(T=o.onCaughtError),o.onRecoverableError!==void 0&&(S=o.onRecoverableError),o.formState!==void 0&&(P=o.formState)),r=gT(n,1,!0,r,o??null,u,m,P,g,T,S,IT),r.context=yT(null),o=r.current,u=zn(),u=ga(u),m=yr(u),m.callback=null,vr(o,m,u),o=u,r.current.lanes=o,ma(r,o),es(r),n[Li]=r.current,ag(n),new Ld(r)},su.version="19.2.4",su}var LT;function U2(){if(LT)return Cg.exports;LT=1;function s(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(s)}catch(e){console.error(e)}}return s(),Cg.exports=L2(),Cg.exports}var z2=U2();var UT="popstate";function zT(s){return typeof s=="object"&&s!=null&&"pathname"in s&&"search"in s&&"hash"in s&&"state"in s&&"key"in s}function B2(s={}){function e(i,a){let l=a.state?.masked,{pathname:c,search:f,hash:p}=l||i.location;return ey("",{pathname:c,search:f,hash:p},a.state&&a.state.usr||null,a.state&&a.state.key||"default",l?{pathname:i.location.pathname,search:i.location.search,hash:i.location.hash}:void 0)}function t(i,a){return typeof a=="string"?a:Ru(a)}return q2(e,t,null,s)}function St(s,e){if(s===!1||s===null||typeof s>"u")throw new Error(e)}function li(s,e){if(!s){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function F2(){return Math.random().toString(36).substring(2,10)}function BT(s,e){return{usr:s.state,key:s.key,idx:e,masked:s.unstable_mask?{pathname:s.pathname,search:s.search,hash:s.hash}:void 0}}function ey(s,e,t=null,i,a){return{pathname:typeof s=="string"?s:s.pathname,search:"",hash:"",...typeof e=="string"?Hl(e):e,state:t,key:e&&e.key||i||F2(),unstable_mask:a}}function Ru({pathname:s="/",search:e="",hash:t=""}){return e&&e!=="?"&&(s+=e.charAt(0)==="?"?e:"?"+e),t&&t!=="#"&&(s+=t.charAt(0)==="#"?t:"#"+t),s}function Hl(s){let e={};if(s){let t=s.indexOf("#");t>=0&&(e.hash=s.substring(t),s=s.substring(0,t));let i=s.indexOf("?");i>=0&&(e.search=s.substring(i),s=s.substring(0,i)),s&&(e.pathname=s)}return e}function q2(s,e,t,i={}){let{window:a=document.defaultView,v5Compat:l=!1}=i,c=a.history,f="POP",p=null,y=v();y==null&&(y=0,c.replaceState({...c.state,idx:y},""));function v(){return(c.state||{idx:null}).idx}function b(){f="POP";let M=v(),Y=M==null?null:M-y;y=M,p&&p({action:f,location:D.location,delta:Y})}function x(M,Y){f="PUSH";let Z=zT(M)?M:ey(D.location,M,Y);y=v()+1;let $=BT(Z,y),ne=D.createHref(Z.unstable_mask||Z);try{c.pushState($,"",ne)}catch(ee){if(ee instanceof DOMException&&ee.name==="DataCloneError")throw ee;a.location.assign(ne)}l&&p&&p({action:f,location:D.location,delta:1})}function k(M,Y){f="REPLACE";let Z=zT(M)?M:ey(D.location,M,Y);y=v();let $=BT(Z,y),ne=D.createHref(Z.unstable_mask||Z);c.replaceState($,"",ne),l&&p&&p({action:f,location:D.location,delta:0})}function O(M){return H2(M)}let D={get action(){return f},get location(){return s(a,c)},listen(M){if(p)throw new Error("A history only accepts one active listener");return a.addEventListener(UT,b),p=M,()=>{a.removeEventListener(UT,b),p=null}},createHref(M){return e(a,M)},createURL:O,encodeLocation(M){let Y=O(M);return{pathname:Y.pathname,search:Y.search,hash:Y.hash}},push:x,replace:k,go(M){return c.go(M)}};return D}function H2(s,e=!1){let t="http://localhost";typeof window<"u"&&(t=window.location.origin!=="null"?window.location.origin:window.location.href),St(t,"No window.location.(origin|href) available to create URL");let i=typeof s=="string"?s:Ru(s);return i=i.replace(/ $/,"%20"),!e&&i.startsWith("//")&&(i=t+i),new URL(i,t)}function e1(s,e,t="/"){return G2(s,e,t,!1)}function G2(s,e,t,i){let a=typeof e=="string"?Hl(e):e,l=Hs(a.pathname||"/",t);if(l==null)return null;let c=t1(s);Q2(c);let f=null;for(let p=0;f==null&&p<c.length;++p){let y=iC(l);f=tC(c[p],y,i)}return f}function t1(s,e=[],t=[],i="",a=!1){let l=(c,f,p=a,y)=>{let v={relativePath:y===void 0?c.path||"":y,caseSensitive:c.caseSensitive===!0,childrenIndex:f,route:c};if(v.relativePath.startsWith("/")){if(!v.relativePath.startsWith(i)&&p)return;St(v.relativePath.startsWith(i),`Absolute route path "${v.relativePath}" nested under path "${i}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),v.relativePath=v.relativePath.slice(i.length)}let b=rs([i,v.relativePath]),x=t.concat(v);c.children&&c.children.length>0&&(St(c.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${b}".`),t1(c.children,e,x,b,p)),!(c.path==null&&!c.index)&&e.push({path:b,score:Z2(b,c.index),routesMeta:x})};return s.forEach((c,f)=>{if(c.path===""||!c.path?.includes("?"))l(c,f);else for(let p of n1(c.path))l(c,f,!0,p)}),e}function n1(s){let e=s.split("/");if(e.length===0)return[];let[t,...i]=e,a=t.endsWith("?"),l=t.replace(/\?$/,"");if(i.length===0)return a?[l,""]:[l];let c=n1(i.join("/")),f=[];return f.push(...c.map(p=>p===""?l:[l,p].join("/"))),a&&f.push(...c),f.map(p=>s.startsWith("/")&&p===""?"/":p)}function Q2(s){s.sort((e,t)=>e.score!==t.score?t.score-e.score:eC(e.routesMeta.map(i=>i.childrenIndex),t.routesMeta.map(i=>i.childrenIndex)))}var K2=/^:[\w-]+$/,$2=3,W2=2,Y2=1,X2=10,J2=-2,FT=s=>s==="*";function Z2(s,e){let t=s.split("/"),i=t.length;return t.some(FT)&&(i+=J2),e&&(i+=W2),t.filter(a=>!FT(a)).reduce((a,l)=>a+(K2.test(l)?$2:l===""?Y2:X2),i)}function eC(s,e){return s.length===e.length&&s.slice(0,-1).every((i,a)=>i===e[a])?s[s.length-1]-e[e.length-1]:0}function tC(s,e,t=!1){let{routesMeta:i}=s,a={},l="/",c=[];for(let f=0;f<i.length;++f){let p=i[f],y=f===i.length-1,v=l==="/"?e:e.slice(l.length)||"/",b=Tf({path:p.relativePath,caseSensitive:p.caseSensitive,end:y},v),x=p.route;if(!b&&y&&t&&!i[i.length-1].route.index&&(b=Tf({path:p.relativePath,caseSensitive:p.caseSensitive,end:!1},v)),!b)return null;Object.assign(a,b.params),c.push({params:a,pathname:rs([l,b.pathname]),pathnameBase:oC(rs([l,b.pathnameBase])),route:x}),b.pathnameBase!=="/"&&(l=rs([l,b.pathnameBase]))}return c}function Tf(s,e){typeof s=="string"&&(s={path:s,caseSensitive:!1,end:!0});let[t,i]=nC(s.path,s.caseSensitive,s.end),a=e.match(t);if(!a)return null;let l=a[0],c=l.replace(/(.)\/+$/,"$1"),f=a.slice(1);return{params:i.reduce((y,{paramName:v,isOptional:b},x)=>{if(v==="*"){let O=f[x]||"";c=l.slice(0,l.length-O.length).replace(/(.)\/+$/,"$1")}const k=f[x];return b&&!k?y[v]=void 0:y[v]=(k||"").replace(/%2F/g,"/"),y},{}),pathname:l,pathnameBase:c,pattern:s}}function nC(s,e=!1,t=!0){li(s==="*"||!s.endsWith("*")||s.endsWith("/*"),`Route path "${s}" will be treated as if it were "${s.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${s.replace(/\*$/,"/*")}".`);let i=[],a="^"+s.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(c,f,p,y,v)=>{if(i.push({paramName:f,isOptional:p!=null}),p){let b=v.charAt(y+c.length);return b&&b!=="/"?"/([^\\/]*)":"(?:/([^\\/]*))?"}return"/([^\\/]+)"}).replace(/\/([\w-]+)\?(\/|$)/g,"(/$1)?$2");return s.endsWith("*")?(i.push({paramName:"*"}),a+=s==="*"||s==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):t?a+="\\/*$":s!==""&&s!=="/"&&(a+="(?:(?=\\/|$))"),[new RegExp(a,e?void 0:"i"),i]}function iC(s){try{return s.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return li(!1,`The URL path "${s}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${e}).`),s}}function Hs(s,e){if(e==="/")return s;if(!s.toLowerCase().startsWith(e.toLowerCase()))return null;let t=e.endsWith("/")?e.length-1:e.length,i=s.charAt(t);return i&&i!=="/"?null:s.slice(t)||"/"}var sC=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i;function rC(s,e="/"){let{pathname:t,search:i="",hash:a=""}=typeof s=="string"?Hl(s):s,l;return t?(t=t.replace(/\/\/+/g,"/"),t.startsWith("/")?l=qT(t.substring(1),"/"):l=qT(t,e)):l=e,{pathname:l,search:lC(i),hash:cC(a)}}function qT(s,e){let t=e.replace(/\/+$/,"").split("/");return s.split("/").forEach(a=>{a===".."?t.length>1&&t.pop():a!=="."&&t.push(a)}),t.length>1?t.join("/"):"/"}function jg(s,e,t,i){return`Cannot include a '${s}' character in a manually specified \`to.${e}\` field [${JSON.stringify(i)}].  Please separate it out to the \`to.${t}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function aC(s){return s.filter((e,t)=>t===0||e.route.path&&e.route.path.length>0)}function Ly(s){let e=aC(s);return e.map((t,i)=>i===e.length-1?t.pathname:t.pathnameBase)}function Xf(s,e,t,i=!1){let a;typeof s=="string"?a=Hl(s):(a={...s},St(!a.pathname||!a.pathname.includes("?"),jg("?","pathname","search",a)),St(!a.pathname||!a.pathname.includes("#"),jg("#","pathname","hash",a)),St(!a.search||!a.search.includes("#"),jg("#","search","hash",a)));let l=s===""||a.pathname==="",c=l?"/":a.pathname,f;if(c==null)f=t;else{let b=e.length-1;if(!i&&c.startsWith("..")){let x=c.split("/");for(;x[0]==="..";)x.shift(),b-=1;a.pathname=x.join("/")}f=b>=0?e[b]:"/"}let p=rC(a,f),y=c&&c!=="/"&&c.endsWith("/"),v=(l||c===".")&&t.endsWith("/");return!p.pathname.endsWith("/")&&(y||v)&&(p.pathname+="/"),p}var rs=s=>s.join("/").replace(/\/\/+/g,"/"),oC=s=>s.replace(/\/+$/,"").replace(/^\/*/,"/"),lC=s=>!s||s==="?"?"":s.startsWith("?")?s:"?"+s,cC=s=>!s||s==="#"?"":s.startsWith("#")?s:"#"+s,uC=class{constructor(s,e,t,i=!1){this.status=s,this.statusText=e||"",this.internal=i,t instanceof Error?(this.data=t.toString(),this.error=t):this.data=t}};function hC(s){return s!=null&&typeof s.status=="number"&&typeof s.statusText=="string"&&typeof s.internal=="boolean"&&"data"in s}function dC(s){return s.map(e=>e.route.path).filter(Boolean).join("/").replace(/\/\/*/g,"/")||"/"}var i1=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";function s1(s,e){let t=s;if(typeof t!="string"||!sC.test(t))return{absoluteURL:void 0,isExternal:!1,to:t};let i=t,a=!1;if(i1)try{let l=new URL(window.location.href),c=t.startsWith("//")?new URL(l.protocol+t):new URL(t),f=Hs(c.pathname,e);c.origin===l.origin&&f!=null?t=f+c.search+c.hash:a=!0}catch{li(!1,`<Link to="${t}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}return{absoluteURL:i,isExternal:a,to:t}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");var r1=["POST","PUT","PATCH","DELETE"];new Set(r1);var fC=["GET",...r1];new Set(fC);var Gl=N.createContext(null);Gl.displayName="DataRouter";var Jf=N.createContext(null);Jf.displayName="DataRouterState";var mC=N.createContext(!1),a1=N.createContext({isTransitioning:!1});a1.displayName="ViewTransition";var pC=N.createContext(new Map);pC.displayName="Fetchers";var gC=N.createContext(null);gC.displayName="Await";var $n=N.createContext(null);$n.displayName="Navigation";var Ku=N.createContext(null);Ku.displayName="Location";var ui=N.createContext({outlet:null,matches:[],isDataRoute:!1});ui.displayName="Route";var Uy=N.createContext(null);Uy.displayName="RouteError";var o1="REACT_ROUTER_ERROR",yC="REDIRECT",vC="ROUTE_ERROR_RESPONSE";function _C(s){if(s.startsWith(`${o1}:${yC}:{`))try{let e=JSON.parse(s.slice(28));if(typeof e=="object"&&e&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.location=="string"&&typeof e.reloadDocument=="boolean"&&typeof e.replace=="boolean")return e}catch{}}function bC(s){if(s.startsWith(`${o1}:${vC}:{`))try{let e=JSON.parse(s.slice(40));if(typeof e=="object"&&e&&typeof e.status=="number"&&typeof e.statusText=="string")return new uC(e.status,e.statusText,e.data)}catch{}}function TC(s,{relative:e}={}){St(Ql(),"useHref() may be used only in the context of a <Router> component.");let{basename:t,navigator:i}=N.useContext($n),{hash:a,pathname:l,search:c}=$u(s,{relative:e}),f=l;return t!=="/"&&(f=l==="/"?t:rs([t,l])),i.createHref({pathname:f,search:c,hash:a})}function Ql(){return N.useContext(Ku)!=null}function hi(){return St(Ql(),"useLocation() may be used only in the context of a <Router> component."),N.useContext(Ku).location}var l1="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function c1(s){N.useContext($n).static||N.useLayoutEffect(s)}function ln(){let{isDataRoute:s}=N.useContext(ui);return s?PC():EC()}function EC(){St(Ql(),"useNavigate() may be used only in the context of a <Router> component.");let s=N.useContext(Gl),{basename:e,navigator:t}=N.useContext($n),{matches:i}=N.useContext(ui),{pathname:a}=hi(),l=JSON.stringify(Ly(i)),c=N.useRef(!1);return c1(()=>{c.current=!0}),N.useCallback((p,y={})=>{if(li(c.current,l1),!c.current)return;if(typeof p=="number"){t.go(p);return}let v=Xf(p,JSON.parse(l),a,y.relative==="path");s==null&&e!=="/"&&(v.pathname=v.pathname==="/"?e:rs([e,v.pathname])),(y.replace?t.replace:t.push)(v,y.state,y)},[e,t,l,a,s])}var xC=N.createContext(null);function SC(s){let e=N.useContext(ui).outlet;return N.useMemo(()=>e&&N.createElement(xC.Provider,{value:s},e),[e,s])}function wC(){let{matches:s}=N.useContext(ui),e=s[s.length-1];return e?e.params:{}}function $u(s,{relative:e}={}){let{matches:t}=N.useContext(ui),{pathname:i}=hi(),a=JSON.stringify(Ly(t));return N.useMemo(()=>Xf(s,JSON.parse(a),i,e==="path"),[s,a,i,e])}function AC(s,e){return u1(s,e)}function u1(s,e,t){St(Ql(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:i}=N.useContext($n),{matches:a}=N.useContext(ui),l=a[a.length-1],c=l?l.params:{},f=l?l.pathname:"/",p=l?l.pathnameBase:"/",y=l&&l.route;{let M=y&&y.path||"";d1(f,!y||M.endsWith("*")||M.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${f}" (under <Route path="${M}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${M}"> to <Route path="${M==="/"?"*":`${M}/*`}">.`)}let v=hi(),b;if(e){let M=typeof e=="string"?Hl(e):e;St(p==="/"||M.pathname?.startsWith(p),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${p}" but pathname "${M.pathname}" was given in the \`location\` prop.`),b=M}else b=v;let x=b.pathname||"/",k=x;if(p!=="/"){let M=p.replace(/^\//,"").split("/");k="/"+x.replace(/^\//,"").split("/").slice(M.length).join("/")}let O=e1(s,{pathname:k});li(y||O!=null,`No routes matched location "${b.pathname}${b.search}${b.hash}" `),li(O==null||O[O.length-1].route.element!==void 0||O[O.length-1].route.Component!==void 0||O[O.length-1].route.lazy!==void 0,`Matched leaf route at location "${b.pathname}${b.search}${b.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`);let D=NC(O&&O.map(M=>Object.assign({},M,{params:Object.assign({},c,M.params),pathname:rs([p,i.encodeLocation?i.encodeLocation(M.pathname.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:M.pathname]),pathnameBase:M.pathnameBase==="/"?p:rs([p,i.encodeLocation?i.encodeLocation(M.pathnameBase.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:M.pathnameBase])})),a,t);return e&&D?N.createElement(Ku.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",unstable_mask:void 0,...b},navigationType:"POP"}},D):D}function IC(){let s=MC(),e=hC(s)?`${s.status} ${s.statusText}`:s instanceof Error?s.message:JSON.stringify(s),t=s instanceof Error?s.stack:null,i="rgba(200,200,200, 0.5)",a={padding:"0.5rem",backgroundColor:i},l={padding:"2px 4px",backgroundColor:i},c=null;return console.error("Error handled by React Router default ErrorBoundary:",s),c=N.createElement(N.Fragment,null,N.createElement("p",null," Hey developer "),N.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",N.createElement("code",{style:l},"ErrorBoundary")," or"," ",N.createElement("code",{style:l},"errorElement")," prop on your route.")),N.createElement(N.Fragment,null,N.createElement("h2",null,"Unexpected Application Error!"),N.createElement("h3",{style:{fontStyle:"italic"}},e),t?N.createElement("pre",{style:a},t):null,c)}var CC=N.createElement(IC,null),h1=class extends N.Component{constructor(s){super(s),this.state={location:s.location,revalidation:s.revalidation,error:s.error}}static getDerivedStateFromError(s){return{error:s}}static getDerivedStateFromProps(s,e){return e.location!==s.location||e.revalidation!=="idle"&&s.revalidation==="idle"?{error:s.error,location:s.location,revalidation:s.revalidation}:{error:s.error!==void 0?s.error:e.error,location:e.location,revalidation:s.revalidation||e.revalidation}}componentDidCatch(s,e){this.props.onError?this.props.onError(s,e):console.error("React Router caught the following error during render",s)}render(){let s=this.state.error;if(this.context&&typeof s=="object"&&s&&"digest"in s&&typeof s.digest=="string"){const t=bC(s.digest);t&&(s=t)}let e=s!==void 0?N.createElement(ui.Provider,{value:this.props.routeContext},N.createElement(Uy.Provider,{value:s,children:this.props.component})):this.props.children;return this.context?N.createElement(RC,{error:s},e):e}};h1.contextType=mC;var kg=new WeakMap;function RC({children:s,error:e}){let{basename:t}=N.useContext($n);if(typeof e=="object"&&e&&"digest"in e&&typeof e.digest=="string"){let i=_C(e.digest);if(i){let a=kg.get(e);if(a)throw a;let l=s1(i.location,t);if(i1&&!kg.get(e))if(l.isExternal||i.reloadDocument)window.location.href=l.absoluteURL||l.to;else{const c=Promise.resolve().then(()=>window.__reactRouterDataRouter.navigate(l.to,{replace:i.replace}));throw kg.set(e,c),c}return N.createElement("meta",{httpEquiv:"refresh",content:`0;url=${l.absoluteURL||l.to}`})}}return s}function DC({routeContext:s,match:e,children:t}){let i=N.useContext(Gl);return i&&i.static&&i.staticContext&&(e.route.errorElement||e.route.ErrorBoundary)&&(i.staticContext._deepestRenderedBoundaryId=e.route.id),N.createElement(ui.Provider,{value:s},t)}function NC(s,e=[],t){let i=t?.state;if(s==null){if(!i)return null;if(i.errors)s=i.matches;else if(e.length===0&&!i.initialized&&i.matches.length>0)s=i.matches;else return null}let a=s,l=i?.errors;if(l!=null){let v=a.findIndex(b=>b.route.id&&l?.[b.route.id]!==void 0);St(v>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(l).join(",")}`),a=a.slice(0,Math.min(a.length,v+1))}let c=!1,f=-1;if(t&&i){c=i.renderFallback;for(let v=0;v<a.length;v++){let b=a[v];if((b.route.HydrateFallback||b.route.hydrateFallbackElement)&&(f=v),b.route.id){let{loaderData:x,errors:k}=i,O=b.route.loader&&!x.hasOwnProperty(b.route.id)&&(!k||k[b.route.id]===void 0);if(b.route.lazy||O){t.isStatic&&(c=!0),f>=0?a=a.slice(0,f+1):a=[a[0]];break}}}}let p=t?.onError,y=i&&p?(v,b)=>{p(v,{location:i.location,params:i.matches?.[0]?.params??{},unstable_pattern:dC(i.matches),errorInfo:b})}:void 0;return a.reduceRight((v,b,x)=>{let k,O=!1,D=null,M=null;i&&(k=l&&b.route.id?l[b.route.id]:void 0,D=b.route.errorElement||CC,c&&(f<0&&x===0?(d1("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),O=!0,M=null):f===x&&(O=!0,M=b.route.hydrateFallbackElement||null)));let Y=e.concat(a.slice(0,x+1)),Z=()=>{let $;return k?$=D:O?$=M:b.route.Component?$=N.createElement(b.route.Component,null):b.route.element?$=b.route.element:$=v,N.createElement(DC,{match:b,routeContext:{outlet:v,matches:Y,isDataRoute:i!=null},children:$})};return i&&(b.route.ErrorBoundary||b.route.errorElement||x===0)?N.createElement(h1,{location:i.location,revalidation:i.revalidation,component:D,error:k,children:Z(),routeContext:{outlet:null,matches:Y,isDataRoute:!0},onError:y}):Z()},null)}function zy(s){return`${s} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function jC(s){let e=N.useContext(Gl);return St(e,zy(s)),e}function kC(s){let e=N.useContext(Jf);return St(e,zy(s)),e}function OC(s){let e=N.useContext(ui);return St(e,zy(s)),e}function By(s){let e=OC(s),t=e.matches[e.matches.length-1];return St(t.route.id,`${s} can only be used on routes that contain a unique "id"`),t.route.id}function VC(){return By("useRouteId")}function MC(){let s=N.useContext(Uy),e=kC("useRouteError"),t=By("useRouteError");return s!==void 0?s:e.errors?.[t]}function PC(){let{router:s}=jC("useNavigate"),e=By("useNavigate"),t=N.useRef(!1);return c1(()=>{t.current=!0}),N.useCallback(async(a,l={})=>{li(t.current,l1),t.current&&(typeof a=="number"?await s.navigate(a):await s.navigate(a,{fromRouteId:e,...l}))},[s,e])}var HT={};function d1(s,e,t){!e&&!HT[s]&&(HT[s]=!0,li(!1,t))}N.memo(LC);function LC({routes:s,future:e,state:t,isStatic:i,onError:a}){return u1(s,void 0,{state:t,isStatic:i,onError:a})}function UC({to:s,replace:e,state:t,relative:i}){St(Ql(),"<Navigate> may be used only in the context of a <Router> component.");let{static:a}=N.useContext($n);li(!a,"<Navigate> must not be used on the initial render in a <StaticRouter>. This is a no-op, but you should modify your code so the <Navigate> is only ever rendered in response to some user interaction or state change.");let{matches:l}=N.useContext(ui),{pathname:c}=hi(),f=ln(),p=Xf(s,Ly(l),c,i==="path"),y=JSON.stringify(p);return N.useEffect(()=>{f(JSON.parse(y),{replace:e,state:t,relative:i})},[f,y,i,e,t]),null}function zC(s){return SC(s.context)}function hn(s){St(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function BC({basename:s="/",children:e=null,location:t,navigationType:i="POP",navigator:a,static:l=!1,unstable_useTransitions:c}){St(!Ql(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let f=s.replace(/^\/*/,"/"),p=N.useMemo(()=>({basename:f,navigator:a,static:l,unstable_useTransitions:c,future:{}}),[f,a,l,c]);typeof t=="string"&&(t=Hl(t));let{pathname:y="/",search:v="",hash:b="",state:x=null,key:k="default",unstable_mask:O}=t,D=N.useMemo(()=>{let M=Hs(y,f);return M==null?null:{location:{pathname:M,search:v,hash:b,state:x,key:k,unstable_mask:O},navigationType:i}},[f,y,v,b,x,k,i,O]);return li(D!=null,`<Router basename="${f}"> is not able to match the URL "${y}${v}${b}" because it does not start with the basename, so the <Router> won't render anything.`),D==null?null:N.createElement($n.Provider,{value:p},N.createElement(Ku.Provider,{children:e,value:D}))}function FC({children:s,location:e}){return AC(ty(s),e)}function ty(s,e=[]){let t=[];return N.Children.forEach(s,(i,a)=>{if(!N.isValidElement(i))return;let l=[...e,a];if(i.type===N.Fragment){t.push.apply(t,ty(i.props.children,l));return}St(i.type===hn,`[${typeof i.type=="string"?i.type:i.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),St(!i.props.index||!i.props.children,"An index route cannot have child routes.");let c={id:i.props.id||l.join("-"),caseSensitive:i.props.caseSensitive,element:i.props.element,Component:i.props.Component,index:i.props.index,path:i.props.path,middleware:i.props.middleware,loader:i.props.loader,action:i.props.action,hydrateFallbackElement:i.props.hydrateFallbackElement,HydrateFallback:i.props.HydrateFallback,errorElement:i.props.errorElement,ErrorBoundary:i.props.ErrorBoundary,hasErrorBoundary:i.props.hasErrorBoundary===!0||i.props.ErrorBoundary!=null||i.props.errorElement!=null,shouldRevalidate:i.props.shouldRevalidate,handle:i.props.handle,lazy:i.props.lazy};i.props.children&&(c.children=ty(i.props.children,l)),t.push(c)}),t}var tf="get",nf="application/x-www-form-urlencoded";function Zf(s){return typeof HTMLElement<"u"&&s instanceof HTMLElement}function qC(s){return Zf(s)&&s.tagName.toLowerCase()==="button"}function HC(s){return Zf(s)&&s.tagName.toLowerCase()==="form"}function GC(s){return Zf(s)&&s.tagName.toLowerCase()==="input"}function QC(s){return!!(s.metaKey||s.altKey||s.ctrlKey||s.shiftKey)}function KC(s,e){return s.button===0&&(!e||e==="_self")&&!QC(s)}function ny(s=""){return new URLSearchParams(typeof s=="string"||Array.isArray(s)||s instanceof URLSearchParams?s:Object.keys(s).reduce((e,t)=>{let i=s[t];return e.concat(Array.isArray(i)?i.map(a=>[t,a]):[[t,i]])},[]))}function $C(s,e){let t=ny(s);return e&&e.forEach((i,a)=>{t.has(a)||e.getAll(a).forEach(l=>{t.append(a,l)})}),t}var Bd=null;function WC(){if(Bd===null)try{new FormData(document.createElement("form"),0),Bd=!1}catch{Bd=!0}return Bd}var YC=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function Og(s){return s!=null&&!YC.has(s)?(li(!1,`"${s}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${nf}"`),null):s}function XC(s,e){let t,i,a,l,c;if(HC(s)){let f=s.getAttribute("action");i=f?Hs(f,e):null,t=s.getAttribute("method")||tf,a=Og(s.getAttribute("enctype"))||nf,l=new FormData(s)}else if(qC(s)||GC(s)&&(s.type==="submit"||s.type==="image")){let f=s.form;if(f==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let p=s.getAttribute("formaction")||f.getAttribute("action");if(i=p?Hs(p,e):null,t=s.getAttribute("formmethod")||f.getAttribute("method")||tf,a=Og(s.getAttribute("formenctype"))||Og(f.getAttribute("enctype"))||nf,l=new FormData(f,s),!WC()){let{name:y,type:v,value:b}=s;if(v==="image"){let x=y?`${y}.`:"";l.append(`${x}x`,"0"),l.append(`${x}y`,"0")}else y&&l.append(y,b)}}else{if(Zf(s))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');t=tf,i=null,a=nf,c=s}return l&&a==="text/plain"&&(c=l,l=void 0),{action:i,method:t.toLowerCase(),encType:a,formData:l,body:c}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");function Fy(s,e){if(s===!1||s===null||typeof s>"u")throw new Error(e)}function JC(s,e,t,i){let a=typeof s=="string"?new URL(s,typeof window>"u"?"server://singlefetch/":window.location.origin):s;return t?a.pathname.endsWith("/")?a.pathname=`${a.pathname}_.${i}`:a.pathname=`${a.pathname}.${i}`:a.pathname==="/"?a.pathname=`_root.${i}`:e&&Hs(a.pathname,e)==="/"?a.pathname=`${e.replace(/\/$/,"")}/_root.${i}`:a.pathname=`${a.pathname.replace(/\/$/,"")}.${i}`,a}async function ZC(s,e){if(s.id in e)return e[s.id];try{let t=await import(s.module);return e[s.id]=t,t}catch(t){return console.error(`Error loading route module \`${s.module}\`, reloading page...`),console.error(t),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function eR(s){return s==null?!1:s.href==null?s.rel==="preload"&&typeof s.imageSrcSet=="string"&&typeof s.imageSizes=="string":typeof s.rel=="string"&&typeof s.href=="string"}async function tR(s,e,t){let i=await Promise.all(s.map(async a=>{let l=e.routes[a.route.id];if(l){let c=await ZC(l,t);return c.links?c.links():[]}return[]}));return rR(i.flat(1).filter(eR).filter(a=>a.rel==="stylesheet"||a.rel==="preload").map(a=>a.rel==="stylesheet"?{...a,rel:"prefetch",as:"style"}:{...a,rel:"prefetch"}))}function GT(s,e,t,i,a,l){let c=(p,y)=>t[y]?p.route.id!==t[y].route.id:!0,f=(p,y)=>t[y].pathname!==p.pathname||t[y].route.path?.endsWith("*")&&t[y].params["*"]!==p.params["*"];return l==="assets"?e.filter((p,y)=>c(p,y)||f(p,y)):l==="data"?e.filter((p,y)=>{let v=i.routes[p.route.id];if(!v||!v.hasLoader)return!1;if(c(p,y)||f(p,y))return!0;if(p.route.shouldRevalidate){let b=p.route.shouldRevalidate({currentUrl:new URL(a.pathname+a.search+a.hash,window.origin),currentParams:t[0]?.params||{},nextUrl:new URL(s,window.origin),nextParams:p.params,defaultShouldRevalidate:!0});if(typeof b=="boolean")return b}return!0}):[]}function nR(s,e,{includeHydrateFallback:t}={}){return iR(s.map(i=>{let a=e.routes[i.route.id];if(!a)return[];let l=[a.module];return a.clientActionModule&&(l=l.concat(a.clientActionModule)),a.clientLoaderModule&&(l=l.concat(a.clientLoaderModule)),t&&a.hydrateFallbackModule&&(l=l.concat(a.hydrateFallbackModule)),a.imports&&(l=l.concat(a.imports)),l}).flat(1))}function iR(s){return[...new Set(s)]}function sR(s){let e={},t=Object.keys(s).sort();for(let i of t)e[i]=s[i];return e}function rR(s,e){let t=new Set;return new Set(e),s.reduce((i,a)=>{let l=JSON.stringify(sR(a));return t.has(l)||(t.add(l),i.push({key:l,link:a})),i},[])}function f1(){let s=N.useContext(Gl);return Fy(s,"You must render this element inside a <DataRouterContext.Provider> element"),s}function aR(){let s=N.useContext(Jf);return Fy(s,"You must render this element inside a <DataRouterStateContext.Provider> element"),s}var qy=N.createContext(void 0);qy.displayName="FrameworkContext";function m1(){let s=N.useContext(qy);return Fy(s,"You must render this element inside a <HydratedRouter> element"),s}function oR(s,e){let t=N.useContext(qy),[i,a]=N.useState(!1),[l,c]=N.useState(!1),{onFocus:f,onBlur:p,onMouseEnter:y,onMouseLeave:v,onTouchStart:b}=e,x=N.useRef(null);N.useEffect(()=>{if(s==="render"&&c(!0),s==="viewport"){let D=Y=>{Y.forEach(Z=>{c(Z.isIntersecting)})},M=new IntersectionObserver(D,{threshold:.5});return x.current&&M.observe(x.current),()=>{M.disconnect()}}},[s]),N.useEffect(()=>{if(i){let D=setTimeout(()=>{c(!0)},100);return()=>{clearTimeout(D)}}},[i]);let k=()=>{a(!0)},O=()=>{a(!1),c(!1)};return t?s!=="intent"?[l,x,{}]:[l,x,{onFocus:ru(f,k),onBlur:ru(p,O),onMouseEnter:ru(y,k),onMouseLeave:ru(v,O),onTouchStart:ru(b,k)}]:[!1,x,{}]}function ru(s,e){return t=>{s&&s(t),t.defaultPrevented||e(t)}}function lR({page:s,...e}){let{router:t}=f1(),i=N.useMemo(()=>e1(t.routes,s,t.basename),[t.routes,s,t.basename]);return i?N.createElement(uR,{page:s,matches:i,...e}):null}function cR(s){let{manifest:e,routeModules:t}=m1(),[i,a]=N.useState([]);return N.useEffect(()=>{let l=!1;return tR(s,e,t).then(c=>{l||a(c)}),()=>{l=!0}},[s,e,t]),i}function uR({page:s,matches:e,...t}){let i=hi(),{future:a,manifest:l,routeModules:c}=m1(),{basename:f}=f1(),{loaderData:p,matches:y}=aR(),v=N.useMemo(()=>GT(s,e,y,l,i,"data"),[s,e,y,l,i]),b=N.useMemo(()=>GT(s,e,y,l,i,"assets"),[s,e,y,l,i]),x=N.useMemo(()=>{if(s===i.pathname+i.search+i.hash)return[];let D=new Set,M=!1;if(e.forEach(Z=>{let $=l.routes[Z.route.id];!$||!$.hasLoader||(!v.some(ne=>ne.route.id===Z.route.id)&&Z.route.id in p&&c[Z.route.id]?.shouldRevalidate||$.hasClientLoader?M=!0:D.add(Z.route.id))}),D.size===0)return[];let Y=JC(s,f,a.unstable_trailingSlashAwareDataRequests,"data");return M&&D.size>0&&Y.searchParams.set("_routes",e.filter(Z=>D.has(Z.route.id)).map(Z=>Z.route.id).join(",")),[Y.pathname+Y.search]},[f,a.unstable_trailingSlashAwareDataRequests,p,i,l,v,e,s,c]),k=N.useMemo(()=>nR(b,l),[b,l]),O=cR(b);return N.createElement(N.Fragment,null,x.map(D=>N.createElement("link",{key:D,rel:"prefetch",as:"fetch",href:D,...t})),k.map(D=>N.createElement("link",{key:D,rel:"modulepreload",href:D,...t})),O.map(({key:D,link:M})=>N.createElement("link",{key:D,nonce:t.nonce,...M,crossOrigin:M.crossOrigin??t.crossOrigin})))}function hR(...s){return e=>{s.forEach(t=>{typeof t=="function"?t(e):t!=null&&(t.current=e)})}}var dR=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{dR&&(window.__reactRouterVersion="7.13.1")}catch{}function fR({basename:s,children:e,unstable_useTransitions:t,window:i}){let a=N.useRef();a.current==null&&(a.current=B2({window:i,v5Compat:!0}));let l=a.current,[c,f]=N.useState({action:l.action,location:l.location}),p=N.useCallback(y=>{t===!1?f(y):N.startTransition(()=>f(y))},[t]);return N.useLayoutEffect(()=>l.listen(p),[l,p]),N.createElement(BC,{basename:s,children:e,location:c.location,navigationType:c.action,navigator:l,unstable_useTransitions:t})}var p1=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,g1=N.forwardRef(function({onClick:e,discover:t="render",prefetch:i="none",relative:a,reloadDocument:l,replace:c,unstable_mask:f,state:p,target:y,to:v,preventScrollReset:b,viewTransition:x,unstable_defaultShouldRevalidate:k,...O},D){let{basename:M,navigator:Y,unstable_useTransitions:Z}=N.useContext($n),$=typeof v=="string"&&p1.test(v),ne=s1(v,M);v=ne.to;let ee=TC(v,{relative:a}),se=hi(),w=null;if(f){let Te=Xf(f,[],se.unstable_mask?se.unstable_mask.pathname:"/",!0);M!=="/"&&(Te.pathname=Te.pathname==="/"?M:rs([M,Te.pathname])),w=Y.createHref(Te)}let[C,A,R]=oR(i,O),j=gR(v,{replace:c,unstable_mask:f,state:p,target:y,preventScrollReset:b,relative:a,viewTransition:x,unstable_defaultShouldRevalidate:k,unstable_useTransitions:Z});function L(Te){e&&e(Te),Te.defaultPrevented||j(Te)}let V=!(ne.isExternal||l),we=N.createElement("a",{...O,...R,href:(V?w:void 0)||ne.absoluteURL||ee,onClick:V?L:e,ref:hR(D,A),target:y,"data-discover":!$&&t==="render"?"true":void 0});return C&&!$?N.createElement(N.Fragment,null,we,N.createElement(lR,{page:ee})):we});g1.displayName="Link";var y1=N.forwardRef(function({"aria-current":e="page",caseSensitive:t=!1,className:i="",end:a=!1,style:l,to:c,viewTransition:f,children:p,...y},v){let b=$u(c,{relative:y.relative}),x=hi(),k=N.useContext(Jf),{navigator:O,basename:D}=N.useContext($n),M=k!=null&&TR(b)&&f===!0,Y=O.encodeLocation?O.encodeLocation(b).pathname:b.pathname,Z=x.pathname,$=k&&k.navigation&&k.navigation.location?k.navigation.location.pathname:null;t||(Z=Z.toLowerCase(),$=$?$.toLowerCase():null,Y=Y.toLowerCase()),$&&D&&($=Hs($,D)||$);const ne=Y!=="/"&&Y.endsWith("/")?Y.length-1:Y.length;let ee=Z===Y||!a&&Z.startsWith(Y)&&Z.charAt(ne)==="/",se=$!=null&&($===Y||!a&&$.startsWith(Y)&&$.charAt(Y.length)==="/"),w={isActive:ee,isPending:se,isTransitioning:M},C=ee?e:void 0,A;typeof i=="function"?A=i(w):A=[i,ee?"active":null,se?"pending":null,M?"transitioning":null].filter(Boolean).join(" ");let R=typeof l=="function"?l(w):l;return N.createElement(g1,{...y,"aria-current":C,className:A,ref:v,style:R,to:c,viewTransition:f},typeof p=="function"?p(w):p)});y1.displayName="NavLink";var mR=N.forwardRef(({discover:s="render",fetcherKey:e,navigate:t,reloadDocument:i,replace:a,state:l,method:c=tf,action:f,onSubmit:p,relative:y,preventScrollReset:v,viewTransition:b,unstable_defaultShouldRevalidate:x,...k},O)=>{let{unstable_useTransitions:D}=N.useContext($n),M=_R(),Y=bR(f,{relative:y}),Z=c.toLowerCase()==="get"?"get":"post",$=typeof f=="string"&&p1.test(f),ne=ee=>{if(p&&p(ee),ee.defaultPrevented)return;ee.preventDefault();let se=ee.nativeEvent.submitter,w=se?.getAttribute("formmethod")||c,C=()=>M(se||ee.currentTarget,{fetcherKey:e,method:w,navigate:t,replace:a,state:l,relative:y,preventScrollReset:v,viewTransition:b,unstable_defaultShouldRevalidate:x});D&&t!==!1?N.startTransition(()=>C()):C()};return N.createElement("form",{ref:O,method:Z,action:Y,onSubmit:i?p:ne,...k,"data-discover":!$&&s==="render"?"true":void 0})});mR.displayName="Form";function pR(s){return`${s} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function v1(s){let e=N.useContext(Gl);return St(e,pR(s)),e}function gR(s,{target:e,replace:t,unstable_mask:i,state:a,preventScrollReset:l,relative:c,viewTransition:f,unstable_defaultShouldRevalidate:p,unstable_useTransitions:y}={}){let v=ln(),b=hi(),x=$u(s,{relative:c});return N.useCallback(k=>{if(KC(k,e)){k.preventDefault();let O=t!==void 0?t:Ru(b)===Ru(x),D=()=>v(s,{replace:O,unstable_mask:i,state:a,preventScrollReset:l,relative:c,viewTransition:f,unstable_defaultShouldRevalidate:p});y?N.startTransition(()=>D()):D()}},[b,v,x,t,i,a,e,s,l,c,f,p,y])}function _1(s){li(typeof URLSearchParams<"u","You cannot use the `useSearchParams` hook in a browser that does not support the URLSearchParams API. If you need to support Internet Explorer 11, we recommend you load a polyfill such as https://github.com/ungap/url-search-params.");let e=N.useRef(ny(s)),t=N.useRef(!1),i=hi(),a=N.useMemo(()=>$C(i.search,t.current?null:e.current),[i.search]),l=ln(),c=N.useCallback((f,p)=>{const y=ny(typeof f=="function"?f(new URLSearchParams(a)):f);t.current=!0,l("?"+y,p)},[l,a]);return[a,c]}var yR=0,vR=()=>`__${String(++yR)}__`;function _R(){let{router:s}=v1("useSubmit"),{basename:e}=N.useContext($n),t=VC(),i=s.fetch,a=s.navigate;return N.useCallback(async(l,c={})=>{let{action:f,method:p,encType:y,formData:v,body:b}=XC(l,e);if(c.navigate===!1){let x=c.fetcherKey||vR();await i(x,t,c.action||f,{unstable_defaultShouldRevalidate:c.unstable_defaultShouldRevalidate,preventScrollReset:c.preventScrollReset,formData:v,body:b,formMethod:c.method||p,formEncType:c.encType||y,flushSync:c.flushSync})}else await a(c.action||f,{unstable_defaultShouldRevalidate:c.unstable_defaultShouldRevalidate,preventScrollReset:c.preventScrollReset,formData:v,body:b,formMethod:c.method||p,formEncType:c.encType||y,replace:c.replace,state:c.state,fromRouteId:t,flushSync:c.flushSync,viewTransition:c.viewTransition})},[i,a,e,t])}function bR(s,{relative:e}={}){let{basename:t}=N.useContext($n),i=N.useContext(ui);St(i,"useFormAction must be used inside a RouteContext");let[a]=i.matches.slice(-1),l={...$u(s||".",{relative:e})},c=hi();if(s==null){l.search=c.search;let f=new URLSearchParams(l.search),p=f.getAll("index");if(p.some(v=>v==="")){f.delete("index"),p.filter(b=>b).forEach(b=>f.append("index",b));let v=f.toString();l.search=v?`?${v}`:""}}return(!s||s===".")&&a.route.index&&(l.search=l.search?l.search.replace(/^\?/,"?index&"):"?index"),t!=="/"&&(l.pathname=l.pathname==="/"?t:rs([t,l.pathname])),Ru(l)}function TR(s,{relative:e}={}){let t=N.useContext(a1);St(t!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:i}=v1("useViewTransitionState"),a=$u(s,{relative:e});if(!t.isTransitioning)return!1;let l=Hs(t.currentLocation.pathname,i)||t.currentLocation.pathname,c=Hs(t.nextLocation.pathname,i)||t.nextLocation.pathname;return Tf(a.pathname,c)!=null||Tf(a.pathname,l)!=null}function sf({isOpen:s,onClose:e,title:t,children:i,size:a="md",showClose:l=!0}){const c=N.useCallback(f=>{f.key==="Escape"&&e?.()},[e]);return N.useEffect(()=>(s&&(document.addEventListener("keydown",c),document.body.style.overflow="hidden"),()=>{document.removeEventListener("keydown",c),document.body.style.overflow=""}),[s,c]),s?d.jsxs("div",{className:"np-modal-backdrop",children:[d.jsx("div",{className:"np-modal-overlay",onClick:e}),d.jsxs("div",{className:`np-modal np-modal-${a}`,children:[(t||l)&&d.jsxs("div",{className:"np-modal-header",children:[t&&d.jsx("h2",{className:"np-modal-title",children:t}),l&&d.jsx("button",{onClick:e,className:"np-modal-close",children:d.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:d.jsx("path",{d:"M18 6L6 18M6 6l12 12"})})})]}),d.jsx("div",{className:"np-modal-body",children:i})]})]}):null}const QT=s=>{let e;const t=new Set,i=(y,v)=>{const b=typeof y=="function"?y(e):y;if(!Object.is(b,e)){const x=e;e=v??(typeof b!="object"||b===null)?b:Object.assign({},e,b),t.forEach(k=>k(e,x))}},a=()=>e,f={setState:i,getState:a,getInitialState:()=>p,subscribe:y=>(t.add(y),()=>t.delete(y))},p=e=s(i,a,f);return f},ER=(s=>s?QT(s):QT),xR=s=>s;function SR(s,e=xR){const t=zd.useSyncExternalStore(s.subscribe,zd.useCallback(()=>e(s.getState()),[s,e]),zd.useCallback(()=>e(s.getInitialState()),[s,e]));return zd.useDebugValue(t),t}const KT=s=>{const e=ER(s),t=i=>SR(e,i);return Object.assign(t,e),t},em=(s=>s?KT(s):KT),Kl=em(s=>({isOnline:navigator.onLine,sidebarCollapsed:!1,accentColor:"#6C63FF",fontSize:"medium",toasts:[],setIsOnline:e=>s({isOnline:e}),toggleSidebar:()=>s(e=>({sidebarCollapsed:!e.sidebarCollapsed})),setSidebarCollapsed:e=>s({sidebarCollapsed:e}),setAccentColor:e=>{document.documentElement.style.setProperty("--primary",e),s({accentColor:e})},setFontSize:e=>{document.documentElement.setAttribute("data-font-size",e),s({fontSize:e})},addToast:e=>s(t=>({toasts:[...t.toasts,{id:Date.now(),...e}]})),removeToast:e=>s(t=>({toasts:t.toasts.filter(i=>i.id!==e)}))}));function wR({toast:s,onRemove:e}){N.useEffect(()=>{const a=setTimeout(()=>e(s.id),s.duration||4e3);return()=>clearTimeout(a)},[s,e]);const t=`np-toast-${s.type||"info"}`,i={success:d.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"#00D9A3",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[d.jsx("path",{d:"M22 11.08V12a10 10 0 11-5.93-9.14"}),d.jsx("polyline",{points:"22 4 12 14.01 9 11.01"})]}),error:d.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"#FF6B6B",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[d.jsx("circle",{cx:"12",cy:"12",r:"10"}),d.jsx("line",{x1:"15",y1:"9",x2:"9",y2:"15"}),d.jsx("line",{x1:"9",y1:"9",x2:"15",y2:"15"})]}),warning:d.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"#FFB347",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[d.jsx("path",{d:"M10.29 3.86L1.82 18a2 2 0 001.71 3h16.94a2 2 0 001.71-3L13.71 3.86a2 2 0 00-3.42 0z"}),d.jsx("line",{x1:"12",y1:"9",x2:"12",y2:"13"}),d.jsx("line",{x1:"12",y1:"17",x2:"12.01",y2:"17"})]}),info:d.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"#6C63FF",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[d.jsx("circle",{cx:"12",cy:"12",r:"10"}),d.jsx("line",{x1:"12",y1:"16",x2:"12",y2:"12"}),d.jsx("line",{x1:"12",y1:"8",x2:"12.01",y2:"8"})]})};return d.jsxs("div",{className:`np-toast ${t}`,children:[d.jsx("div",{style:{flexShrink:0,marginTop:2},children:i[s.type]||i.info}),d.jsxs("div",{style:{flex:1,minWidth:0},children:[s.title&&d.jsx("p",{className:"np-toast-title",children:s.title}),d.jsx("p",{className:"np-toast-message",children:s.message})]}),d.jsx("button",{onClick:()=>e(s.id),style:{flexShrink:0,padding:4,borderRadius:6,color:"var(--muted)",transition:"color 0.15s"},children:d.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:d.jsx("path",{d:"M18 6L6 18M6 6l12 12"})})})]})}function AR(){const{toasts:s,removeToast:e}=Kl();return s.length===0?null:d.jsx("div",{className:"np-toast-container",children:s.map(t=>d.jsx(wR,{toast:t,onRemove:e},t.id))})}function IR(){return d.jsx("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",minHeight:"60vh"},children:d.jsxs("div",{style:{textAlign:"center"},children:[d.jsxs("div",{style:{position:"relative",width:48,height:48,margin:"0 auto 16px"},children:[d.jsx("div",{style:{position:"absolute",inset:0,borderRadius:"50%",border:"3px solid rgba(255,255,255,0.08)",borderTopColor:"var(--primary)",animation:"spin 0.8s linear infinite"}}),d.jsx("div",{style:{position:"absolute",inset:4,borderRadius:"50%",border:"3px solid transparent",borderBottomColor:"var(--secondary)",animation:"spin 1.2s linear infinite reverse"}})]}),d.jsx("p",{style:{fontSize:"0.85rem",color:"var(--muted)"},children:"Loading..."})]})})}function b1({progress:s=0,size:e=120,strokeWidth:t=8,color:i="var(--primary)",trackColor:a="var(--border)",animated:l=!0,children:c,className:f=""}){const[p,y]=N.useState(0),v=(e-t)/2,b=2*Math.PI*v,x=b-p/100*b;return N.useEffect(()=>{if(l){const k=setTimeout(()=>{y(Math.min(100,Math.max(0,s)))},100);return()=>clearTimeout(k)}else y(s)},[s,l]),d.jsxs("div",{className:`relative inline-flex items-center justify-center ${f}`,children:[d.jsxs("svg",{width:e,height:e,className:"-rotate-90",children:[d.jsx("circle",{cx:e/2,cy:e/2,r:v,fill:"none",stroke:a,strokeWidth:t}),d.jsx("circle",{cx:e/2,cy:e/2,r:v,fill:"none",stroke:i,strokeWidth:t,strokeLinecap:"round",strokeDasharray:b,strokeDashoffset:x,style:{transition:l?"stroke-dashoffset 1s cubic-bezier(0.4, 0, 0.2, 1)":"none",filter:`drop-shadow(0 0 6px ${i})`}})]}),c&&d.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:c})]})}const CR=()=>{};var $T={};const T1=function(s){const e=[];let t=0;for(let i=0;i<s.length;i++){let a=s.charCodeAt(i);a<128?e[t++]=a:a<2048?(e[t++]=a>>6|192,e[t++]=a&63|128):(a&64512)===55296&&i+1<s.length&&(s.charCodeAt(i+1)&64512)===56320?(a=65536+((a&1023)<<10)+(s.charCodeAt(++i)&1023),e[t++]=a>>18|240,e[t++]=a>>12&63|128,e[t++]=a>>6&63|128,e[t++]=a&63|128):(e[t++]=a>>12|224,e[t++]=a>>6&63|128,e[t++]=a&63|128)}return e},RR=function(s){const e=[];let t=0,i=0;for(;t<s.length;){const a=s[t++];if(a<128)e[i++]=String.fromCharCode(a);else if(a>191&&a<224){const l=s[t++];e[i++]=String.fromCharCode((a&31)<<6|l&63)}else if(a>239&&a<365){const l=s[t++],c=s[t++],f=s[t++],p=((a&7)<<18|(l&63)<<12|(c&63)<<6|f&63)-65536;e[i++]=String.fromCharCode(55296+(p>>10)),e[i++]=String.fromCharCode(56320+(p&1023))}else{const l=s[t++],c=s[t++];e[i++]=String.fromCharCode((a&15)<<12|(l&63)<<6|c&63)}}return e.join("")},E1={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(s,e){if(!Array.isArray(s))throw Error("encodeByteArray takes an array as a parameter");this.init_();const t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,i=[];for(let a=0;a<s.length;a+=3){const l=s[a],c=a+1<s.length,f=c?s[a+1]:0,p=a+2<s.length,y=p?s[a+2]:0,v=l>>2,b=(l&3)<<4|f>>4;let x=(f&15)<<2|y>>6,k=y&63;p||(k=64,c||(x=64)),i.push(t[v],t[b],t[x],t[k])}return i.join("")},encodeString(s,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(s):this.encodeByteArray(T1(s),e)},decodeString(s,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(s):RR(this.decodeStringToByteArray(s,e))},decodeStringToByteArray(s,e){this.init_();const t=e?this.charToByteMapWebSafe_:this.charToByteMap_,i=[];for(let a=0;a<s.length;){const l=t[s.charAt(a++)],f=a<s.length?t[s.charAt(a)]:0;++a;const y=a<s.length?t[s.charAt(a)]:64;++a;const b=a<s.length?t[s.charAt(a)]:64;if(++a,l==null||f==null||y==null||b==null)throw new DR;const x=l<<2|f>>4;if(i.push(x),y!==64){const k=f<<4&240|y>>2;if(i.push(k),b!==64){const O=y<<6&192|b;i.push(O)}}}return i},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let s=0;s<this.ENCODED_VALS.length;s++)this.byteToCharMap_[s]=this.ENCODED_VALS.charAt(s),this.charToByteMap_[this.byteToCharMap_[s]]=s,this.byteToCharMapWebSafe_[s]=this.ENCODED_VALS_WEBSAFE.charAt(s),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[s]]=s,s>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(s)]=s,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(s)]=s)}}};class DR extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const NR=function(s){const e=T1(s);return E1.encodeByteArray(e,!0)},Ef=function(s){return NR(s).replace(/\./g,"")},x1=function(s){try{return E1.decodeString(s,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};function S1(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}const jR=()=>S1().__FIREBASE_DEFAULTS__,kR=()=>{if(typeof process>"u"||typeof $T>"u")return;const s=$T.__FIREBASE_DEFAULTS__;if(s)return JSON.parse(s)},OR=()=>{if(typeof document>"u")return;let s;try{s=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=s&&x1(s[1]);return e&&JSON.parse(e)},tm=()=>{try{return CR()||jR()||kR()||OR()}catch(s){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${s}`);return}},w1=s=>tm()?.emulatorHosts?.[s],VR=s=>{const e=w1(s);if(!e)return;const t=e.lastIndexOf(":");if(t<=0||t+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const i=parseInt(e.substring(t+1),10);return e[0]==="["?[e.substring(1,t-1),i]:[e.substring(0,t),i]},A1=()=>tm()?.config,I1=s=>tm()?.[`_${s}`];class MR{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,i)=>{t?this.reject(t):this.resolve(i),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,i))}}}function uo(s){try{return(s.startsWith("http://")||s.startsWith("https://")?new URL(s).hostname:s).endsWith(".cloudworkstations.dev")}catch{return!1}}async function Hy(s){return(await fetch(s,{credentials:"include"})).ok}function PR(s,e){if(s.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const t={alg:"none",type:"JWT"},i=e||"demo-project",a=s.iat||0,l=s.sub||s.user_id;if(!l)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const c={iss:`https://securetoken.google.com/${i}`,aud:i,iat:a,exp:a+3600,auth_time:a,sub:l,user_id:l,firebase:{sign_in_provider:"custom",identities:{}},...s};return[Ef(JSON.stringify(t)),Ef(JSON.stringify(c)),""].join(".")}const vu={};function LR(){const s={prod:[],emulator:[]};for(const e of Object.keys(vu))vu[e]?s.emulator.push(e):s.prod.push(e);return s}function UR(s){let e=document.getElementById(s),t=!1;return e||(e=document.createElement("div"),e.setAttribute("id",s),t=!0),{created:t,element:e}}let WT=!1;function C1(s,e){if(typeof window>"u"||typeof document>"u"||!uo(window.location.host)||vu[s]===e||vu[s]||WT)return;vu[s]=e;function t(x){return`__firebase__banner__${x}`}const i="__firebase__banner",l=LR().prod.length>0;function c(){const x=document.getElementById(i);x&&x.remove()}function f(x){x.style.display="flex",x.style.background="#7faaf0",x.style.position="fixed",x.style.bottom="5px",x.style.left="5px",x.style.padding=".5em",x.style.borderRadius="5px",x.style.alignItems="center"}function p(x,k){x.setAttribute("width","24"),x.setAttribute("id",k),x.setAttribute("height","24"),x.setAttribute("viewBox","0 0 24 24"),x.setAttribute("fill","none"),x.style.marginLeft="-6px"}function y(){const x=document.createElement("span");return x.style.cursor="pointer",x.style.marginLeft="16px",x.style.fontSize="24px",x.innerHTML=" &times;",x.onclick=()=>{WT=!0,c()},x}function v(x,k){x.setAttribute("id",k),x.innerText="Learn more",x.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",x.setAttribute("target","__blank"),x.style.paddingLeft="5px",x.style.textDecoration="underline"}function b(){const x=UR(i),k=t("text"),O=document.getElementById(k)||document.createElement("span"),D=t("learnmore"),M=document.getElementById(D)||document.createElement("a"),Y=t("preprendIcon"),Z=document.getElementById(Y)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(x.created){const $=x.element;f($),v(M,D);const ne=y();p(Z,Y),$.append(Z,O,M,ne),document.body.appendChild($)}l?(O.innerText="Preview backend disconnected.",Z.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(Z.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,O.innerText="Preview backend running in this workspace."),O.setAttribute("id",k)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",b):b()}function Qt(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function zR(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Qt())}function R1(){const s=tm()?.forceEnvironment;if(s==="node")return!0;if(s==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function BR(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function FR(){const s=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof s=="object"&&s.id!==void 0}function qR(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function HR(){const s=Qt();return s.indexOf("MSIE ")>=0||s.indexOf("Trident/")>=0}function D1(){return!R1()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function N1(){return!R1()&&!!navigator.userAgent&&(navigator.userAgent.includes("Safari")||navigator.userAgent.includes("WebKit"))&&!navigator.userAgent.includes("Chrome")}function j1(){try{return typeof indexedDB=="object"}catch{return!1}}function GR(){return new Promise((s,e)=>{try{let t=!0;const i="validate-browser-context-for-indexeddb-analytics-module",a=self.indexedDB.open(i);a.onsuccess=()=>{a.result.close(),t||self.indexedDB.deleteDatabase(i),s(!0)},a.onupgradeneeded=()=>{t=!1},a.onerror=()=>{e(a.error?.message||"")}}catch(t){e(t)}})}const QR="FirebaseError";class ds extends Error{constructor(e,t,i){super(t),this.code=e,this.customData=i,this.name=QR,Object.setPrototypeOf(this,ds.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Wu.prototype.create)}}class Wu{constructor(e,t,i){this.service=e,this.serviceName=t,this.errors=i}create(e,...t){const i=t[0]||{},a=`${this.service}/${e}`,l=this.errors[e],c=l?KR(l,i):"Error",f=`${this.serviceName}: ${c} (${a}).`;return new ds(a,f,i)}}function KR(s,e){return s.replace($R,(t,i)=>{const a=e[i];return a!=null?String(a):`<${i}?>`})}const $R=/\{\$([^}]+)}/g;function WR(s){for(const e in s)if(Object.prototype.hasOwnProperty.call(s,e))return!1;return!0}function Ja(s,e){if(s===e)return!0;const t=Object.keys(s),i=Object.keys(e);for(const a of t){if(!i.includes(a))return!1;const l=s[a],c=e[a];if(YT(l)&&YT(c)){if(!Ja(l,c))return!1}else if(l!==c)return!1}for(const a of i)if(!t.includes(a))return!1;return!0}function YT(s){return s!==null&&typeof s=="object"}function Yu(s){const e=[];for(const[t,i]of Object.entries(s))Array.isArray(i)?i.forEach(a=>{e.push(encodeURIComponent(t)+"="+encodeURIComponent(a))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(i));return e.length?"&"+e.join("&"):""}function du(s){const e={};return s.replace(/^\?/,"").split("&").forEach(i=>{if(i){const[a,l]=i.split("=");e[decodeURIComponent(a)]=decodeURIComponent(l)}}),e}function fu(s){const e=s.indexOf("?");if(!e)return"";const t=s.indexOf("#",e);return s.substring(e,t>0?t:void 0)}function YR(s,e){const t=new XR(s,e);return t.subscribe.bind(t)}class XR{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(i=>{this.error(i)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,i){let a;if(e===void 0&&t===void 0&&i===void 0)throw new Error("Missing Observer.");JR(e,["next","error","complete"])?a=e:a={next:e,error:t,complete:i},a.next===void 0&&(a.next=Vg),a.error===void 0&&(a.error=Vg),a.complete===void 0&&(a.complete=Vg);const l=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?a.error(this.finalError):a.complete()}catch{}}),this.observers.push(a),l}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{t(this.observers[e])}catch(i){typeof console<"u"&&console.error&&console.error(i)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function JR(s,e){if(typeof s!="object"||s===null)return!1;for(const t of e)if(t in s&&typeof s[t]=="function")return!0;return!1}function Vg(){}function At(s){return s&&s._delegate?s._delegate:s}class Jr{constructor(e,t,i){this.name=e,this.instanceFactory=t,this.type=i,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}const Fa="[DEFAULT]";class ZR{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const i=new MR;if(this.instancesDeferred.set(t,i),this.isInitialized(t)||this.shouldAutoInitialize())try{const a=this.getOrInitializeService({instanceIdentifier:t});a&&i.resolve(a)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){const t=this.normalizeInstanceIdentifier(e?.identifier),i=e?.optional??!1;if(this.isInitialized(t)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:t})}catch(a){if(i)return null;throw a}else{if(i)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(tD(e))try{this.getOrInitializeService({instanceIdentifier:Fa})}catch{}for(const[t,i]of this.instancesDeferred.entries()){const a=this.normalizeInstanceIdentifier(t);try{const l=this.getOrInitializeService({instanceIdentifier:a});i.resolve(l)}catch{}}}}clearInstance(e=Fa){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=Fa){return this.instances.has(e)}getOptions(e=Fa){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:t={}}=e,i=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(i))throw Error(`${this.name}(${i}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const a=this.getOrInitializeService({instanceIdentifier:i,options:t});for(const[l,c]of this.instancesDeferred.entries()){const f=this.normalizeInstanceIdentifier(l);i===f&&c.resolve(a)}return a}onInit(e,t){const i=this.normalizeInstanceIdentifier(t),a=this.onInitCallbacks.get(i)??new Set;a.add(e),this.onInitCallbacks.set(i,a);const l=this.instances.get(i);return l&&e(l,i),()=>{a.delete(e)}}invokeOnInitCallbacks(e,t){const i=this.onInitCallbacks.get(t);if(i)for(const a of i)try{a(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let i=this.instances.get(e);if(!i&&this.component&&(i=this.component.instanceFactory(this.container,{instanceIdentifier:eD(e),options:t}),this.instances.set(e,i),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(i,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,i)}catch{}return i||null}normalizeInstanceIdentifier(e=Fa){return this.component?this.component.multipleInstances?e:Fa:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function eD(s){return s===Fa?void 0:s}function tD(s){return s.instantiationMode==="EAGER"}class nD{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new ZR(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}var Fe;(function(s){s[s.DEBUG=0]="DEBUG",s[s.VERBOSE=1]="VERBOSE",s[s.INFO=2]="INFO",s[s.WARN=3]="WARN",s[s.ERROR=4]="ERROR",s[s.SILENT=5]="SILENT"})(Fe||(Fe={}));const iD={debug:Fe.DEBUG,verbose:Fe.VERBOSE,info:Fe.INFO,warn:Fe.WARN,error:Fe.ERROR,silent:Fe.SILENT},sD=Fe.INFO,rD={[Fe.DEBUG]:"log",[Fe.VERBOSE]:"log",[Fe.INFO]:"info",[Fe.WARN]:"warn",[Fe.ERROR]:"error"},aD=(s,e,...t)=>{if(e<s.logLevel)return;const i=new Date().toISOString(),a=rD[e];if(a)console[a](`[${i}]  ${s.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class Gy{constructor(e){this.name=e,this._logLevel=sD,this._logHandler=aD,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in Fe))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?iD[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,Fe.DEBUG,...e),this._logHandler(this,Fe.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,Fe.VERBOSE,...e),this._logHandler(this,Fe.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,Fe.INFO,...e),this._logHandler(this,Fe.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,Fe.WARN,...e),this._logHandler(this,Fe.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,Fe.ERROR,...e),this._logHandler(this,Fe.ERROR,...e)}}const oD=(s,e)=>e.some(t=>s instanceof t);let XT,JT;function lD(){return XT||(XT=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function cD(){return JT||(JT=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const k1=new WeakMap,iy=new WeakMap,O1=new WeakMap,Mg=new WeakMap,Qy=new WeakMap;function uD(s){const e=new Promise((t,i)=>{const a=()=>{s.removeEventListener("success",l),s.removeEventListener("error",c)},l=()=>{t(Qr(s.result)),a()},c=()=>{i(s.error),a()};s.addEventListener("success",l),s.addEventListener("error",c)});return e.then(t=>{t instanceof IDBCursor&&k1.set(t,s)}).catch(()=>{}),Qy.set(e,s),e}function hD(s){if(iy.has(s))return;const e=new Promise((t,i)=>{const a=()=>{s.removeEventListener("complete",l),s.removeEventListener("error",c),s.removeEventListener("abort",c)},l=()=>{t(),a()},c=()=>{i(s.error||new DOMException("AbortError","AbortError")),a()};s.addEventListener("complete",l),s.addEventListener("error",c),s.addEventListener("abort",c)});iy.set(s,e)}let sy={get(s,e,t){if(s instanceof IDBTransaction){if(e==="done")return iy.get(s);if(e==="objectStoreNames")return s.objectStoreNames||O1.get(s);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return Qr(s[e])},set(s,e,t){return s[e]=t,!0},has(s,e){return s instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in s}};function dD(s){sy=s(sy)}function fD(s){return s===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){const i=s.call(Pg(this),e,...t);return O1.set(i,e.sort?e.sort():[e]),Qr(i)}:cD().includes(s)?function(...e){return s.apply(Pg(this),e),Qr(k1.get(this))}:function(...e){return Qr(s.apply(Pg(this),e))}}function mD(s){return typeof s=="function"?fD(s):(s instanceof IDBTransaction&&hD(s),oD(s,lD())?new Proxy(s,sy):s)}function Qr(s){if(s instanceof IDBRequest)return uD(s);if(Mg.has(s))return Mg.get(s);const e=mD(s);return e!==s&&(Mg.set(s,e),Qy.set(e,s)),e}const Pg=s=>Qy.get(s);function pD(s,e,{blocked:t,upgrade:i,blocking:a,terminated:l}={}){const c=indexedDB.open(s,e),f=Qr(c);return i&&c.addEventListener("upgradeneeded",p=>{i(Qr(c.result),p.oldVersion,p.newVersion,Qr(c.transaction),p)}),t&&c.addEventListener("blocked",p=>t(p.oldVersion,p.newVersion,p)),f.then(p=>{l&&p.addEventListener("close",()=>l()),a&&p.addEventListener("versionchange",y=>a(y.oldVersion,y.newVersion,y))}).catch(()=>{}),f}const gD=["get","getKey","getAll","getAllKeys","count"],yD=["put","add","delete","clear"],Lg=new Map;function ZT(s,e){if(!(s instanceof IDBDatabase&&!(e in s)&&typeof e=="string"))return;if(Lg.get(e))return Lg.get(e);const t=e.replace(/FromIndex$/,""),i=e!==t,a=yD.includes(t);if(!(t in(i?IDBIndex:IDBObjectStore).prototype)||!(a||gD.includes(t)))return;const l=async function(c,...f){const p=this.transaction(c,a?"readwrite":"readonly");let y=p.store;return i&&(y=y.index(f.shift())),(await Promise.all([y[t](...f),a&&p.done]))[0]};return Lg.set(e,l),l}dD(s=>({...s,get:(e,t,i)=>ZT(e,t)||s.get(e,t,i),has:(e,t)=>!!ZT(e,t)||s.has(e,t)}));class vD{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(_D(t)){const i=t.getImmediate();return`${i.library}/${i.version}`}else return null}).filter(t=>t).join(" ")}}function _D(s){return s.getComponent()?.type==="VERSION"}const ry="@firebase/app",eE="0.14.8";const Gs=new Gy("@firebase/app"),bD="@firebase/app-compat",TD="@firebase/analytics-compat",ED="@firebase/analytics",xD="@firebase/app-check-compat",SD="@firebase/app-check",wD="@firebase/auth",AD="@firebase/auth-compat",ID="@firebase/database",CD="@firebase/data-connect",RD="@firebase/database-compat",DD="@firebase/functions",ND="@firebase/functions-compat",jD="@firebase/installations",kD="@firebase/installations-compat",OD="@firebase/messaging",VD="@firebase/messaging-compat",MD="@firebase/performance",PD="@firebase/performance-compat",LD="@firebase/remote-config",UD="@firebase/remote-config-compat",zD="@firebase/storage",BD="@firebase/storage-compat",FD="@firebase/firestore",qD="@firebase/ai",HD="@firebase/firestore-compat",GD="firebase",QD="12.9.0";const ay="[DEFAULT]",KD={[ry]:"fire-core",[bD]:"fire-core-compat",[ED]:"fire-analytics",[TD]:"fire-analytics-compat",[SD]:"fire-app-check",[xD]:"fire-app-check-compat",[wD]:"fire-auth",[AD]:"fire-auth-compat",[ID]:"fire-rtdb",[CD]:"fire-data-connect",[RD]:"fire-rtdb-compat",[DD]:"fire-fn",[ND]:"fire-fn-compat",[jD]:"fire-iid",[kD]:"fire-iid-compat",[OD]:"fire-fcm",[VD]:"fire-fcm-compat",[MD]:"fire-perf",[PD]:"fire-perf-compat",[LD]:"fire-rc",[UD]:"fire-rc-compat",[zD]:"fire-gcs",[BD]:"fire-gcs-compat",[FD]:"fire-fst",[HD]:"fire-fst-compat",[qD]:"fire-vertex","fire-js":"fire-js",[GD]:"fire-js-all"};const xf=new Map,$D=new Map,oy=new Map;function tE(s,e){try{s.container.addComponent(e)}catch(t){Gs.debug(`Component ${e.name} failed to register with FirebaseApp ${s.name}`,t)}}function Za(s){const e=s.name;if(oy.has(e))return Gs.debug(`There were multiple attempts to register component ${e}.`),!1;oy.set(e,s);for(const t of xf.values())tE(t,s);for(const t of $D.values())tE(t,s);return!0}function nm(s,e){const t=s.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),s.container.getProvider(e)}function Fn(s){return s==null?!1:s.settings!==void 0}const WD={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},Kr=new Wu("app","Firebase",WD);class YD{constructor(e,t,i){this._isDeleted=!1,this._options={...e},this._config={...t},this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=i,this.container.addComponent(new Jr("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Kr.create("app-deleted",{appName:this._name})}}const ho=QD;function V1(s,e={}){let t=s;typeof e!="object"&&(e={name:e});const i={name:ay,automaticDataCollectionEnabled:!0,...e},a=i.name;if(typeof a!="string"||!a)throw Kr.create("bad-app-name",{appName:String(a)});if(t||(t=A1()),!t)throw Kr.create("no-options");const l=xf.get(a);if(l){if(Ja(t,l.options)&&Ja(i,l.config))return l;throw Kr.create("duplicate-app",{appName:a})}const c=new nD(a);for(const p of oy.values())c.addComponent(p);const f=new YD(t,i,c);return xf.set(a,f),f}function M1(s=ay){const e=xf.get(s);if(!e&&s===ay&&A1())return V1();if(!e)throw Kr.create("no-app",{appName:s});return e}function as(s,e,t){let i=KD[s]??s;t&&(i+=`-${t}`);const a=i.match(/\s|\//),l=e.match(/\s|\//);if(a||l){const c=[`Unable to register library "${i}" with version "${e}":`];a&&c.push(`library name "${i}" contains illegal characters (whitespace or "/")`),a&&l&&c.push("and"),l&&c.push(`version name "${e}" contains illegal characters (whitespace or "/")`),Gs.warn(c.join(" "));return}Za(new Jr(`${i}-version`,()=>({library:i,version:e}),"VERSION"))}const XD="firebase-heartbeat-database",JD=1,Du="firebase-heartbeat-store";let Ug=null;function P1(){return Ug||(Ug=pD(XD,JD,{upgrade:(s,e)=>{switch(e){case 0:try{s.createObjectStore(Du)}catch(t){console.warn(t)}}}}).catch(s=>{throw Kr.create("idb-open",{originalErrorMessage:s.message})})),Ug}async function ZD(s){try{const t=(await P1()).transaction(Du),i=await t.objectStore(Du).get(L1(s));return await t.done,i}catch(e){if(e instanceof ds)Gs.warn(e.message);else{const t=Kr.create("idb-get",{originalErrorMessage:e?.message});Gs.warn(t.message)}}}async function nE(s,e){try{const i=(await P1()).transaction(Du,"readwrite");await i.objectStore(Du).put(e,L1(s)),await i.done}catch(t){if(t instanceof ds)Gs.warn(t.message);else{const i=Kr.create("idb-set",{originalErrorMessage:t?.message});Gs.warn(i.message)}}}function L1(s){return`${s.name}!${s.options.appId}`}const eN=1024,tN=30;class nN{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new sN(t),this._heartbeatsCachePromise=this._storage.read().then(i=>(this._heartbeatsCache=i,i))}async triggerHeartbeat(){try{const t=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),i=iE();if(this._heartbeatsCache?.heartbeats==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null)||this._heartbeatsCache.lastSentHeartbeatDate===i||this._heartbeatsCache.heartbeats.some(a=>a.date===i))return;if(this._heartbeatsCache.heartbeats.push({date:i,agent:t}),this._heartbeatsCache.heartbeats.length>tN){const a=rN(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(a,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(e){Gs.warn(e)}}async getHeartbeatsHeader(){try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null||this._heartbeatsCache.heartbeats.length===0)return"";const e=iE(),{heartbeatsToSend:t,unsentEntries:i}=iN(this._heartbeatsCache.heartbeats),a=Ef(JSON.stringify({version:2,heartbeats:t}));return this._heartbeatsCache.lastSentHeartbeatDate=e,i.length>0?(this._heartbeatsCache.heartbeats=i,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),a}catch(e){return Gs.warn(e),""}}}function iE(){return new Date().toISOString().substring(0,10)}function iN(s,e=eN){const t=[];let i=s.slice();for(const a of s){const l=t.find(c=>c.agent===a.agent);if(l){if(l.dates.push(a.date),sE(t)>e){l.dates.pop();break}}else if(t.push({agent:a.agent,dates:[a.date]}),sE(t)>e){t.pop();break}i=i.slice(1)}return{heartbeatsToSend:t,unsentEntries:i}}class sN{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return j1()?GR().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const t=await ZD(this.app);return t?.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){const i=await this.read();return nE(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??i.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){const i=await this.read();return nE(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??i.lastSentHeartbeatDate,heartbeats:[...i.heartbeats,...e.heartbeats]})}else return}}function sE(s){return Ef(JSON.stringify({version:2,heartbeats:s})).length}function rN(s){if(s.length===0)return-1;let e=0,t=s[0].date;for(let i=1;i<s.length;i++)s[i].date<t&&(t=s[i].date,e=i);return e}function aN(s){Za(new Jr("platform-logger",e=>new vD(e),"PRIVATE")),Za(new Jr("heartbeat",e=>new nN(e),"PRIVATE")),as(ry,eE,s),as(ry,eE,"esm2020"),as("fire-js","")}aN("");function U1(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const oN=U1,z1=new Wu("auth","Firebase",U1());const Sf=new Gy("@firebase/auth");function lN(s,...e){Sf.logLevel<=Fe.WARN&&Sf.warn(`Auth (${ho}): ${s}`,...e)}function rf(s,...e){Sf.logLevel<=Fe.ERROR&&Sf.error(`Auth (${ho}): ${s}`,...e)}function Di(s,...e){throw Ky(s,...e)}function os(s,...e){return Ky(s,...e)}function B1(s,e,t){const i={...oN(),[e]:t};return new Wu("auth","Firebase",i).create(e,{appName:s.name})}function Bs(s){return B1(s,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function Ky(s,...e){if(typeof s!="string"){const t=e[0],i=[...e.slice(1)];return i[0]&&(i[0].appName=s.name),s._errorFactory.create(t,...i)}return z1.create(s,...e)}function Re(s,e,...t){if(!s)throw Ky(e,...t)}function Ls(s){const e="INTERNAL ASSERTION FAILED: "+s;throw rf(e),new Error(e)}function Qs(s,e){s||Ls(e)}function ly(){return typeof self<"u"&&self.location?.href||""}function cN(){return rE()==="http:"||rE()==="https:"}function rE(){return typeof self<"u"&&self.location?.protocol||null}function uN(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(cN()||FR()||"connection"in navigator)?navigator.onLine:!0}function hN(){if(typeof navigator>"u")return null;const s=navigator;return s.languages&&s.languages[0]||s.language||null}class Xu{constructor(e,t){this.shortDelay=e,this.longDelay=t,Qs(t>e,"Short delay should be less than long delay!"),this.isMobile=zR()||qR()}get(){return uN()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}function $y(s,e){Qs(s.emulator,"Emulator should always be set here");const{url:t}=s.emulator;return e?`${t}${e.startsWith("/")?e.slice(1):e}`:t}class F1{static initialize(e,t,i){this.fetchImpl=e,t&&(this.headersImpl=t),i&&(this.responseImpl=i)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;Ls("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;Ls("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;Ls("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}const dN={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};const fN=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],mN=new Xu(3e4,6e4);function Ws(s,e){return s.tenantId&&!e.tenantId?{...e,tenantId:s.tenantId}:e}async function fs(s,e,t,i,a={}){return q1(s,a,async()=>{let l={},c={};i&&(e==="GET"?c=i:l={body:JSON.stringify(i)});const f=Yu({key:s.config.apiKey,...c}).slice(1),p=await s._getAdditionalHeaders();p["Content-Type"]="application/json",s.languageCode&&(p["X-Firebase-Locale"]=s.languageCode);const y={method:e,headers:p,...l};return BR()||(y.referrerPolicy="no-referrer"),s.emulatorConfig&&uo(s.emulatorConfig.host)&&(y.credentials="include"),F1.fetch()(await H1(s,s.config.apiHost,t,f),y)})}async function q1(s,e,t){s._canInitEmulator=!1;const i={...dN,...e};try{const a=new gN(s),l=await Promise.race([t(),a.promise]);a.clearNetworkTimeout();const c=await l.json();if("needConfirmation"in c)throw Fd(s,"account-exists-with-different-credential",c);if(l.ok&&!("errorMessage"in c))return c;{const f=l.ok?c.errorMessage:c.error.message,[p,y]=f.split(" : ");if(p==="FEDERATED_USER_ID_ALREADY_LINKED")throw Fd(s,"credential-already-in-use",c);if(p==="EMAIL_EXISTS")throw Fd(s,"email-already-in-use",c);if(p==="USER_DISABLED")throw Fd(s,"user-disabled",c);const v=i[p]||p.toLowerCase().replace(/[_\s]+/g,"-");if(y)throw B1(s,v,y);Di(s,v)}}catch(a){if(a instanceof ds)throw a;Di(s,"network-request-failed",{message:String(a)})}}async function Ju(s,e,t,i,a={}){const l=await fs(s,e,t,i,a);return"mfaPendingCredential"in l&&Di(s,"multi-factor-auth-required",{_serverResponse:l}),l}async function H1(s,e,t,i){const a=`${e}${t}?${i}`,l=s,c=l.config.emulator?$y(s.config,a):`${s.config.apiScheme}://${a}`;return fN.includes(t)&&(await l._persistenceManagerAvailable,l._getPersistenceType()==="COOKIE")?l._getPersistence()._getFinalTarget(c).toString():c}function pN(s){switch(s){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class gN{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((t,i)=>{this.timer=setTimeout(()=>i(os(this.auth,"network-request-failed")),mN.get())})}}function Fd(s,e,t){const i={appName:s.name};t.email&&(i.email=t.email),t.phoneNumber&&(i.phoneNumber=t.phoneNumber);const a=os(s,e,i);return a.customData._tokenResponse=t,a}function aE(s){return s!==void 0&&s.enterprise!==void 0}class yN{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const t of this.recaptchaEnforcementState)if(t.provider&&t.provider===e)return pN(t.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}isAnyProviderEnabled(){return this.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")||this.isProviderEnabled("PHONE_PROVIDER")}}async function vN(s,e){return fs(s,"GET","/v2/recaptchaConfig",Ws(s,e))}async function _N(s,e){return fs(s,"POST","/v1/accounts:delete",e)}async function wf(s,e){return fs(s,"POST","/v1/accounts:lookup",e)}function _u(s){if(s)try{const e=new Date(Number(s));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function bN(s,e=!1){const t=At(s),i=await t.getIdToken(e),a=Wy(i);Re(a&&a.exp&&a.auth_time&&a.iat,t.auth,"internal-error");const l=typeof a.firebase=="object"?a.firebase:void 0,c=l?.sign_in_provider;return{claims:a,token:i,authTime:_u(zg(a.auth_time)),issuedAtTime:_u(zg(a.iat)),expirationTime:_u(zg(a.exp)),signInProvider:c||null,signInSecondFactor:l?.sign_in_second_factor||null}}function zg(s){return Number(s)*1e3}function Wy(s){const[e,t,i]=s.split(".");if(e===void 0||t===void 0||i===void 0)return rf("JWT malformed, contained fewer than 3 sections"),null;try{const a=x1(t);return a?JSON.parse(a):(rf("Failed to decode base64 JWT payload"),null)}catch(a){return rf("Caught error parsing JWT payload as JSON",a?.toString()),null}}function oE(s){const e=Wy(s);return Re(e,"internal-error"),Re(typeof e.exp<"u","internal-error"),Re(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}async function Sl(s,e,t=!1){if(t)return e;try{return await e}catch(i){throw i instanceof ds&&TN(i)&&s.auth.currentUser===s&&await s.auth.signOut(),i}}function TN({code:s}){return s==="auth/user-disabled"||s==="auth/user-token-expired"}class EN{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){if(e){const t=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),t}else{this.errorBackoff=3e4;const i=(this.user.stsTokenManager.expirationTime??0)-Date.now()-3e5;return Math.max(0,i)}}schedule(e=!1){if(!this.isRunning)return;const t=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},t)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){e?.code==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}class cy{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=_u(this.lastLoginAt),this.creationTime=_u(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}async function Af(s){const e=s.auth,t=await s.getIdToken(),i=await Sl(s,wf(e,{idToken:t}));Re(i?.users.length,e,"internal-error");const a=i.users[0];s._notifyReloadListener(a);const l=a.providerUserInfo?.length?G1(a.providerUserInfo):[],c=SN(s.providerData,l),f=s.isAnonymous,p=!(s.email&&a.passwordHash)&&!c?.length,y=f?p:!1,v={uid:a.localId,displayName:a.displayName||null,photoURL:a.photoUrl||null,email:a.email||null,emailVerified:a.emailVerified||!1,phoneNumber:a.phoneNumber||null,tenantId:a.tenantId||null,providerData:c,metadata:new cy(a.createdAt,a.lastLoginAt),isAnonymous:y};Object.assign(s,v)}async function xN(s){const e=At(s);await Af(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function SN(s,e){return[...s.filter(i=>!e.some(a=>a.providerId===i.providerId)),...e]}function G1(s){return s.map(({providerId:e,...t})=>({providerId:e,uid:t.rawId||"",displayName:t.displayName||null,email:t.email||null,phoneNumber:t.phoneNumber||null,photoURL:t.photoUrl||null}))}async function wN(s,e){const t=await q1(s,{},async()=>{const i=Yu({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:a,apiKey:l}=s.config,c=await H1(s,a,"/v1/token",`key=${l}`),f=await s._getAdditionalHeaders();f["Content-Type"]="application/x-www-form-urlencoded";const p={method:"POST",headers:f,body:i};return s.emulatorConfig&&uo(s.emulatorConfig.host)&&(p.credentials="include"),F1.fetch()(c,p)});return{accessToken:t.access_token,expiresIn:t.expires_in,refreshToken:t.refresh_token}}async function AN(s,e){return fs(s,"POST","/v2/accounts:revokeToken",Ws(s,e))}class vl{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){Re(e.idToken,"internal-error"),Re(typeof e.idToken<"u","internal-error"),Re(typeof e.refreshToken<"u","internal-error");const t="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):oE(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){Re(e.length!==0,"internal-error");const t=oE(e);this.updateTokensAndExpiration(e,null,t)}async getToken(e,t=!1){return!t&&this.accessToken&&!this.isExpired?this.accessToken:(Re(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){const{accessToken:i,refreshToken:a,expiresIn:l}=await wN(e,t);this.updateTokensAndExpiration(i,a,Number(l))}updateTokensAndExpiration(e,t,i){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+i*1e3}static fromJSON(e,t){const{refreshToken:i,accessToken:a,expirationTime:l}=t,c=new vl;return i&&(Re(typeof i=="string","internal-error",{appName:e}),c.refreshToken=i),a&&(Re(typeof a=="string","internal-error",{appName:e}),c.accessToken=a),l&&(Re(typeof l=="number","internal-error",{appName:e}),c.expirationTime=l),c}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new vl,this.toJSON())}_performRefresh(){return Ls("not implemented")}}function Or(s,e){Re(typeof s=="string"||typeof s>"u","internal-error",{appName:e})}class Ai{constructor({uid:e,auth:t,stsTokenManager:i,...a}){this.providerId="firebase",this.proactiveRefresh=new EN(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=t,this.stsTokenManager=i,this.accessToken=i.accessToken,this.displayName=a.displayName||null,this.email=a.email||null,this.emailVerified=a.emailVerified||!1,this.phoneNumber=a.phoneNumber||null,this.photoURL=a.photoURL||null,this.isAnonymous=a.isAnonymous||!1,this.tenantId=a.tenantId||null,this.providerData=a.providerData?[...a.providerData]:[],this.metadata=new cy(a.createdAt||void 0,a.lastLoginAt||void 0)}async getIdToken(e){const t=await Sl(this,this.stsTokenManager.getToken(this.auth,e));return Re(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return bN(this,e)}reload(){return xN(this)}_assign(e){this!==e&&(Re(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(t=>({...t})),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const t=new Ai({...this,auth:e,stsTokenManager:this.stsTokenManager._clone()});return t.metadata._copy(this.metadata),t}_onReload(e){Re(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,t=!1){let i=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),i=!0),t&&await Af(this),await this.auth._persistUserIfCurrent(this),i&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(Fn(this.auth.app))return Promise.reject(Bs(this.auth));const e=await this.getIdToken();return await Sl(this,_N(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return{uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>({...e})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId,...this.metadata.toJSON(),apiKey:this.auth.config.apiKey,appName:this.auth.name}}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){const i=t.displayName??void 0,a=t.email??void 0,l=t.phoneNumber??void 0,c=t.photoURL??void 0,f=t.tenantId??void 0,p=t._redirectEventId??void 0,y=t.createdAt??void 0,v=t.lastLoginAt??void 0,{uid:b,emailVerified:x,isAnonymous:k,providerData:O,stsTokenManager:D}=t;Re(b&&D,e,"internal-error");const M=vl.fromJSON(this.name,D);Re(typeof b=="string",e,"internal-error"),Or(i,e.name),Or(a,e.name),Re(typeof x=="boolean",e,"internal-error"),Re(typeof k=="boolean",e,"internal-error"),Or(l,e.name),Or(c,e.name),Or(f,e.name),Or(p,e.name),Or(y,e.name),Or(v,e.name);const Y=new Ai({uid:b,auth:e,email:a,emailVerified:x,displayName:i,isAnonymous:k,photoURL:c,phoneNumber:l,tenantId:f,stsTokenManager:M,createdAt:y,lastLoginAt:v});return O&&Array.isArray(O)&&(Y.providerData=O.map(Z=>({...Z}))),p&&(Y._redirectEventId=p),Y}static async _fromIdTokenResponse(e,t,i=!1){const a=new vl;a.updateFromServerResponse(t);const l=new Ai({uid:t.localId,auth:e,stsTokenManager:a,isAnonymous:i});return await Af(l),l}static async _fromGetAccountInfoResponse(e,t,i){const a=t.users[0];Re(a.localId!==void 0,"internal-error");const l=a.providerUserInfo!==void 0?G1(a.providerUserInfo):[],c=!(a.email&&a.passwordHash)&&!l?.length,f=new vl;f.updateFromIdToken(i);const p=new Ai({uid:a.localId,auth:e,stsTokenManager:f,isAnonymous:c}),y={uid:a.localId,displayName:a.displayName||null,photoURL:a.photoUrl||null,email:a.email||null,emailVerified:a.emailVerified||!1,phoneNumber:a.phoneNumber||null,tenantId:a.tenantId||null,providerData:l,metadata:new cy(a.createdAt,a.lastLoginAt),isAnonymous:!(a.email&&a.passwordHash)&&!l?.length};return Object.assign(p,y),p}}const lE=new Map;function Us(s){Qs(s instanceof Function,"Expected a class definition");let e=lE.get(s);return e?(Qs(e instanceof s,"Instance stored in cache mismatched with class"),e):(e=new s,lE.set(s,e),e)}class Q1{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,t){this.storage[e]=t}async _get(e){const t=this.storage[e];return t===void 0?null:t}async _remove(e){delete this.storage[e]}_addListener(e,t){}_removeListener(e,t){}}Q1.type="NONE";const cE=Q1;function af(s,e,t){return`firebase:${s}:${e}:${t}`}class _l{constructor(e,t,i){this.persistence=e,this.auth=t,this.userKey=i;const{config:a,name:l}=this.auth;this.fullUserKey=af(this.userKey,a.apiKey,l),this.fullPersistenceKey=af("persistence",a.apiKey,l),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const t=await wf(this.auth,{idToken:e}).catch(()=>{});return t?Ai._fromGetAccountInfoResponse(this.auth,t,e):null}return Ai._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const t=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,t)return this.setCurrentUser(t)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t,i="authUser"){if(!t.length)return new _l(Us(cE),e,i);const a=(await Promise.all(t.map(async y=>{if(await y._isAvailable())return y}))).filter(y=>y);let l=a[0]||Us(cE);const c=af(i,e.config.apiKey,e.name);let f=null;for(const y of t)try{const v=await y._get(c);if(v){let b;if(typeof v=="string"){const x=await wf(e,{idToken:v}).catch(()=>{});if(!x)break;b=await Ai._fromGetAccountInfoResponse(e,x,v)}else b=Ai._fromJSON(e,v);y!==l&&(f=b),l=y;break}}catch{}const p=a.filter(y=>y._shouldAllowMigration);return!l._shouldAllowMigration||!p.length?new _l(l,e,i):(l=p[0],f&&await l._set(c,f.toJSON()),await Promise.all(t.map(async y=>{if(y!==l)try{await y._remove(c)}catch{}})),new _l(l,e,i))}}function uE(s){const e=s.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(Y1(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(K1(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(J1(e))return"Blackberry";if(Z1(e))return"Webos";if($1(e))return"Safari";if((e.includes("chrome/")||W1(e))&&!e.includes("edge/"))return"Chrome";if(X1(e))return"Android";{const t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,i=s.match(t);if(i?.length===2)return i[1]}return"Other"}function K1(s=Qt()){return/firefox\//i.test(s)}function $1(s=Qt()){const e=s.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function W1(s=Qt()){return/crios\//i.test(s)}function Y1(s=Qt()){return/iemobile/i.test(s)}function X1(s=Qt()){return/android/i.test(s)}function J1(s=Qt()){return/blackberry/i.test(s)}function Z1(s=Qt()){return/webos/i.test(s)}function Yy(s=Qt()){return/iphone|ipad|ipod/i.test(s)||/macintosh/i.test(s)&&/mobile/i.test(s)}function IN(s=Qt()){return Yy(s)&&!!window.navigator?.standalone}function CN(){return HR()&&document.documentMode===10}function eS(s=Qt()){return Yy(s)||X1(s)||Z1(s)||J1(s)||/windows phone/i.test(s)||Y1(s)}function tS(s,e=[]){let t;switch(s){case"Browser":t=uE(Qt());break;case"Worker":t=`${uE(Qt())}-${s}`;break;default:t=s}const i=e.length?e.join(","):"FirebaseCore-web";return`${t}/JsCore/${ho}/${i}`}class RN{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){const i=l=>new Promise((c,f)=>{try{const p=e(l);c(p)}catch(p){f(p)}});i.onAbort=t,this.queue.push(i);const a=this.queue.length-1;return()=>{this.queue[a]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const t=[];try{for(const i of this.queue)await i(e),i.onAbort&&t.push(i.onAbort)}catch(i){t.reverse();for(const a of t)try{a()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:i?.message})}}}async function DN(s,e={}){return fs(s,"GET","/v2/passwordPolicy",Ws(s,e))}const NN=6;class jN{constructor(e){const t=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=t.minPasswordLength??NN,t.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=t.maxPasswordLength),t.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=t.containsLowercaseCharacter),t.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=t.containsUppercaseCharacter),t.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=t.containsNumericCharacter),t.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=t.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=e.allowedNonAlphanumericCharacters?.join("")??"",this.forceUpgradeOnSignin=e.forceUpgradeOnSignin??!1,this.schemaVersion=e.schemaVersion}validatePassword(e){const t={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,t),this.validatePasswordCharacterOptions(e,t),t.isValid&&(t.isValid=t.meetsMinPasswordLength??!0),t.isValid&&(t.isValid=t.meetsMaxPasswordLength??!0),t.isValid&&(t.isValid=t.containsLowercaseLetter??!0),t.isValid&&(t.isValid=t.containsUppercaseLetter??!0),t.isValid&&(t.isValid=t.containsNumericCharacter??!0),t.isValid&&(t.isValid=t.containsNonAlphanumericCharacter??!0),t}validatePasswordLengthOptions(e,t){const i=this.customStrengthOptions.minPasswordLength,a=this.customStrengthOptions.maxPasswordLength;i&&(t.meetsMinPasswordLength=e.length>=i),a&&(t.meetsMaxPasswordLength=e.length<=a)}validatePasswordCharacterOptions(e,t){this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);let i;for(let a=0;a<e.length;a++)i=e.charAt(a),this.updatePasswordCharacterOptionsStatuses(t,i>="a"&&i<="z",i>="A"&&i<="Z",i>="0"&&i<="9",this.allowedNonAlphanumericCharacters.includes(i))}updatePasswordCharacterOptionsStatuses(e,t,i,a,l){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=i)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=a)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=l))}}class kN{constructor(e,t,i,a){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=i,this.config=a,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new hE(this),this.idTokenSubscription=new hE(this),this.beforeStateQueue=new RN(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=z1,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=a.sdkClientVersion,this._persistenceManagerAvailable=new Promise(l=>this._resolvePersistenceManagerAvailable=l)}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=Us(t)),this._initializationPromise=this.queue(async()=>{if(!this._deleted&&(this.persistenceManager=await _l.create(this,e),this._resolvePersistenceManagerAvailable?.(),!this._deleted)){if(this._popupRedirectResolver?._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(t),this.lastNotifiedUid=this.currentUser?.uid||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const t=await wf(this,{idToken:e}),i=await Ai._fromGetAccountInfoResponse(this,t,e);await this.directlySetCurrentUser(i)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){if(Fn(this.app)){const l=this.app.settings.authIdToken;return l?new Promise(c=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(l).then(c,c))}):this.directlySetCurrentUser(null)}const t=await this.assertedPersistence.getCurrentUser();let i=t,a=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const l=this.redirectUser?._redirectEventId,c=i?._redirectEventId,f=await this.tryRedirectSignIn(e);(!l||l===c)&&f?.user&&(i=f.user,a=!0)}if(!i)return this.directlySetCurrentUser(null);if(!i._redirectEventId){if(a)try{await this.beforeStateQueue.runMiddleware(i)}catch(l){i=t,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(l))}return i?this.reloadAndSetCurrentUserOrClear(i):this.directlySetCurrentUser(null)}return Re(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===i._redirectEventId?this.directlySetCurrentUser(i):this.reloadAndSetCurrentUserOrClear(i)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await Af(e)}catch(t){if(t?.code!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=hN()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(Fn(this.app))return Promise.reject(Bs(this));const t=e?At(e):null;return t&&Re(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e,t=!1){if(!this._deleted)return e&&Re(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return Fn(this.app)?Promise.reject(Bs(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return Fn(this.app)?Promise.reject(Bs(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(Us(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await DN(this),t=new jN(e);this.tenantId===null?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new Wu("auth","Firebase",e())}onAuthStateChanged(e,t,i){return this.registerStateListener(this.authStateSubscription,e,t,i)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,i){return this.registerStateListener(this.idTokenSubscription,e,t,i)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{const i=this.onAuthStateChanged(()=>{i(),e()},t)}})}async revokeAccessToken(e){if(this.currentUser){const t=await this.currentUser.getIdToken(),i={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:t};this.tenantId!=null&&(i.tenantId=this.tenantId),await AN(this,i)}}toJSON(){return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:this._currentUser?.toJSON()}}async _setRedirectUser(e,t){const i=await this.getOrInitRedirectPersistenceManager(t);return e===null?i.removeCurrentUser():i.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const t=e&&Us(e)||this._popupRedirectResolver;Re(t,this,"argument-error"),this.redirectPersistenceManager=await _l.create(this,[Us(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){return this._isInitialized&&await this.queue(async()=>{}),this._currentUser?._redirectEventId===e?this._currentUser:this.redirectUser?._redirectEventId===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const e=this.currentUser?.uid??null;this.lastNotifiedUid!==e&&(this.lastNotifiedUid=e,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,i,a){if(this._deleted)return()=>{};const l=typeof t=="function"?t:t.next.bind(t);let c=!1;const f=this._isInitialized?Promise.resolve():this._initializationPromise;if(Re(f,this,"internal-error"),f.then(()=>{c||l(this.currentUser)}),typeof t=="function"){const p=e.addObserver(t,i,a);return()=>{c=!0,p()}}else{const p=e.addObserver(t);return()=>{c=!0,p()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return Re(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=tS(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){const e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId);const t=await this.heartbeatServiceProvider.getImmediate({optional:!0})?.getHeartbeatsHeader();t&&(e["X-Firebase-Client"]=t);const i=await this._getAppCheckToken();return i&&(e["X-Firebase-AppCheck"]=i),e}async _getAppCheckToken(){if(Fn(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=await this.appCheckServiceProvider.getImmediate({optional:!0})?.getToken();return e?.error&&lN(`Error while retrieving App Check token: ${e.error}`),e?.token}}function ia(s){return At(s)}class hE{constructor(e){this.auth=e,this.observer=null,this.addObserver=YR(t=>this.observer=t)}get next(){return Re(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}let im={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function ON(s){im=s}function nS(s){return im.loadJS(s)}function VN(){return im.recaptchaEnterpriseScript}function MN(){return im.gapiScript}function PN(s){return`__${s}${Math.floor(Math.random()*1e6)}`}class LN{constructor(){this.enterprise=new UN}ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}class UN{ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}const zN="recaptcha-enterprise",iS="NO_RECAPTCHA";class BN{constructor(e){this.type=zN,this.auth=ia(e)}async verify(e="verify",t=!1){async function i(l){if(!t){if(l.tenantId==null&&l._agentRecaptchaConfig!=null)return l._agentRecaptchaConfig.siteKey;if(l.tenantId!=null&&l._tenantRecaptchaConfigs[l.tenantId]!==void 0)return l._tenantRecaptchaConfigs[l.tenantId].siteKey}return new Promise(async(c,f)=>{vN(l,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(p=>{if(p.recaptchaKey===void 0)f(new Error("recaptcha Enterprise site key undefined"));else{const y=new yN(p);return l.tenantId==null?l._agentRecaptchaConfig=y:l._tenantRecaptchaConfigs[l.tenantId]=y,c(y.siteKey)}}).catch(p=>{f(p)})})}function a(l,c,f){const p=window.grecaptcha;aE(p)?p.enterprise.ready(()=>{p.enterprise.execute(l,{action:e}).then(y=>{c(y)}).catch(()=>{c(iS)})}):f(Error("No reCAPTCHA enterprise script loaded."))}return this.auth.settings.appVerificationDisabledForTesting?new LN().execute("siteKey",{action:"verify"}):new Promise((l,c)=>{i(this.auth).then(f=>{if(!t&&aE(window.grecaptcha))a(f,l,c);else{if(typeof window>"u"){c(new Error("RecaptchaVerifier is only supported in browser"));return}let p=VN();p.length!==0&&(p+=f),nS(p).then(()=>{a(f,l,c)}).catch(y=>{c(y)})}}).catch(f=>{c(f)})})}}async function dE(s,e,t,i=!1,a=!1){const l=new BN(s);let c;if(a)c=iS;else try{c=await l.verify(t)}catch{c=await l.verify(t,!0)}const f={...e};if(t==="mfaSmsEnrollment"||t==="mfaSmsSignIn"){if("phoneEnrollmentInfo"in f){const p=f.phoneEnrollmentInfo.phoneNumber,y=f.phoneEnrollmentInfo.recaptchaToken;Object.assign(f,{phoneEnrollmentInfo:{phoneNumber:p,recaptchaToken:y,captchaResponse:c,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}else if("phoneSignInInfo"in f){const p=f.phoneSignInInfo.recaptchaToken;Object.assign(f,{phoneSignInInfo:{recaptchaToken:p,captchaResponse:c,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}return f}return i?Object.assign(f,{captchaResp:c}):Object.assign(f,{captchaResponse:c}),Object.assign(f,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(f,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),f}async function If(s,e,t,i,a){if(s._getRecaptchaConfig()?.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const l=await dE(s,e,t,t==="getOobCode");return i(s,l)}else return i(s,e).catch(async l=>{if(l.code==="auth/missing-recaptcha-token"){console.log(`${t} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const c=await dE(s,e,t,t==="getOobCode");return i(s,c)}else return Promise.reject(l)})}function FN(s,e){const t=nm(s,"auth");if(t.isInitialized()){const a=t.getImmediate(),l=t.getOptions();if(Ja(l,e??{}))return a;Di(a,"already-initialized")}return t.initialize({options:e})}function qN(s,e){const t=e?.persistence||[],i=(Array.isArray(t)?t:[t]).map(Us);e?.errorMap&&s._updateErrorMap(e.errorMap),s._initializeWithPersistence(i,e?.popupRedirectResolver)}function HN(s,e,t){const i=ia(s);Re(/^https?:\/\//.test(e),i,"invalid-emulator-scheme");const a=!1,l=sS(e),{host:c,port:f}=GN(e),p=f===null?"":`:${f}`,y={url:`${l}//${c}${p}/`},v=Object.freeze({host:c,port:f,protocol:l.replace(":",""),options:Object.freeze({disableWarnings:a})});if(!i._canInitEmulator){Re(i.config.emulator&&i.emulatorConfig,i,"emulator-config-failed"),Re(Ja(y,i.config.emulator)&&Ja(v,i.emulatorConfig),i,"emulator-config-failed");return}i.config.emulator=y,i.emulatorConfig=v,i.settings.appVerificationDisabledForTesting=!0,uo(c)?(Hy(`${l}//${c}${p}`),C1("Auth",!0)):QN()}function sS(s){const e=s.indexOf(":");return e<0?"":s.substr(0,e+1)}function GN(s){const e=sS(s),t=/(\/\/)?([^?#/]+)/.exec(s.substr(e.length));if(!t)return{host:"",port:null};const i=t[2].split("@").pop()||"",a=/^(\[[^\]]+\])(:|$)/.exec(i);if(a){const l=a[1];return{host:l,port:fE(i.substr(l.length+1))}}else{const[l,c]=i.split(":");return{host:l,port:fE(c)}}}function fE(s){if(!s)return null;const e=Number(s);return isNaN(e)?null:e}function QN(){function s(){const e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",s):s())}class Xy{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return Ls("not implemented")}_getIdTokenResponse(e){return Ls("not implemented")}_linkToIdToken(e,t){return Ls("not implemented")}_getReauthenticationResolver(e){return Ls("not implemented")}}async function KN(s,e){return fs(s,"POST","/v1/accounts:signUp",e)}async function $N(s,e){return Ju(s,"POST","/v1/accounts:signInWithPassword",Ws(s,e))}async function WN(s,e){return fs(s,"POST","/v1/accounts:sendOobCode",Ws(s,e))}async function YN(s,e){return WN(s,e)}async function XN(s,e){return Ju(s,"POST","/v1/accounts:signInWithEmailLink",Ws(s,e))}async function JN(s,e){return Ju(s,"POST","/v1/accounts:signInWithEmailLink",Ws(s,e))}class Nu extends Xy{constructor(e,t,i,a=null){super("password",i),this._email=e,this._password=t,this._tenantId=a}static _fromEmailAndPassword(e,t){return new Nu(e,t,"password")}static _fromEmailAndCode(e,t,i=null){return new Nu(e,t,"emailLink",i)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e;if(t?.email&&t?.password){if(t.signInMethod==="password")return this._fromEmailAndPassword(t.email,t.password);if(t.signInMethod==="emailLink")return this._fromEmailAndCode(t.email,t.password,t.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const t={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return If(e,t,"signInWithPassword",$N);case"emailLink":return XN(e,{email:this._email,oobCode:this._password});default:Di(e,"internal-error")}}async _linkToIdToken(e,t){switch(this.signInMethod){case"password":const i={idToken:t,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return If(e,i,"signUpPassword",KN);case"emailLink":return JN(e,{idToken:t,email:this._email,oobCode:this._password});default:Di(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}async function bl(s,e){return Ju(s,"POST","/v1/accounts:signInWithIdp",Ws(s,e))}const ZN="http://localhost";class eo extends Xy{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const t=new eo(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):Di("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e,{providerId:i,signInMethod:a,...l}=t;if(!i||!a)return null;const c=new eo(i,a);return c.idToken=l.idToken||void 0,c.accessToken=l.accessToken||void 0,c.secret=l.secret,c.nonce=l.nonce,c.pendingToken=l.pendingToken||null,c}_getIdTokenResponse(e){const t=this.buildRequest();return bl(e,t)}_linkToIdToken(e,t){const i=this.buildRequest();return i.idToken=t,bl(e,i)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,bl(e,t)}buildRequest(){const e={requestUri:ZN,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=Yu(t)}return e}}function ej(s){switch(s){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function tj(s){const e=du(fu(s)).link,t=e?du(fu(e)).deep_link_id:null,i=du(fu(s)).deep_link_id;return(i?du(fu(i)).link:null)||i||t||e||s}class Jy{constructor(e){const t=du(fu(e)),i=t.apiKey??null,a=t.oobCode??null,l=ej(t.mode??null);Re(i&&a&&l,"argument-error"),this.apiKey=i,this.operation=l,this.code=a,this.continueUrl=t.continueUrl??null,this.languageCode=t.lang??null,this.tenantId=t.tenantId??null}static parseLink(e){const t=tj(e);try{return new Jy(t)}catch{return null}}}class $l{constructor(){this.providerId=$l.PROVIDER_ID}static credential(e,t){return Nu._fromEmailAndPassword(e,t)}static credentialWithLink(e,t){const i=Jy.parseLink(t);return Re(i,"argument-error"),Nu._fromEmailAndCode(e,i.code,i.tenantId)}}$l.PROVIDER_ID="password";$l.EMAIL_PASSWORD_SIGN_IN_METHOD="password";$l.EMAIL_LINK_SIGN_IN_METHOD="emailLink";class rS{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}class Zu extends rS{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}class Ur extends Zu{constructor(){super("facebook.com")}static credential(e){return eo._fromParams({providerId:Ur.PROVIDER_ID,signInMethod:Ur.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Ur.credentialFromTaggedObject(e)}static credentialFromError(e){return Ur.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Ur.credential(e.oauthAccessToken)}catch{return null}}}Ur.FACEBOOK_SIGN_IN_METHOD="facebook.com";Ur.PROVIDER_ID="facebook.com";class zr extends Zu{constructor(){super("google.com"),this.addScope("profile")}static credential(e,t){return eo._fromParams({providerId:zr.PROVIDER_ID,signInMethod:zr.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}static credentialFromResult(e){return zr.credentialFromTaggedObject(e)}static credentialFromError(e){return zr.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:i}=e;if(!t&&!i)return null;try{return zr.credential(t,i)}catch{return null}}}zr.GOOGLE_SIGN_IN_METHOD="google.com";zr.PROVIDER_ID="google.com";class Br extends Zu{constructor(){super("github.com")}static credential(e){return eo._fromParams({providerId:Br.PROVIDER_ID,signInMethod:Br.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Br.credentialFromTaggedObject(e)}static credentialFromError(e){return Br.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Br.credential(e.oauthAccessToken)}catch{return null}}}Br.GITHUB_SIGN_IN_METHOD="github.com";Br.PROVIDER_ID="github.com";class Fr extends Zu{constructor(){super("twitter.com")}static credential(e,t){return eo._fromParams({providerId:Fr.PROVIDER_ID,signInMethod:Fr.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}static credentialFromResult(e){return Fr.credentialFromTaggedObject(e)}static credentialFromError(e){return Fr.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:t,oauthTokenSecret:i}=e;if(!t||!i)return null;try{return Fr.credential(t,i)}catch{return null}}}Fr.TWITTER_SIGN_IN_METHOD="twitter.com";Fr.PROVIDER_ID="twitter.com";async function nj(s,e){return Ju(s,"POST","/v1/accounts:signUp",Ws(s,e))}class to{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,i,a=!1){const l=await Ai._fromIdTokenResponse(e,i,a),c=mE(i);return new to({user:l,providerId:c,_tokenResponse:i,operationType:t})}static async _forOperation(e,t,i){await e._updateTokensIfNecessary(i,!0);const a=mE(i);return new to({user:e,providerId:a,_tokenResponse:i,operationType:t})}}function mE(s){return s.providerId?s.providerId:"phoneNumber"in s?"phone":null}class Cf extends ds{constructor(e,t,i,a){super(t.code,t.message),this.operationType=i,this.user=a,Object.setPrototypeOf(this,Cf.prototype),this.customData={appName:e.name,tenantId:e.tenantId??void 0,_serverResponse:t.customData._serverResponse,operationType:i}}static _fromErrorAndOperation(e,t,i,a){return new Cf(e,t,i,a)}}function aS(s,e,t,i){return(e==="reauthenticate"?t._getReauthenticationResolver(s):t._getIdTokenResponse(s)).catch(l=>{throw l.code==="auth/multi-factor-auth-required"?Cf._fromErrorAndOperation(s,l,e,i):l})}async function ij(s,e,t=!1){const i=await Sl(s,e._linkToIdToken(s.auth,await s.getIdToken()),t);return to._forOperation(s,"link",i)}async function sj(s,e,t=!1){const{auth:i}=s;if(Fn(i.app))return Promise.reject(Bs(i));const a="reauthenticate";try{const l=await Sl(s,aS(i,a,e,s),t);Re(l.idToken,i,"internal-error");const c=Wy(l.idToken);Re(c,i,"internal-error");const{sub:f}=c;return Re(s.uid===f,i,"user-mismatch"),to._forOperation(s,a,l)}catch(l){throw l?.code==="auth/user-not-found"&&Di(i,"user-mismatch"),l}}async function oS(s,e,t=!1){if(Fn(s.app))return Promise.reject(Bs(s));const i="signIn",a=await aS(s,i,e),l=await to._fromIdTokenResponse(s,i,a);return t||await s._updateCurrentUser(l.user),l}async function rj(s,e){return oS(ia(s),e)}async function lS(s){const e=ia(s);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}async function aj(s,e,t){const i=ia(s);await If(i,{requestType:"PASSWORD_RESET",email:e,clientType:"CLIENT_TYPE_WEB"},"getOobCode",YN)}async function oj(s,e,t){if(Fn(s.app))return Promise.reject(Bs(s));const i=ia(s),c=await If(i,{returnSecureToken:!0,email:e,password:t,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",nj).catch(p=>{throw p.code==="auth/password-does-not-meet-requirements"&&lS(s),p}),f=await to._fromIdTokenResponse(i,"signIn",c);return await i._updateCurrentUser(f.user),f}function lj(s,e,t){return Fn(s.app)?Promise.reject(Bs(s)):rj(At(s),$l.credential(e,t)).catch(async i=>{throw i.code==="auth/password-does-not-meet-requirements"&&lS(s),i})}async function cj(s,e){return fs(s,"POST","/v1/accounts:update",e)}async function uj(s,{displayName:e,photoURL:t}){if(e===void 0&&t===void 0)return;const i=At(s),l={idToken:await i.getIdToken(),displayName:e,photoUrl:t,returnSecureToken:!0},c=await Sl(i,cj(i.auth,l));i.displayName=c.displayName||null,i.photoURL=c.photoUrl||null;const f=i.providerData.find(({providerId:p})=>p==="password");f&&(f.displayName=i.displayName,f.photoURL=i.photoURL),await i._updateTokensIfNecessary(c)}function hj(s,e,t,i){return At(s).onIdTokenChanged(e,t,i)}function dj(s,e,t){return At(s).beforeAuthStateChanged(e,t)}function fj(s,e,t,i){return At(s).onAuthStateChanged(e,t,i)}function mj(s){return At(s).signOut()}const Rf="__sak";class cS{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(Rf,"1"),this.storage.removeItem(Rf),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){const t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}const pj=1e3,gj=10;class uS extends cS{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,t)=>this.onStorageEvent(e,t),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=eS(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const t of Object.keys(this.listeners)){const i=this.storage.getItem(t),a=this.localCache[t];i!==a&&e(t,a,i)}}onStorageEvent(e,t=!1){if(!e.key){this.forAllChangedKeys((c,f,p)=>{this.notifyListeners(c,p)});return}const i=e.key;t?this.detachListener():this.stopPolling();const a=()=>{const c=this.storage.getItem(i);!t&&this.localCache[i]===c||this.notifyListeners(i,c)},l=this.storage.getItem(i);CN()&&l!==e.newValue&&e.newValue!==e.oldValue?setTimeout(a,gj):a()}notifyListeners(e,t){this.localCache[e]=t;const i=this.listeners[e];if(i)for(const a of Array.from(i))a(t&&JSON.parse(t))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,t,i)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:t,newValue:i}),!0)})},pj)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,t){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,t){await super._set(e,t),this.localCache[e]=JSON.stringify(t)}async _get(e){const t=await super._get(e);return this.localCache[e]=JSON.stringify(t),t}async _remove(e){await super._remove(e),delete this.localCache[e]}}uS.type="LOCAL";const yj=uS;class hS extends cS{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,t){}_removeListener(e,t){}}hS.type="SESSION";const dS=hS;function vj(s){return Promise.all(s.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(t){return{fulfilled:!1,reason:t}}}))}class sm{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const t=this.receivers.find(a=>a.isListeningto(e));if(t)return t;const i=new sm(e);return this.receivers.push(i),i}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const t=e,{eventId:i,eventType:a,data:l}=t.data,c=this.handlersMap[a];if(!c?.size)return;t.ports[0].postMessage({status:"ack",eventId:i,eventType:a});const f=Array.from(c).map(async y=>y(t.origin,l)),p=await vj(f);t.ports[0].postMessage({status:"done",eventId:i,eventType:a,response:p})}_subscribe(e,t){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),(!t||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}sm.receivers=[];function Zy(s="",e=10){let t="";for(let i=0;i<e;i++)t+=Math.floor(Math.random()*10);return s+t}class _j{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t,i=50){const a=typeof MessageChannel<"u"?new MessageChannel:null;if(!a)throw new Error("connection_unavailable");let l,c;return new Promise((f,p)=>{const y=Zy("",20);a.port1.start();const v=setTimeout(()=>{p(new Error("unsupported_event"))},i);c={messageChannel:a,onMessage(b){const x=b;if(x.data.eventId===y)switch(x.data.status){case"ack":clearTimeout(v),l=setTimeout(()=>{p(new Error("timeout"))},3e3);break;case"done":clearTimeout(l),f(x.data.response);break;default:clearTimeout(v),clearTimeout(l),p(new Error("invalid_response"));break}}},this.handlers.add(c),a.port1.addEventListener("message",c.onMessage),this.target.postMessage({eventType:e,eventId:y,data:t},[a.port2])}).finally(()=>{c&&this.removeMessageHandler(c)})}}function ls(){return window}function bj(s){ls().location.href=s}function fS(){return typeof ls().WorkerGlobalScope<"u"&&typeof ls().importScripts=="function"}async function Tj(){if(!navigator?.serviceWorker)return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function Ej(){return navigator?.serviceWorker?.controller||null}function xj(){return fS()?self:null}const mS="firebaseLocalStorageDb",Sj=1,Df="firebaseLocalStorage",pS="fbase_key";class eh{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}}function rm(s,e){return s.transaction([Df],e?"readwrite":"readonly").objectStore(Df)}function wj(){const s=indexedDB.deleteDatabase(mS);return new eh(s).toPromise()}function uy(){const s=indexedDB.open(mS,Sj);return new Promise((e,t)=>{s.addEventListener("error",()=>{t(s.error)}),s.addEventListener("upgradeneeded",()=>{const i=s.result;try{i.createObjectStore(Df,{keyPath:pS})}catch(a){t(a)}}),s.addEventListener("success",async()=>{const i=s.result;i.objectStoreNames.contains(Df)?e(i):(i.close(),await wj(),e(await uy()))})})}async function pE(s,e,t){const i=rm(s,!0).put({[pS]:e,value:t});return new eh(i).toPromise()}async function Aj(s,e){const t=rm(s,!1).get(e),i=await new eh(t).toPromise();return i===void 0?null:i.value}function gE(s,e){const t=rm(s,!0).delete(e);return new eh(t).toPromise()}const Ij=800,Cj=3;class gS{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await uy(),this.db)}async _withRetries(e){let t=0;for(;;)try{const i=await this._openDb();return await e(i)}catch(i){if(t++>Cj)throw i;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return fS()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=sm._getInstance(xj()),this.receiver._subscribe("keyChanged",async(e,t)=>({keyProcessed:(await this._poll()).includes(t.key)})),this.receiver._subscribe("ping",async(e,t)=>["keyChanged"])}async initializeSender(){if(this.activeServiceWorker=await Tj(),!this.activeServiceWorker)return;this.sender=new _j(this.activeServiceWorker);const e=await this.sender._send("ping",{},800);e&&e[0]?.fulfilled&&e[0]?.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||Ej()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await uy();return await pE(e,Rf,"1"),await gE(e,Rf),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,t){return this._withPendingWrite(async()=>(await this._withRetries(i=>pE(i,e,t)),this.localCache[e]=t,this.notifyServiceWorker(e)))}async _get(e){const t=await this._withRetries(i=>Aj(i,e));return this.localCache[e]=t,t}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(t=>gE(t,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(a=>{const l=rm(a,!1).getAll();return new eh(l).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const t=[],i=new Set;if(e.length!==0)for(const{fbase_key:a,value:l}of e)i.add(a),JSON.stringify(this.localCache[a])!==JSON.stringify(l)&&(this.notifyListeners(a,l),t.push(a));for(const a of Object.keys(this.localCache))this.localCache[a]&&!i.has(a)&&(this.notifyListeners(a,null),t.push(a));return t}notifyListeners(e,t){this.localCache[e]=t;const i=this.listeners[e];if(i)for(const a of Array.from(i))a(t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),Ij)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,t){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}gS.type="LOCAL";const Rj=gS;new Xu(3e4,6e4);function Dj(s,e){return e?Us(e):(Re(s._popupRedirectResolver,s,"argument-error"),s._popupRedirectResolver)}class ev extends Xy{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return bl(e,this._buildIdpRequest())}_linkToIdToken(e,t){return bl(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return bl(e,this._buildIdpRequest())}_buildIdpRequest(e){const t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function Nj(s){return oS(s.auth,new ev(s),s.bypassAuthState)}function jj(s){const{auth:e,user:t}=s;return Re(t,e,"internal-error"),sj(t,new ev(s),s.bypassAuthState)}async function kj(s){const{auth:e,user:t}=s;return Re(t,e,"internal-error"),ij(t,new ev(s),s.bypassAuthState)}class yS{constructor(e,t,i,a,l=!1){this.auth=e,this.resolver=i,this.user=a,this.bypassAuthState=l,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise(async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(i){this.reject(i)}})}async onAuthEvent(e){const{urlResponse:t,sessionId:i,postBody:a,tenantId:l,error:c,type:f}=e;if(c){this.reject(c);return}const p={auth:this.auth,requestUri:t,sessionId:i,tenantId:l||void 0,postBody:a||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(f)(p))}catch(y){this.reject(y)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return Nj;case"linkViaPopup":case"linkViaRedirect":return kj;case"reauthViaPopup":case"reauthViaRedirect":return jj;default:Di(this.auth,"internal-error")}}resolve(e){Qs(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){Qs(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}const Oj=new Xu(2e3,1e4);class gl extends yS{constructor(e,t,i,a,l){super(e,t,a,l),this.provider=i,this.authWindow=null,this.pollId=null,gl.currentPopupAction&&gl.currentPopupAction.cancel(),gl.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return Re(e,this.auth,"internal-error"),e}async onExecution(){Qs(this.filter.length===1,"Popup operations only handle one event");const e=Zy();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(t=>{this.reject(t)}),this.resolver._isIframeWebStorageSupported(this.auth,t=>{t||this.reject(os(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){return this.authWindow?.associatedEvent||null}cancel(){this.reject(os(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,gl.currentPopupAction=null}pollUserCancellation(){const e=()=>{if(this.authWindow?.window?.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(os(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,Oj.get())};e()}}gl.currentPopupAction=null;const Vj="pendingRedirect",of=new Map;class Mj extends yS{constructor(e,t,i=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,i),this.eventId=null}async execute(){let e=of.get(this.auth._key());if(!e){try{const i=await Pj(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(i)}catch(t){e=()=>Promise.reject(t)}of.set(this.auth._key(),e)}return this.bypassAuthState||of.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function Pj(s,e){const t=zj(e),i=Uj(s);if(!await i._isAvailable())return!1;const a=await i._get(t)==="true";return await i._remove(t),a}function Lj(s,e){of.set(s._key(),e)}function Uj(s){return Us(s._redirectPersistence)}function zj(s){return af(Vj,s.config.apiKey,s.name)}async function Bj(s,e,t=!1){if(Fn(s.app))return Promise.reject(Bs(s));const i=ia(s),a=Dj(i,e),c=await new Mj(i,a,t).execute();return c&&!t&&(delete c.user._redirectEventId,await i._persistUserIfCurrent(c.user),await i._setRedirectUser(null,e)),c}const Fj=600*1e3;class qj{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(i=>{this.isEventForConsumer(e,i)&&(t=!0,this.sendToConsumer(e,i),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!Hj(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){if(e.error&&!vS(e)){const i=e.error.code?.split("auth/")[1]||"internal-error";t.onError(os(this.auth,i))}else t.onAuthEvent(e)}isEventForConsumer(e,t){const i=t.eventId===null||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&i}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=Fj&&this.cachedEventUids.clear(),this.cachedEventUids.has(yE(e))}saveEventToCache(e){this.cachedEventUids.add(yE(e)),this.lastProcessedEventTime=Date.now()}}function yE(s){return[s.type,s.eventId,s.sessionId,s.tenantId].filter(e=>e).join("-")}function vS({type:s,error:e}){return s==="unknown"&&e?.code==="auth/no-auth-event"}function Hj(s){switch(s.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return vS(s);default:return!1}}async function Gj(s,e={}){return fs(s,"GET","/v1/projects",e)}const Qj=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,Kj=/^https?/;async function $j(s){if(s.config.emulator)return;const{authorizedDomains:e}=await Gj(s);for(const t of e)try{if(Wj(t))return}catch{}Di(s,"unauthorized-domain")}function Wj(s){const e=ly(),{protocol:t,hostname:i}=new URL(e);if(s.startsWith("chrome-extension://")){const c=new URL(s);return c.hostname===""&&i===""?t==="chrome-extension:"&&s.replace("chrome-extension://","")===e.replace("chrome-extension://",""):t==="chrome-extension:"&&c.hostname===i}if(!Kj.test(t))return!1;if(Qj.test(s))return i===s;const a=s.replace(/\./g,"\\.");return new RegExp("^(.+\\."+a+"|"+a+")$","i").test(i)}const Yj=new Xu(3e4,6e4);function vE(){const s=ls().___jsl;if(s?.H){for(const e of Object.keys(s.H))if(s.H[e].r=s.H[e].r||[],s.H[e].L=s.H[e].L||[],s.H[e].r=[...s.H[e].L],s.CP)for(let t=0;t<s.CP.length;t++)s.CP[t]=null}}function Xj(s){return new Promise((e,t)=>{function i(){vE(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{vE(),t(os(s,"network-request-failed"))},timeout:Yj.get()})}if(ls().gapi?.iframes?.Iframe)e(gapi.iframes.getContext());else if(ls().gapi?.load)i();else{const a=PN("iframefcb");return ls()[a]=()=>{gapi.load?i():t(os(s,"network-request-failed"))},nS(`${MN()}?onload=${a}`).catch(l=>t(l))}}).catch(e=>{throw lf=null,e})}let lf=null;function Jj(s){return lf=lf||Xj(s),lf}const Zj=new Xu(5e3,15e3),ek="__/auth/iframe",tk="emulator/auth/iframe",nk={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},ik=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function sk(s){const e=s.config;Re(e.authDomain,s,"auth-domain-config-required");const t=e.emulator?$y(e,tk):`https://${s.config.authDomain}/${ek}`,i={apiKey:e.apiKey,appName:s.name,v:ho},a=ik.get(s.config.apiHost);a&&(i.eid=a);const l=s._getFrameworks();return l.length&&(i.fw=l.join(",")),`${t}?${Yu(i).slice(1)}`}async function rk(s){const e=await Jj(s),t=ls().gapi;return Re(t,s,"internal-error"),e.open({where:document.body,url:sk(s),messageHandlersFilter:t.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:nk,dontclear:!0},i=>new Promise(async(a,l)=>{await i.restyle({setHideOnLeave:!1});const c=os(s,"network-request-failed"),f=ls().setTimeout(()=>{l(c)},Zj.get());function p(){ls().clearTimeout(f),a(i)}i.ping(p).then(p,()=>{l(c)})}))}const ak={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},ok=500,lk=600,ck="_blank",uk="http://localhost";class _E{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function hk(s,e,t,i=ok,a=lk){const l=Math.max((window.screen.availHeight-a)/2,0).toString(),c=Math.max((window.screen.availWidth-i)/2,0).toString();let f="";const p={...ak,width:i.toString(),height:a.toString(),top:l,left:c},y=Qt().toLowerCase();t&&(f=W1(y)?ck:t),K1(y)&&(e=e||uk,p.scrollbars="yes");const v=Object.entries(p).reduce((x,[k,O])=>`${x}${k}=${O},`,"");if(IN(y)&&f!=="_self")return dk(e||"",f),new _E(null);const b=window.open(e||"",f,v);Re(b,s,"popup-blocked");try{b.focus()}catch{}return new _E(b)}function dk(s,e){const t=document.createElement("a");t.href=s,t.target=e;const i=document.createEvent("MouseEvent");i.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),t.dispatchEvent(i)}const fk="__/auth/handler",mk="emulator/auth/handler",pk=encodeURIComponent("fac");async function bE(s,e,t,i,a,l){Re(s.config.authDomain,s,"auth-domain-config-required"),Re(s.config.apiKey,s,"invalid-api-key");const c={apiKey:s.config.apiKey,appName:s.name,authType:t,redirectUrl:i,v:ho,eventId:a};if(e instanceof rS){e.setDefaultLanguage(s.languageCode),c.providerId=e.providerId||"",WR(e.getCustomParameters())||(c.customParameters=JSON.stringify(e.getCustomParameters()));for(const[v,b]of Object.entries({}))c[v]=b}if(e instanceof Zu){const v=e.getScopes().filter(b=>b!=="");v.length>0&&(c.scopes=v.join(","))}s.tenantId&&(c.tid=s.tenantId);const f=c;for(const v of Object.keys(f))f[v]===void 0&&delete f[v];const p=await s._getAppCheckToken(),y=p?`#${pk}=${encodeURIComponent(p)}`:"";return`${gk(s)}?${Yu(f).slice(1)}${y}`}function gk({config:s}){return s.emulator?$y(s,mk):`https://${s.authDomain}/${fk}`}const Bg="webStorageSupport";class yk{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=dS,this._completeRedirectFn=Bj,this._overrideRedirectResult=Lj}async _openPopup(e,t,i,a){Qs(this.eventManagers[e._key()]?.manager,"_initialize() not called before _openPopup()");const l=await bE(e,t,i,ly(),a);return hk(e,l,Zy())}async _openRedirect(e,t,i,a){await this._originValidation(e);const l=await bE(e,t,i,ly(),a);return bj(l),new Promise(()=>{})}_initialize(e){const t=e._key();if(this.eventManagers[t]){const{manager:a,promise:l}=this.eventManagers[t];return a?Promise.resolve(a):(Qs(l,"If manager is not set, promise should be"),l)}const i=this.initAndGetManager(e);return this.eventManagers[t]={promise:i},i.catch(()=>{delete this.eventManagers[t]}),i}async initAndGetManager(e){const t=await rk(e),i=new qj(e);return t.register("authEvent",a=>(Re(a?.authEvent,e,"invalid-auth-event"),{status:i.onEvent(a.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:i},this.iframes[e._key()]=t,i}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(Bg,{type:Bg},a=>{const l=a?.[0]?.[Bg];l!==void 0&&t(!!l),Di(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=$j(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return eS()||$1()||Yy()}}const vk=yk;var TE="@firebase/auth",EE="1.12.0";class _k{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){return this.assertAuthConfigured(),this.auth.currentUser?.uid||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const t=this.auth.onIdTokenChanged(i=>{e(i?.stsTokenManager.accessToken||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){Re(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}function bk(s){switch(s){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function Tk(s){Za(new Jr("auth",(e,{options:t})=>{const i=e.getProvider("app").getImmediate(),a=e.getProvider("heartbeat"),l=e.getProvider("app-check-internal"),{apiKey:c,authDomain:f}=i.options;Re(c&&!c.includes(":"),"invalid-api-key",{appName:i.name});const p={apiKey:c,authDomain:f,clientPlatform:s,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:tS(s)},y=new kN(i,a,l,p);return qN(y,t),y},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,i)=>{e.getProvider("auth-internal").initialize()})),Za(new Jr("auth-internal",e=>{const t=ia(e.getProvider("auth").getImmediate());return(i=>new _k(i))(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),as(TE,EE,bk(s)),as(TE,EE,"esm2020")}const Ek=300,xk=I1("authIdTokenMaxAge")||Ek;let xE=null;const Sk=s=>async e=>{const t=e&&await e.getIdTokenResult(),i=t&&(new Date().getTime()-Date.parse(t.issuedAtTime))/1e3;if(i&&i>xk)return;const a=t?.token;xE!==a&&(xE=a,await fetch(s,{method:a?"POST":"DELETE",headers:a?{Authorization:`Bearer ${a}`}:{}}))};function wk(s=M1()){const e=nm(s,"auth");if(e.isInitialized())return e.getImmediate();const t=FN(s,{popupRedirectResolver:vk,persistence:[Rj,yj,dS]}),i=I1("authTokenSyncURL");if(i&&typeof isSecureContext=="boolean"&&isSecureContext){const l=new URL(i,location.origin);if(location.origin===l.origin){const c=Sk(l.toString());dj(t,c,()=>c(t.currentUser)),hj(t,f=>c(f))}}const a=w1("auth");return a&&HN(t,`http://${a}`),t}function Ak(){return document.getElementsByTagName("head")?.[0]??document}ON({loadJS(s){return new Promise((e,t)=>{const i=document.createElement("script");i.setAttribute("src",s),i.onload=e,i.onerror=a=>{const l=os("internal-error");l.customData=a,t(l)},i.type="text/javascript",i.charset="UTF-8",Ak().appendChild(i)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});Tk("Browser");var Ik="firebase",Ck="12.9.0";as(Ik,Ck,"app");var SE=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};var $r,_S;(function(){var s;function e(w,C){function A(){}A.prototype=C.prototype,w.F=C.prototype,w.prototype=new A,w.prototype.constructor=w,w.D=function(R,j,L){for(var V=Array(arguments.length-2),we=2;we<arguments.length;we++)V[we-2]=arguments[we];return C.prototype[j].apply(R,V)}}function t(){this.blockSize=-1}function i(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.C=Array(this.blockSize),this.o=this.h=0,this.u()}e(i,t),i.prototype.u=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function a(w,C,A){A||(A=0);const R=Array(16);if(typeof C=="string")for(var j=0;j<16;++j)R[j]=C.charCodeAt(A++)|C.charCodeAt(A++)<<8|C.charCodeAt(A++)<<16|C.charCodeAt(A++)<<24;else for(j=0;j<16;++j)R[j]=C[A++]|C[A++]<<8|C[A++]<<16|C[A++]<<24;C=w.g[0],A=w.g[1],j=w.g[2];let L=w.g[3],V;V=C+(L^A&(j^L))+R[0]+3614090360&4294967295,C=A+(V<<7&4294967295|V>>>25),V=L+(j^C&(A^j))+R[1]+3905402710&4294967295,L=C+(V<<12&4294967295|V>>>20),V=j+(A^L&(C^A))+R[2]+606105819&4294967295,j=L+(V<<17&4294967295|V>>>15),V=A+(C^j&(L^C))+R[3]+3250441966&4294967295,A=j+(V<<22&4294967295|V>>>10),V=C+(L^A&(j^L))+R[4]+4118548399&4294967295,C=A+(V<<7&4294967295|V>>>25),V=L+(j^C&(A^j))+R[5]+1200080426&4294967295,L=C+(V<<12&4294967295|V>>>20),V=j+(A^L&(C^A))+R[6]+2821735955&4294967295,j=L+(V<<17&4294967295|V>>>15),V=A+(C^j&(L^C))+R[7]+4249261313&4294967295,A=j+(V<<22&4294967295|V>>>10),V=C+(L^A&(j^L))+R[8]+1770035416&4294967295,C=A+(V<<7&4294967295|V>>>25),V=L+(j^C&(A^j))+R[9]+2336552879&4294967295,L=C+(V<<12&4294967295|V>>>20),V=j+(A^L&(C^A))+R[10]+4294925233&4294967295,j=L+(V<<17&4294967295|V>>>15),V=A+(C^j&(L^C))+R[11]+2304563134&4294967295,A=j+(V<<22&4294967295|V>>>10),V=C+(L^A&(j^L))+R[12]+1804603682&4294967295,C=A+(V<<7&4294967295|V>>>25),V=L+(j^C&(A^j))+R[13]+4254626195&4294967295,L=C+(V<<12&4294967295|V>>>20),V=j+(A^L&(C^A))+R[14]+2792965006&4294967295,j=L+(V<<17&4294967295|V>>>15),V=A+(C^j&(L^C))+R[15]+1236535329&4294967295,A=j+(V<<22&4294967295|V>>>10),V=C+(j^L&(A^j))+R[1]+4129170786&4294967295,C=A+(V<<5&4294967295|V>>>27),V=L+(A^j&(C^A))+R[6]+3225465664&4294967295,L=C+(V<<9&4294967295|V>>>23),V=j+(C^A&(L^C))+R[11]+643717713&4294967295,j=L+(V<<14&4294967295|V>>>18),V=A+(L^C&(j^L))+R[0]+3921069994&4294967295,A=j+(V<<20&4294967295|V>>>12),V=C+(j^L&(A^j))+R[5]+3593408605&4294967295,C=A+(V<<5&4294967295|V>>>27),V=L+(A^j&(C^A))+R[10]+38016083&4294967295,L=C+(V<<9&4294967295|V>>>23),V=j+(C^A&(L^C))+R[15]+3634488961&4294967295,j=L+(V<<14&4294967295|V>>>18),V=A+(L^C&(j^L))+R[4]+3889429448&4294967295,A=j+(V<<20&4294967295|V>>>12),V=C+(j^L&(A^j))+R[9]+568446438&4294967295,C=A+(V<<5&4294967295|V>>>27),V=L+(A^j&(C^A))+R[14]+3275163606&4294967295,L=C+(V<<9&4294967295|V>>>23),V=j+(C^A&(L^C))+R[3]+4107603335&4294967295,j=L+(V<<14&4294967295|V>>>18),V=A+(L^C&(j^L))+R[8]+1163531501&4294967295,A=j+(V<<20&4294967295|V>>>12),V=C+(j^L&(A^j))+R[13]+2850285829&4294967295,C=A+(V<<5&4294967295|V>>>27),V=L+(A^j&(C^A))+R[2]+4243563512&4294967295,L=C+(V<<9&4294967295|V>>>23),V=j+(C^A&(L^C))+R[7]+1735328473&4294967295,j=L+(V<<14&4294967295|V>>>18),V=A+(L^C&(j^L))+R[12]+2368359562&4294967295,A=j+(V<<20&4294967295|V>>>12),V=C+(A^j^L)+R[5]+4294588738&4294967295,C=A+(V<<4&4294967295|V>>>28),V=L+(C^A^j)+R[8]+2272392833&4294967295,L=C+(V<<11&4294967295|V>>>21),V=j+(L^C^A)+R[11]+1839030562&4294967295,j=L+(V<<16&4294967295|V>>>16),V=A+(j^L^C)+R[14]+4259657740&4294967295,A=j+(V<<23&4294967295|V>>>9),V=C+(A^j^L)+R[1]+2763975236&4294967295,C=A+(V<<4&4294967295|V>>>28),V=L+(C^A^j)+R[4]+1272893353&4294967295,L=C+(V<<11&4294967295|V>>>21),V=j+(L^C^A)+R[7]+4139469664&4294967295,j=L+(V<<16&4294967295|V>>>16),V=A+(j^L^C)+R[10]+3200236656&4294967295,A=j+(V<<23&4294967295|V>>>9),V=C+(A^j^L)+R[13]+681279174&4294967295,C=A+(V<<4&4294967295|V>>>28),V=L+(C^A^j)+R[0]+3936430074&4294967295,L=C+(V<<11&4294967295|V>>>21),V=j+(L^C^A)+R[3]+3572445317&4294967295,j=L+(V<<16&4294967295|V>>>16),V=A+(j^L^C)+R[6]+76029189&4294967295,A=j+(V<<23&4294967295|V>>>9),V=C+(A^j^L)+R[9]+3654602809&4294967295,C=A+(V<<4&4294967295|V>>>28),V=L+(C^A^j)+R[12]+3873151461&4294967295,L=C+(V<<11&4294967295|V>>>21),V=j+(L^C^A)+R[15]+530742520&4294967295,j=L+(V<<16&4294967295|V>>>16),V=A+(j^L^C)+R[2]+3299628645&4294967295,A=j+(V<<23&4294967295|V>>>9),V=C+(j^(A|~L))+R[0]+4096336452&4294967295,C=A+(V<<6&4294967295|V>>>26),V=L+(A^(C|~j))+R[7]+1126891415&4294967295,L=C+(V<<10&4294967295|V>>>22),V=j+(C^(L|~A))+R[14]+2878612391&4294967295,j=L+(V<<15&4294967295|V>>>17),V=A+(L^(j|~C))+R[5]+4237533241&4294967295,A=j+(V<<21&4294967295|V>>>11),V=C+(j^(A|~L))+R[12]+1700485571&4294967295,C=A+(V<<6&4294967295|V>>>26),V=L+(A^(C|~j))+R[3]+2399980690&4294967295,L=C+(V<<10&4294967295|V>>>22),V=j+(C^(L|~A))+R[10]+4293915773&4294967295,j=L+(V<<15&4294967295|V>>>17),V=A+(L^(j|~C))+R[1]+2240044497&4294967295,A=j+(V<<21&4294967295|V>>>11),V=C+(j^(A|~L))+R[8]+1873313359&4294967295,C=A+(V<<6&4294967295|V>>>26),V=L+(A^(C|~j))+R[15]+4264355552&4294967295,L=C+(V<<10&4294967295|V>>>22),V=j+(C^(L|~A))+R[6]+2734768916&4294967295,j=L+(V<<15&4294967295|V>>>17),V=A+(L^(j|~C))+R[13]+1309151649&4294967295,A=j+(V<<21&4294967295|V>>>11),V=C+(j^(A|~L))+R[4]+4149444226&4294967295,C=A+(V<<6&4294967295|V>>>26),V=L+(A^(C|~j))+R[11]+3174756917&4294967295,L=C+(V<<10&4294967295|V>>>22),V=j+(C^(L|~A))+R[2]+718787259&4294967295,j=L+(V<<15&4294967295|V>>>17),V=A+(L^(j|~C))+R[9]+3951481745&4294967295,w.g[0]=w.g[0]+C&4294967295,w.g[1]=w.g[1]+(j+(V<<21&4294967295|V>>>11))&4294967295,w.g[2]=w.g[2]+j&4294967295,w.g[3]=w.g[3]+L&4294967295}i.prototype.v=function(w,C){C===void 0&&(C=w.length);const A=C-this.blockSize,R=this.C;let j=this.h,L=0;for(;L<C;){if(j==0)for(;L<=A;)a(this,w,L),L+=this.blockSize;if(typeof w=="string"){for(;L<C;)if(R[j++]=w.charCodeAt(L++),j==this.blockSize){a(this,R),j=0;break}}else for(;L<C;)if(R[j++]=w[L++],j==this.blockSize){a(this,R),j=0;break}}this.h=j,this.o+=C},i.prototype.A=function(){var w=Array((this.h<56?this.blockSize:this.blockSize*2)-this.h);w[0]=128;for(var C=1;C<w.length-8;++C)w[C]=0;C=this.o*8;for(var A=w.length-8;A<w.length;++A)w[A]=C&255,C/=256;for(this.v(w),w=Array(16),C=0,A=0;A<4;++A)for(let R=0;R<32;R+=8)w[C++]=this.g[A]>>>R&255;return w};function l(w,C){var A=f;return Object.prototype.hasOwnProperty.call(A,w)?A[w]:A[w]=C(w)}function c(w,C){this.h=C;const A=[];let R=!0;for(let j=w.length-1;j>=0;j--){const L=w[j]|0;R&&L==C||(A[j]=L,R=!1)}this.g=A}var f={};function p(w){return-128<=w&&w<128?l(w,function(C){return new c([C|0],C<0?-1:0)}):new c([w|0],w<0?-1:0)}function y(w){if(isNaN(w)||!isFinite(w))return b;if(w<0)return M(y(-w));const C=[];let A=1;for(let R=0;w>=A;R++)C[R]=w/A|0,A*=4294967296;return new c(C,0)}function v(w,C){if(w.length==0)throw Error("number format error: empty string");if(C=C||10,C<2||36<C)throw Error("radix out of range: "+C);if(w.charAt(0)=="-")return M(v(w.substring(1),C));if(w.indexOf("-")>=0)throw Error('number format error: interior "-" character');const A=y(Math.pow(C,8));let R=b;for(let L=0;L<w.length;L+=8){var j=Math.min(8,w.length-L);const V=parseInt(w.substring(L,L+j),C);j<8?(j=y(Math.pow(C,j)),R=R.j(j).add(y(V))):(R=R.j(A),R=R.add(y(V)))}return R}var b=p(0),x=p(1),k=p(16777216);s=c.prototype,s.m=function(){if(D(this))return-M(this).m();let w=0,C=1;for(let A=0;A<this.g.length;A++){const R=this.i(A);w+=(R>=0?R:4294967296+R)*C,C*=4294967296}return w},s.toString=function(w){if(w=w||10,w<2||36<w)throw Error("radix out of range: "+w);if(O(this))return"0";if(D(this))return"-"+M(this).toString(w);const C=y(Math.pow(w,6));var A=this;let R="";for(;;){const j=ne(A,C).g;A=Y(A,j.j(C));let L=((A.g.length>0?A.g[0]:A.h)>>>0).toString(w);if(A=j,O(A))return L+R;for(;L.length<6;)L="0"+L;R=L+R}},s.i=function(w){return w<0?0:w<this.g.length?this.g[w]:this.h};function O(w){if(w.h!=0)return!1;for(let C=0;C<w.g.length;C++)if(w.g[C]!=0)return!1;return!0}function D(w){return w.h==-1}s.l=function(w){return w=Y(this,w),D(w)?-1:O(w)?0:1};function M(w){const C=w.g.length,A=[];for(let R=0;R<C;R++)A[R]=~w.g[R];return new c(A,~w.h).add(x)}s.abs=function(){return D(this)?M(this):this},s.add=function(w){const C=Math.max(this.g.length,w.g.length),A=[];let R=0;for(let j=0;j<=C;j++){let L=R+(this.i(j)&65535)+(w.i(j)&65535),V=(L>>>16)+(this.i(j)>>>16)+(w.i(j)>>>16);R=V>>>16,L&=65535,V&=65535,A[j]=V<<16|L}return new c(A,A[A.length-1]&-2147483648?-1:0)};function Y(w,C){return w.add(M(C))}s.j=function(w){if(O(this)||O(w))return b;if(D(this))return D(w)?M(this).j(M(w)):M(M(this).j(w));if(D(w))return M(this.j(M(w)));if(this.l(k)<0&&w.l(k)<0)return y(this.m()*w.m());const C=this.g.length+w.g.length,A=[];for(var R=0;R<2*C;R++)A[R]=0;for(R=0;R<this.g.length;R++)for(let j=0;j<w.g.length;j++){const L=this.i(R)>>>16,V=this.i(R)&65535,we=w.i(j)>>>16,Te=w.i(j)&65535;A[2*R+2*j]+=V*Te,Z(A,2*R+2*j),A[2*R+2*j+1]+=L*Te,Z(A,2*R+2*j+1),A[2*R+2*j+1]+=V*we,Z(A,2*R+2*j+1),A[2*R+2*j+2]+=L*we,Z(A,2*R+2*j+2)}for(w=0;w<C;w++)A[w]=A[2*w+1]<<16|A[2*w];for(w=C;w<2*C;w++)A[w]=0;return new c(A,0)};function Z(w,C){for(;(w[C]&65535)!=w[C];)w[C+1]+=w[C]>>>16,w[C]&=65535,C++}function $(w,C){this.g=w,this.h=C}function ne(w,C){if(O(C))throw Error("division by zero");if(O(w))return new $(b,b);if(D(w))return C=ne(M(w),C),new $(M(C.g),M(C.h));if(D(C))return C=ne(w,M(C)),new $(M(C.g),C.h);if(w.g.length>30){if(D(w)||D(C))throw Error("slowDivide_ only works with positive integers.");for(var A=x,R=C;R.l(w)<=0;)A=ee(A),R=ee(R);var j=se(A,1),L=se(R,1);for(R=se(R,2),A=se(A,2);!O(R);){var V=L.add(R);V.l(w)<=0&&(j=j.add(A),L=V),R=se(R,1),A=se(A,1)}return C=Y(w,j.j(C)),new $(j,C)}for(j=b;w.l(C)>=0;){for(A=Math.max(1,Math.floor(w.m()/C.m())),R=Math.ceil(Math.log(A)/Math.LN2),R=R<=48?1:Math.pow(2,R-48),L=y(A),V=L.j(C);D(V)||V.l(w)>0;)A-=R,L=y(A),V=L.j(C);O(L)&&(L=x),j=j.add(L),w=Y(w,V)}return new $(j,w)}s.B=function(w){return ne(this,w).h},s.and=function(w){const C=Math.max(this.g.length,w.g.length),A=[];for(let R=0;R<C;R++)A[R]=this.i(R)&w.i(R);return new c(A,this.h&w.h)},s.or=function(w){const C=Math.max(this.g.length,w.g.length),A=[];for(let R=0;R<C;R++)A[R]=this.i(R)|w.i(R);return new c(A,this.h|w.h)},s.xor=function(w){const C=Math.max(this.g.length,w.g.length),A=[];for(let R=0;R<C;R++)A[R]=this.i(R)^w.i(R);return new c(A,this.h^w.h)};function ee(w){const C=w.g.length+1,A=[];for(let R=0;R<C;R++)A[R]=w.i(R)<<1|w.i(R-1)>>>31;return new c(A,w.h)}function se(w,C){const A=C>>5;C%=32;const R=w.g.length-A,j=[];for(let L=0;L<R;L++)j[L]=C>0?w.i(L+A)>>>C|w.i(L+A+1)<<32-C:w.i(L+A);return new c(j,w.h)}i.prototype.digest=i.prototype.A,i.prototype.reset=i.prototype.u,i.prototype.update=i.prototype.v,_S=i,c.prototype.add=c.prototype.add,c.prototype.multiply=c.prototype.j,c.prototype.modulo=c.prototype.B,c.prototype.compare=c.prototype.l,c.prototype.toNumber=c.prototype.m,c.prototype.toString=c.prototype.toString,c.prototype.getBits=c.prototype.i,c.fromNumber=y,c.fromString=v,$r=c}).apply(typeof SE<"u"?SE:typeof self<"u"?self:typeof window<"u"?window:{});var qd=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};var bS,mu,TS,cf,hy,ES,xS,SS;(function(){var s,e=Object.defineProperty;function t(h){h=[typeof globalThis=="object"&&globalThis,h,typeof window=="object"&&window,typeof self=="object"&&self,typeof qd=="object"&&qd];for(var _=0;_<h.length;++_){var E=h[_];if(E&&E.Math==Math)return E}throw Error("Cannot find global object")}var i=t(this);function a(h,_){if(_)e:{var E=i;h=h.split(".");for(var I=0;I<h.length-1;I++){var H=h[I];if(!(H in E))break e;E=E[H]}h=h[h.length-1],I=E[h],_=_(I),_!=I&&_!=null&&e(E,h,{configurable:!0,writable:!0,value:_})}}a("Symbol.dispose",function(h){return h||Symbol("Symbol.dispose")}),a("Array.prototype.values",function(h){return h||function(){return this[Symbol.iterator]()}}),a("Object.entries",function(h){return h||function(_){var E=[],I;for(I in _)Object.prototype.hasOwnProperty.call(_,I)&&E.push([I,_[I]]);return E}});var l=l||{},c=this||self;function f(h){var _=typeof h;return _=="object"&&h!=null||_=="function"}function p(h,_,E){return h.call.apply(h.bind,arguments)}function y(h,_,E){return y=p,y.apply(null,arguments)}function v(h,_){var E=Array.prototype.slice.call(arguments,1);return function(){var I=E.slice();return I.push.apply(I,arguments),h.apply(this,I)}}function b(h,_){function E(){}E.prototype=_.prototype,h.Z=_.prototype,h.prototype=new E,h.prototype.constructor=h,h.Ob=function(I,H,X){for(var fe=Array(arguments.length-2),ke=2;ke<arguments.length;ke++)fe[ke-2]=arguments[ke];return _.prototype[H].apply(I,fe)}}var x=typeof AsyncContext<"u"&&typeof AsyncContext.Snapshot=="function"?h=>h&&AsyncContext.Snapshot.wrap(h):h=>h;function k(h){const _=h.length;if(_>0){const E=Array(_);for(let I=0;I<_;I++)E[I]=h[I];return E}return[]}function O(h,_){for(let I=1;I<arguments.length;I++){const H=arguments[I];var E=typeof H;if(E=E!="object"?E:H?Array.isArray(H)?"array":E:"null",E=="array"||E=="object"&&typeof H.length=="number"){E=h.length||0;const X=H.length||0;h.length=E+X;for(let fe=0;fe<X;fe++)h[E+fe]=H[fe]}else h.push(H)}}class D{constructor(_,E){this.i=_,this.j=E,this.h=0,this.g=null}get(){let _;return this.h>0?(this.h--,_=this.g,this.g=_.next,_.next=null):_=this.i(),_}}function M(h){c.setTimeout(()=>{throw h},0)}function Y(){var h=w;let _=null;return h.g&&(_=h.g,h.g=h.g.next,h.g||(h.h=null),_.next=null),_}class Z{constructor(){this.h=this.g=null}add(_,E){const I=$.get();I.set(_,E),this.h?this.h.next=I:this.g=I,this.h=I}}var $=new D(()=>new ne,h=>h.reset());class ne{constructor(){this.next=this.g=this.h=null}set(_,E){this.h=_,this.g=E,this.next=null}reset(){this.next=this.g=this.h=null}}let ee,se=!1,w=new Z,C=()=>{const h=Promise.resolve(void 0);ee=()=>{h.then(A)}};function A(){for(var h;h=Y();){try{h.h.call(h.g)}catch(E){M(E)}var _=$;_.j(h),_.h<100&&(_.h++,h.next=_.g,_.g=h)}se=!1}function R(){this.u=this.u,this.C=this.C}R.prototype.u=!1,R.prototype.dispose=function(){this.u||(this.u=!0,this.N())},R.prototype[Symbol.dispose]=function(){this.dispose()},R.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function j(h,_){this.type=h,this.g=this.target=_,this.defaultPrevented=!1}j.prototype.h=function(){this.defaultPrevented=!0};var L=(function(){if(!c.addEventListener||!Object.defineProperty)return!1;var h=!1,_=Object.defineProperty({},"passive",{get:function(){h=!0}});try{const E=()=>{};c.addEventListener("test",E,_),c.removeEventListener("test",E,_)}catch{}return h})();function V(h){return/^[\s\xa0]*$/.test(h)}function we(h,_){j.call(this,h?h.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,h&&this.init(h,_)}b(we,j),we.prototype.init=function(h,_){const E=this.type=h.type,I=h.changedTouches&&h.changedTouches.length?h.changedTouches[0]:null;this.target=h.target||h.srcElement,this.g=_,_=h.relatedTarget,_||(E=="mouseover"?_=h.fromElement:E=="mouseout"&&(_=h.toElement)),this.relatedTarget=_,I?(this.clientX=I.clientX!==void 0?I.clientX:I.pageX,this.clientY=I.clientY!==void 0?I.clientY:I.pageY,this.screenX=I.screenX||0,this.screenY=I.screenY||0):(this.clientX=h.clientX!==void 0?h.clientX:h.pageX,this.clientY=h.clientY!==void 0?h.clientY:h.pageY,this.screenX=h.screenX||0,this.screenY=h.screenY||0),this.button=h.button,this.key=h.key||"",this.ctrlKey=h.ctrlKey,this.altKey=h.altKey,this.shiftKey=h.shiftKey,this.metaKey=h.metaKey,this.pointerId=h.pointerId||0,this.pointerType=h.pointerType,this.state=h.state,this.i=h,h.defaultPrevented&&we.Z.h.call(this)},we.prototype.h=function(){we.Z.h.call(this);const h=this.i;h.preventDefault?h.preventDefault():h.returnValue=!1};var Te="closure_listenable_"+(Math.random()*1e6|0),G=0;function oe(h,_,E,I,H){this.listener=h,this.proxy=null,this.src=_,this.type=E,this.capture=!!I,this.ha=H,this.key=++G,this.da=this.fa=!1}function pe(h){h.da=!0,h.listener=null,h.proxy=null,h.src=null,h.ha=null}function xe(h,_,E){for(const I in h)_.call(E,h[I],I,h)}function Me(h,_){for(const E in h)_.call(void 0,h[E],E,h)}function U(h){const _={};for(const E in h)_[E]=h[E];return _}const z="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function ue(h,_){let E,I;for(let H=1;H<arguments.length;H++){I=arguments[H];for(E in I)h[E]=I[E];for(let X=0;X<z.length;X++)E=z[X],Object.prototype.hasOwnProperty.call(I,E)&&(h[E]=I[E])}}function re(h){this.src=h,this.g={},this.h=0}re.prototype.add=function(h,_,E,I,H){const X=h.toString();h=this.g[X],h||(h=this.g[X]=[],this.h++);const fe=Ie(h,_,I,H);return fe>-1?(_=h[fe],E||(_.fa=!1)):(_=new oe(_,this.src,X,!!I,H),_.fa=E,h.push(_)),_};function ge(h,_){const E=_.type;if(E in h.g){var I=h.g[E],H=Array.prototype.indexOf.call(I,_,void 0),X;(X=H>=0)&&Array.prototype.splice.call(I,H,1),X&&(pe(_),h.g[E].length==0&&(delete h.g[E],h.h--))}}function Ie(h,_,E,I){for(let H=0;H<h.length;++H){const X=h[H];if(!X.da&&X.listener==_&&X.capture==!!E&&X.ha==I)return H}return-1}var Ne="closure_lm_"+(Math.random()*1e6|0),Qe={};function $e(h,_,E,I,H){if(Array.isArray(_)){for(let X=0;X<_.length;X++)$e(h,_[X],E,I,H);return null}return E=ki(E),h&&h[Te]?h.J(_,E,f(I)?!!I.capture:!1,H):Ni(h,_,E,!1,I,H)}function Ni(h,_,E,I,H,X){if(!_)throw Error("Invalid event type");const fe=f(H)?!!H.capture:!!H;let ke=ys(h);if(ke||(h[Ne]=ke=new re(h)),E=ke.add(_,E,I,fe,X),E.proxy)return E;if(I=ps(),E.proxy=I,I.src=h,I.listener=E,h.addEventListener)L||(H=fe),H===void 0&&(H=!1),h.addEventListener(_.toString(),I,H);else if(h.attachEvent)h.attachEvent(gn(_.toString()),I);else if(h.addListener&&h.removeListener)h.addListener(I);else throw Error("addEventListener and attachEvent are unavailable.");return E}function ps(){function h(E){return _.call(h.src,h.listener,E)}const _=tr;return h}function gs(h,_,E,I,H){if(Array.isArray(_))for(var X=0;X<_.length;X++)gs(h,_[X],E,I,H);else I=f(I)?!!I.capture:!!I,E=ki(E),h&&h[Te]?(h=h.i,X=String(_).toString(),X in h.g&&(_=h.g[X],E=Ie(_,E,I,H),E>-1&&(pe(_[E]),Array.prototype.splice.call(_,E,1),_.length==0&&(delete h.g[X],h.h--)))):h&&(h=ys(h))&&(_=h.g[_.toString()],h=-1,_&&(h=Ie(_,E,I,H)),(E=h>-1?_[h]:null)&&er(E))}function er(h){if(typeof h!="number"&&h&&!h.da){var _=h.src;if(_&&_[Te])ge(_.i,h);else{var E=h.type,I=h.proxy;_.removeEventListener?_.removeEventListener(E,I,h.capture):_.detachEvent?_.detachEvent(gn(E),I):_.addListener&&_.removeListener&&_.removeListener(I),(E=ys(_))?(ge(E,h),E.h==0&&(E.src=null,_[Ne]=null)):pe(h)}}}function gn(h){return h in Qe?Qe[h]:Qe[h]="on"+h}function tr(h,_){if(h.da)h=!0;else{_=new we(_,this);const E=h.listener,I=h.ha||h.src;h.fa&&er(h),h=E.call(I,_)}return h}function ys(h){return h=h[Ne],h instanceof re?h:null}var ji="__closure_events_fn_"+(Math.random()*1e9>>>0);function ki(h){return typeof h=="function"?h:(h[ji]||(h[ji]=function(_){return h.handleEvent(_)}),h[ji])}function He(){R.call(this),this.i=new re(this),this.M=this,this.G=null}b(He,R),He.prototype[Te]=!0,He.prototype.removeEventListener=function(h,_,E,I){gs(this,h,_,E,I)};function mt(h,_){var E,I=h.G;if(I)for(E=[];I;I=I.G)E.push(I);if(h=h.M,I=_.type||_,typeof _=="string")_=new j(_,h);else if(_ instanceof j)_.target=_.target||h;else{var H=_;_=new j(I,h),ue(_,H)}H=!0;let X,fe;if(E)for(fe=E.length-1;fe>=0;fe--)X=_.g=E[fe],H=fi(X,I,!0,_)&&H;if(X=_.g=h,H=fi(X,I,!0,_)&&H,H=fi(X,I,!1,_)&&H,E)for(fe=0;fe<E.length;fe++)X=_.g=E[fe],H=fi(X,I,!1,_)&&H}He.prototype.N=function(){if(He.Z.N.call(this),this.i){var h=this.i;for(const _ in h.g){const E=h.g[_];for(let I=0;I<E.length;I++)pe(E[I]);delete h.g[_],h.h--}}this.G=null},He.prototype.J=function(h,_,E,I){return this.i.add(String(h),_,!1,E,I)},He.prototype.K=function(h,_,E,I){return this.i.add(String(h),_,!0,E,I)};function fi(h,_,E,I){if(_=h.i.g[String(_)],!_)return!0;_=_.concat();let H=!0;for(let X=0;X<_.length;++X){const fe=_[X];if(fe&&!fe.da&&fe.capture==E){const ke=fe.listener,Dt=fe.ha||fe.src;fe.fa&&ge(h.i,fe),H=ke.call(Dt,I)!==!1&&H}}return H&&!I.defaultPrevented}function mo(h,_){if(typeof h!="function")if(h&&typeof h.handleEvent=="function")h=y(h.handleEvent,h);else throw Error("Invalid listener argument");return Number(_)>2147483647?-1:c.setTimeout(h,_||0)}function ua(h){h.g=mo(()=>{h.g=null,h.i&&(h.i=!1,ua(h))},h.l);const _=h.h;h.h=null,h.m.apply(null,_)}class vt extends R{constructor(_,E){super(),this.m=_,this.l=E,this.h=null,this.i=!1,this.g=null}j(_){this.h=arguments,this.g?this.i=!0:ua(this)}N(){super.N(),this.g&&(c.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Wn(h){R.call(this),this.h=h,this.g={}}b(Wn,R);var ha=[];function da(h){xe(h.g,function(_,E){this.g.hasOwnProperty(E)&&er(_)},h),h.g={}}Wn.prototype.N=function(){Wn.Z.N.call(this),da(this)},Wn.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var Oi=c.JSON.stringify,po=c.JSON.parse,go=class{stringify(h){return c.JSON.stringify(h,void 0)}parse(h){return c.JSON.parse(h,void 0)}};function fa(){}function yo(){}var Dn={OPEN:"a",hb:"b",ERROR:"c",tb:"d"};function Ht(){j.call(this,"d")}b(Ht,j);function bn(){j.call(this,"c")}b(bn,j);var de={},Zt=null;function Nn(){return Zt=Zt||new He}de.Ia="serverreachability";function nr(h){j.call(this,de.Ia,h)}b(nr,j);function dt(h){const _=Nn();mt(_,new nr(_))}de.STAT_EVENT="statevent";function vs(h,_){j.call(this,de.STAT_EVENT,h),this.stat=_}b(vs,j);function pt(h){const _=Nn();mt(_,new vs(_,h))}de.Ja="timingevent";function Vi(h,_){j.call(this,de.Ja,h),this.size=_}b(Vi,j);function Mi(h,_){if(typeof h!="function")throw Error("Fn must not be null and must be a function");return c.setTimeout(function(){h()},_)}function mi(){this.g=!0}mi.prototype.ua=function(){this.g=!1};function Dm(h,_,E,I,H,X){h.info(function(){if(h.g)if(X){var fe="",ke=X.split("&");for(let Je=0;Je<ke.length;Je++){var Dt=ke[Je].split("=");if(Dt.length>1){const _t=Dt[0];Dt=Dt[1];const Zn=_t.split("_");fe=Zn.length>=2&&Zn[1]=="type"?fe+(_t+"="+Dt+"&"):fe+(_t+"=redacted&")}}}else fe=null;else fe=X;return"XMLHTTP REQ ("+I+") [attempt "+H+"]: "+_+`
`+E+`
`+fe})}function yh(h,_,E,I,H,X,fe){h.info(function(){return"XMLHTTP RESP ("+I+") [ attempt "+H+"]: "+_+`
`+E+`
`+X+" "+fe})}function Pi(h,_,E,I){h.info(function(){return"XMLHTTP TEXT ("+_+"): "+Nm(h,E)+(I?" "+I:"")})}function ma(h,_){h.info(function(){return"TIMEOUT: "+_})}mi.prototype.info=function(){};function Nm(h,_){if(!h.g)return _;if(!_)return null;try{const X=JSON.parse(_);if(X){for(h=0;h<X.length;h++)if(Array.isArray(X[h])){var E=X[h];if(!(E.length<2)){var I=E[1];if(Array.isArray(I)&&!(I.length<1)){var H=I[0];if(H!="noop"&&H!="stop"&&H!="close")for(let fe=1;fe<I.length;fe++)I[fe]=""}}}}return Oi(X)}catch{return _}}var pa={NO_ERROR:0,cb:1,qb:2,pb:3,kb:4,ob:5,rb:6,Ga:7,TIMEOUT:8,ub:9},sc={ib:"complete",Fb:"success",ERROR:"error",Ga:"abort",xb:"ready",yb:"readystatechange",TIMEOUT:"timeout",sb:"incrementaldata",wb:"progress",lb:"downloadprogress",Nb:"uploadprogress"},rc;function ga(){}b(ga,fa),ga.prototype.g=function(){return new XMLHttpRequest},rc=new ga;function _s(h){return encodeURIComponent(String(h))}function vh(h){var _=1;h=h.split(":");const E=[];for(;_>0&&h.length;)E.push(h.shift()),_--;return h.length&&E.push(h.join(":")),E}function pi(h,_,E,I){this.j=h,this.i=_,this.l=E,this.S=I||1,this.V=new Wn(this),this.H=45e3,this.J=null,this.o=!1,this.u=this.B=this.A=this.M=this.F=this.T=this.D=null,this.G=[],this.g=null,this.C=0,this.m=this.v=null,this.X=-1,this.K=!1,this.P=0,this.O=null,this.W=this.L=this.U=this.R=!1,this.h=new gi}function gi(){this.i=null,this.g="",this.h=!1}var Vt={},$t={};function Li(h,_,E){h.M=1,h.A=ya(Pt(_)),h.u=E,h.R=!0,vo(h,null)}function vo(h,_){h.F=Date.now(),Ui(h),h.B=Pt(h.A);var E=h.B,I=h.S;Array.isArray(I)||(I=[String(I)]),Eo(E.i,"t",I),h.C=0,E=h.j.L,h.h=new gi,h.g=kh(h.j,E?_:null,!h.u),h.P>0&&(h.O=new vt(y(h.Y,h,h.g),h.P)),_=h.V,E=h.g,I=h.ba;var H="readystatechange";Array.isArray(H)||(H&&(ha[0]=H.toString()),H=ha);for(let X=0;X<H.length;X++){const fe=$e(E,H[X],I||_.handleEvent,!1,_.h||_);if(!fe)break;_.g[fe.key]=fe}_=h.J?U(h.J):{},h.u?(h.v||(h.v="POST"),_["Content-Type"]="application/x-www-form-urlencoded",h.g.ea(h.B,h.v,h.u,_)):(h.v="GET",h.g.ea(h.B,h.v,null,_)),dt(),Dm(h.i,h.v,h.B,h.l,h.S,h.u)}pi.prototype.ba=function(h){h=h.target;const _=this.O;_&&_i(h)==3?_.j():this.Y(h)},pi.prototype.Y=function(h){try{if(h==this.g)e:{const ke=_i(this.g),Dt=this.g.ya(),Je=this.g.ca();if(!(ke<3)&&(ke!=3||this.g&&(this.h.h||this.g.la()||en(this.g)))){this.K||ke!=4||Dt==7||(Dt==8||Je<=0?dt(3):dt(2)),zi(this);var _=this.g.ca();this.X=_;var E=jm(this);if(this.o=_==200,yh(this.i,this.v,this.B,this.l,this.S,ke,_),this.o){if(this.U&&!this.L){t:{if(this.g){var I,H=this.g;if((I=H.g?H.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!V(I)){var X=I;break t}}X=null}if(h=X)Pi(this.i,this.l,h,"Initial handshake response via X-HTTP-Initial-Response"),this.L=!0,Bi(this,h);else{this.o=!1,this.m=3,pt(12),jn(this),Yn(this);break e}}if(this.R){h=!0;let _t;for(;!this.K&&this.C<E.length;)if(_t=bh(this,E),_t==$t){ke==4&&(this.m=4,pt(14),h=!1),Pi(this.i,this.l,null,"[Incomplete Response]");break}else if(_t==Vt){this.m=4,pt(15),Pi(this.i,this.l,E,"[Invalid Chunk]"),h=!1;break}else Pi(this.i,this.l,_t,null),Bi(this,_t);if(_h(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),ke!=4||E.length!=0||this.h.h||(this.m=1,pt(16),h=!1),this.o=this.o&&h,!h)Pi(this.i,this.l,E,"[Invalid Chunked Response]"),jn(this),Yn(this);else if(E.length>0&&!this.W){this.W=!0;var fe=this.j;fe.g==this&&fe.aa&&!fe.P&&(fe.j.info("Great, no buffering proxy detected. Bytes received: "+E.length),bc(fe),fe.P=!0,pt(11))}}else Pi(this.i,this.l,E,null),Bi(this,E);ke==4&&jn(this),this.o&&!this.K&&(ke==4?Rh(this.j,this):(this.o=!1,Ui(this)))}else Ts(this.g),_==400&&E.indexOf("Unknown SID")>0?(this.m=3,pt(12)):(this.m=0,pt(13)),jn(this),Yn(this)}}}catch{}};function jm(h){if(!_h(h))return h.g.la();const _=en(h.g);if(_==="")return"";let E="";const I=_.length,H=_i(h.g)==4;if(!h.h.i){if(typeof TextDecoder>"u")return jn(h),Yn(h),"";h.h.i=new c.TextDecoder}for(let X=0;X<I;X++)h.h.h=!0,E+=h.h.i.decode(_[X],{stream:!(H&&X==I-1)});return _.length=0,h.h.g+=E,h.C=0,h.h.g}function _h(h){return h.g?h.v=="GET"&&h.M!=2&&h.j.Aa:!1}function bh(h,_){var E=h.C,I=_.indexOf(`
`,E);return I==-1?$t:(E=Number(_.substring(E,I)),isNaN(E)?Vt:(I+=1,I+E>_.length?$t:(_=_.slice(I,I+E),h.C=I+E,_)))}pi.prototype.cancel=function(){this.K=!0,jn(this)};function Ui(h){h.T=Date.now()+h.H,_o(h,h.H)}function _o(h,_){if(h.D!=null)throw Error("WatchDog timer not null");h.D=Mi(y(h.aa,h),_)}function zi(h){h.D&&(c.clearTimeout(h.D),h.D=null)}pi.prototype.aa=function(){this.D=null;const h=Date.now();h-this.T>=0?(ma(this.i,this.B),this.M!=2&&(dt(),pt(17)),jn(this),this.m=2,Yn(this)):_o(this,this.T-h)};function Yn(h){h.j.I==0||h.K||Rh(h.j,h)}function jn(h){zi(h);var _=h.O;_&&typeof _.dispose=="function"&&_.dispose(),h.O=null,da(h.V),h.g&&(_=h.g,h.g=null,_.abort(),_.dispose())}function Bi(h,_){try{var E=h.j;if(E.I!=0&&(E.g==h||qi(E.h,h))){if(!h.L&&qi(E.h,h)&&E.I==3){try{var I=E.Ba.g.parse(_)}catch{I=null}if(Array.isArray(I)&&I.length==3){var H=I;if(H[0]==0){e:if(!E.v){if(E.g)if(E.g.F+3e3<h.F)Io(E),ur(E);else break e;Sa(E),pt(18)}}else E.xa=H[1],0<E.xa-E.K&&H[2]<37500&&E.F&&E.A==0&&!E.C&&(E.C=Mi(y(E.Va,E),6e3));Fi(E.h)<=1&&E.ta&&(E.ta=void 0)}else Wi(E,11)}else if((h.L||E.g==h)&&Io(E),!V(_))for(H=E.Ba.g.parse(_),_=0;_<H.length;_++){let Je=H[_];const _t=Je[0];if(!(_t<=E.K))if(E.K=_t,Je=Je[1],E.I==2)if(Je[0]=="c"){E.M=Je[1],E.ba=Je[2];const Zn=Je[3];Zn!=null&&(E.ka=Zn,E.j.info("VER="+E.ka));const Yi=Je[4];Yi!=null&&(E.za=Yi,E.j.info("SVER="+E.za));const bi=Je[5];bi!=null&&typeof bi=="number"&&bi>0&&(I=1.5*bi,E.O=I,E.j.info("backChannelRequestTimeoutMs_="+I)),I=E;const Ti=h.g;if(Ti){const wa=Ti.g?Ti.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(wa){var X=I.h;X.g||wa.indexOf("spdy")==-1&&wa.indexOf("quic")==-1&&wa.indexOf("h2")==-1||(X.j=X.l,X.g=new Set,X.h&&(lc(X,X.h),X.h=null))}if(I.G){const Co=Ti.g?Ti.g.getResponseHeader("X-HTTP-Session-Id"):null;Co&&(I.wa=Co,et(I.J,I.G,Co))}}E.I=3,E.l&&E.l.ra(),E.aa&&(E.T=Date.now()-h.F,E.j.info("Handshake RTT: "+E.T+"ms")),I=E;var fe=h;if(I.na=jh(I,I.L?I.ba:null,I.W),fe.L){cc(I.h,fe);var ke=fe,Dt=I.O;Dt&&(ke.H=Dt),ke.D&&(zi(ke),Ui(ke)),I.g=fe}else Ih(I);E.i.length>0&&$i(E)}else Je[0]!="stop"&&Je[0]!="close"||Wi(E,7);else E.I==3&&(Je[0]=="stop"||Je[0]=="close"?Je[0]=="stop"?Wi(E,7):vc(E):Je[0]!="noop"&&E.l&&E.l.qa(Je),E.A=0)}}dt(4)}catch{}}var Mt=class{constructor(h,_){this.g=h,this.map=_}};function ac(h){this.l=h||10,c.PerformanceNavigationTiming?(h=c.performance.getEntriesByType("navigation"),h=h.length>0&&(h[0].nextHopProtocol=="hq"||h[0].nextHopProtocol=="h2")):h=!!(c.chrome&&c.chrome.loadTimes&&c.chrome.loadTimes()&&c.chrome.loadTimes().wasFetchedViaSpdy),this.j=h?this.l:1,this.g=null,this.j>1&&(this.g=new Set),this.h=null,this.i=[]}function oc(h){return h.h?!0:h.g?h.g.size>=h.j:!1}function Fi(h){return h.h?1:h.g?h.g.size:0}function qi(h,_){return h.h?h.h==_:h.g?h.g.has(_):!1}function lc(h,_){h.g?h.g.add(_):h.h=_}function cc(h,_){h.h&&h.h==_?h.h=null:h.g&&h.g.has(_)&&h.g.delete(_)}ac.prototype.cancel=function(){if(this.i=uc(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const h of this.g.values())h.cancel();this.g.clear()}};function uc(h){if(h.h!=null)return h.i.concat(h.h.G);if(h.g!=null&&h.g.size!==0){let _=h.i;for(const E of h.g.values())_=_.concat(E.G);return _}return k(h.i)}var Th=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function bo(h,_){if(h){h=h.split("&");for(let E=0;E<h.length;E++){const I=h[E].indexOf("=");let H,X=null;I>=0?(H=h[E].substring(0,I),X=h[E].substring(I+1)):H=h[E],_(H,X?decodeURIComponent(X.replace(/\+/g," ")):"")}}}function kn(h){this.g=this.o=this.j="",this.u=null,this.m=this.h="",this.l=!1;let _;h instanceof kn?(this.l=h.l,Wt(this,h.j),this.o=h.o,this.g=h.g,ir(this,h.u),this.h=h.h,hc(this,wh(h.i)),this.m=h.m):h&&(_=String(h).match(Th))?(this.l=!1,Wt(this,_[1]||"",!0),this.o=Hi(_[2]||""),this.g=Hi(_[3]||"",!0),ir(this,_[4]),this.h=Hi(_[5]||"",!0),hc(this,_[6]||"",!0),this.m=Hi(_[7]||"")):(this.l=!1,this.i=new rr(null,this.l))}kn.prototype.toString=function(){const h=[];var _=this.j;_&&h.push(va(_,To,!0),":");var E=this.g;return(E||_=="file")&&(h.push("//"),(_=this.o)&&h.push(va(_,To,!0),"@"),h.push(_s(E).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),E=this.u,E!=null&&h.push(":",String(E))),(E=this.h)&&(this.g&&E.charAt(0)!="/"&&h.push("/"),h.push(va(E,E.charAt(0)=="/"?dc:Eh,!0))),(E=this.i.toString())&&h.push("?",E),(E=this.m)&&h.push("#",va(E,xh)),h.join("")},kn.prototype.resolve=function(h){const _=Pt(this);let E=!!h.j;E?Wt(_,h.j):E=!!h.o,E?_.o=h.o:E=!!h.g,E?_.g=h.g:E=h.u!=null;var I=h.h;if(E)ir(_,h.u);else if(E=!!h.h){if(I.charAt(0)!="/")if(this.g&&!this.h)I="/"+I;else{var H=_.h.lastIndexOf("/");H!=-1&&(I=_.h.slice(0,H+1)+I)}if(H=I,H==".."||H==".")I="";else if(H.indexOf("./")!=-1||H.indexOf("/.")!=-1){I=H.lastIndexOf("/",0)==0,H=H.split("/");const X=[];for(let fe=0;fe<H.length;){const ke=H[fe++];ke=="."?I&&fe==H.length&&X.push(""):ke==".."?((X.length>1||X.length==1&&X[0]!="")&&X.pop(),I&&fe==H.length&&X.push("")):(X.push(ke),I=!0)}I=X.join("/")}else I=H}return E?_.h=I:E=h.i.toString()!=="",E?hc(_,wh(h.i)):E=!!h.m,E&&(_.m=h.m),_};function Pt(h){return new kn(h)}function Wt(h,_,E){h.j=E?Hi(_,!0):_,h.j&&(h.j=h.j.replace(/:$/,""))}function ir(h,_){if(_){if(_=Number(_),isNaN(_)||_<0)throw Error("Bad port number "+_);h.u=_}else h.u=null}function hc(h,_,E){_ instanceof rr?(h.i=_,xo(h.i,h.l)):(E||(_=va(_,sr)),h.i=new rr(_,h.l))}function et(h,_,E){h.i.set(_,E)}function ya(h){return et(h,"zx",Math.floor(Math.random()*2147483648).toString(36)+Math.abs(Math.floor(Math.random()*2147483648)^Date.now()).toString(36)),h}function Hi(h,_){return h?_?decodeURI(h.replace(/%25/g,"%2525")):decodeURIComponent(h):""}function va(h,_,E){return typeof h=="string"?(h=encodeURI(h).replace(_,Tn),E&&(h=h.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),h):null}function Tn(h){return h=h.charCodeAt(0),"%"+(h>>4&15).toString(16)+(h&15).toString(16)}var To=/[#\/\?@]/g,Eh=/[#\?:]/g,dc=/[#\?]/g,sr=/[#\?@]/g,xh=/#/g;function rr(h,_){this.h=this.g=null,this.i=h||null,this.j=!!_}function En(h){h.g||(h.g=new Map,h.h=0,h.i&&bo(h.i,function(_,E){h.add(decodeURIComponent(_.replace(/\+/g," ")),E)}))}s=rr.prototype,s.add=function(h,_){En(this),this.i=null,h=ar(this,h);let E=this.g.get(h);return E||this.g.set(h,E=[]),E.push(_),this.h+=1,this};function Sh(h,_){En(h),_=ar(h,_),h.g.has(_)&&(h.i=null,h.h-=h.g.get(_).length,h.g.delete(_))}function fc(h,_){return En(h),_=ar(h,_),h.g.has(_)}s.forEach=function(h,_){En(this),this.g.forEach(function(E,I){E.forEach(function(H){h.call(_,H,I,this)},this)},this)};function mc(h,_){En(h);let E=[];if(typeof _=="string")fc(h,_)&&(E=E.concat(h.g.get(ar(h,_))));else for(h=Array.from(h.g.values()),_=0;_<h.length;_++)E=E.concat(h[_]);return E}s.set=function(h,_){return En(this),this.i=null,h=ar(this,h),fc(this,h)&&(this.h-=this.g.get(h).length),this.g.set(h,[_]),this.h+=1,this},s.get=function(h,_){return h?(h=mc(this,h),h.length>0?String(h[0]):_):_};function Eo(h,_,E){Sh(h,_),E.length>0&&(h.i=null,h.g.set(ar(h,_),k(E)),h.h+=E.length)}s.toString=function(){if(this.i)return this.i;if(!this.g)return"";const h=[],_=Array.from(this.g.keys());for(let I=0;I<_.length;I++){var E=_[I];const H=_s(E);E=mc(this,E);for(let X=0;X<E.length;X++){let fe=H;E[X]!==""&&(fe+="="+_s(E[X])),h.push(fe)}}return this.i=h.join("&")};function wh(h){const _=new rr;return _.i=h.i,h.g&&(_.g=new Map(h.g),_.h=h.h),_}function ar(h,_){return _=String(_),h.j&&(_=_.toLowerCase()),_}function xo(h,_){_&&!h.j&&(En(h),h.i=null,h.g.forEach(function(E,I){const H=I.toLowerCase();I!=H&&(Sh(this,I),Eo(this,H,E))},h)),h.j=_}function yi(h,_){const E=new mi;if(c.Image){const I=new Image;I.onload=v(Xn,E,"TestLoadImage: loaded",!0,_,I),I.onerror=v(Xn,E,"TestLoadImage: error",!1,_,I),I.onabort=v(Xn,E,"TestLoadImage: abort",!1,_,I),I.ontimeout=v(Xn,E,"TestLoadImage: timeout",!1,_,I),c.setTimeout(function(){I.ontimeout&&I.ontimeout()},1e4),I.src=h}else _(!1)}function pc(h,_){const E=new mi,I=new AbortController,H=setTimeout(()=>{I.abort(),Xn(E,"TestPingServer: timeout",!1,_)},1e4);fetch(h,{signal:I.signal}).then(X=>{clearTimeout(H),X.ok?Xn(E,"TestPingServer: ok",!0,_):Xn(E,"TestPingServer: server error",!1,_)}).catch(()=>{clearTimeout(H),Xn(E,"TestPingServer: error",!1,_)})}function Xn(h,_,E,I,H){try{H&&(H.onload=null,H.onerror=null,H.onabort=null,H.ontimeout=null),I(E)}catch{}}function or(){this.g=new go}function Gi(h){this.i=h.Sb||null,this.h=h.ab||!1}b(Gi,fa),Gi.prototype.g=function(){return new _a(this.i,this.h)};function _a(h,_){He.call(this),this.H=h,this.o=_,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.A=new Headers,this.h=null,this.F="GET",this.D="",this.g=!1,this.B=this.j=this.l=null,this.v=new AbortController}b(_a,He),s=_a.prototype,s.open=function(h,_){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.F=h,this.D=_,this.readyState=1,vi(this)},s.send=function(h){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");if(this.v.signal.aborted)throw this.abort(),Error("Request was aborted.");this.g=!0;const _={headers:this.A,method:this.F,credentials:this.m,cache:void 0,signal:this.v.signal};h&&(_.body=h),(this.H||c).fetch(new Request(this.D,_)).then(this.Pa.bind(this),this.ga.bind(this))},s.abort=function(){this.response=this.responseText="",this.A=new Headers,this.status=0,this.v.abort(),this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),this.readyState>=1&&this.g&&this.readyState!=4&&(this.g=!1,lr(this)),this.readyState=0},s.Pa=function(h){if(this.g&&(this.l=h,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=h.headers,this.readyState=2,vi(this)),this.g&&(this.readyState=3,vi(this),this.g)))if(this.responseType==="arraybuffer")h.arrayBuffer().then(this.Na.bind(this),this.ga.bind(this));else if(typeof c.ReadableStream<"u"&&"body"in h){if(this.j=h.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.B=new TextDecoder;So(this)}else h.text().then(this.Oa.bind(this),this.ga.bind(this))};function So(h){h.j.read().then(h.Ma.bind(h)).catch(h.ga.bind(h))}s.Ma=function(h){if(this.g){if(this.o&&h.value)this.response.push(h.value);else if(!this.o){var _=h.value?h.value:new Uint8Array(0);(_=this.B.decode(_,{stream:!h.done}))&&(this.response=this.responseText+=_)}h.done?lr(this):vi(this),this.readyState==3&&So(this)}},s.Oa=function(h){this.g&&(this.response=this.responseText=h,lr(this))},s.Na=function(h){this.g&&(this.response=h,lr(this))},s.ga=function(){this.g&&lr(this)};function lr(h){h.readyState=4,h.l=null,h.j=null,h.B=null,vi(h)}s.setRequestHeader=function(h,_){this.A.append(h,_)},s.getResponseHeader=function(h){return this.h&&this.h.get(h.toLowerCase())||""},s.getAllResponseHeaders=function(){if(!this.h)return"";const h=[],_=this.h.entries();for(var E=_.next();!E.done;)E=E.value,h.push(E[0]+": "+E[1]),E=_.next();return h.join(`\r
`)};function vi(h){h.onreadystatechange&&h.onreadystatechange.call(h)}Object.defineProperty(_a.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(h){this.m=h?"include":"same-origin"}});function Jn(h){let _="";return xe(h,function(E,I){_+=I,_+=":",_+=E,_+=`\r
`}),_}function ba(h,_,E){e:{for(I in E){var I=!1;break e}I=!0}I||(E=Jn(E),typeof h=="string"?E!=null&&_s(E):et(h,_,E))}function at(h){He.call(this),this.headers=new Map,this.L=h||null,this.h=!1,this.g=null,this.D="",this.o=0,this.l="",this.j=this.B=this.v=this.A=!1,this.m=null,this.F="",this.H=!1}b(at,He);var Qi=/^https?$/i,gc=["POST","PUT"];s=at.prototype,s.Fa=function(h){this.H=h},s.ea=function(h,_,E,I){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+h);_=_?_.toUpperCase():"GET",this.D=h,this.l="",this.o=0,this.A=!1,this.h=!0,this.g=this.L?this.L.g():rc.g(),this.g.onreadystatechange=x(y(this.Ca,this));try{this.B=!0,this.g.open(_,String(h),!0),this.B=!1}catch(X){Ta(this,X);return}if(h=E||"",E=new Map(this.headers),I)if(Object.getPrototypeOf(I)===Object.prototype)for(var H in I)E.set(H,I[H]);else if(typeof I.keys=="function"&&typeof I.get=="function")for(const X of I.keys())E.set(X,I.get(X));else throw Error("Unknown input type for opt_headers: "+String(I));I=Array.from(E.keys()).find(X=>X.toLowerCase()=="content-type"),H=c.FormData&&h instanceof c.FormData,!(Array.prototype.indexOf.call(gc,_,void 0)>=0)||I||H||E.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[X,fe]of E)this.g.setRequestHeader(X,fe);this.F&&(this.g.responseType=this.F),"withCredentials"in this.g&&this.g.withCredentials!==this.H&&(this.g.withCredentials=this.H);try{this.m&&(clearTimeout(this.m),this.m=null),this.v=!0,this.g.send(h),this.v=!1}catch(X){Ta(this,X)}};function Ta(h,_){h.h=!1,h.g&&(h.j=!0,h.g.abort(),h.j=!1),h.l=_,h.o=5,yc(h),bs(h)}function yc(h){h.A||(h.A=!0,mt(h,"complete"),mt(h,"error"))}s.abort=function(h){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.o=h||7,mt(this,"complete"),mt(this,"abort"),bs(this))},s.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),bs(this,!0)),at.Z.N.call(this)},s.Ca=function(){this.u||(this.B||this.v||this.j?Ea(this):this.Xa())},s.Xa=function(){Ea(this)};function Ea(h){if(h.h&&typeof l<"u"){if(h.v&&_i(h)==4)setTimeout(h.Ca.bind(h),0);else if(mt(h,"readystatechange"),_i(h)==4){h.h=!1;try{const X=h.ca();e:switch(X){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var _=!0;break e;default:_=!1}var E;if(!(E=_)){var I;if(I=X===0){let fe=String(h.D).match(Th)[1]||null;!fe&&c.self&&c.self.location&&(fe=c.self.location.protocol.slice(0,-1)),I=!Qi.test(fe?fe.toLowerCase():"")}E=I}if(E)mt(h,"complete"),mt(h,"success");else{h.o=6;try{var H=_i(h)>2?h.g.statusText:""}catch{H=""}h.l=H+" ["+h.ca()+"]",yc(h)}}finally{bs(h)}}}}function bs(h,_){if(h.g){h.m&&(clearTimeout(h.m),h.m=null);const E=h.g;h.g=null,_||mt(h,"ready");try{E.onreadystatechange=null}catch{}}}s.isActive=function(){return!!this.g};function _i(h){return h.g?h.g.readyState:0}s.ca=function(){try{return _i(this)>2?this.g.status:-1}catch{return-1}},s.la=function(){try{return this.g?this.g.responseText:""}catch{return""}},s.La=function(h){if(this.g){var _=this.g.responseText;return h&&_.indexOf(h)==0&&(_=_.substring(h.length)),po(_)}};function en(h){try{if(!h.g)return null;if("response"in h.g)return h.g.response;switch(h.F){case"":case"text":return h.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in h.g)return h.g.mozResponseArrayBuffer}return null}catch{return null}}function Ts(h){const _={};h=(h.g&&_i(h)>=2&&h.g.getAllResponseHeaders()||"").split(`\r
`);for(let I=0;I<h.length;I++){if(V(h[I]))continue;var E=vh(h[I]);const H=E[0];if(E=E[1],typeof E!="string")continue;E=E.trim();const X=_[H]||[];_[H]=X,X.push(E)}Me(_,function(I){return I.join(", ")})}s.ya=function(){return this.o},s.Ha=function(){return typeof this.l=="string"?this.l:String(this.l)};function Ki(h,_,E){return E&&E.internalChannelParams&&E.internalChannelParams[h]||_}function cr(h){this.za=0,this.i=[],this.j=new mi,this.ba=this.na=this.J=this.W=this.g=this.wa=this.G=this.H=this.u=this.U=this.o=null,this.Ya=this.V=0,this.Sa=Ki("failFast",!1,h),this.F=this.C=this.v=this.m=this.l=null,this.X=!0,this.xa=this.K=-1,this.Y=this.A=this.D=0,this.Qa=Ki("baseRetryDelayMs",5e3,h),this.Za=Ki("retryDelaySeedMs",1e4,h),this.Ta=Ki("forwardChannelMaxRetries",2,h),this.va=Ki("forwardChannelRequestTimeoutMs",2e4,h),this.ma=h&&h.xmlHttpFactory||void 0,this.Ua=h&&h.Rb||void 0,this.Aa=h&&h.useFetchStreams||!1,this.O=void 0,this.L=h&&h.supportsCrossDomainXhr||!1,this.M="",this.h=new ac(h&&h.concurrentRequestLimit),this.Ba=new or,this.S=h&&h.fastHandshake||!1,this.R=h&&h.encodeInitMessageHeaders||!1,this.S&&this.R&&(this.R=!1),this.Ra=h&&h.Pb||!1,h&&h.ua&&this.j.ua(),h&&h.forceLongPolling&&(this.X=!1),this.aa=!this.S&&this.X&&h&&h.detectBufferingProxy||!1,this.ia=void 0,h&&h.longPollingTimeout&&h.longPollingTimeout>0&&(this.ia=h.longPollingTimeout),this.ta=void 0,this.T=0,this.P=!1,this.ja=this.B=null}s=cr.prototype,s.ka=8,s.I=1,s.connect=function(h,_,E,I){pt(0),this.W=h,this.H=_||{},E&&I!==void 0&&(this.H.OSID=E,this.H.OAID=I),this.F=this.X,this.J=jh(this,null,this.W),$i(this)};function vc(h){if(wo(h),h.I==3){var _=h.V++,E=Pt(h.J);if(et(E,"SID",h.M),et(E,"RID",_),et(E,"TYPE","terminate"),xa(h,E),_=new pi(h,h.j,_),_.M=2,_.A=ya(Pt(E)),E=!1,c.navigator&&c.navigator.sendBeacon)try{E=c.navigator.sendBeacon(_.A.toString(),"")}catch{}!E&&c.Image&&(new Image().src=_.A,E=!0),E||(_.g=kh(_.j,null),_.g.ea(_.A)),_.F=Date.now(),Ui(_)}Nh(h)}function ur(h){h.g&&(bc(h),h.g.cancel(),h.g=null)}function wo(h){ur(h),h.v&&(c.clearTimeout(h.v),h.v=null),Io(h),h.h.cancel(),h.m&&(typeof h.m=="number"&&c.clearTimeout(h.m),h.m=null)}function $i(h){if(!oc(h.h)&&!h.m){h.m=!0;var _=h.Ea;ee||C(),se||(ee(),se=!0),w.add(_,h),h.D=0}}function Ao(h,_){return Fi(h.h)>=h.h.j-(h.m?1:0)?!1:h.m?(h.i=_.G.concat(h.i),!0):h.I==1||h.I==2||h.D>=(h.Sa?0:h.Ta)?!1:(h.m=Mi(y(h.Ea,h,_),Dh(h,h.D)),h.D++,!0)}s.Ea=function(h){if(this.m)if(this.m=null,this.I==1){if(!h){this.V=Math.floor(Math.random()*1e5),h=this.V++;const H=new pi(this,this.j,h);let X=this.o;if(this.U&&(X?(X=U(X),ue(X,this.U)):X=this.U),this.u!==null||this.R||(H.J=X,X=null),this.S)e:{for(var _=0,E=0;E<this.i.length;E++){t:{var I=this.i[E];if("__data__"in I.map&&(I=I.map.__data__,typeof I=="string")){I=I.length;break t}I=void 0}if(I===void 0)break;if(_+=I,_>4096){_=E;break e}if(_===4096||E===this.i.length-1){_=E+1;break e}}_=1e3}else _=1e3;_=Ah(this,H,_),E=Pt(this.J),et(E,"RID",h),et(E,"CVER",22),this.G&&et(E,"X-HTTP-Session-Id",this.G),xa(this,E),X&&(this.R?_="headers="+_s(Jn(X))+"&"+_:this.u&&ba(E,this.u,X)),lc(this.h,H),this.Ra&&et(E,"TYPE","init"),this.S?(et(E,"$req",_),et(E,"SID","null"),H.U=!0,Li(H,E,null)):Li(H,E,_),this.I=2}}else this.I==3&&(h?_c(this,h):this.i.length==0||oc(this.h)||_c(this))};function _c(h,_){var E;_?E=_.l:E=h.V++;const I=Pt(h.J);et(I,"SID",h.M),et(I,"RID",E),et(I,"AID",h.K),xa(h,I),h.u&&h.o&&ba(I,h.u,h.o),E=new pi(h,h.j,E,h.D+1),h.u===null&&(E.J=h.o),_&&(h.i=_.G.concat(h.i)),_=Ah(h,E,1e3),E.H=Math.round(h.va*.5)+Math.round(h.va*.5*Math.random()),lc(h.h,E),Li(E,I,_)}function xa(h,_){h.H&&xe(h.H,function(E,I){et(_,I,E)}),h.l&&xe({},function(E,I){et(_,I,E)})}function Ah(h,_,E){E=Math.min(h.i.length,E);const I=h.l?y(h.l.Ka,h.l,h):null;e:{var H=h.i;let ke=-1;for(;;){const Dt=["count="+E];ke==-1?E>0?(ke=H[0].g,Dt.push("ofs="+ke)):ke=0:Dt.push("ofs="+ke);let Je=!0;for(let _t=0;_t<E;_t++){var X=H[_t].g;const Zn=H[_t].map;if(X-=ke,X<0)ke=Math.max(0,H[_t].g-100),Je=!1;else try{X="req"+X+"_"||"";try{var fe=Zn instanceof Map?Zn:Object.entries(Zn);for(const[Yi,bi]of fe){let Ti=bi;f(bi)&&(Ti=Oi(bi)),Dt.push(X+Yi+"="+encodeURIComponent(Ti))}}catch(Yi){throw Dt.push(X+"type="+encodeURIComponent("_badmap")),Yi}}catch{I&&I(Zn)}}if(Je){fe=Dt.join("&");break e}}fe=void 0}return h=h.i.splice(0,E),_.G=h,fe}function Ih(h){if(!h.g&&!h.v){h.Y=1;var _=h.Da;ee||C(),se||(ee(),se=!0),w.add(_,h),h.A=0}}function Sa(h){return h.g||h.v||h.A>=3?!1:(h.Y++,h.v=Mi(y(h.Da,h),Dh(h,h.A)),h.A++,!0)}s.Da=function(){if(this.v=null,Ch(this),this.aa&&!(this.P||this.g==null||this.T<=0)){var h=4*this.T;this.j.info("BP detection timer enabled: "+h),this.B=Mi(y(this.Wa,this),h)}},s.Wa=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.P=!0,pt(10),ur(this),Ch(this))};function bc(h){h.B!=null&&(c.clearTimeout(h.B),h.B=null)}function Ch(h){h.g=new pi(h,h.j,"rpc",h.Y),h.u===null&&(h.g.J=h.o),h.g.P=0;var _=Pt(h.na);et(_,"RID","rpc"),et(_,"SID",h.M),et(_,"AID",h.K),et(_,"CI",h.F?"0":"1"),!h.F&&h.ia&&et(_,"TO",h.ia),et(_,"TYPE","xmlhttp"),xa(h,_),h.u&&h.o&&ba(_,h.u,h.o),h.O&&(h.g.H=h.O);var E=h.g;h=h.ba,E.M=1,E.A=ya(Pt(_)),E.u=null,E.R=!0,vo(E,h)}s.Va=function(){this.C!=null&&(this.C=null,ur(this),Sa(this),pt(19))};function Io(h){h.C!=null&&(c.clearTimeout(h.C),h.C=null)}function Rh(h,_){var E=null;if(h.g==_){Io(h),bc(h),h.g=null;var I=2}else if(qi(h.h,_))E=_.G,cc(h.h,_),I=1;else return;if(h.I!=0){if(_.o)if(I==1){E=_.u?_.u.length:0,_=Date.now()-_.F;var H=h.D;I=Nn(),mt(I,new Vi(I,E)),$i(h)}else Ih(h);else if(H=_.m,H==3||H==0&&_.X>0||!(I==1&&Ao(h,_)||I==2&&Sa(h)))switch(E&&E.length>0&&(_=h.h,_.i=_.i.concat(E)),H){case 1:Wi(h,5);break;case 4:Wi(h,10);break;case 3:Wi(h,6);break;default:Wi(h,2)}}}function Dh(h,_){let E=h.Qa+Math.floor(Math.random()*h.Za);return h.isActive()||(E*=2),E*_}function Wi(h,_){if(h.j.info("Error code "+_),_==2){var E=y(h.bb,h),I=h.Ua;const H=!I;I=new kn(I||"//www.google.com/images/cleardot.gif"),c.location&&c.location.protocol=="http"||Wt(I,"https"),ya(I),H?yi(I.toString(),E):pc(I.toString(),E)}else pt(2);h.I=0,h.l&&h.l.pa(_),Nh(h),wo(h)}s.bb=function(h){h?(this.j.info("Successfully pinged google.com"),pt(2)):(this.j.info("Failed to ping google.com"),pt(1))};function Nh(h){if(h.I=0,h.ja=[],h.l){const _=uc(h.h);(_.length!=0||h.i.length!=0)&&(O(h.ja,_),O(h.ja,h.i),h.h.i.length=0,k(h.i),h.i.length=0),h.l.oa()}}function jh(h,_,E){var I=E instanceof kn?Pt(E):new kn(E);if(I.g!="")_&&(I.g=_+"."+I.g),ir(I,I.u);else{var H=c.location;I=H.protocol,_=_?_+"."+H.hostname:H.hostname,H=+H.port;const X=new kn(null);I&&Wt(X,I),_&&(X.g=_),H&&ir(X,H),E&&(X.h=E),I=X}return E=h.G,_=h.wa,E&&_&&et(I,E,_),et(I,"VER",h.ka),xa(h,I),I}function kh(h,_,E){if(_&&!h.L)throw Error("Can't create secondary domain capable XhrIo object.");return _=h.Aa&&!h.ma?new at(new Gi({ab:E})):new at(h.ma),_.Fa(h.L),_}s.isActive=function(){return!!this.l&&this.l.isActive(this)};function Oh(){}s=Oh.prototype,s.ra=function(){},s.qa=function(){},s.pa=function(){},s.oa=function(){},s.isActive=function(){return!0},s.Ka=function(){};function hr(){}hr.prototype.g=function(h,_){return new yn(h,_)};function yn(h,_){He.call(this),this.g=new cr(_),this.l=h,this.h=_&&_.messageUrlParams||null,h=_&&_.messageHeaders||null,_&&_.clientProtocolHeaderRequired&&(h?h["X-Client-Protocol"]="webchannel":h={"X-Client-Protocol":"webchannel"}),this.g.o=h,h=_&&_.initMessageHeaders||null,_&&_.messageContentType&&(h?h["X-WebChannel-Content-Type"]=_.messageContentType:h={"X-WebChannel-Content-Type":_.messageContentType}),_&&_.sa&&(h?h["X-WebChannel-Client-Profile"]=_.sa:h={"X-WebChannel-Client-Profile":_.sa}),this.g.U=h,(h=_&&_.Qb)&&!V(h)&&(this.g.u=h),this.A=_&&_.supportsCrossDomainXhr||!1,this.v=_&&_.sendRawJson||!1,(_=_&&_.httpSessionIdParam)&&!V(_)&&(this.g.G=_,h=this.h,h!==null&&_ in h&&(h=this.h,_ in h&&delete h[_])),this.j=new Es(this)}b(yn,He),yn.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.L=!0),this.g.connect(this.l,this.h||void 0)},yn.prototype.close=function(){vc(this.g)},yn.prototype.o=function(h){var _=this.g;if(typeof h=="string"){var E={};E.__data__=h,h=E}else this.v&&(E={},E.__data__=Oi(h),h=E);_.i.push(new Mt(_.Ya++,h)),_.I==3&&$i(_)},yn.prototype.N=function(){this.g.l=null,delete this.j,vc(this.g),delete this.g,yn.Z.N.call(this)};function Vh(h){Ht.call(this),h.__headers__&&(this.headers=h.__headers__,this.statusCode=h.__status__,delete h.__headers__,delete h.__status__);var _=h.__sm__;if(_){e:{for(const E in _){h=E;break e}h=void 0}(this.i=h)&&(h=this.i,_=_!==null&&h in _?_[h]:void 0),this.data=_}else this.data=h}b(Vh,Ht);function Mh(){bn.call(this),this.status=1}b(Mh,bn);function Es(h){this.g=h}b(Es,Oh),Es.prototype.ra=function(){mt(this.g,"a")},Es.prototype.qa=function(h){mt(this.g,new Vh(h))},Es.prototype.pa=function(h){mt(this.g,new Mh)},Es.prototype.oa=function(){mt(this.g,"b")},hr.prototype.createWebChannel=hr.prototype.g,yn.prototype.send=yn.prototype.o,yn.prototype.open=yn.prototype.m,yn.prototype.close=yn.prototype.close,SS=function(){return new hr},xS=function(){return Nn()},ES=de,hy={jb:0,mb:1,nb:2,Hb:3,Mb:4,Jb:5,Kb:6,Ib:7,Gb:8,Lb:9,PROXY:10,NOPROXY:11,Eb:12,Ab:13,Bb:14,zb:15,Cb:16,Db:17,fb:18,eb:19,gb:20},pa.NO_ERROR=0,pa.TIMEOUT=8,pa.HTTP_ERROR=6,cf=pa,sc.COMPLETE="complete",TS=sc,yo.EventType=Dn,Dn.OPEN="a",Dn.CLOSE="b",Dn.ERROR="c",Dn.MESSAGE="d",He.prototype.listen=He.prototype.J,mu=yo,at.prototype.listenOnce=at.prototype.K,at.prototype.getLastError=at.prototype.Ha,at.prototype.getLastErrorCode=at.prototype.ya,at.prototype.getStatus=at.prototype.ca,at.prototype.getResponseJson=at.prototype.La,at.prototype.getResponseText=at.prototype.la,at.prototype.send=at.prototype.ea,at.prototype.setWithCredentials=at.prototype.Fa,bS=at}).apply(typeof qd<"u"?qd:typeof self<"u"?self:typeof window<"u"?window:{});class dn{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}dn.UNAUTHENTICATED=new dn(null),dn.GOOGLE_CREDENTIALS=new dn("google-credentials-uid"),dn.FIRST_PARTY=new dn("first-party-uid"),dn.MOCK_USER=new dn("mock-user");let Wl="12.9.0";function Rk(s){Wl=s}const no=new Gy("@firebase/firestore");function hl(){return no.logLevel}function ce(s,...e){if(no.logLevel<=Fe.DEBUG){const t=e.map(tv);no.debug(`Firestore (${Wl}): ${s}`,...t)}}function kt(s,...e){if(no.logLevel<=Fe.ERROR){const t=e.map(tv);no.error(`Firestore (${Wl}): ${s}`,...t)}}function wl(s,...e){if(no.logLevel<=Fe.WARN){const t=e.map(tv);no.warn(`Firestore (${Wl}): ${s}`,...t)}}function tv(s){if(typeof s=="string")return s;try{return(function(t){return JSON.stringify(t)})(s)}catch{return s}}function ye(s,e,t){let i="Unexpected state";typeof e=="string"?i=e:t=e,wS(s,i,t)}function wS(s,e,t){let i=`FIRESTORE (${Wl}) INTERNAL ASSERTION FAILED: ${e} (ID: ${s.toString(16)})`;if(t!==void 0)try{i+=" CONTEXT: "+JSON.stringify(t)}catch{i+=" CONTEXT: "+t}throw kt(i),new Error(i)}function be(s,e,t,i){let a="Unexpected state";typeof t=="string"?a=t:i=t,s||wS(e,a,i)}function _e(s,e){return s}const te={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class he extends ds{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}class Ci{constructor(){this.promise=new Promise(((e,t)=>{this.resolve=e,this.reject=t}))}}class Dk{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class Nk{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable((()=>t(dn.UNAUTHENTICATED)))}shutdown(){}}class jk{constructor(e){this.t=e,this.currentUser=dn.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){be(this.o===void 0,42304);let i=this.i;const a=p=>this.i!==i?(i=this.i,t(p)):Promise.resolve();let l=new Ci;this.o=()=>{this.i++,this.currentUser=this.u(),l.resolve(),l=new Ci,e.enqueueRetryable((()=>a(this.currentUser)))};const c=()=>{const p=l;e.enqueueRetryable((async()=>{await p.promise,await a(this.currentUser)}))},f=p=>{ce("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=p,this.o&&(this.auth.addAuthTokenListener(this.o),c())};this.t.onInit((p=>f(p))),setTimeout((()=>{if(!this.auth){const p=this.t.getImmediate({optional:!0});p?f(p):(ce("FirebaseAuthCredentialsProvider","Auth not yet detected"),l.resolve(),l=new Ci)}}),0),c()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then((i=>this.i!==e?(ce("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):i?(be(typeof i.accessToken=="string",31837,{l:i}),new Dk(i.accessToken,this.currentUser)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return be(e===null||typeof e=="string",2055,{h:e}),new dn(e)}}class kk{constructor(e,t,i){this.P=e,this.T=t,this.I=i,this.type="FirstParty",this.user=dn.FIRST_PARTY,this.R=new Map}A(){return this.I?this.I():null}get headers(){this.R.set("X-Goog-AuthUser",this.P);const e=this.A();return e&&this.R.set("Authorization",e),this.T&&this.R.set("X-Goog-Iam-Authorization-Token",this.T),this.R}}class Ok{constructor(e,t,i){this.P=e,this.T=t,this.I=i}getToken(){return Promise.resolve(new kk(this.P,this.T,this.I))}start(e,t){e.enqueueRetryable((()=>t(dn.FIRST_PARTY)))}shutdown(){}invalidateToken(){}}class wE{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class Vk{constructor(e,t){this.V=t,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,Fn(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,t){be(this.o===void 0,3512);const i=l=>{l.error!=null&&ce("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${l.error.message}`);const c=l.token!==this.m;return this.m=l.token,ce("FirebaseAppCheckTokenProvider",`Received ${c?"new":"existing"} token.`),c?t(l.token):Promise.resolve()};this.o=l=>{e.enqueueRetryable((()=>i(l)))};const a=l=>{ce("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=l,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit((l=>a(l))),setTimeout((()=>{if(!this.appCheck){const l=this.V.getImmediate({optional:!0});l?a(l):ce("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}}),0)}getToken(){if(this.p)return Promise.resolve(new wE(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then((t=>t?(be(typeof t.token=="string",44558,{tokenResult:t}),this.m=t.token,new wE(t.token)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}function Mk(s){const e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(s);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let i=0;i<s;i++)t[i]=Math.floor(256*Math.random());return t}class nv{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=62*Math.floor(4.129032258064516);let i="";for(;i.length<20;){const a=Mk(40);for(let l=0;l<a.length;++l)i.length<20&&a[l]<t&&(i+=e.charAt(a[l]%62))}return i}}function De(s,e){return s<e?-1:s>e?1:0}function dy(s,e){const t=Math.min(s.length,e.length);for(let i=0;i<t;i++){const a=s.charAt(i),l=e.charAt(i);if(a!==l)return Fg(a)===Fg(l)?De(a,l):Fg(a)?1:-1}return De(s.length,e.length)}const Pk=55296,Lk=57343;function Fg(s){const e=s.charCodeAt(0);return e>=Pk&&e<=Lk}function Al(s,e,t){return s.length===e.length&&s.every(((i,a)=>t(i,e[a])))}function AS(s){return s+"\0"}const AE="__name__";class ts{constructor(e,t,i){t===void 0?t=0:t>e.length&&ye(637,{offset:t,range:e.length}),i===void 0?i=e.length-t:i>e.length-t&&ye(1746,{length:i,range:e.length-t}),this.segments=e,this.offset=t,this.len=i}get length(){return this.len}isEqual(e){return ts.comparator(this,e)===0}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof ts?e.forEach((i=>{t.push(i)})):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,i=this.limit();t<i;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const i=Math.min(e.length,t.length);for(let a=0;a<i;a++){const l=ts.compareSegments(e.get(a),t.get(a));if(l!==0)return l}return De(e.length,t.length)}static compareSegments(e,t){const i=ts.isNumericId(e),a=ts.isNumericId(t);return i&&!a?-1:!i&&a?1:i&&a?ts.extractNumericId(e).compare(ts.extractNumericId(t)):dy(e,t)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return $r.fromString(e.substring(4,e.length-2))}}class We extends ts{construct(e,t,i){return new We(e,t,i)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const t=[];for(const i of e){if(i.indexOf("//")>=0)throw new he(te.INVALID_ARGUMENT,`Invalid segment (${i}). Paths must not contain // in them.`);t.push(...i.split("/").filter((a=>a.length>0)))}return new We(t)}static emptyPath(){return new We([])}}const Uk=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class wt extends ts{construct(e,t,i){return new wt(e,t,i)}static isValidIdentifier(e){return Uk.test(e)}canonicalString(){return this.toArray().map((e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),wt.isValidIdentifier(e)||(e="`"+e+"`"),e))).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===AE}static keyField(){return new wt([AE])}static fromServerFormat(e){const t=[];let i="",a=0;const l=()=>{if(i.length===0)throw new he(te.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(i),i=""};let c=!1;for(;a<e.length;){const f=e[a];if(f==="\\"){if(a+1===e.length)throw new he(te.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const p=e[a+1];if(p!=="\\"&&p!=="."&&p!=="`")throw new he(te.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);i+=p,a+=2}else f==="`"?(c=!c,a++):f!=="."||c?(i+=f,a++):(l(),a++)}if(l(),c)throw new he(te.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new wt(t)}static emptyPath(){return new wt([])}}class me{constructor(e){this.path=e}static fromPath(e){return new me(We.fromString(e))}static fromName(e){return new me(We.fromString(e).popFirst(5))}static empty(){return new me(We.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&We.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return We.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new me(new We(e.slice()))}}function IS(s,e,t){if(!t)throw new he(te.INVALID_ARGUMENT,`Function ${s}() cannot be called with an empty ${e}.`)}function zk(s,e,t,i){if(e===!0&&i===!0)throw new he(te.INVALID_ARGUMENT,`${s} and ${t} cannot be used together.`)}function IE(s){if(!me.isDocumentKey(s))throw new he(te.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${s} has ${s.length}.`)}function CE(s){if(me.isDocumentKey(s))throw new he(te.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${s} has ${s.length}.`)}function CS(s){return typeof s=="object"&&s!==null&&(Object.getPrototypeOf(s)===Object.prototype||Object.getPrototypeOf(s)===null)}function am(s){if(s===void 0)return"undefined";if(s===null)return"null";if(typeof s=="string")return s.length>20&&(s=`${s.substring(0,20)}...`),JSON.stringify(s);if(typeof s=="number"||typeof s=="boolean")return""+s;if(typeof s=="object"){if(s instanceof Array)return"an array";{const e=(function(i){return i.constructor?i.constructor.name:null})(s);return e?`a custom ${e} object`:"an object"}}return typeof s=="function"?"a function":ye(12329,{type:typeof s})}function ci(s,e){if("_delegate"in s&&(s=s._delegate),!(s instanceof e)){if(e.name===s.constructor.name)throw new he(te.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const t=am(s);throw new he(te.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return s}function Bk(s,e){if(e<=0)throw new he(te.INVALID_ARGUMENT,`Function ${s}() requires a positive number, but it was: ${e}.`)}function qt(s,e){const t={typeString:s};return e&&(t.value=e),t}function th(s,e){if(!CS(s))throw new he(te.INVALID_ARGUMENT,"JSON must be an object");let t;for(const i in e)if(e[i]){const a=e[i].typeString,l="value"in e[i]?{value:e[i].value}:void 0;if(!(i in s)){t=`JSON missing required field: '${i}'`;break}const c=s[i];if(a&&typeof c!==a){t=`JSON field '${i}' must be a ${a}.`;break}if(l!==void 0&&c!==l.value){t=`Expected '${i}' field to equal '${l.value}'`;break}}if(t)throw new he(te.INVALID_ARGUMENT,t);return!0}const RE=-62135596800,DE=1e6;class it{static now(){return it.fromMillis(Date.now())}static fromDate(e){return it.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),i=Math.floor((e-1e3*t)*DE);return new it(t,i)}constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new he(te.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new he(te.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<RE)throw new he(te.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new he(te.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/DE}_compareTo(e){return this.seconds===e.seconds?De(this.nanoseconds,e.nanoseconds):De(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:it._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(th(e,it._jsonSchema))return new it(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-RE;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}it._jsonSchemaVersion="firestore/timestamp/1.0",it._jsonSchema={type:qt("string",it._jsonSchemaVersion),seconds:qt("number"),nanoseconds:qt("number")};class Se{static fromTimestamp(e){return new Se(e)}static min(){return new Se(new it(0,0))}static max(){return new Se(new it(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}const Il=-1;class Nf{constructor(e,t,i,a){this.indexId=e,this.collectionGroup=t,this.fields=i,this.indexState=a}}function fy(s){return s.fields.find((e=>e.kind===2))}function qa(s){return s.fields.filter((e=>e.kind!==2))}Nf.UNKNOWN_ID=-1;class uf{constructor(e,t){this.fieldPath=e,this.kind=t}}class ju{constructor(e,t){this.sequenceNumber=e,this.offset=t}static empty(){return new ju(0,Qn.min())}}function RS(s,e){const t=s.toTimestamp().seconds,i=s.toTimestamp().nanoseconds+1,a=Se.fromTimestamp(i===1e9?new it(t+1,0):new it(t,i));return new Qn(a,me.empty(),e)}function DS(s){return new Qn(s.readTime,s.key,Il)}class Qn{constructor(e,t,i){this.readTime=e,this.documentKey=t,this.largestBatchId=i}static min(){return new Qn(Se.min(),me.empty(),Il)}static max(){return new Qn(Se.max(),me.empty(),Il)}}function iv(s,e){let t=s.readTime.compareTo(e.readTime);return t!==0?t:(t=me.comparator(s.documentKey,e.documentKey),t!==0?t:De(s.largestBatchId,e.largestBatchId))}const NS="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class jS{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach((e=>e()))}}async function sa(s){if(s.code!==te.FAILED_PRECONDITION||s.message!==NS)throw s;ce("LocalStore","Unexpectedly lost primary lease")}class q{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e((t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)}),(t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)}))}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&ye(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new q(((i,a)=>{this.nextCallback=l=>{this.wrapSuccess(e,l).next(i,a)},this.catchCallback=l=>{this.wrapFailure(t,l).next(i,a)}}))}toPromise(){return new Promise(((e,t)=>{this.next(e,t)}))}wrapUserFunction(e){try{const t=e();return t instanceof q?t:q.resolve(t)}catch(t){return q.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction((()=>e(t))):q.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction((()=>e(t))):q.reject(t)}static resolve(e){return new q(((t,i)=>{t(e)}))}static reject(e){return new q(((t,i)=>{i(e)}))}static waitFor(e){return new q(((t,i)=>{let a=0,l=0,c=!1;e.forEach((f=>{++a,f.next((()=>{++l,c&&l===a&&t()}),(p=>i(p)))})),c=!0,l===a&&t()}))}static or(e){let t=q.resolve(!1);for(const i of e)t=t.next((a=>a?q.resolve(a):i()));return t}static forEach(e,t){const i=[];return e.forEach(((a,l)=>{i.push(t.call(this,a,l))})),this.waitFor(i)}static mapArray(e,t){return new q(((i,a)=>{const l=e.length,c=new Array(l);let f=0;for(let p=0;p<l;p++){const y=p;t(e[y]).next((v=>{c[y]=v,++f,f===l&&i(c)}),(v=>a(v)))}}))}static doWhile(e,t){return new q(((i,a)=>{const l=()=>{e()===!0?t().next((()=>{l()}),a):i()};l()}))}}const Bn="SimpleDb";class om{static open(e,t,i,a){try{return new om(t,e.transaction(a,i))}catch(l){throw new bu(t,l)}}constructor(e,t){this.action=e,this.transaction=t,this.aborted=!1,this.S=new Ci,this.transaction.oncomplete=()=>{this.S.resolve()},this.transaction.onabort=()=>{t.error?this.S.reject(new bu(e,t.error)):this.S.resolve()},this.transaction.onerror=i=>{const a=sv(i.target.error);this.S.reject(new bu(e,a))}}get D(){return this.S.promise}abort(e){e&&this.S.reject(e),this.aborted||(ce(Bn,"Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}C(){const e=this.transaction;this.aborted||typeof e.commit!="function"||e.commit()}store(e){const t=this.transaction.objectStore(e);return new qk(t)}}class Wr{static delete(e){return ce(Bn,"Removing database:",e),Ga(S1().indexedDB.deleteDatabase(e)).toPromise()}static v(){if(!j1())return!1;if(Wr.F())return!0;const e=Qt(),t=Wr.M(e),i=0<t&&t<10,a=kS(e),l=0<a&&a<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||i||l)}static F(){return typeof process<"u"&&process.__PRIVATE_env?.__PRIVATE_USE_MOCK_PERSISTENCE==="YES"}static O(e,t){return e.store(t)}static M(e){const t=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),i=t?t[1].split("_").slice(0,2).join("."):"-1";return Number(i)}constructor(e,t,i){this.name=e,this.version=t,this.N=i,this.B=null,Wr.M(Qt())===12.2&&kt("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}async L(e){return this.db||(ce(Bn,"Opening database:",this.name),this.db=await new Promise(((t,i)=>{const a=indexedDB.open(this.name,this.version);a.onsuccess=l=>{const c=l.target.result;t(c)},a.onblocked=()=>{i(new bu(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},a.onerror=l=>{const c=l.target.error;c.name==="VersionError"?i(new he(te.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):c.name==="InvalidStateError"?i(new he(te.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+c)):i(new bu(e,c))},a.onupgradeneeded=l=>{ce(Bn,'Database "'+this.name+'" requires upgrade from version:',l.oldVersion);const c=l.target.result;this.N.k(c,a.transaction,l.oldVersion,this.version).next((()=>{ce(Bn,"Database upgrade to version "+this.version+" complete")}))}}))),this.K&&(this.db.onversionchange=t=>this.K(t)),this.db}q(e){this.K=e,this.db&&(this.db.onversionchange=t=>e(t))}async runTransaction(e,t,i,a){const l=t==="readonly";let c=0;for(;;){++c;try{this.db=await this.L(e);const f=om.open(this.db,e,l?"readonly":"readwrite",i),p=a(f).next((y=>(f.C(),y))).catch((y=>(f.abort(y),q.reject(y)))).toPromise();return p.catch((()=>{})),await f.D,p}catch(f){const p=f,y=p.name!=="FirebaseError"&&c<3;if(ce(Bn,"Transaction failed with error:",p.message,"Retrying:",y),this.close(),!y)return Promise.reject(p)}}}close(){this.db&&this.db.close(),this.db=void 0}}function kS(s){const e=s.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}class Fk{constructor(e){this.U=e,this.$=!1,this.W=null}get isDone(){return this.$}get G(){return this.W}set cursor(e){this.U=e}done(){this.$=!0}j(e){this.W=e}delete(){return Ga(this.U.delete())}}class bu extends he{constructor(e,t){super(te.UNAVAILABLE,`IndexedDB transaction '${e}' failed: ${t}`),this.name="IndexedDbTransactionError"}}function ra(s){return s.name==="IndexedDbTransactionError"}class qk{constructor(e){this.store=e}put(e,t){let i;return t!==void 0?(ce(Bn,"PUT",this.store.name,e,t),i=this.store.put(t,e)):(ce(Bn,"PUT",this.store.name,"<auto-key>",e),i=this.store.put(e)),Ga(i)}add(e){return ce(Bn,"ADD",this.store.name,e,e),Ga(this.store.add(e))}get(e){return Ga(this.store.get(e)).next((t=>(t===void 0&&(t=null),ce(Bn,"GET",this.store.name,e,t),t)))}delete(e){return ce(Bn,"DELETE",this.store.name,e),Ga(this.store.delete(e))}count(){return ce(Bn,"COUNT",this.store.name),Ga(this.store.count())}H(e,t){const i=this.options(e,t),a=i.index?this.store.index(i.index):this.store;if(typeof a.getAll=="function"){const l=a.getAll(i.range);return new q(((c,f)=>{l.onerror=p=>{f(p.target.error)},l.onsuccess=p=>{c(p.target.result)}}))}{const l=this.cursor(i),c=[];return this.J(l,((f,p)=>{c.push(p)})).next((()=>c))}}Z(e,t){const i=this.store.getAll(e,t===null?void 0:t);return new q(((a,l)=>{i.onerror=c=>{l(c.target.error)},i.onsuccess=c=>{a(c.target.result)}}))}X(e,t){ce(Bn,"DELETE ALL",this.store.name);const i=this.options(e,t);i.Y=!1;const a=this.cursor(i);return this.J(a,((l,c,f)=>f.delete()))}ee(e,t){let i;t?i=e:(i={},t=e);const a=this.cursor(i);return this.J(a,t)}te(e){const t=this.cursor({});return new q(((i,a)=>{t.onerror=l=>{const c=sv(l.target.error);a(c)},t.onsuccess=l=>{const c=l.target.result;c?e(c.primaryKey,c.value).next((f=>{f?c.continue():i()})):i()}}))}J(e,t){const i=[];return new q(((a,l)=>{e.onerror=c=>{l(c.target.error)},e.onsuccess=c=>{const f=c.target.result;if(!f)return void a();const p=new Fk(f),y=t(f.primaryKey,f.value,p);if(y instanceof q){const v=y.catch((b=>(p.done(),q.reject(b))));i.push(v)}p.isDone?a():p.G===null?f.continue():f.continue(p.G)}})).next((()=>q.waitFor(i)))}options(e,t){let i;return e!==void 0&&(typeof e=="string"?i=e:t=e),{index:i,range:t}}cursor(e){let t="next";if(e.reverse&&(t="prev"),e.index){const i=this.store.index(e.index);return e.Y?i.openKeyCursor(e.range,t):i.openCursor(e.range,t)}return this.store.openCursor(e.range,t)}}function Ga(s){return new q(((e,t)=>{s.onsuccess=i=>{const a=i.target.result;e(a)},s.onerror=i=>{const a=sv(i.target.error);t(a)}}))}let NE=!1;function sv(s){const e=Wr.M(Qt());if(e>=12.2&&e<13){const t="An internal error was encountered in the Indexed Database server";if(s.message.indexOf(t)>=0){const i=new he("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${t}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return NE||(NE=!0,setTimeout((()=>{throw i}),0)),i}}return s}const Tu="IndexBackfiller";class Hk{constructor(e,t){this.asyncQueue=e,this.ne=t,this.task=null}start(){this.re(15e3)}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return this.task!==null}re(e){ce(Tu,`Scheduled in ${e}ms`),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",e,(async()=>{this.task=null;try{const t=await this.ne.ie();ce(Tu,`Documents written: ${t}`)}catch(t){ra(t)?ce(Tu,"Ignoring IndexedDB error during index backfill: ",t):await sa(t)}await this.re(6e4)}))}}class Gk{constructor(e,t){this.localStore=e,this.persistence=t}async ie(e=50){return this.persistence.runTransaction("Backfill Indexes","readwrite-primary",(t=>this.se(t,e)))}se(e,t){const i=new Set;let a=t,l=!0;return q.doWhile((()=>l===!0&&a>0),(()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(e).next((c=>{if(c!==null&&!i.has(c))return ce(Tu,`Processing collection: ${c}`),this.oe(e,c,a).next((f=>{a-=f,i.add(c)}));l=!1})))).next((()=>t-a))}oe(e,t,i){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(e,t).next((a=>this.localStore.localDocuments.getNextDocuments(e,t,a,i).next((l=>{const c=l.changes;return this.localStore.indexManager.updateIndexEntries(e,c).next((()=>this._e(a,l))).next((f=>(ce(Tu,`Updating offset: ${f}`),this.localStore.indexManager.updateCollectionGroup(e,t,f)))).next((()=>c.size))}))))}_e(e,t){let i=e;return t.changes.forEach(((a,l)=>{const c=DS(l);iv(c,i)>0&&(i=c)})),new Qn(i.readTime,i.documentKey,Math.max(t.batchId,e.largestBatchId))}}class Cn{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=i=>this.ae(i),this.ue=i=>t.writeSequenceNumber(i))}ae(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ue&&this.ue(e),e}}Cn.ce=-1;const Ya=-1;function nh(s){return s==null}function ku(s){return s===0&&1/s==-1/0}function OS(s){return typeof s=="number"&&Number.isInteger(s)&&!ku(s)&&s<=Number.MAX_SAFE_INTEGER&&s>=Number.MIN_SAFE_INTEGER}const jf="";function mn(s){let e="";for(let t=0;t<s.length;t++)e.length>0&&(e=jE(e)),e=Qk(s.get(t),e);return jE(e)}function Qk(s,e){let t=e;const i=s.length;for(let a=0;a<i;a++){const l=s.charAt(a);switch(l){case"\0":t+="";break;case jf:t+="";break;default:t+=l}}return t}function jE(s){return s+jf+""}function is(s){const e=s.length;if(be(e>=2,64408,{path:s}),e===2)return be(s.charAt(0)===jf&&s.charAt(1)==="",56145,{path:s}),We.emptyPath();const t=e-2,i=[];let a="";for(let l=0;l<e;){const c=s.indexOf(jf,l);switch((c<0||c>t)&&ye(50515,{path:s}),s.charAt(c+1)){case"":const f=s.substring(l,c);let p;a.length===0?p=f:(a+=f,p=a,a=""),i.push(p);break;case"":a+=s.substring(l,c),a+="\0";break;case"":a+=s.substring(l,c+1);break;default:ye(61167,{path:s})}l=c+2}return new We(i)}const Ha="remoteDocuments",ih="owner",sl="owner",Ou="mutationQueues",Kk="userId",wi="mutations",kE="batchId",Wa="userMutationsIndex",OE=["userId","batchId"];function hf(s,e){return[s,mn(e)]}function VS(s,e,t){return[s,mn(e),t]}const $k={},Cl="documentMutations",kf="remoteDocumentsV14",Wk=["prefixPath","collectionGroup","readTime","documentId"],df="documentKeyIndex",Yk=["prefixPath","collectionGroup","documentId"],MS="collectionGroupIndex",Xk=["collectionGroup","readTime","prefixPath","documentId"],Vu="remoteDocumentGlobal",my="remoteDocumentGlobalKey",Rl="targets",PS="queryTargetsIndex",Jk=["canonicalId","targetId"],Dl="targetDocuments",Zk=["targetId","path"],rv="documentTargetsIndex",eO=["path","targetId"],Of="targetGlobalKey",Xa="targetGlobal",Mu="collectionParents",tO=["collectionId","parent"],Nl="clientMetadata",nO="clientId",lm="bundles",iO="bundleId",cm="namedQueries",sO="name",av="indexConfiguration",rO="indexId",py="collectionGroupIndex",aO="collectionGroup",Eu="indexState",oO=["indexId","uid"],LS="sequenceNumberIndex",lO=["uid","sequenceNumber"],xu="indexEntries",cO=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],US="documentKeyIndex",uO=["indexId","uid","orderedDocumentKey"],um="documentOverlays",hO=["userId","collectionPath","documentId"],gy="collectionPathOverlayIndex",dO=["userId","collectionPath","largestBatchId"],zS="collectionGroupOverlayIndex",fO=["userId","collectionGroup","largestBatchId"],ov="globals",mO="name",BS=[Ou,wi,Cl,Ha,Rl,ih,Xa,Dl,Nl,Vu,Mu,lm,cm],pO=[...BS,um],FS=[Ou,wi,Cl,kf,Rl,ih,Xa,Dl,Nl,Vu,Mu,lm,cm,um],qS=FS,lv=[...qS,av,Eu,xu],gO=lv,HS=[...lv,ov],yO=HS;class yy extends jS{constructor(e,t){super(),this.le=e,this.currentSequenceNumber=t}}function Kt(s,e){const t=_e(s);return Wr.O(t.le,e)}function VE(s){let e=0;for(const t in s)Object.prototype.hasOwnProperty.call(s,t)&&e++;return e}function aa(s,e){for(const t in s)Object.prototype.hasOwnProperty.call(s,t)&&e(t,s[t])}function GS(s){for(const e in s)if(Object.prototype.hasOwnProperty.call(s,e))return!1;return!0}class ft{constructor(e,t){this.comparator=e,this.root=t||an.EMPTY}insert(e,t){return new ft(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,an.BLACK,null,null))}remove(e){return new ft(this.comparator,this.root.remove(e,this.comparator).copy(null,null,an.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const i=this.comparator(e,t.key);if(i===0)return t.value;i<0?t=t.left:i>0&&(t=t.right)}return null}indexOf(e){let t=0,i=this.root;for(;!i.isEmpty();){const a=this.comparator(e,i.key);if(a===0)return t+i.left.size;a<0?i=i.left:(t+=i.left.size+1,i=i.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal(((t,i)=>(e(t,i),!1)))}toString(){const e=[];return this.inorderTraversal(((t,i)=>(e.push(`${t}:${i}`),!1))),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Hd(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Hd(this.root,e,this.comparator,!1)}getReverseIterator(){return new Hd(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Hd(this.root,e,this.comparator,!0)}}class Hd{constructor(e,t,i,a){this.isReverse=a,this.nodeStack=[];let l=1;for(;!e.isEmpty();)if(l=t?i(e.key,t):1,t&&a&&(l*=-1),l<0)e=this.isReverse?e.left:e.right;else{if(l===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class an{constructor(e,t,i,a,l){this.key=e,this.value=t,this.color=i??an.RED,this.left=a??an.EMPTY,this.right=l??an.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,i,a,l){return new an(e??this.key,t??this.value,i??this.color,a??this.left,l??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,i){let a=this;const l=i(e,a.key);return a=l<0?a.copy(null,null,null,a.left.insert(e,t,i),null):l===0?a.copy(null,t,null,null,null):a.copy(null,null,null,null,a.right.insert(e,t,i)),a.fixUp()}removeMin(){if(this.left.isEmpty())return an.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let i,a=this;if(t(e,a.key)<0)a.left.isEmpty()||a.left.isRed()||a.left.left.isRed()||(a=a.moveRedLeft()),a=a.copy(null,null,null,a.left.remove(e,t),null);else{if(a.left.isRed()&&(a=a.rotateRight()),a.right.isEmpty()||a.right.isRed()||a.right.left.isRed()||(a=a.moveRedRight()),t(e,a.key)===0){if(a.right.isEmpty())return an.EMPTY;i=a.right.min(),a=a.copy(i.key,i.value,null,null,a.right.removeMin())}a=a.copy(null,null,null,null,a.right.remove(e,t))}return a.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,an.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,an.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw ye(43730,{key:this.key,value:this.value});if(this.right.isRed())throw ye(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw ye(27949);return e+(this.isRed()?0:1)}}an.EMPTY=null,an.RED=!0,an.BLACK=!1;an.EMPTY=new class{constructor(){this.size=0}get key(){throw ye(57766)}get value(){throw ye(16141)}get color(){throw ye(16727)}get left(){throw ye(29726)}get right(){throw ye(36894)}copy(e,t,i,a,l){return this}insert(e,t,i){return new an(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};class rt{constructor(e){this.comparator=e,this.data=new ft(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal(((t,i)=>(e(t),!1)))}forEachInRange(e,t){const i=this.data.getIteratorFrom(e[0]);for(;i.hasNext();){const a=i.getNext();if(this.comparator(a.key,e[1])>=0)return;t(a.key)}}forEachWhile(e,t){let i;for(i=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();i.hasNext();)if(!e(i.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new ME(this.data.getIterator())}getIteratorFrom(e){return new ME(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach((i=>{t=t.add(i)})),t}isEqual(e){if(!(e instanceof rt)||this.size!==e.size)return!1;const t=this.data.getIterator(),i=e.data.getIterator();for(;t.hasNext();){const a=t.getNext().key,l=i.getNext().key;if(this.comparator(a,l)!==0)return!1}return!0}toArray(){const e=[];return this.forEach((t=>{e.push(t)})),e}toString(){const e=[];return this.forEach((t=>e.push(t))),"SortedSet("+e.toString()+")"}copy(e){const t=new rt(this.comparator);return t.data=e,t}}class ME{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}function rl(s){return s.hasNext()?s.getNext():void 0}class Rn{constructor(e){this.fields=e,e.sort(wt.comparator)}static empty(){return new Rn([])}unionWith(e){let t=new rt(wt.comparator);for(const i of this.fields)t=t.add(i);for(const i of e)t=t.add(i);return new Rn(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return Al(this.fields,e.fields,((t,i)=>t.isEqual(i)))}}class QS extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}class Ot{constructor(e){this.binaryString=e}static fromBase64String(e){const t=(function(a){try{return atob(a)}catch(l){throw typeof DOMException<"u"&&l instanceof DOMException?new QS("Invalid base64 string: "+l):l}})(e);return new Ot(t)}static fromUint8Array(e){const t=(function(a){let l="";for(let c=0;c<a.length;++c)l+=String.fromCharCode(a[c]);return l})(e);return new Ot(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return(function(t){return btoa(t)})(this.binaryString)}toUint8Array(){return(function(t){const i=new Uint8Array(t.length);for(let a=0;a<t.length;a++)i[a]=t.charCodeAt(a);return i})(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return De(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}Ot.EMPTY_BYTE_STRING=new Ot("");const vO=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Ks(s){if(be(!!s,39018),typeof s=="string"){let e=0;const t=vO.exec(s);if(be(!!t,46558,{timestamp:s}),t[1]){let a=t[1];a=(a+"000000000").substr(0,9),e=Number(a)}const i=new Date(s);return{seconds:Math.floor(i.getTime()/1e3),nanos:e}}return{seconds:Tt(s.seconds),nanos:Tt(s.nanos)}}function Tt(s){return typeof s=="number"?s:typeof s=="string"?Number(s):0}function $s(s){return typeof s=="string"?Ot.fromBase64String(s):Ot.fromUint8Array(s)}const KS="server_timestamp",$S="__type__",WS="__previous_value__",YS="__local_write_time__";function cv(s){return(s?.mapValue?.fields||{})[$S]?.stringValue===KS}function hm(s){const e=s.mapValue.fields[WS];return cv(e)?hm(e):e}function Pu(s){const e=Ks(s.mapValue.fields[YS].timestampValue);return new it(e.seconds,e.nanos)}class _O{constructor(e,t,i,a,l,c,f,p,y,v,b){this.databaseId=e,this.appId=t,this.persistenceKey=i,this.host=a,this.ssl=l,this.forceLongPolling=c,this.autoDetectLongPolling=f,this.longPollingOptions=p,this.useFetchStreams=y,this.isUsingEmulator=v,this.apiKey=b}}const Vf="(default)";class io{constructor(e,t){this.projectId=e,this.database=t||Vf}static empty(){return new io("","")}get isDefaultDatabase(){return this.database===Vf}isEqual(e){return e instanceof io&&e.projectId===this.projectId&&e.database===this.database}}function bO(s,e){if(!Object.prototype.hasOwnProperty.apply(s.options,["projectId"]))throw new he(te.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new io(s.options.projectId,e)}const uv="__type__",XS="__max__",Hr={mapValue:{fields:{__type__:{stringValue:XS}}}},hv="__vector__",jl="value",ff={nullValue:"NULL_VALUE"};function Zr(s){return"nullValue"in s?0:"booleanValue"in s?1:"integerValue"in s||"doubleValue"in s?2:"timestampValue"in s?3:"stringValue"in s?5:"bytesValue"in s?6:"referenceValue"in s?7:"geoPointValue"in s?8:"arrayValue"in s?9:"mapValue"in s?cv(s)?4:JS(s)?9007199254740991:dm(s)?10:11:ye(28295,{value:s})}function us(s,e){if(s===e)return!0;const t=Zr(s);if(t!==Zr(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return s.booleanValue===e.booleanValue;case 4:return Pu(s).isEqual(Pu(e));case 3:return(function(a,l){if(typeof a.timestampValue=="string"&&typeof l.timestampValue=="string"&&a.timestampValue.length===l.timestampValue.length)return a.timestampValue===l.timestampValue;const c=Ks(a.timestampValue),f=Ks(l.timestampValue);return c.seconds===f.seconds&&c.nanos===f.nanos})(s,e);case 5:return s.stringValue===e.stringValue;case 6:return(function(a,l){return $s(a.bytesValue).isEqual($s(l.bytesValue))})(s,e);case 7:return s.referenceValue===e.referenceValue;case 8:return(function(a,l){return Tt(a.geoPointValue.latitude)===Tt(l.geoPointValue.latitude)&&Tt(a.geoPointValue.longitude)===Tt(l.geoPointValue.longitude)})(s,e);case 2:return(function(a,l){if("integerValue"in a&&"integerValue"in l)return Tt(a.integerValue)===Tt(l.integerValue);if("doubleValue"in a&&"doubleValue"in l){const c=Tt(a.doubleValue),f=Tt(l.doubleValue);return c===f?ku(c)===ku(f):isNaN(c)&&isNaN(f)}return!1})(s,e);case 9:return Al(s.arrayValue.values||[],e.arrayValue.values||[],us);case 10:case 11:return(function(a,l){const c=a.mapValue.fields||{},f=l.mapValue.fields||{};if(VE(c)!==VE(f))return!1;for(const p in c)if(c.hasOwnProperty(p)&&(f[p]===void 0||!us(c[p],f[p])))return!1;return!0})(s,e);default:return ye(52216,{left:s})}}function Lu(s,e){return(s.values||[]).find((t=>us(t,e)))!==void 0}function ea(s,e){if(s===e)return 0;const t=Zr(s),i=Zr(e);if(t!==i)return De(t,i);switch(t){case 0:case 9007199254740991:return 0;case 1:return De(s.booleanValue,e.booleanValue);case 2:return(function(l,c){const f=Tt(l.integerValue||l.doubleValue),p=Tt(c.integerValue||c.doubleValue);return f<p?-1:f>p?1:f===p?0:isNaN(f)?isNaN(p)?0:-1:1})(s,e);case 3:return PE(s.timestampValue,e.timestampValue);case 4:return PE(Pu(s),Pu(e));case 5:return dy(s.stringValue,e.stringValue);case 6:return(function(l,c){const f=$s(l),p=$s(c);return f.compareTo(p)})(s.bytesValue,e.bytesValue);case 7:return(function(l,c){const f=l.split("/"),p=c.split("/");for(let y=0;y<f.length&&y<p.length;y++){const v=De(f[y],p[y]);if(v!==0)return v}return De(f.length,p.length)})(s.referenceValue,e.referenceValue);case 8:return(function(l,c){const f=De(Tt(l.latitude),Tt(c.latitude));return f!==0?f:De(Tt(l.longitude),Tt(c.longitude))})(s.geoPointValue,e.geoPointValue);case 9:return LE(s.arrayValue,e.arrayValue);case 10:return(function(l,c){const f=l.fields||{},p=c.fields||{},y=f[jl]?.arrayValue,v=p[jl]?.arrayValue,b=De(y?.values?.length||0,v?.values?.length||0);return b!==0?b:LE(y,v)})(s.mapValue,e.mapValue);case 11:return(function(l,c){if(l===Hr.mapValue&&c===Hr.mapValue)return 0;if(l===Hr.mapValue)return 1;if(c===Hr.mapValue)return-1;const f=l.fields||{},p=Object.keys(f),y=c.fields||{},v=Object.keys(y);p.sort(),v.sort();for(let b=0;b<p.length&&b<v.length;++b){const x=dy(p[b],v[b]);if(x!==0)return x;const k=ea(f[p[b]],y[v[b]]);if(k!==0)return k}return De(p.length,v.length)})(s.mapValue,e.mapValue);default:throw ye(23264,{he:t})}}function PE(s,e){if(typeof s=="string"&&typeof e=="string"&&s.length===e.length)return De(s,e);const t=Ks(s),i=Ks(e),a=De(t.seconds,i.seconds);return a!==0?a:De(t.nanos,i.nanos)}function LE(s,e){const t=s.values||[],i=e.values||[];for(let a=0;a<t.length&&a<i.length;++a){const l=ea(t[a],i[a]);if(l)return l}return De(t.length,i.length)}function kl(s){return vy(s)}function vy(s){return"nullValue"in s?"null":"booleanValue"in s?""+s.booleanValue:"integerValue"in s?""+s.integerValue:"doubleValue"in s?""+s.doubleValue:"timestampValue"in s?(function(t){const i=Ks(t);return`time(${i.seconds},${i.nanos})`})(s.timestampValue):"stringValue"in s?s.stringValue:"bytesValue"in s?(function(t){return $s(t).toBase64()})(s.bytesValue):"referenceValue"in s?(function(t){return me.fromName(t).toString()})(s.referenceValue):"geoPointValue"in s?(function(t){return`geo(${t.latitude},${t.longitude})`})(s.geoPointValue):"arrayValue"in s?(function(t){let i="[",a=!0;for(const l of t.values||[])a?a=!1:i+=",",i+=vy(l);return i+"]"})(s.arrayValue):"mapValue"in s?(function(t){const i=Object.keys(t.fields||{}).sort();let a="{",l=!0;for(const c of i)l?l=!1:a+=",",a+=`${c}:${vy(t.fields[c])}`;return a+"}"})(s.mapValue):ye(61005,{value:s})}function mf(s){switch(Zr(s)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=hm(s);return e?16+mf(e):16;case 5:return 2*s.stringValue.length;case 6:return $s(s.bytesValue).approximateByteSize();case 7:return s.referenceValue.length;case 9:return(function(i){return(i.values||[]).reduce(((a,l)=>a+mf(l)),0)})(s.arrayValue);case 10:case 11:return(function(i){let a=0;return aa(i.fields,((l,c)=>{a+=l.length+mf(c)})),a})(s.mapValue);default:throw ye(13486,{value:s})}}function Uu(s,e){return{referenceValue:`projects/${s.projectId}/databases/${s.database}/documents/${e.path.canonicalString()}`}}function _y(s){return!!s&&"integerValue"in s}function zu(s){return!!s&&"arrayValue"in s}function UE(s){return!!s&&"nullValue"in s}function zE(s){return!!s&&"doubleValue"in s&&isNaN(Number(s.doubleValue))}function pf(s){return!!s&&"mapValue"in s}function dm(s){return(s?.mapValue?.fields||{})[uv]?.stringValue===hv}function Su(s){if(s.geoPointValue)return{geoPointValue:{...s.geoPointValue}};if(s.timestampValue&&typeof s.timestampValue=="object")return{timestampValue:{...s.timestampValue}};if(s.mapValue){const e={mapValue:{fields:{}}};return aa(s.mapValue.fields,((t,i)=>e.mapValue.fields[t]=Su(i))),e}if(s.arrayValue){const e={arrayValue:{values:[]}};for(let t=0;t<(s.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=Su(s.arrayValue.values[t]);return e}return{...s}}function JS(s){return(((s.mapValue||{}).fields||{}).__type__||{}).stringValue===XS}const ZS={mapValue:{fields:{[uv]:{stringValue:hv},[jl]:{arrayValue:{}}}}};function TO(s){return"nullValue"in s?ff:"booleanValue"in s?{booleanValue:!1}:"integerValue"in s||"doubleValue"in s?{doubleValue:NaN}:"timestampValue"in s?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in s?{stringValue:""}:"bytesValue"in s?{bytesValue:""}:"referenceValue"in s?Uu(io.empty(),me.empty()):"geoPointValue"in s?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in s?{arrayValue:{}}:"mapValue"in s?dm(s)?ZS:{mapValue:{}}:ye(35942,{value:s})}function EO(s){return"nullValue"in s?{booleanValue:!1}:"booleanValue"in s?{doubleValue:NaN}:"integerValue"in s||"doubleValue"in s?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in s?{stringValue:""}:"stringValue"in s?{bytesValue:""}:"bytesValue"in s?Uu(io.empty(),me.empty()):"referenceValue"in s?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in s?{arrayValue:{}}:"arrayValue"in s?ZS:"mapValue"in s?dm(s)?{mapValue:{}}:Hr:ye(61959,{value:s})}function BE(s,e){const t=ea(s.value,e.value);return t!==0?t:s.inclusive&&!e.inclusive?-1:!s.inclusive&&e.inclusive?1:0}function FE(s,e){const t=ea(s.value,e.value);return t!==0?t:s.inclusive&&!e.inclusive?1:!s.inclusive&&e.inclusive?-1:0}class on{constructor(e){this.value=e}static empty(){return new on({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let i=0;i<e.length-1;++i)if(t=(t.mapValue.fields||{})[e.get(i)],!pf(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=Su(t)}setAll(e){let t=wt.emptyPath(),i={},a=[];e.forEach(((c,f)=>{if(!t.isImmediateParentOf(f)){const p=this.getFieldsMap(t);this.applyChanges(p,i,a),i={},a=[],t=f.popLast()}c?i[f.lastSegment()]=Su(c):a.push(f.lastSegment())}));const l=this.getFieldsMap(t);this.applyChanges(l,i,a)}delete(e){const t=this.field(e.popLast());pf(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return us(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let i=0;i<e.length;++i){let a=t.mapValue.fields[e.get(i)];pf(a)&&a.mapValue.fields||(a={mapValue:{fields:{}}},t.mapValue.fields[e.get(i)]=a),t=a}return t.mapValue.fields}applyChanges(e,t,i){aa(t,((a,l)=>e[a]=l));for(const a of i)delete e[a]}clone(){return new on(Su(this.value))}}function ew(s){const e=[];return aa(s.fields,((t,i)=>{const a=new wt([t]);if(pf(i)){const l=ew(i.mapValue).fields;if(l.length===0)e.push(a);else for(const c of l)e.push(a.child(c))}else e.push(a)})),new Rn(e)}class Et{constructor(e,t,i,a,l,c,f){this.key=e,this.documentType=t,this.version=i,this.readTime=a,this.createTime=l,this.data=c,this.documentState=f}static newInvalidDocument(e){return new Et(e,0,Se.min(),Se.min(),Se.min(),on.empty(),0)}static newFoundDocument(e,t,i,a){return new Et(e,1,t,Se.min(),i,a,0)}static newNoDocument(e,t){return new Et(e,2,t,Se.min(),Se.min(),on.empty(),0)}static newUnknownDocument(e,t){return new Et(e,3,t,Se.min(),Se.min(),on.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(Se.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=on.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=on.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=Se.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof Et&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new Et(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}class Ol{constructor(e,t){this.position=e,this.inclusive=t}}function qE(s,e,t){let i=0;for(let a=0;a<s.position.length;a++){const l=e[a],c=s.position[a];if(l.field.isKeyField()?i=me.comparator(me.fromName(c.referenceValue),t.key):i=ea(c,t.data.field(l.field)),l.dir==="desc"&&(i*=-1),i!==0)break}return i}function HE(s,e){if(s===null)return e===null;if(e===null||s.inclusive!==e.inclusive||s.position.length!==e.position.length)return!1;for(let t=0;t<s.position.length;t++)if(!us(s.position[t],e.position[t]))return!1;return!0}class Bu{constructor(e,t="asc"){this.field=e,this.dir=t}}function xO(s,e){return s.dir===e.dir&&s.field.isEqual(e.field)}class tw{}class qe extends tw{constructor(e,t,i){super(),this.field=e,this.op=t,this.value=i}static create(e,t,i){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,i):new SO(e,t,i):t==="array-contains"?new IO(e,i):t==="in"?new ow(e,i):t==="not-in"?new CO(e,i):t==="array-contains-any"?new RO(e,i):new qe(e,t,i)}static createKeyFieldInFilter(e,t,i){return t==="in"?new wO(e,i):new AO(e,i)}matches(e){const t=e.data.field(this.field);return this.op==="!="?t!==null&&t.nullValue===void 0&&this.matchesComparison(ea(t,this.value)):t!==null&&Zr(this.value)===Zr(t)&&this.matchesComparison(ea(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return ye(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class st extends tw{constructor(e,t){super(),this.filters=e,this.op=t,this.Pe=null}static create(e,t){return new st(e,t)}matches(e){return Vl(this)?this.filters.find((t=>!t.matches(e)))===void 0:this.filters.find((t=>t.matches(e)))!==void 0}getFlattenedFilters(){return this.Pe!==null||(this.Pe=this.filters.reduce(((e,t)=>e.concat(t.getFlattenedFilters())),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function Vl(s){return s.op==="and"}function by(s){return s.op==="or"}function dv(s){return nw(s)&&Vl(s)}function nw(s){for(const e of s.filters)if(e instanceof st)return!1;return!0}function Ty(s){if(s instanceof qe)return s.field.canonicalString()+s.op.toString()+kl(s.value);if(dv(s))return s.filters.map((e=>Ty(e))).join(",");{const e=s.filters.map((t=>Ty(t))).join(",");return`${s.op}(${e})`}}function iw(s,e){return s instanceof qe?(function(i,a){return a instanceof qe&&i.op===a.op&&i.field.isEqual(a.field)&&us(i.value,a.value)})(s,e):s instanceof st?(function(i,a){return a instanceof st&&i.op===a.op&&i.filters.length===a.filters.length?i.filters.reduce(((l,c,f)=>l&&iw(c,a.filters[f])),!0):!1})(s,e):void ye(19439)}function sw(s,e){const t=s.filters.concat(e);return st.create(t,s.op)}function rw(s){return s instanceof qe?(function(t){return`${t.field.canonicalString()} ${t.op} ${kl(t.value)}`})(s):s instanceof st?(function(t){return t.op.toString()+" {"+t.getFilters().map(rw).join(" ,")+"}"})(s):"Filter"}class SO extends qe{constructor(e,t,i){super(e,t,i),this.key=me.fromName(i.referenceValue)}matches(e){const t=me.comparator(e.key,this.key);return this.matchesComparison(t)}}class wO extends qe{constructor(e,t){super(e,"in",t),this.keys=aw("in",t)}matches(e){return this.keys.some((t=>t.isEqual(e.key)))}}class AO extends qe{constructor(e,t){super(e,"not-in",t),this.keys=aw("not-in",t)}matches(e){return!this.keys.some((t=>t.isEqual(e.key)))}}function aw(s,e){return(e.arrayValue?.values||[]).map((t=>me.fromName(t.referenceValue)))}class IO extends qe{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return zu(t)&&Lu(t.arrayValue,this.value)}}class ow extends qe{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return t!==null&&Lu(this.value.arrayValue,t)}}class CO extends qe{constructor(e,t){super(e,"not-in",t)}matches(e){if(Lu(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return t!==null&&t.nullValue===void 0&&!Lu(this.value.arrayValue,t)}}class RO extends qe{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!zu(t)||!t.arrayValue.values)&&t.arrayValue.values.some((i=>Lu(this.value.arrayValue,i)))}}class DO{constructor(e,t=null,i=[],a=[],l=null,c=null,f=null){this.path=e,this.collectionGroup=t,this.orderBy=i,this.filters=a,this.limit=l,this.startAt=c,this.endAt=f,this.Te=null}}function Ey(s,e=null,t=[],i=[],a=null,l=null,c=null){return new DO(s,e,t,i,a,l,c)}function so(s){const e=_e(s);if(e.Te===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map((i=>Ty(i))).join(","),t+="|ob:",t+=e.orderBy.map((i=>(function(l){return l.field.canonicalString()+l.dir})(i))).join(","),nh(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map((i=>kl(i))).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map((i=>kl(i))).join(",")),e.Te=t}return e.Te}function sh(s,e){if(s.limit!==e.limit||s.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<s.orderBy.length;t++)if(!xO(s.orderBy[t],e.orderBy[t]))return!1;if(s.filters.length!==e.filters.length)return!1;for(let t=0;t<s.filters.length;t++)if(!iw(s.filters[t],e.filters[t]))return!1;return s.collectionGroup===e.collectionGroup&&!!s.path.isEqual(e.path)&&!!HE(s.startAt,e.startAt)&&HE(s.endAt,e.endAt)}function Mf(s){return me.isDocumentKey(s.path)&&s.collectionGroup===null&&s.filters.length===0}function Pf(s,e){return s.filters.filter((t=>t instanceof qe&&t.field.isEqual(e)))}function GE(s,e,t){let i=ff,a=!0;for(const l of Pf(s,e)){let c=ff,f=!0;switch(l.op){case"<":case"<=":c=TO(l.value);break;case"==":case"in":case">=":c=l.value;break;case">":c=l.value,f=!1;break;case"!=":case"not-in":c=ff}BE({value:i,inclusive:a},{value:c,inclusive:f})<0&&(i=c,a=f)}if(t!==null){for(let l=0;l<s.orderBy.length;++l)if(s.orderBy[l].field.isEqual(e)){const c=t.position[l];BE({value:i,inclusive:a},{value:c,inclusive:t.inclusive})<0&&(i=c,a=t.inclusive);break}}return{value:i,inclusive:a}}function QE(s,e,t){let i=Hr,a=!0;for(const l of Pf(s,e)){let c=Hr,f=!0;switch(l.op){case">=":case">":c=EO(l.value),f=!1;break;case"==":case"in":case"<=":c=l.value;break;case"<":c=l.value,f=!1;break;case"!=":case"not-in":c=Hr}FE({value:i,inclusive:a},{value:c,inclusive:f})>0&&(i=c,a=f)}if(t!==null){for(let l=0;l<s.orderBy.length;++l)if(s.orderBy[l].field.isEqual(e)){const c=t.position[l];FE({value:i,inclusive:a},{value:c,inclusive:t.inclusive})>0&&(i=c,a=t.inclusive);break}}return{value:i,inclusive:a}}class Yl{constructor(e,t=null,i=[],a=[],l=null,c="F",f=null,p=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=i,this.filters=a,this.limit=l,this.limitType=c,this.startAt=f,this.endAt=p,this.Ie=null,this.Ee=null,this.Re=null,this.startAt,this.endAt}}function lw(s,e,t,i,a,l,c,f){return new Yl(s,e,t,i,a,l,c,f)}function fm(s){return new Yl(s)}function KE(s){return s.filters.length===0&&s.limit===null&&s.startAt==null&&s.endAt==null&&(s.explicitOrderBy.length===0||s.explicitOrderBy.length===1&&s.explicitOrderBy[0].field.isKeyField())}function NO(s){return me.isDocumentKey(s.path)&&s.collectionGroup===null&&s.filters.length===0}function cw(s){return s.collectionGroup!==null}function wu(s){const e=_e(s);if(e.Ie===null){e.Ie=[];const t=new Set;for(const l of e.explicitOrderBy)e.Ie.push(l),t.add(l.field.canonicalString());const i=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(c){let f=new rt(wt.comparator);return c.filters.forEach((p=>{p.getFlattenedFilters().forEach((y=>{y.isInequality()&&(f=f.add(y.field))}))})),f})(e).forEach((l=>{t.has(l.canonicalString())||l.isKeyField()||e.Ie.push(new Bu(l,i))})),t.has(wt.keyField().canonicalString())||e.Ie.push(new Bu(wt.keyField(),i))}return e.Ie}function Gn(s){const e=_e(s);return e.Ee||(e.Ee=jO(e,wu(s))),e.Ee}function jO(s,e){if(s.limitType==="F")return Ey(s.path,s.collectionGroup,e,s.filters,s.limit,s.startAt,s.endAt);{e=e.map((a=>{const l=a.dir==="desc"?"asc":"desc";return new Bu(a.field,l)}));const t=s.endAt?new Ol(s.endAt.position,s.endAt.inclusive):null,i=s.startAt?new Ol(s.startAt.position,s.startAt.inclusive):null;return Ey(s.path,s.collectionGroup,e,s.filters,s.limit,t,i)}}function xy(s,e){const t=s.filters.concat([e]);return new Yl(s.path,s.collectionGroup,s.explicitOrderBy.slice(),t,s.limit,s.limitType,s.startAt,s.endAt)}function kO(s,e){const t=s.explicitOrderBy.concat([e]);return new Yl(s.path,s.collectionGroup,t,s.filters.slice(),s.limit,s.limitType,s.startAt,s.endAt)}function Lf(s,e,t){return new Yl(s.path,s.collectionGroup,s.explicitOrderBy.slice(),s.filters.slice(),e,t,s.startAt,s.endAt)}function mm(s,e){return sh(Gn(s),Gn(e))&&s.limitType===e.limitType}function uw(s){return`${so(Gn(s))}|lt:${s.limitType}`}function dl(s){return`Query(target=${(function(t){let i=t.path.canonicalString();return t.collectionGroup!==null&&(i+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(i+=`, filters: [${t.filters.map((a=>rw(a))).join(", ")}]`),nh(t.limit)||(i+=", limit: "+t.limit),t.orderBy.length>0&&(i+=`, orderBy: [${t.orderBy.map((a=>(function(c){return`${c.field.canonicalString()} (${c.dir})`})(a))).join(", ")}]`),t.startAt&&(i+=", startAt: ",i+=t.startAt.inclusive?"b:":"a:",i+=t.startAt.position.map((a=>kl(a))).join(",")),t.endAt&&(i+=", endAt: ",i+=t.endAt.inclusive?"a:":"b:",i+=t.endAt.position.map((a=>kl(a))).join(",")),`Target(${i})`})(Gn(s))}; limitType=${s.limitType})`}function rh(s,e){return e.isFoundDocument()&&(function(i,a){const l=a.key.path;return i.collectionGroup!==null?a.key.hasCollectionId(i.collectionGroup)&&i.path.isPrefixOf(l):me.isDocumentKey(i.path)?i.path.isEqual(l):i.path.isImmediateParentOf(l)})(s,e)&&(function(i,a){for(const l of wu(i))if(!l.field.isKeyField()&&a.data.field(l.field)===null)return!1;return!0})(s,e)&&(function(i,a){for(const l of i.filters)if(!l.matches(a))return!1;return!0})(s,e)&&(function(i,a){return!(i.startAt&&!(function(c,f,p){const y=qE(c,f,p);return c.inclusive?y<=0:y<0})(i.startAt,wu(i),a)||i.endAt&&!(function(c,f,p){const y=qE(c,f,p);return c.inclusive?y>=0:y>0})(i.endAt,wu(i),a))})(s,e)}function hw(s){return s.collectionGroup||(s.path.length%2==1?s.path.lastSegment():s.path.get(s.path.length-2))}function dw(s){return(e,t)=>{let i=!1;for(const a of wu(s)){const l=OO(a,e,t);if(l!==0)return l;i=i||a.field.isKeyField()}return 0}}function OO(s,e,t){const i=s.field.isKeyField()?me.comparator(e.key,t.key):(function(l,c,f){const p=c.data.field(l),y=f.data.field(l);return p!==null&&y!==null?ea(p,y):ye(42886)})(s.field,e,t);switch(s.dir){case"asc":return i;case"desc":return-1*i;default:return ye(19790,{direction:s.dir})}}class Ys{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),i=this.inner[t];if(i!==void 0){for(const[a,l]of i)if(this.equalsFn(a,e))return l}}has(e){return this.get(e)!==void 0}set(e,t){const i=this.mapKeyFn(e),a=this.inner[i];if(a===void 0)return this.inner[i]=[[e,t]],void this.innerSize++;for(let l=0;l<a.length;l++)if(this.equalsFn(a[l][0],e))return void(a[l]=[e,t]);a.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),i=this.inner[t];if(i===void 0)return!1;for(let a=0;a<i.length;a++)if(this.equalsFn(i[a][0],e))return i.length===1?delete this.inner[t]:i.splice(a,1),this.innerSize--,!0;return!1}forEach(e){aa(this.inner,((t,i)=>{for(const[a,l]of i)e(a,l)}))}isEmpty(){return GS(this.inner)}size(){return this.innerSize}}const VO=new ft(me.comparator);function Hn(){return VO}const fw=new ft(me.comparator);function pu(...s){let e=fw;for(const t of s)e=e.insert(t.key,t);return e}function mw(s){let e=fw;return s.forEach(((t,i)=>e=e.insert(t,i.overlayedDocument))),e}function ss(){return Au()}function pw(){return Au()}function Au(){return new Ys((s=>s.toString()),((s,e)=>s.isEqual(e)))}const MO=new ft(me.comparator),PO=new rt(me.comparator);function Pe(...s){let e=PO;for(const t of s)e=e.add(t);return e}const LO=new rt(De);function fv(){return LO}function mv(s,e){if(s.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:ku(e)?"-0":e}}function gw(s){return{integerValue:""+s}}function UO(s,e){return OS(e)?gw(e):mv(s,e)}class pm{constructor(){this._=void 0}}function zO(s,e,t){return s instanceof Ml?(function(a,l){const c={fields:{[$S]:{stringValue:KS},[YS]:{timestampValue:{seconds:a.seconds,nanos:a.nanoseconds}}}};return l&&cv(l)&&(l=hm(l)),l&&(c.fields[WS]=l),{mapValue:c}})(t,e):s instanceof Pl?vw(s,e):s instanceof Ll?_w(s,e):(function(a,l){const c=yw(a,l),f=$E(c)+$E(a.Ae);return _y(c)&&_y(a.Ae)?gw(f):mv(a.serializer,f)})(s,e)}function BO(s,e,t){return s instanceof Pl?vw(s,e):s instanceof Ll?_w(s,e):t}function yw(s,e){return s instanceof Fu?(function(i){return _y(i)||(function(l){return!!l&&"doubleValue"in l})(i)})(e)?e:{integerValue:0}:null}class Ml extends pm{}class Pl extends pm{constructor(e){super(),this.elements=e}}function vw(s,e){const t=bw(e);for(const i of s.elements)t.some((a=>us(a,i)))||t.push(i);return{arrayValue:{values:t}}}class Ll extends pm{constructor(e){super(),this.elements=e}}function _w(s,e){let t=bw(e);for(const i of s.elements)t=t.filter((a=>!us(a,i)));return{arrayValue:{values:t}}}class Fu extends pm{constructor(e,t){super(),this.serializer=e,this.Ae=t}}function $E(s){return Tt(s.integerValue||s.doubleValue)}function bw(s){return zu(s)&&s.arrayValue.values?s.arrayValue.values.slice():[]}class Tw{constructor(e,t){this.field=e,this.transform=t}}function FO(s,e){return s.field.isEqual(e.field)&&(function(i,a){return i instanceof Pl&&a instanceof Pl||i instanceof Ll&&a instanceof Ll?Al(i.elements,a.elements,us):i instanceof Fu&&a instanceof Fu?us(i.Ae,a.Ae):i instanceof Ml&&a instanceof Ml})(s.transform,e.transform)}class qO{constructor(e,t){this.version=e,this.transformResults=t}}class xt{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new xt}static exists(e){return new xt(void 0,e)}static updateTime(e){return new xt(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function gf(s,e){return s.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(s.updateTime):s.exists===void 0||s.exists===e.isFoundDocument()}class gm{}function Ew(s,e){if(!s.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return s.isNoDocument()?new Jl(s.key,xt.none()):new Xl(s.key,s.data,xt.none());{const t=s.data,i=on.empty();let a=new rt(wt.comparator);for(let l of e.fields)if(!a.has(l)){let c=t.field(l);c===null&&l.length>1&&(l=l.popLast(),c=t.field(l)),c===null?i.delete(l):i.set(l,c),a=a.add(l)}return new Xs(s.key,i,new Rn(a.toArray()),xt.none())}}function HO(s,e,t){s instanceof Xl?(function(a,l,c){const f=a.value.clone(),p=YE(a.fieldTransforms,l,c.transformResults);f.setAll(p),l.convertToFoundDocument(c.version,f).setHasCommittedMutations()})(s,e,t):s instanceof Xs?(function(a,l,c){if(!gf(a.precondition,l))return void l.convertToUnknownDocument(c.version);const f=YE(a.fieldTransforms,l,c.transformResults),p=l.data;p.setAll(xw(a)),p.setAll(f),l.convertToFoundDocument(c.version,p).setHasCommittedMutations()})(s,e,t):(function(a,l,c){l.convertToNoDocument(c.version).setHasCommittedMutations()})(0,e,t)}function Iu(s,e,t,i){return s instanceof Xl?(function(l,c,f,p){if(!gf(l.precondition,c))return f;const y=l.value.clone(),v=XE(l.fieldTransforms,p,c);return y.setAll(v),c.convertToFoundDocument(c.version,y).setHasLocalMutations(),null})(s,e,t,i):s instanceof Xs?(function(l,c,f,p){if(!gf(l.precondition,c))return f;const y=XE(l.fieldTransforms,p,c),v=c.data;return v.setAll(xw(l)),v.setAll(y),c.convertToFoundDocument(c.version,v).setHasLocalMutations(),f===null?null:f.unionWith(l.fieldMask.fields).unionWith(l.fieldTransforms.map((b=>b.field)))})(s,e,t,i):(function(l,c,f){return gf(l.precondition,c)?(c.convertToNoDocument(c.version).setHasLocalMutations(),null):f})(s,e,t)}function GO(s,e){let t=null;for(const i of s.fieldTransforms){const a=e.data.field(i.field),l=yw(i.transform,a||null);l!=null&&(t===null&&(t=on.empty()),t.set(i.field,l))}return t||null}function WE(s,e){return s.type===e.type&&!!s.key.isEqual(e.key)&&!!s.precondition.isEqual(e.precondition)&&!!(function(i,a){return i===void 0&&a===void 0||!(!i||!a)&&Al(i,a,((l,c)=>FO(l,c)))})(s.fieldTransforms,e.fieldTransforms)&&(s.type===0?s.value.isEqual(e.value):s.type!==1||s.data.isEqual(e.data)&&s.fieldMask.isEqual(e.fieldMask))}class Xl extends gm{constructor(e,t,i,a=[]){super(),this.key=e,this.value=t,this.precondition=i,this.fieldTransforms=a,this.type=0}getFieldMask(){return null}}class Xs extends gm{constructor(e,t,i,a,l=[]){super(),this.key=e,this.data=t,this.fieldMask=i,this.precondition=a,this.fieldTransforms=l,this.type=1}getFieldMask(){return this.fieldMask}}function xw(s){const e=new Map;return s.fieldMask.fields.forEach((t=>{if(!t.isEmpty()){const i=s.data.field(t);e.set(t,i)}})),e}function YE(s,e,t){const i=new Map;be(s.length===t.length,32656,{Ve:t.length,de:s.length});for(let a=0;a<t.length;a++){const l=s[a],c=l.transform,f=e.data.field(l.field);i.set(l.field,BO(c,f,t[a]))}return i}function XE(s,e,t){const i=new Map;for(const a of s){const l=a.transform,c=t.data.field(a.field);i.set(a.field,zO(l,c,e))}return i}class Jl extends gm{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class pv extends gm{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}class gv{constructor(e,t,i,a){this.batchId=e,this.localWriteTime=t,this.baseMutations=i,this.mutations=a}applyToRemoteDocument(e,t){const i=t.mutationResults;for(let a=0;a<this.mutations.length;a++){const l=this.mutations[a];l.key.isEqual(e.key)&&HO(l,e,i[a])}}applyToLocalView(e,t){for(const i of this.baseMutations)i.key.isEqual(e.key)&&(t=Iu(i,e,t,this.localWriteTime));for(const i of this.mutations)i.key.isEqual(e.key)&&(t=Iu(i,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const i=pw();return this.mutations.forEach((a=>{const l=e.get(a.key),c=l.overlayedDocument;let f=this.applyToLocalView(c,l.mutatedFields);f=t.has(a.key)?null:f;const p=Ew(c,f);p!==null&&i.set(a.key,p),c.isValidDocument()||c.convertToNoDocument(Se.min())})),i}keys(){return this.mutations.reduce(((e,t)=>e.add(t.key)),Pe())}isEqual(e){return this.batchId===e.batchId&&Al(this.mutations,e.mutations,((t,i)=>WE(t,i)))&&Al(this.baseMutations,e.baseMutations,((t,i)=>WE(t,i)))}}class yv{constructor(e,t,i,a){this.batch=e,this.commitVersion=t,this.mutationResults=i,this.docVersions=a}static from(e,t,i){be(e.mutations.length===i.length,58842,{me:e.mutations.length,fe:i.length});let a=(function(){return MO})();const l=e.mutations;for(let c=0;c<l.length;c++)a=a.insert(l[c].key,i[c].version);return new yv(e,t,i,a)}}class vv{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}class QO{constructor(e,t){this.count=e,this.unchangedNames=t}}var Ft,Ke;function Sw(s){switch(s){case te.OK:return ye(64938);case te.CANCELLED:case te.UNKNOWN:case te.DEADLINE_EXCEEDED:case te.RESOURCE_EXHAUSTED:case te.INTERNAL:case te.UNAVAILABLE:case te.UNAUTHENTICATED:return!1;case te.INVALID_ARGUMENT:case te.NOT_FOUND:case te.ALREADY_EXISTS:case te.PERMISSION_DENIED:case te.FAILED_PRECONDITION:case te.ABORTED:case te.OUT_OF_RANGE:case te.UNIMPLEMENTED:case te.DATA_LOSS:return!0;default:return ye(15467,{code:s})}}function ww(s){if(s===void 0)return kt("GRPC error has no .code"),te.UNKNOWN;switch(s){case Ft.OK:return te.OK;case Ft.CANCELLED:return te.CANCELLED;case Ft.UNKNOWN:return te.UNKNOWN;case Ft.DEADLINE_EXCEEDED:return te.DEADLINE_EXCEEDED;case Ft.RESOURCE_EXHAUSTED:return te.RESOURCE_EXHAUSTED;case Ft.INTERNAL:return te.INTERNAL;case Ft.UNAVAILABLE:return te.UNAVAILABLE;case Ft.UNAUTHENTICATED:return te.UNAUTHENTICATED;case Ft.INVALID_ARGUMENT:return te.INVALID_ARGUMENT;case Ft.NOT_FOUND:return te.NOT_FOUND;case Ft.ALREADY_EXISTS:return te.ALREADY_EXISTS;case Ft.PERMISSION_DENIED:return te.PERMISSION_DENIED;case Ft.FAILED_PRECONDITION:return te.FAILED_PRECONDITION;case Ft.ABORTED:return te.ABORTED;case Ft.OUT_OF_RANGE:return te.OUT_OF_RANGE;case Ft.UNIMPLEMENTED:return te.UNIMPLEMENTED;case Ft.DATA_LOSS:return te.DATA_LOSS;default:return ye(39323,{code:s})}}(Ke=Ft||(Ft={}))[Ke.OK=0]="OK",Ke[Ke.CANCELLED=1]="CANCELLED",Ke[Ke.UNKNOWN=2]="UNKNOWN",Ke[Ke.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Ke[Ke.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Ke[Ke.NOT_FOUND=5]="NOT_FOUND",Ke[Ke.ALREADY_EXISTS=6]="ALREADY_EXISTS",Ke[Ke.PERMISSION_DENIED=7]="PERMISSION_DENIED",Ke[Ke.UNAUTHENTICATED=16]="UNAUTHENTICATED",Ke[Ke.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Ke[Ke.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Ke[Ke.ABORTED=10]="ABORTED",Ke[Ke.OUT_OF_RANGE=11]="OUT_OF_RANGE",Ke[Ke.UNIMPLEMENTED=12]="UNIMPLEMENTED",Ke[Ke.INTERNAL=13]="INTERNAL",Ke[Ke.UNAVAILABLE=14]="UNAVAILABLE",Ke[Ke.DATA_LOSS=15]="DATA_LOSS";function KO(){return new TextEncoder}const $O=new $r([4294967295,4294967295],0);function JE(s){const e=KO().encode(s),t=new _S;return t.update(e),new Uint8Array(t.digest())}function ZE(s){const e=new DataView(s.buffer),t=e.getUint32(0,!0),i=e.getUint32(4,!0),a=e.getUint32(8,!0),l=e.getUint32(12,!0);return[new $r([t,i],0),new $r([a,l],0)]}class _v{constructor(e,t,i){if(this.bitmap=e,this.padding=t,this.hashCount=i,t<0||t>=8)throw new gu(`Invalid padding: ${t}`);if(i<0)throw new gu(`Invalid hash count: ${i}`);if(e.length>0&&this.hashCount===0)throw new gu(`Invalid hash count: ${i}`);if(e.length===0&&t!==0)throw new gu(`Invalid padding when bitmap length is 0: ${t}`);this.ge=8*e.length-t,this.pe=$r.fromNumber(this.ge)}ye(e,t,i){let a=e.add(t.multiply($r.fromNumber(i)));return a.compare($O)===1&&(a=new $r([a.getBits(0),a.getBits(1)],0)),a.modulo(this.pe).toNumber()}we(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.ge===0)return!1;const t=JE(e),[i,a]=ZE(t);for(let l=0;l<this.hashCount;l++){const c=this.ye(i,a,l);if(!this.we(c))return!1}return!0}static create(e,t,i){const a=e%8==0?0:8-e%8,l=new Uint8Array(Math.ceil(e/8)),c=new _v(l,a,t);return i.forEach((f=>c.insert(f))),c}insert(e){if(this.ge===0)return;const t=JE(e),[i,a]=ZE(t);for(let l=0;l<this.hashCount;l++){const c=this.ye(i,a,l);this.be(c)}}be(e){const t=Math.floor(e/8),i=e%8;this.bitmap[t]|=1<<i}}class gu extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}class ah{constructor(e,t,i,a,l){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=i,this.documentUpdates=a,this.resolvedLimboDocuments=l}static createSynthesizedRemoteEventForCurrentChange(e,t,i){const a=new Map;return a.set(e,oh.createSynthesizedTargetChangeForCurrentChange(e,t,i)),new ah(Se.min(),a,new ft(De),Hn(),Pe())}}class oh{constructor(e,t,i,a,l){this.resumeToken=e,this.current=t,this.addedDocuments=i,this.modifiedDocuments=a,this.removedDocuments=l}static createSynthesizedTargetChangeForCurrentChange(e,t,i){return new oh(i,t,Pe(),Pe(),Pe())}}class yf{constructor(e,t,i,a){this.Se=e,this.removedTargetIds=t,this.key=i,this.De=a}}class Aw{constructor(e,t){this.targetId=e,this.Ce=t}}class Iw{constructor(e,t,i=Ot.EMPTY_BYTE_STRING,a=null){this.state=e,this.targetIds=t,this.resumeToken=i,this.cause=a}}class ex{constructor(){this.ve=0,this.Fe=tx(),this.Me=Ot.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return this.ve!==0}get Be(){return this.Oe}Le(e){e.approximateByteSize()>0&&(this.Oe=!0,this.Me=e)}ke(){let e=Pe(),t=Pe(),i=Pe();return this.Fe.forEach(((a,l)=>{switch(l){case 0:e=e.add(a);break;case 2:t=t.add(a);break;case 1:i=i.add(a);break;default:ye(38017,{changeType:l})}})),new oh(this.Me,this.xe,e,t,i)}Ke(){this.Oe=!1,this.Fe=tx()}qe(e,t){this.Oe=!0,this.Fe=this.Fe.insert(e,t)}Ue(e){this.Oe=!0,this.Fe=this.Fe.remove(e)}$e(){this.ve+=1}We(){this.ve-=1,be(this.ve>=0,3241,{ve:this.ve})}Qe(){this.Oe=!0,this.xe=!0}}class WO{constructor(e){this.Ge=e,this.ze=new Map,this.je=Hn(),this.He=Gd(),this.Je=Gd(),this.Ze=new ft(De)}Xe(e){for(const t of e.Se)e.De&&e.De.isFoundDocument()?this.Ye(t,e.De):this.et(t,e.key,e.De);for(const t of e.removedTargetIds)this.et(t,e.key,e.De)}tt(e){this.forEachTarget(e,(t=>{const i=this.nt(t);switch(e.state){case 0:this.rt(t)&&i.Le(e.resumeToken);break;case 1:i.We(),i.Ne||i.Ke(),i.Le(e.resumeToken);break;case 2:i.We(),i.Ne||this.removeTarget(t);break;case 3:this.rt(t)&&(i.Qe(),i.Le(e.resumeToken));break;case 4:this.rt(t)&&(this.it(t),i.Le(e.resumeToken));break;default:ye(56790,{state:e.state})}}))}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.ze.forEach(((i,a)=>{this.rt(a)&&t(a)}))}st(e){const t=e.targetId,i=e.Ce.count,a=this.ot(t);if(a){const l=a.target;if(Mf(l))if(i===0){const c=new me(l.path);this.et(t,c,Et.newNoDocument(c,Se.min()))}else be(i===1,20013,{expectedCount:i});else{const c=this._t(t);if(c!==i){const f=this.ut(e),p=f?this.ct(f,e,c):1;if(p!==0){this.it(t);const y=p===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ze=this.Ze.insert(t,y)}}}}}ut(e){const t=e.Ce.unchangedNames;if(!t||!t.bits)return null;const{bits:{bitmap:i="",padding:a=0},hashCount:l=0}=t;let c,f;try{c=$s(i).toUint8Array()}catch(p){if(p instanceof QS)return wl("Decoding the base64 bloom filter in existence filter failed ("+p.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw p}try{f=new _v(c,a,l)}catch(p){return wl(p instanceof gu?"BloomFilter error: ":"Applying bloom filter failed: ",p),null}return f.ge===0?null:f}ct(e,t,i){return t.Ce.count===i-this.Pt(e,t.targetId)?0:2}Pt(e,t){const i=this.Ge.getRemoteKeysForTarget(t);let a=0;return i.forEach((l=>{const c=this.Ge.ht(),f=`projects/${c.projectId}/databases/${c.database}/documents/${l.path.canonicalString()}`;e.mightContain(f)||(this.et(t,l,null),a++)})),a}Tt(e){const t=new Map;this.ze.forEach(((l,c)=>{const f=this.ot(c);if(f){if(l.current&&Mf(f.target)){const p=new me(f.target.path);this.It(p).has(c)||this.Et(c,p)||this.et(c,p,Et.newNoDocument(p,e))}l.Be&&(t.set(c,l.ke()),l.Ke())}}));let i=Pe();this.Je.forEach(((l,c)=>{let f=!0;c.forEachWhile((p=>{const y=this.ot(p);return!y||y.purpose==="TargetPurposeLimboResolution"||(f=!1,!1)})),f&&(i=i.add(l))})),this.je.forEach(((l,c)=>c.setReadTime(e)));const a=new ah(e,t,this.Ze,this.je,i);return this.je=Hn(),this.He=Gd(),this.Je=Gd(),this.Ze=new ft(De),a}Ye(e,t){if(!this.rt(e))return;const i=this.Et(e,t.key)?2:0;this.nt(e).qe(t.key,i),this.je=this.je.insert(t.key,t),this.He=this.He.insert(t.key,this.It(t.key).add(e)),this.Je=this.Je.insert(t.key,this.Rt(t.key).add(e))}et(e,t,i){if(!this.rt(e))return;const a=this.nt(e);this.Et(e,t)?a.qe(t,1):a.Ue(t),this.Je=this.Je.insert(t,this.Rt(t).delete(e)),this.Je=this.Je.insert(t,this.Rt(t).add(e)),i&&(this.je=this.je.insert(t,i))}removeTarget(e){this.ze.delete(e)}_t(e){const t=this.nt(e).ke();return this.Ge.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}$e(e){this.nt(e).$e()}nt(e){let t=this.ze.get(e);return t||(t=new ex,this.ze.set(e,t)),t}Rt(e){let t=this.Je.get(e);return t||(t=new rt(De),this.Je=this.Je.insert(e,t)),t}It(e){let t=this.He.get(e);return t||(t=new rt(De),this.He=this.He.insert(e,t)),t}rt(e){const t=this.ot(e)!==null;return t||ce("WatchChangeAggregator","Detected inactive target",e),t}ot(e){const t=this.ze.get(e);return t&&t.Ne?null:this.Ge.At(e)}it(e){this.ze.set(e,new ex),this.Ge.getRemoteKeysForTarget(e).forEach((t=>{this.et(e,t,null)}))}Et(e,t){return this.Ge.getRemoteKeysForTarget(e).has(t)}}function Gd(){return new ft(me.comparator)}function tx(){return new ft(me.comparator)}const YO={asc:"ASCENDING",desc:"DESCENDING"},XO={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},JO={and:"AND",or:"OR"};class ZO{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function Sy(s,e){return s.useProto3Json||nh(e)?e:{value:e}}function Ul(s,e){return s.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function Cw(s,e){return s.useProto3Json?e.toBase64():e.toUint8Array()}function eV(s,e){return Ul(s,e.toTimestamp())}function Jt(s){return be(!!s,49232),Se.fromTimestamp((function(t){const i=Ks(t);return new it(i.seconds,i.nanos)})(s))}function bv(s,e){return wy(s,e).canonicalString()}function wy(s,e){const t=(function(a){return new We(["projects",a.projectId,"databases",a.database])})(s).child("documents");return e===void 0?t:t.child(e)}function Rw(s){const e=We.fromString(s);return be(Lw(e),10190,{key:e.toString()}),e}function qu(s,e){return bv(s.databaseId,e.path)}function Fs(s,e){const t=Rw(e);if(t.get(1)!==s.databaseId.projectId)throw new he(te.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+s.databaseId.projectId);if(t.get(3)!==s.databaseId.database)throw new he(te.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+s.databaseId.database);return new me(jw(t))}function Dw(s,e){return bv(s.databaseId,e)}function Nw(s){const e=Rw(s);return e.length===4?We.emptyPath():jw(e)}function Ay(s){return new We(["projects",s.databaseId.projectId,"databases",s.databaseId.database]).canonicalString()}function jw(s){return be(s.length>4&&s.get(4)==="documents",29091,{key:s.toString()}),s.popFirst(5)}function nx(s,e,t){return{name:qu(s,e),fields:t.value.mapValue.fields}}function tV(s,e,t){const i=Fs(s,e.name),a=Jt(e.updateTime),l=e.createTime?Jt(e.createTime):Se.min(),c=new on({mapValue:{fields:e.fields}}),f=Et.newFoundDocument(i,a,l,c);return t&&f.setHasCommittedMutations(),t?f.setHasCommittedMutations():f}function nV(s,e){return"found"in e?(function(i,a){be(!!a.found,43571),a.found.name,a.found.updateTime;const l=Fs(i,a.found.name),c=Jt(a.found.updateTime),f=a.found.createTime?Jt(a.found.createTime):Se.min(),p=new on({mapValue:{fields:a.found.fields}});return Et.newFoundDocument(l,c,f,p)})(s,e):"missing"in e?(function(i,a){be(!!a.missing,3894),be(!!a.readTime,22933);const l=Fs(i,a.missing),c=Jt(a.readTime);return Et.newNoDocument(l,c)})(s,e):ye(7234,{result:e})}function iV(s,e){let t;if("targetChange"in e){e.targetChange;const i=(function(y){return y==="NO_CHANGE"?0:y==="ADD"?1:y==="REMOVE"?2:y==="CURRENT"?3:y==="RESET"?4:ye(39313,{state:y})})(e.targetChange.targetChangeType||"NO_CHANGE"),a=e.targetChange.targetIds||[],l=(function(y,v){return y.useProto3Json?(be(v===void 0||typeof v=="string",58123),Ot.fromBase64String(v||"")):(be(v===void 0||v instanceof Buffer||v instanceof Uint8Array,16193),Ot.fromUint8Array(v||new Uint8Array))})(s,e.targetChange.resumeToken),c=e.targetChange.cause,f=c&&(function(y){const v=y.code===void 0?te.UNKNOWN:ww(y.code);return new he(v,y.message||"")})(c);t=new Iw(i,a,l,f||null)}else if("documentChange"in e){e.documentChange;const i=e.documentChange;i.document,i.document.name,i.document.updateTime;const a=Fs(s,i.document.name),l=Jt(i.document.updateTime),c=i.document.createTime?Jt(i.document.createTime):Se.min(),f=new on({mapValue:{fields:i.document.fields}}),p=Et.newFoundDocument(a,l,c,f),y=i.targetIds||[],v=i.removedTargetIds||[];t=new yf(y,v,p.key,p)}else if("documentDelete"in e){e.documentDelete;const i=e.documentDelete;i.document;const a=Fs(s,i.document),l=i.readTime?Jt(i.readTime):Se.min(),c=Et.newNoDocument(a,l),f=i.removedTargetIds||[];t=new yf([],f,c.key,c)}else if("documentRemove"in e){e.documentRemove;const i=e.documentRemove;i.document;const a=Fs(s,i.document),l=i.removedTargetIds||[];t=new yf([],l,a,null)}else{if(!("filter"in e))return ye(11601,{Vt:e});{e.filter;const i=e.filter;i.targetId;const{count:a=0,unchangedNames:l}=i,c=new QO(a,l),f=i.targetId;t=new Aw(f,c)}}return t}function Hu(s,e){let t;if(e instanceof Xl)t={update:nx(s,e.key,e.value)};else if(e instanceof Jl)t={delete:qu(s,e.key)};else if(e instanceof Xs)t={update:nx(s,e.key,e.data),updateMask:cV(e.fieldMask)};else{if(!(e instanceof pv))return ye(16599,{dt:e.type});t={verify:qu(s,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map((i=>(function(l,c){const f=c.transform;if(f instanceof Ml)return{fieldPath:c.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(f instanceof Pl)return{fieldPath:c.field.canonicalString(),appendMissingElements:{values:f.elements}};if(f instanceof Ll)return{fieldPath:c.field.canonicalString(),removeAllFromArray:{values:f.elements}};if(f instanceof Fu)return{fieldPath:c.field.canonicalString(),increment:f.Ae};throw ye(20930,{transform:c.transform})})(0,i)))),e.precondition.isNone||(t.currentDocument=(function(a,l){return l.updateTime!==void 0?{updateTime:eV(a,l.updateTime)}:l.exists!==void 0?{exists:l.exists}:ye(27497)})(s,e.precondition)),t}function Iy(s,e){const t=e.currentDocument?(function(l){return l.updateTime!==void 0?xt.updateTime(Jt(l.updateTime)):l.exists!==void 0?xt.exists(l.exists):xt.none()})(e.currentDocument):xt.none(),i=e.updateTransforms?e.updateTransforms.map((a=>(function(c,f){let p=null;if("setToServerValue"in f)be(f.setToServerValue==="REQUEST_TIME",16630,{proto:f}),p=new Ml;else if("appendMissingElements"in f){const v=f.appendMissingElements.values||[];p=new Pl(v)}else if("removeAllFromArray"in f){const v=f.removeAllFromArray.values||[];p=new Ll(v)}else"increment"in f?p=new Fu(c,f.increment):ye(16584,{proto:f});const y=wt.fromServerFormat(f.fieldPath);return new Tw(y,p)})(s,a))):[];if(e.update){e.update.name;const a=Fs(s,e.update.name),l=new on({mapValue:{fields:e.update.fields}});if(e.updateMask){const c=(function(p){const y=p.fieldPaths||[];return new Rn(y.map((v=>wt.fromServerFormat(v))))})(e.updateMask);return new Xs(a,l,c,t,i)}return new Xl(a,l,t,i)}if(e.delete){const a=Fs(s,e.delete);return new Jl(a,t)}if(e.verify){const a=Fs(s,e.verify);return new pv(a,t)}return ye(1463,{proto:e})}function sV(s,e){return s&&s.length>0?(be(e!==void 0,14353),s.map((t=>(function(a,l){let c=a.updateTime?Jt(a.updateTime):Jt(l);return c.isEqual(Se.min())&&(c=Jt(l)),new qO(c,a.transformResults||[])})(t,e)))):[]}function kw(s,e){return{documents:[Dw(s,e.path)]}}function Ow(s,e){const t={structuredQuery:{}},i=e.path;let a;e.collectionGroup!==null?(a=i,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(a=i.popLast(),t.structuredQuery.from=[{collectionId:i.lastSegment()}]),t.parent=Dw(s,a);const l=(function(y){if(y.length!==0)return Pw(st.create(y,"and"))})(e.filters);l&&(t.structuredQuery.where=l);const c=(function(y){if(y.length!==0)return y.map((v=>(function(x){return{field:fl(x.field),direction:aV(x.dir)}})(v)))})(e.orderBy);c&&(t.structuredQuery.orderBy=c);const f=Sy(s,e.limit);return f!==null&&(t.structuredQuery.limit=f),e.startAt&&(t.structuredQuery.startAt=(function(y){return{before:y.inclusive,values:y.position}})(e.startAt)),e.endAt&&(t.structuredQuery.endAt=(function(y){return{before:!y.inclusive,values:y.position}})(e.endAt)),{ft:t,parent:a}}function Vw(s){let e=Nw(s.parent);const t=s.structuredQuery,i=t.from?t.from.length:0;let a=null;if(i>0){be(i===1,65062);const v=t.from[0];v.allDescendants?a=v.collectionId:e=e.child(v.collectionId)}let l=[];t.where&&(l=(function(b){const x=Mw(b);return x instanceof st&&dv(x)?x.getFilters():[x]})(t.where));let c=[];t.orderBy&&(c=(function(b){return b.map((x=>(function(O){return new Bu(ml(O.field),(function(M){switch(M){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}})(O.direction))})(x)))})(t.orderBy));let f=null;t.limit&&(f=(function(b){let x;return x=typeof b=="object"?b.value:b,nh(x)?null:x})(t.limit));let p=null;t.startAt&&(p=(function(b){const x=!!b.before,k=b.values||[];return new Ol(k,x)})(t.startAt));let y=null;return t.endAt&&(y=(function(b){const x=!b.before,k=b.values||[];return new Ol(k,x)})(t.endAt)),lw(e,a,c,l,f,"F",p,y)}function rV(s,e){const t=(function(a){switch(a){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return ye(28987,{purpose:a})}})(e.purpose);return t==null?null:{"goog-listen-tags":t}}function Mw(s){return s.unaryFilter!==void 0?(function(t){switch(t.unaryFilter.op){case"IS_NAN":const i=ml(t.unaryFilter.field);return qe.create(i,"==",{doubleValue:NaN});case"IS_NULL":const a=ml(t.unaryFilter.field);return qe.create(a,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const l=ml(t.unaryFilter.field);return qe.create(l,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const c=ml(t.unaryFilter.field);return qe.create(c,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return ye(61313);default:return ye(60726)}})(s):s.fieldFilter!==void 0?(function(t){return qe.create(ml(t.fieldFilter.field),(function(a){switch(a){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return ye(58110);default:return ye(50506)}})(t.fieldFilter.op),t.fieldFilter.value)})(s):s.compositeFilter!==void 0?(function(t){return st.create(t.compositeFilter.filters.map((i=>Mw(i))),(function(a){switch(a){case"AND":return"and";case"OR":return"or";default:return ye(1026)}})(t.compositeFilter.op))})(s):ye(30097,{filter:s})}function aV(s){return YO[s]}function oV(s){return XO[s]}function lV(s){return JO[s]}function fl(s){return{fieldPath:s.canonicalString()}}function ml(s){return wt.fromServerFormat(s.fieldPath)}function Pw(s){return s instanceof qe?(function(t){if(t.op==="=="){if(zE(t.value))return{unaryFilter:{field:fl(t.field),op:"IS_NAN"}};if(UE(t.value))return{unaryFilter:{field:fl(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(zE(t.value))return{unaryFilter:{field:fl(t.field),op:"IS_NOT_NAN"}};if(UE(t.value))return{unaryFilter:{field:fl(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:fl(t.field),op:oV(t.op),value:t.value}}})(s):s instanceof st?(function(t){const i=t.getFilters().map((a=>Pw(a)));return i.length===1?i[0]:{compositeFilter:{op:lV(t.op),filters:i}}})(s):ye(54877,{filter:s})}function cV(s){const e=[];return s.fields.forEach((t=>e.push(t.canonicalString()))),{fieldPaths:e}}function Lw(s){return s.length>=4&&s.get(0)==="projects"&&s.get(2)==="databases"}function Uw(s){return!!s&&typeof s._toProto=="function"&&s._protoValueType==="ProtoValue"}class zs{constructor(e,t,i,a,l=Se.min(),c=Se.min(),f=Ot.EMPTY_BYTE_STRING,p=null){this.target=e,this.targetId=t,this.purpose=i,this.sequenceNumber=a,this.snapshotVersion=l,this.lastLimboFreeSnapshotVersion=c,this.resumeToken=f,this.expectedCount=p}withSequenceNumber(e){return new zs(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new zs(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new zs(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new zs(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}class zw{constructor(e){this.yt=e}}function uV(s,e){let t;if(e.document)t=tV(s.yt,e.document,!!e.hasCommittedMutations);else if(e.noDocument){const i=me.fromSegments(e.noDocument.path),a=ao(e.noDocument.readTime);t=Et.newNoDocument(i,a),e.hasCommittedMutations&&t.setHasCommittedMutations()}else{if(!e.unknownDocument)return ye(56709);{const i=me.fromSegments(e.unknownDocument.path),a=ao(e.unknownDocument.version);t=Et.newUnknownDocument(i,a)}}return e.readTime&&t.setReadTime((function(a){const l=new it(a[0],a[1]);return Se.fromTimestamp(l)})(e.readTime)),t}function ix(s,e){const t=e.key,i={prefixPath:t.getCollectionPath().popLast().toArray(),collectionGroup:t.collectionGroup,documentId:t.path.lastSegment(),readTime:Uf(e.readTime),hasCommittedMutations:e.hasCommittedMutations};if(e.isFoundDocument())i.document=(function(l,c){return{name:qu(l,c.key),fields:c.data.value.mapValue.fields,updateTime:Ul(l,c.version.toTimestamp()),createTime:Ul(l,c.createTime.toTimestamp())}})(s.yt,e);else if(e.isNoDocument())i.noDocument={path:t.path.toArray(),readTime:ro(e.version)};else{if(!e.isUnknownDocument())return ye(57904,{document:e});i.unknownDocument={path:t.path.toArray(),version:ro(e.version)}}return i}function Uf(s){const e=s.toTimestamp();return[e.seconds,e.nanoseconds]}function ro(s){const e=s.toTimestamp();return{seconds:e.seconds,nanoseconds:e.nanoseconds}}function ao(s){const e=new it(s.seconds,s.nanoseconds);return Se.fromTimestamp(e)}function Qa(s,e){const t=(e.baseMutations||[]).map((l=>Iy(s.yt,l)));for(let l=0;l<e.mutations.length-1;++l){const c=e.mutations[l];if(l+1<e.mutations.length&&e.mutations[l+1].transform!==void 0){const f=e.mutations[l+1];c.updateTransforms=f.transform.fieldTransforms,e.mutations.splice(l+1,1),++l}}const i=e.mutations.map((l=>Iy(s.yt,l))),a=it.fromMillis(e.localWriteTimeMs);return new gv(e.batchId,a,t,i)}function yu(s){const e=ao(s.readTime),t=s.lastLimboFreeSnapshotVersion!==void 0?ao(s.lastLimboFreeSnapshotVersion):Se.min();let i;return i=(function(l){return l.documents!==void 0})(s.query)?(function(l){const c=l.documents.length;return be(c===1,1966,{count:c}),Gn(fm(Nw(l.documents[0])))})(s.query):(function(l){return Gn(Vw(l))})(s.query),new zs(i,s.targetId,"TargetPurposeListen",s.lastListenSequenceNumber,e,t,Ot.fromBase64String(s.resumeToken))}function Bw(s,e){const t=ro(e.snapshotVersion),i=ro(e.lastLimboFreeSnapshotVersion);let a;a=Mf(e.target)?kw(s.yt,e.target):Ow(s.yt,e.target).ft;const l=e.resumeToken.toBase64();return{targetId:e.targetId,canonicalId:so(e.target),readTime:t,resumeToken:l,lastListenSequenceNumber:e.sequenceNumber,lastLimboFreeSnapshotVersion:i,query:a}}function Fw(s){const e=Vw({parent:s.parent,structuredQuery:s.structuredQuery});return s.limitType==="LAST"?Lf(e,e.limit,"L"):e}function qg(s,e){return new vv(e.largestBatchId,Iy(s.yt,e.overlayMutation))}function sx(s,e){const t=e.path.lastSegment();return[s,mn(e.path.popLast()),t]}function rx(s,e,t,i){return{indexId:s,uid:e,sequenceNumber:t,readTime:ro(i.readTime),documentKey:mn(i.documentKey.path),largestBatchId:i.largestBatchId}}class hV{getBundleMetadata(e,t){return ax(e).get(t).next((i=>{if(i)return(function(l){return{id:l.bundleId,createTime:ao(l.createTime),version:l.version}})(i)}))}saveBundleMetadata(e,t){return ax(e).put((function(a){return{bundleId:a.id,createTime:ro(Jt(a.createTime)),version:a.version}})(t))}getNamedQuery(e,t){return ox(e).get(t).next((i=>{if(i)return(function(l){return{name:l.name,query:Fw(l.bundledQuery),readTime:ao(l.readTime)}})(i)}))}saveNamedQuery(e,t){return ox(e).put((function(a){return{name:a.name,readTime:ro(Jt(a.readTime)),bundledQuery:a.bundledQuery}})(t))}}function ax(s){return Kt(s,lm)}function ox(s){return Kt(s,cm)}class ym{constructor(e,t){this.serializer=e,this.userId=t}static wt(e,t){const i=t.uid||"";return new ym(e,i)}getOverlay(e,t){return au(e).get(sx(this.userId,t)).next((i=>i?qg(this.serializer,i):null))}getOverlays(e,t){const i=ss();return q.forEach(t,(a=>this.getOverlay(e,a).next((l=>{l!==null&&i.set(a,l)})))).next((()=>i))}saveOverlays(e,t,i){const a=[];return i.forEach(((l,c)=>{const f=new vv(t,c);a.push(this.bt(e,f))})),q.waitFor(a)}removeOverlaysForBatchId(e,t,i){const a=new Set;t.forEach((c=>a.add(mn(c.getCollectionPath()))));const l=[];return a.forEach((c=>{const f=IDBKeyRange.bound([this.userId,c,i],[this.userId,c,i+1],!1,!0);l.push(au(e).X(gy,f))})),q.waitFor(l)}getOverlaysForCollection(e,t,i){const a=ss(),l=mn(t),c=IDBKeyRange.bound([this.userId,l,i],[this.userId,l,Number.POSITIVE_INFINITY],!0);return au(e).H(gy,c).next((f=>{for(const p of f){const y=qg(this.serializer,p);a.set(y.getKey(),y)}return a}))}getOverlaysForCollectionGroup(e,t,i,a){const l=ss();let c;const f=IDBKeyRange.bound([this.userId,t,i],[this.userId,t,Number.POSITIVE_INFINITY],!0);return au(e).ee({index:zS,range:f},((p,y,v)=>{const b=qg(this.serializer,y);l.size()<a||b.largestBatchId===c?(l.set(b.getKey(),b),c=b.largestBatchId):v.done()})).next((()=>l))}bt(e,t){return au(e).put((function(a,l,c){const[f,p,y]=sx(l,c.mutation.key);return{userId:l,collectionPath:p,documentId:y,collectionGroup:c.mutation.key.getCollectionGroup(),largestBatchId:c.largestBatchId,overlayMutation:Hu(a.yt,c.mutation)}})(this.serializer,this.userId,t))}}function au(s){return Kt(s,um)}class dV{St(e){return Kt(e,ov)}getSessionToken(e){return this.St(e).get("sessionToken").next((t=>{const i=t?.value;return i?Ot.fromUint8Array(i):Ot.EMPTY_BYTE_STRING}))}setSessionToken(e,t){return this.St(e).put({name:"sessionToken",value:t.toUint8Array()})}}class Ka{constructor(){}Dt(e,t){this.Ct(e,t),t.vt()}Ct(e,t){if("nullValue"in e)this.Ft(t,5);else if("booleanValue"in e)this.Ft(t,10),t.Mt(e.booleanValue?1:0);else if("integerValue"in e)this.Ft(t,15),t.Mt(Tt(e.integerValue));else if("doubleValue"in e){const i=Tt(e.doubleValue);isNaN(i)?this.Ft(t,13):(this.Ft(t,15),ku(i)?t.Mt(0):t.Mt(i))}else if("timestampValue"in e){let i=e.timestampValue;this.Ft(t,20),typeof i=="string"&&(i=Ks(i)),t.xt(`${i.seconds||""}`),t.Mt(i.nanos||0)}else if("stringValue"in e)this.Ot(e.stringValue,t),this.Nt(t);else if("bytesValue"in e)this.Ft(t,30),t.Bt($s(e.bytesValue)),this.Nt(t);else if("referenceValue"in e)this.Lt(e.referenceValue,t);else if("geoPointValue"in e){const i=e.geoPointValue;this.Ft(t,45),t.Mt(i.latitude||0),t.Mt(i.longitude||0)}else"mapValue"in e?JS(e)?this.Ft(t,Number.MAX_SAFE_INTEGER):dm(e)?this.kt(e.mapValue,t):(this.Kt(e.mapValue,t),this.Nt(t)):"arrayValue"in e?(this.qt(e.arrayValue,t),this.Nt(t)):ye(19022,{Ut:e})}Ot(e,t){this.Ft(t,25),this.$t(e,t)}$t(e,t){t.xt(e)}Kt(e,t){const i=e.fields||{};this.Ft(t,55);for(const a of Object.keys(i))this.Ot(a,t),this.Ct(i[a],t)}kt(e,t){const i=e.fields||{};this.Ft(t,53);const a=jl,l=i[a].arrayValue?.values?.length||0;this.Ft(t,15),t.Mt(Tt(l)),this.Ot(a,t),this.Ct(i[a],t)}qt(e,t){const i=e.values||[];this.Ft(t,50);for(const a of i)this.Ct(a,t)}Lt(e,t){this.Ft(t,37),me.fromName(e).path.forEach((i=>{this.Ft(t,60),this.$t(i,t)}))}Ft(e,t){e.Mt(t)}Nt(e){e.Mt(2)}}Ka.Wt=new Ka;const al=255;function fV(s){if(s===0)return 8;let e=0;return s>>4||(e+=4,s<<=4),s>>6||(e+=2,s<<=2),s>>7||(e+=1),e}function lx(s){const e=64-(function(i){let a=0;for(let l=0;l<8;++l){const c=fV(255&i[l]);if(a+=c,c!==8)break}return a})(s);return Math.ceil(e/8)}class mV{constructor(){this.buffer=new Uint8Array(1024),this.position=0}Qt(e){const t=e[Symbol.iterator]();let i=t.next();for(;!i.done;)this.Gt(i.value),i=t.next();this.zt()}jt(e){const t=e[Symbol.iterator]();let i=t.next();for(;!i.done;)this.Ht(i.value),i=t.next();this.Jt()}Zt(e){for(const t of e){const i=t.charCodeAt(0);if(i<128)this.Gt(i);else if(i<2048)this.Gt(960|i>>>6),this.Gt(128|63&i);else if(t<"\uD800"||"\uDBFF"<t)this.Gt(480|i>>>12),this.Gt(128|63&i>>>6),this.Gt(128|63&i);else{const a=t.codePointAt(0);this.Gt(240|a>>>18),this.Gt(128|63&a>>>12),this.Gt(128|63&a>>>6),this.Gt(128|63&a)}}this.zt()}Xt(e){for(const t of e){const i=t.charCodeAt(0);if(i<128)this.Ht(i);else if(i<2048)this.Ht(960|i>>>6),this.Ht(128|63&i);else if(t<"\uD800"||"\uDBFF"<t)this.Ht(480|i>>>12),this.Ht(128|63&i>>>6),this.Ht(128|63&i);else{const a=t.codePointAt(0);this.Ht(240|a>>>18),this.Ht(128|63&a>>>12),this.Ht(128|63&a>>>6),this.Ht(128|63&a)}}this.Jt()}Yt(e){const t=this.en(e),i=lx(t);this.tn(1+i),this.buffer[this.position++]=255&i;for(let a=t.length-i;a<t.length;++a)this.buffer[this.position++]=255&t[a]}nn(e){const t=this.en(e),i=lx(t);this.tn(1+i),this.buffer[this.position++]=~(255&i);for(let a=t.length-i;a<t.length;++a)this.buffer[this.position++]=~(255&t[a])}rn(){this.sn(al),this.sn(255)}_n(){this.an(al),this.an(255)}reset(){this.position=0}seed(e){this.tn(e.length),this.buffer.set(e,this.position),this.position+=e.length}un(){return this.buffer.slice(0,this.position)}en(e){const t=(function(l){const c=new DataView(new ArrayBuffer(8));return c.setFloat64(0,l,!1),new Uint8Array(c.buffer)})(e),i=!!(128&t[0]);t[0]^=i?255:128;for(let a=1;a<t.length;++a)t[a]^=i?255:0;return t}Gt(e){const t=255&e;t===0?(this.sn(0),this.sn(255)):t===al?(this.sn(al),this.sn(0)):this.sn(t)}Ht(e){const t=255&e;t===0?(this.an(0),this.an(255)):t===al?(this.an(al),this.an(0)):this.an(e)}zt(){this.sn(0),this.sn(1)}Jt(){this.an(0),this.an(1)}sn(e){this.tn(1),this.buffer[this.position++]=e}an(e){this.tn(1),this.buffer[this.position++]=~e}tn(e){const t=e+this.position;if(t<=this.buffer.length)return;let i=2*this.buffer.length;i<t&&(i=t);const a=new Uint8Array(i);a.set(this.buffer),this.buffer=a}}class pV{constructor(e){this.cn=e}Bt(e){this.cn.Qt(e)}xt(e){this.cn.Zt(e)}Mt(e){this.cn.Yt(e)}vt(){this.cn.rn()}}class gV{constructor(e){this.cn=e}Bt(e){this.cn.jt(e)}xt(e){this.cn.Xt(e)}Mt(e){this.cn.nn(e)}vt(){this.cn._n()}}class ou{constructor(){this.cn=new mV,this.ascending=new pV(this.cn),this.descending=new gV(this.cn)}seed(e){this.cn.seed(e)}ln(e){return e===0?this.ascending:this.descending}un(){return this.cn.un()}reset(){this.cn.reset()}}class $a{constructor(e,t,i,a){this.hn=e,this.Pn=t,this.Tn=i,this.In=a}En(){const e=this.In.length,t=e===0||this.In[e-1]===255?e+1:e,i=new Uint8Array(t);return i.set(this.In,0),t!==e?i.set([0],this.In.length):++i[i.length-1],new $a(this.hn,this.Pn,this.Tn,i)}Rn(e,t,i){return{indexId:this.hn,uid:e,arrayValue:vf(this.Tn),directionalValue:vf(this.In),orderedDocumentKey:vf(t),documentKey:i.path.toArray()}}An(e,t,i){const a=this.Rn(e,t,i);return[a.indexId,a.uid,a.arrayValue,a.directionalValue,a.orderedDocumentKey,a.documentKey]}}function Vr(s,e){let t=s.hn-e.hn;return t!==0?t:(t=cx(s.Tn,e.Tn),t!==0?t:(t=cx(s.In,e.In),t!==0?t:me.comparator(s.Pn,e.Pn)))}function cx(s,e){for(let t=0;t<s.length&&t<e.length;++t){const i=s[t]-e[t];if(i!==0)return i}return s.length-e.length}function vf(s){return N1()?(function(t){let i="";for(let a=0;a<t.length;a++)i+=String.fromCharCode(t[a]);return i})(s):s}function ux(s){return typeof s!="string"?s:(function(t){const i=new Uint8Array(t.length);for(let a=0;a<t.length;a++)i[a]=t.charCodeAt(a);return i})(s)}class hx{constructor(e){this.Vn=new rt(((t,i)=>wt.comparator(t.field,i.field))),this.collectionId=e.collectionGroup!=null?e.collectionGroup:e.path.lastSegment(),this.dn=e.orderBy,this.mn=[];for(const t of e.filters){const i=t;i.isInequality()?this.Vn=this.Vn.add(i):this.mn.push(i)}}get fn(){return this.Vn.size>1}gn(e){if(be(e.collectionGroup===this.collectionId,49279),this.fn)return!1;const t=fy(e);if(t!==void 0&&!this.pn(t))return!1;const i=qa(e);let a=new Set,l=0,c=0;for(;l<i.length&&this.pn(i[l]);++l)a=a.add(i[l].fieldPath.canonicalString());if(l===i.length)return!0;if(this.Vn.size>0){const f=this.Vn.getIterator().getNext();if(!a.has(f.field.canonicalString())){const p=i[l];if(!this.yn(f,p)||!this.wn(this.dn[c++],p))return!1}++l}for(;l<i.length;++l){const f=i[l];if(c>=this.dn.length||!this.wn(this.dn[c++],f))return!1}return!0}bn(){if(this.fn)return null;let e=new rt(wt.comparator);const t=[];for(const i of this.mn)if(!i.field.isKeyField())if(i.op==="array-contains"||i.op==="array-contains-any")t.push(new uf(i.field,2));else{if(e.has(i.field))continue;e=e.add(i.field),t.push(new uf(i.field,0))}for(const i of this.dn)i.field.isKeyField()||e.has(i.field)||(e=e.add(i.field),t.push(new uf(i.field,i.dir==="asc"?0:1)));return new Nf(Nf.UNKNOWN_ID,this.collectionId,t,ju.empty())}pn(e){for(const t of this.mn)if(this.yn(t,e))return!0;return!1}yn(e,t){if(e===void 0||!e.field.isEqual(t.fieldPath))return!1;const i=e.op==="array-contains"||e.op==="array-contains-any";return t.kind===2===i}wn(e,t){return!!e.field.isEqual(t.fieldPath)&&(t.kind===0&&e.dir==="asc"||t.kind===1&&e.dir==="desc")}}function qw(s){if(be(s instanceof qe||s instanceof st,20012),s instanceof qe){if(s instanceof ow){const t=s.value.arrayValue?.values?.map((i=>qe.create(s.field,"==",i)))||[];return st.create(t,"or")}return s}const e=s.filters.map((t=>qw(t)));return st.create(e,s.op)}function yV(s){if(s.getFilters().length===0)return[];const e=Dy(qw(s));return be(Hw(e),7391),Cy(e)||Ry(e)?[e]:e.getFilters()}function Cy(s){return s instanceof qe}function Ry(s){return s instanceof st&&dv(s)}function Hw(s){return Cy(s)||Ry(s)||(function(t){if(t instanceof st&&by(t)){for(const i of t.getFilters())if(!Cy(i)&&!Ry(i))return!1;return!0}return!1})(s)}function Dy(s){if(be(s instanceof qe||s instanceof st,34018),s instanceof qe)return s;if(s.filters.length===1)return Dy(s.filters[0]);const e=s.filters.map((i=>Dy(i)));let t=st.create(e,s.op);return t=zf(t),Hw(t)?t:(be(t instanceof st,64498),be(Vl(t),40251),be(t.filters.length>1,57927),t.filters.reduce(((i,a)=>Tv(i,a))))}function Tv(s,e){let t;return be(s instanceof qe||s instanceof st,38388),be(e instanceof qe||e instanceof st,25473),t=s instanceof qe?e instanceof qe?(function(a,l){return st.create([a,l],"and")})(s,e):dx(s,e):e instanceof qe?dx(e,s):(function(a,l){if(be(a.filters.length>0&&l.filters.length>0,48005),Vl(a)&&Vl(l))return sw(a,l.getFilters());const c=by(a)?a:l,f=by(a)?l:a,p=c.filters.map((y=>Tv(y,f)));return st.create(p,"or")})(s,e),zf(t)}function dx(s,e){if(Vl(e))return sw(e,s.getFilters());{const t=e.filters.map((i=>Tv(s,i)));return st.create(t,"or")}}function zf(s){if(be(s instanceof qe||s instanceof st,11850),s instanceof qe)return s;const e=s.getFilters();if(e.length===1)return zf(e[0]);if(nw(s))return s;const t=e.map((a=>zf(a))),i=[];return t.forEach((a=>{a instanceof qe?i.push(a):a instanceof st&&(a.op===s.op?i.push(...a.filters):i.push(a))})),i.length===1?i[0]:st.create(i,s.op)}class vV{constructor(){this.Sn=new Ev}addToCollectionParentIndex(e,t){return this.Sn.add(t),q.resolve()}getCollectionParents(e,t){return q.resolve(this.Sn.getEntries(t))}addFieldIndex(e,t){return q.resolve()}deleteFieldIndex(e,t){return q.resolve()}deleteAllFieldIndexes(e){return q.resolve()}createTargetIndexes(e,t){return q.resolve()}getDocumentsMatchingTarget(e,t){return q.resolve(null)}getIndexType(e,t){return q.resolve(0)}getFieldIndexes(e,t){return q.resolve([])}getNextCollectionGroupToUpdate(e){return q.resolve(null)}getMinOffset(e,t){return q.resolve(Qn.min())}getMinOffsetFromCollectionGroup(e,t){return q.resolve(Qn.min())}updateCollectionGroup(e,t,i){return q.resolve()}updateIndexEntries(e,t){return q.resolve()}}class Ev{constructor(){this.index={}}add(e){const t=e.lastSegment(),i=e.popLast(),a=this.index[t]||new rt(We.comparator),l=!a.has(i);return this.index[t]=a.add(i),l}has(e){const t=e.lastSegment(),i=e.popLast(),a=this.index[t];return a&&a.has(i)}getEntries(e){return(this.index[e]||new rt(We.comparator)).toArray()}}const fx="IndexedDbIndexManager",Qd=new Uint8Array(0);class _V{constructor(e,t){this.databaseId=t,this.Dn=new Ev,this.Cn=new Ys((i=>so(i)),((i,a)=>sh(i,a))),this.uid=e.uid||""}addToCollectionParentIndex(e,t){if(!this.Dn.has(t)){const i=t.lastSegment(),a=t.popLast();e.addOnCommittedListener((()=>{this.Dn.add(t)}));const l={collectionId:i,parent:mn(a)};return mx(e).put(l)}return q.resolve()}getCollectionParents(e,t){const i=[],a=IDBKeyRange.bound([t,""],[AS(t),""],!1,!0);return mx(e).H(a).next((l=>{for(const c of l){if(c.collectionId!==t)break;i.push(is(c.parent))}return i}))}addFieldIndex(e,t){const i=lu(e),a=(function(f){return{indexId:f.indexId,collectionGroup:f.collectionGroup,fields:f.fields.map((p=>[p.fieldPath.canonicalString(),p.kind]))}})(t);delete a.indexId;const l=i.add(a);if(t.indexState){const c=ll(e);return l.next((f=>{c.put(rx(f,this.uid,t.indexState.sequenceNumber,t.indexState.offset))}))}return l.next()}deleteFieldIndex(e,t){const i=lu(e),a=ll(e),l=ol(e);return i.delete(t.indexId).next((()=>a.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0)))).next((()=>l.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0))))}deleteAllFieldIndexes(e){const t=lu(e),i=ol(e),a=ll(e);return t.X().next((()=>i.X())).next((()=>a.X()))}createTargetIndexes(e,t){return q.forEach(this.vn(t),(i=>this.getIndexType(e,i).next((a=>{if(a===0||a===1){const l=new hx(i).bn();if(l!=null)return this.addFieldIndex(e,l)}}))))}getDocumentsMatchingTarget(e,t){const i=ol(e);let a=!0;const l=new Map;return q.forEach(this.vn(t),(c=>this.Fn(e,c).next((f=>{a&&(a=!!f),l.set(c,f)})))).next((()=>{if(a){let c=Pe();const f=[];return q.forEach(l,((p,y)=>{ce(fx,`Using index ${(function($){return`id=${$.indexId}|cg=${$.collectionGroup}|f=${$.fields.map((ne=>`${ne.fieldPath}:${ne.kind}`)).join(",")}`})(p)} to execute ${so(t)}`);const v=(function($,ne){const ee=fy(ne);if(ee===void 0)return null;for(const se of Pf($,ee.fieldPath))switch(se.op){case"array-contains-any":return se.value.arrayValue.values||[];case"array-contains":return[se.value]}return null})(y,p),b=(function($,ne){const ee=new Map;for(const se of qa(ne))for(const w of Pf($,se.fieldPath))switch(w.op){case"==":case"in":ee.set(se.fieldPath.canonicalString(),w.value);break;case"not-in":case"!=":return ee.set(se.fieldPath.canonicalString(),w.value),Array.from(ee.values())}return null})(y,p),x=(function($,ne){const ee=[];let se=!0;for(const w of qa(ne)){const C=w.kind===0?GE($,w.fieldPath,$.startAt):QE($,w.fieldPath,$.startAt);ee.push(C.value),se&&(se=C.inclusive)}return new Ol(ee,se)})(y,p),k=(function($,ne){const ee=[];let se=!0;for(const w of qa(ne)){const C=w.kind===0?QE($,w.fieldPath,$.endAt):GE($,w.fieldPath,$.endAt);ee.push(C.value),se&&(se=C.inclusive)}return new Ol(ee,se)})(y,p),O=this.Mn(p,y,x),D=this.Mn(p,y,k),M=this.xn(p,y,b),Y=this.On(p.indexId,v,O,x.inclusive,D,k.inclusive,M);return q.forEach(Y,(Z=>i.Z(Z,t.limit).next(($=>{$.forEach((ne=>{const ee=me.fromSegments(ne.documentKey);c.has(ee)||(c=c.add(ee),f.push(ee))}))}))))})).next((()=>f))}return q.resolve(null)}))}vn(e){let t=this.Cn.get(e);return t||(e.filters.length===0?t=[e]:t=yV(st.create(e.filters,"and")).map((i=>Ey(e.path,e.collectionGroup,e.orderBy,i.getFilters(),e.limit,e.startAt,e.endAt))),this.Cn.set(e,t),t)}On(e,t,i,a,l,c,f){const p=(t!=null?t.length:1)*Math.max(i.length,l.length),y=p/(t!=null?t.length:1),v=[];for(let b=0;b<p;++b){const x=t?this.Nn(t[b/y]):Qd,k=this.Bn(e,x,i[b%y],a),O=this.Ln(e,x,l[b%y],c),D=f.map((M=>this.Bn(e,x,M,!0)));v.push(...this.createRange(k,O,D))}return v}Bn(e,t,i,a){const l=new $a(e,me.empty(),t,i);return a?l:l.En()}Ln(e,t,i,a){const l=new $a(e,me.empty(),t,i);return a?l.En():l}Fn(e,t){const i=new hx(t),a=t.collectionGroup!=null?t.collectionGroup:t.path.lastSegment();return this.getFieldIndexes(e,a).next((l=>{let c=null;for(const f of l)i.gn(f)&&(!c||f.fields.length>c.fields.length)&&(c=f);return c}))}getIndexType(e,t){let i=2;const a=this.vn(t);return q.forEach(a,(l=>this.Fn(e,l).next((c=>{c?i!==0&&c.fields.length<(function(p){let y=new rt(wt.comparator),v=!1;for(const b of p.filters)for(const x of b.getFlattenedFilters())x.field.isKeyField()||(x.op==="array-contains"||x.op==="array-contains-any"?v=!0:y=y.add(x.field));for(const b of p.orderBy)b.field.isKeyField()||(y=y.add(b.field));return y.size+(v?1:0)})(l)&&(i=1):i=0})))).next((()=>(function(c){return c.limit!==null})(t)&&a.length>1&&i===2?1:i))}kn(e,t){const i=new ou;for(const a of qa(e)){const l=t.data.field(a.fieldPath);if(l==null)return null;const c=i.ln(a.kind);Ka.Wt.Dt(l,c)}return i.un()}Nn(e){const t=new ou;return Ka.Wt.Dt(e,t.ln(0)),t.un()}Kn(e,t){const i=new ou;return Ka.Wt.Dt(Uu(this.databaseId,t),i.ln((function(l){const c=qa(l);return c.length===0?0:c[c.length-1].kind})(e))),i.un()}xn(e,t,i){if(i===null)return[];let a=[];a.push(new ou);let l=0;for(const c of qa(e)){const f=i[l++];for(const p of a)if(this.qn(t,c.fieldPath)&&zu(f))a=this.Un(a,c,f);else{const y=p.ln(c.kind);Ka.Wt.Dt(f,y)}}return this.$n(a)}Mn(e,t,i){return this.xn(e,t,i.position)}$n(e){const t=[];for(let i=0;i<e.length;++i)t[i]=e[i].un();return t}Un(e,t,i){const a=[...e],l=[];for(const c of i.arrayValue.values||[])for(const f of a){const p=new ou;p.seed(f.un()),Ka.Wt.Dt(c,p.ln(t.kind)),l.push(p)}return l}qn(e,t){return!!e.filters.find((i=>i instanceof qe&&i.field.isEqual(t)&&(i.op==="in"||i.op==="not-in")))}getFieldIndexes(e,t){const i=lu(e),a=ll(e);return(t?i.H(py,IDBKeyRange.bound(t,t)):i.H()).next((l=>{const c=[];return q.forEach(l,(f=>a.get([f.indexId,this.uid]).next((p=>{c.push((function(v,b){const x=b?new ju(b.sequenceNumber,new Qn(ao(b.readTime),new me(is(b.documentKey)),b.largestBatchId)):ju.empty(),k=v.fields.map((([O,D])=>new uf(wt.fromServerFormat(O),D)));return new Nf(v.indexId,v.collectionGroup,k,x)})(f,p))})))).next((()=>c))}))}getNextCollectionGroupToUpdate(e){return this.getFieldIndexes(e).next((t=>t.length===0?null:(t.sort(((i,a)=>{const l=i.indexState.sequenceNumber-a.indexState.sequenceNumber;return l!==0?l:De(i.collectionGroup,a.collectionGroup)})),t[0].collectionGroup)))}updateCollectionGroup(e,t,i){const a=lu(e),l=ll(e);return this.Wn(e).next((c=>a.H(py,IDBKeyRange.bound(t,t)).next((f=>q.forEach(f,(p=>l.put(rx(p.indexId,this.uid,c,i))))))))}updateIndexEntries(e,t){const i=new Map;return q.forEach(t,((a,l)=>{const c=i.get(a.collectionGroup);return(c?q.resolve(c):this.getFieldIndexes(e,a.collectionGroup)).next((f=>(i.set(a.collectionGroup,f),q.forEach(f,(p=>this.Qn(e,a,p).next((y=>{const v=this.Gn(l,p);return y.isEqual(v)?q.resolve():this.zn(e,l,p,y,v)})))))))}))}jn(e,t,i,a){return ol(e).put(a.Rn(this.uid,this.Kn(i,t.key),t.key))}Hn(e,t,i,a){return ol(e).delete(a.An(this.uid,this.Kn(i,t.key),t.key))}Qn(e,t,i){const a=ol(e);let l=new rt(Vr);return a.ee({index:US,range:IDBKeyRange.only([i.indexId,this.uid,vf(this.Kn(i,t))])},((c,f)=>{l=l.add(new $a(i.indexId,t,ux(f.arrayValue),ux(f.directionalValue)))})).next((()=>l))}Gn(e,t){let i=new rt(Vr);const a=this.kn(t,e);if(a==null)return i;const l=fy(t);if(l!=null){const c=e.data.field(l.fieldPath);if(zu(c))for(const f of c.arrayValue.values||[])i=i.add(new $a(t.indexId,e.key,this.Nn(f),a))}else i=i.add(new $a(t.indexId,e.key,Qd,a));return i}zn(e,t,i,a,l){ce(fx,"Updating index entries for document '%s'",t.key);const c=[];return(function(p,y,v,b,x){const k=p.getIterator(),O=y.getIterator();let D=rl(k),M=rl(O);for(;D||M;){let Y=!1,Z=!1;if(D&&M){const $=v(D,M);$<0?Z=!0:$>0&&(Y=!0)}else D!=null?Z=!0:Y=!0;Y?(b(M),M=rl(O)):Z?(x(D),D=rl(k)):(D=rl(k),M=rl(O))}})(a,l,Vr,(f=>{c.push(this.jn(e,t,i,f))}),(f=>{c.push(this.Hn(e,t,i,f))})),q.waitFor(c)}Wn(e){let t=1;return ll(e).ee({index:LS,reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},((i,a,l)=>{l.done(),t=a.sequenceNumber+1})).next((()=>t))}createRange(e,t,i){i=i.sort(((c,f)=>Vr(c,f))).filter(((c,f,p)=>!f||Vr(c,p[f-1])!==0));const a=[];a.push(e);for(const c of i){const f=Vr(c,e),p=Vr(c,t);if(f===0)a[0]=e.En();else if(f>0&&p<0)a.push(c),a.push(c.En());else if(p>0)break}a.push(t);const l=[];for(let c=0;c<a.length;c+=2){if(this.Jn(a[c],a[c+1]))return[];const f=a[c].An(this.uid,Qd,me.empty()),p=a[c+1].An(this.uid,Qd,me.empty());l.push(IDBKeyRange.bound(f,p))}return l}Jn(e,t){return Vr(e,t)>0}getMinOffsetFromCollectionGroup(e,t){return this.getFieldIndexes(e,t).next(px)}getMinOffset(e,t){return q.mapArray(this.vn(t),(i=>this.Fn(e,i).next((a=>a||ye(44426))))).next(px)}}function mx(s){return Kt(s,Mu)}function ol(s){return Kt(s,xu)}function lu(s){return Kt(s,av)}function ll(s){return Kt(s,Eu)}function px(s){be(s.length!==0,28825);let e=s[0].indexState.offset,t=e.largestBatchId;for(let i=1;i<s.length;i++){const a=s[i].indexState.offset;iv(a,e)<0&&(e=a),t<a.largestBatchId&&(t=a.largestBatchId)}return new Qn(e.readTime,e.documentKey,t)}const gx={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},Gw=41943040;class fn{static withCacheSize(e){return new fn(e,fn.DEFAULT_COLLECTION_PERCENTILE,fn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,t,i){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=i}}function Qw(s,e,t){const i=s.store(wi),a=s.store(Cl),l=[],c=IDBKeyRange.only(t.batchId);let f=0;const p=i.ee({range:c},((v,b,x)=>(f++,x.delete())));l.push(p.next((()=>{be(f===1,47070,{batchId:t.batchId})})));const y=[];for(const v of t.mutations){const b=VS(e,v.key.path,t.batchId);l.push(a.delete(b)),y.push(v.key)}return q.waitFor(l).next((()=>y))}function Bf(s){if(!s)return 0;let e;if(s.document)e=s.document;else if(s.unknownDocument)e=s.unknownDocument;else{if(!s.noDocument)throw ye(14731);e=s.noDocument}return JSON.stringify(e).length}fn.DEFAULT_COLLECTION_PERCENTILE=10,fn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,fn.DEFAULT=new fn(Gw,fn.DEFAULT_COLLECTION_PERCENTILE,fn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),fn.DISABLED=new fn(-1,0,0);class vm{constructor(e,t,i,a){this.userId=e,this.serializer=t,this.indexManager=i,this.referenceDelegate=a,this.Zn={}}static wt(e,t,i,a){be(e.uid!=="",64387);const l=e.isAuthenticated()?e.uid:"";return new vm(l,t,i,a)}checkEmpty(e){let t=!0;const i=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return Mr(e).ee({index:Wa,range:i},((a,l,c)=>{t=!1,c.done()})).next((()=>t))}addMutationBatch(e,t,i,a){const l=pl(e),c=Mr(e);return c.add({}).next((f=>{be(typeof f=="number",49019);const p=new gv(f,t,i,a),y=(function(k,O,D){const M=D.baseMutations.map((Z=>Hu(k.yt,Z))),Y=D.mutations.map((Z=>Hu(k.yt,Z)));return{userId:O,batchId:D.batchId,localWriteTimeMs:D.localWriteTime.toMillis(),baseMutations:M,mutations:Y}})(this.serializer,this.userId,p),v=[];let b=new rt(((x,k)=>De(x.canonicalString(),k.canonicalString())));for(const x of a){const k=VS(this.userId,x.key.path,f);b=b.add(x.key.path.popLast()),v.push(c.put(y)),v.push(l.put(k,$k))}return b.forEach((x=>{v.push(this.indexManager.addToCollectionParentIndex(e,x))})),e.addOnCommittedListener((()=>{this.Zn[f]=p.keys()})),q.waitFor(v).next((()=>p))}))}lookupMutationBatch(e,t){return Mr(e).get(t).next((i=>i?(be(i.userId===this.userId,48,"Unexpected user for mutation batch",{userId:i.userId,batchId:t}),Qa(this.serializer,i)):null))}Xn(e,t){return this.Zn[t]?q.resolve(this.Zn[t]):this.lookupMutationBatch(e,t).next((i=>{if(i){const a=i.keys();return this.Zn[t]=a,a}return null}))}getNextMutationBatchAfterBatchId(e,t){const i=t+1,a=IDBKeyRange.lowerBound([this.userId,i]);let l=null;return Mr(e).ee({index:Wa,range:a},((c,f,p)=>{f.userId===this.userId&&(be(f.batchId>=i,47524,{Yn:i}),l=Qa(this.serializer,f)),p.done()})).next((()=>l))}getHighestUnacknowledgedBatchId(e){const t=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]);let i=Ya;return Mr(e).ee({index:Wa,range:t,reverse:!0},((a,l,c)=>{i=l.batchId,c.done()})).next((()=>i))}getAllMutationBatches(e){const t=IDBKeyRange.bound([this.userId,Ya],[this.userId,Number.POSITIVE_INFINITY]);return Mr(e).H(Wa,t).next((i=>i.map((a=>Qa(this.serializer,a)))))}getAllMutationBatchesAffectingDocumentKey(e,t){const i=hf(this.userId,t.path),a=IDBKeyRange.lowerBound(i),l=[];return pl(e).ee({range:a},((c,f,p)=>{const[y,v,b]=c,x=is(v);if(y===this.userId&&t.path.isEqual(x))return Mr(e).get(b).next((k=>{if(!k)throw ye(61480,{er:c,batchId:b});be(k.userId===this.userId,10503,"Unexpected user for mutation batch",{userId:k.userId,batchId:b}),l.push(Qa(this.serializer,k))}));p.done()})).next((()=>l))}getAllMutationBatchesAffectingDocumentKeys(e,t){let i=new rt(De);const a=[];return t.forEach((l=>{const c=hf(this.userId,l.path),f=IDBKeyRange.lowerBound(c),p=pl(e).ee({range:f},((y,v,b)=>{const[x,k,O]=y,D=is(k);x===this.userId&&l.path.isEqual(D)?i=i.add(O):b.done()}));a.push(p)})),q.waitFor(a).next((()=>this.tr(e,i)))}getAllMutationBatchesAffectingQuery(e,t){const i=t.path,a=i.length+1,l=hf(this.userId,i),c=IDBKeyRange.lowerBound(l);let f=new rt(De);return pl(e).ee({range:c},((p,y,v)=>{const[b,x,k]=p,O=is(x);b===this.userId&&i.isPrefixOf(O)?O.length===a&&(f=f.add(k)):v.done()})).next((()=>this.tr(e,f)))}tr(e,t){const i=[],a=[];return t.forEach((l=>{a.push(Mr(e).get(l).next((c=>{if(c===null)throw ye(35274,{batchId:l});be(c.userId===this.userId,9748,"Unexpected user for mutation batch",{userId:c.userId,batchId:l}),i.push(Qa(this.serializer,c))})))})),q.waitFor(a).next((()=>i))}removeMutationBatch(e,t){return Qw(e.le,this.userId,t).next((i=>(e.addOnCommittedListener((()=>{this.nr(t.batchId)})),q.forEach(i,(a=>this.referenceDelegate.markPotentiallyOrphaned(e,a))))))}nr(e){delete this.Zn[e]}performConsistencyCheck(e){return this.checkEmpty(e).next((t=>{if(!t)return q.resolve();const i=IDBKeyRange.lowerBound((function(c){return[c]})(this.userId)),a=[];return pl(e).ee({range:i},((l,c,f)=>{if(l[0]===this.userId){const p=is(l[1]);a.push(p)}else f.done()})).next((()=>{be(a.length===0,56720,{rr:a.map((l=>l.canonicalString()))})}))}))}containsKey(e,t){return Kw(e,this.userId,t)}ir(e){return $w(e).get(this.userId).next((t=>t||{userId:this.userId,lastAcknowledgedBatchId:Ya,lastStreamToken:""}))}}function Kw(s,e,t){const i=hf(e,t.path),a=i[1],l=IDBKeyRange.lowerBound(i);let c=!1;return pl(s).ee({range:l,Y:!0},((f,p,y)=>{const[v,b,x]=f;v===e&&b===a&&(c=!0),y.done()})).next((()=>c))}function Mr(s){return Kt(s,wi)}function pl(s){return Kt(s,Cl)}function $w(s){return Kt(s,Ou)}class oo{constructor(e){this.sr=e}next(){return this.sr+=2,this.sr}static _r(){return new oo(0)}static ar(){return new oo(-1)}}class bV{constructor(e,t){this.referenceDelegate=e,this.serializer=t}allocateTargetId(e){return this.ur(e).next((t=>{const i=new oo(t.highestTargetId);return t.highestTargetId=i.next(),this.cr(e,t).next((()=>t.highestTargetId))}))}getLastRemoteSnapshotVersion(e){return this.ur(e).next((t=>Se.fromTimestamp(new it(t.lastRemoteSnapshotVersion.seconds,t.lastRemoteSnapshotVersion.nanoseconds))))}getHighestSequenceNumber(e){return this.ur(e).next((t=>t.highestListenSequenceNumber))}setTargetsMetadata(e,t,i){return this.ur(e).next((a=>(a.highestListenSequenceNumber=t,i&&(a.lastRemoteSnapshotVersion=i.toTimestamp()),t>a.highestListenSequenceNumber&&(a.highestListenSequenceNumber=t),this.cr(e,a))))}addTargetData(e,t){return this.lr(e,t).next((()=>this.ur(e).next((i=>(i.targetCount+=1,this.hr(t,i),this.cr(e,i))))))}updateTargetData(e,t){return this.lr(e,t)}removeTargetData(e,t){return this.removeMatchingKeysForTargetId(e,t.targetId).next((()=>cl(e).delete(t.targetId))).next((()=>this.ur(e))).next((i=>(be(i.targetCount>0,8065),i.targetCount-=1,this.cr(e,i))))}removeTargets(e,t,i){let a=0;const l=[];return cl(e).ee(((c,f)=>{const p=yu(f);p.sequenceNumber<=t&&i.get(p.targetId)===null&&(a++,l.push(this.removeTargetData(e,p)))})).next((()=>q.waitFor(l))).next((()=>a))}forEachTarget(e,t){return cl(e).ee(((i,a)=>{const l=yu(a);t(l)}))}ur(e){return yx(e).get(Of).next((t=>(be(t!==null,2888),t)))}cr(e,t){return yx(e).put(Of,t)}lr(e,t){return cl(e).put(Bw(this.serializer,t))}hr(e,t){let i=!1;return e.targetId>t.highestTargetId&&(t.highestTargetId=e.targetId,i=!0),e.sequenceNumber>t.highestListenSequenceNumber&&(t.highestListenSequenceNumber=e.sequenceNumber,i=!0),i}getTargetCount(e){return this.ur(e).next((t=>t.targetCount))}getTargetData(e,t){const i=so(t),a=IDBKeyRange.bound([i,Number.NEGATIVE_INFINITY],[i,Number.POSITIVE_INFINITY]);let l=null;return cl(e).ee({range:a,index:PS},((c,f,p)=>{const y=yu(f);sh(t,y.target)&&(l=y,p.done())})).next((()=>l))}addMatchingKeys(e,t,i){const a=[],l=qr(e);return t.forEach((c=>{const f=mn(c.path);a.push(l.put({targetId:i,path:f})),a.push(this.referenceDelegate.addReference(e,i,c))})),q.waitFor(a)}removeMatchingKeys(e,t,i){const a=qr(e);return q.forEach(t,(l=>{const c=mn(l.path);return q.waitFor([a.delete([i,c]),this.referenceDelegate.removeReference(e,i,l)])}))}removeMatchingKeysForTargetId(e,t){const i=qr(e),a=IDBKeyRange.bound([t],[t+1],!1,!0);return i.delete(a)}getMatchingKeysForTargetId(e,t){const i=IDBKeyRange.bound([t],[t+1],!1,!0),a=qr(e);let l=Pe();return a.ee({range:i,Y:!0},((c,f,p)=>{const y=is(c[1]),v=new me(y);l=l.add(v)})).next((()=>l))}containsKey(e,t){const i=mn(t.path),a=IDBKeyRange.bound([i],[AS(i)],!1,!0);let l=0;return qr(e).ee({index:rv,Y:!0,range:a},(([c,f],p,y)=>{c!==0&&(l++,y.done())})).next((()=>l>0))}At(e,t){return cl(e).get(t).next((i=>i?yu(i):null))}}function cl(s){return Kt(s,Rl)}function yx(s){return Kt(s,Xa)}function qr(s){return Kt(s,Dl)}const vx="LruGarbageCollector",Ww=1048576;function _x([s,e],[t,i]){const a=De(s,t);return a===0?De(e,i):a}class TV{constructor(e){this.Pr=e,this.buffer=new rt(_x),this.Tr=0}Ir(){return++this.Tr}Er(e){const t=[e,this.Ir()];if(this.buffer.size<this.Pr)this.buffer=this.buffer.add(t);else{const i=this.buffer.last();_x(t,i)<0&&(this.buffer=this.buffer.delete(i).add(t))}}get maxValue(){return this.buffer.last()[0]}}class Yw{constructor(e,t,i){this.garbageCollector=e,this.asyncQueue=t,this.localStore=i,this.Rr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Ar(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return this.Rr!==null}Ar(e){ce(vx,`Garbage collection scheduled in ${e}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,(async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(t){ra(t)?ce(vx,"Ignoring IndexedDB error during garbage collection: ",t):await sa(t)}await this.Ar(3e5)}))}}class EV{constructor(e,t){this.Vr=e,this.params=t}calculateTargetCount(e,t){return this.Vr.dr(e).next((i=>Math.floor(t/100*i)))}nthSequenceNumber(e,t){if(t===0)return q.resolve(Cn.ce);const i=new TV(t);return this.Vr.forEachTarget(e,(a=>i.Er(a.sequenceNumber))).next((()=>this.Vr.mr(e,(a=>i.Er(a))))).next((()=>i.maxValue))}removeTargets(e,t,i){return this.Vr.removeTargets(e,t,i)}removeOrphanedDocuments(e,t){return this.Vr.removeOrphanedDocuments(e,t)}collect(e,t){return this.params.cacheSizeCollectionThreshold===-1?(ce("LruGarbageCollector","Garbage collection skipped; disabled"),q.resolve(gx)):this.getCacheSize(e).next((i=>i<this.params.cacheSizeCollectionThreshold?(ce("LruGarbageCollector",`Garbage collection skipped; Cache size ${i} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),gx):this.gr(e,t)))}getCacheSize(e){return this.Vr.getCacheSize(e)}gr(e,t){let i,a,l,c,f,p,y;const v=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next((b=>(b>this.params.maximumSequenceNumbersToCollect?(ce("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${b}`),a=this.params.maximumSequenceNumbersToCollect):a=b,c=Date.now(),this.nthSequenceNumber(e,a)))).next((b=>(i=b,f=Date.now(),this.removeTargets(e,i,t)))).next((b=>(l=b,p=Date.now(),this.removeOrphanedDocuments(e,i)))).next((b=>(y=Date.now(),hl()<=Fe.DEBUG&&ce("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${c-v}ms
	Determined least recently used ${a} in `+(f-c)+`ms
	Removed ${l} targets in `+(p-f)+`ms
	Removed ${b} documents in `+(y-p)+`ms
Total Duration: ${y-v}ms`),q.resolve({didRun:!0,sequenceNumbersCollected:a,targetsRemoved:l,documentsRemoved:b}))))}}function Xw(s,e){return new EV(s,e)}class xV{constructor(e,t){this.db=e,this.garbageCollector=Xw(this,t)}dr(e){const t=this.pr(e);return this.db.getTargetCache().getTargetCount(e).next((i=>t.next((a=>i+a))))}pr(e){let t=0;return this.mr(e,(i=>{t++})).next((()=>t))}forEachTarget(e,t){return this.db.getTargetCache().forEachTarget(e,t)}mr(e,t){return this.yr(e,((i,a)=>t(a)))}addReference(e,t,i){return Kd(e,i)}removeReference(e,t,i){return Kd(e,i)}removeTargets(e,t,i){return this.db.getTargetCache().removeTargets(e,t,i)}markPotentiallyOrphaned(e,t){return Kd(e,t)}wr(e,t){return(function(a,l){let c=!1;return $w(a).te((f=>Kw(a,f,l).next((p=>(p&&(c=!0),q.resolve(!p)))))).next((()=>c))})(e,t)}removeOrphanedDocuments(e,t){const i=this.db.getRemoteDocumentCache().newChangeBuffer(),a=[];let l=0;return this.yr(e,((c,f)=>{if(f<=t){const p=this.wr(e,c).next((y=>{if(!y)return l++,i.getEntry(e,c).next((()=>(i.removeEntry(c,Se.min()),qr(e).delete((function(b){return[0,mn(b.path)]})(c)))))}));a.push(p)}})).next((()=>q.waitFor(a))).next((()=>i.apply(e))).next((()=>l))}removeTarget(e,t){const i=t.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,i)}updateLimboDocument(e,t){return Kd(e,t)}yr(e,t){const i=qr(e);let a,l=Cn.ce;return i.ee({index:rv},(([c,f],{path:p,sequenceNumber:y})=>{c===0?(l!==Cn.ce&&t(new me(is(a)),l),l=y,a=p):l=Cn.ce})).next((()=>{l!==Cn.ce&&t(new me(is(a)),l)}))}getCacheSize(e){return this.db.getRemoteDocumentCache().getSize(e)}}function Kd(s,e){return qr(s).put((function(i,a){return{targetId:0,path:mn(i.path),sequenceNumber:a}})(e,s.currentSequenceNumber))}class Jw{constructor(){this.changes=new Ys((e=>e.toString()),((e,t)=>e.isEqual(t))),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,Et.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const i=this.changes.get(t);return i!==void 0?q.resolve(i):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}class SV{constructor(e){this.serializer=e}setIndexManager(e){this.indexManager=e}addEntry(e,t,i){return Ba(e).put(i)}removeEntry(e,t,i){return Ba(e).delete((function(l,c){const f=l.path.toArray();return[f.slice(0,f.length-2),f[f.length-2],Uf(c),f[f.length-1]]})(t,i))}updateMetadata(e,t){return this.getMetadata(e).next((i=>(i.byteSize+=t,this.br(e,i))))}getEntry(e,t){let i=Et.newInvalidDocument(t);return Ba(e).ee({index:df,range:IDBKeyRange.only(cu(t))},((a,l)=>{i=this.Sr(t,l)})).next((()=>i))}Dr(e,t){let i={size:0,document:Et.newInvalidDocument(t)};return Ba(e).ee({index:df,range:IDBKeyRange.only(cu(t))},((a,l)=>{i={document:this.Sr(t,l),size:Bf(l)}})).next((()=>i))}getEntries(e,t){let i=Hn();return this.Cr(e,t,((a,l)=>{const c=this.Sr(a,l);i=i.insert(a,c)})).next((()=>i))}vr(e,t){let i=Hn(),a=new ft(me.comparator);return this.Cr(e,t,((l,c)=>{const f=this.Sr(l,c);i=i.insert(l,f),a=a.insert(l,Bf(c))})).next((()=>({documents:i,Fr:a})))}Cr(e,t,i){if(t.isEmpty())return q.resolve();let a=new rt(Ex);t.forEach((p=>a=a.add(p)));const l=IDBKeyRange.bound(cu(a.first()),cu(a.last())),c=a.getIterator();let f=c.getNext();return Ba(e).ee({index:df,range:l},((p,y,v)=>{const b=me.fromSegments([...y.prefixPath,y.collectionGroup,y.documentId]);for(;f&&Ex(f,b)<0;)i(f,null),f=c.getNext();f&&f.isEqual(b)&&(i(f,y),f=c.hasNext()?c.getNext():null),f?v.j(cu(f)):v.done()})).next((()=>{for(;f;)i(f,null),f=c.hasNext()?c.getNext():null}))}getDocumentsMatchingQuery(e,t,i,a,l){const c=t.path,f=[c.popLast().toArray(),c.lastSegment(),Uf(i.readTime),i.documentKey.path.isEmpty()?"":i.documentKey.path.lastSegment()],p=[c.popLast().toArray(),c.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return Ba(e).H(IDBKeyRange.bound(f,p,!0)).next((y=>{l?.incrementDocumentReadCount(y.length);let v=Hn();for(const b of y){const x=this.Sr(me.fromSegments(b.prefixPath.concat(b.collectionGroup,b.documentId)),b);x.isFoundDocument()&&(rh(t,x)||a.has(x.key))&&(v=v.insert(x.key,x))}return v}))}getAllFromCollectionGroup(e,t,i,a){let l=Hn();const c=Tx(t,i),f=Tx(t,Qn.max());return Ba(e).ee({index:MS,range:IDBKeyRange.bound(c,f,!0)},((p,y,v)=>{const b=this.Sr(me.fromSegments(y.prefixPath.concat(y.collectionGroup,y.documentId)),y);l=l.insert(b.key,b),l.size===a&&v.done()})).next((()=>l))}newChangeBuffer(e){return new wV(this,!!e&&e.trackRemovals)}getSize(e){return this.getMetadata(e).next((t=>t.byteSize))}getMetadata(e){return bx(e).get(my).next((t=>(be(!!t,20021),t)))}br(e,t){return bx(e).put(my,t)}Sr(e,t){if(t){const i=uV(this.serializer,t);if(!(i.isNoDocument()&&i.version.isEqual(Se.min())))return i}return Et.newInvalidDocument(e)}}function Zw(s){return new SV(s)}class wV extends Jw{constructor(e,t){super(),this.Mr=e,this.trackRemovals=t,this.Or=new Ys((i=>i.toString()),((i,a)=>i.isEqual(a)))}applyChanges(e){const t=[];let i=0,a=new rt(((l,c)=>De(l.canonicalString(),c.canonicalString())));return this.changes.forEach(((l,c)=>{const f=this.Or.get(l);if(t.push(this.Mr.removeEntry(e,l,f.readTime)),c.isValidDocument()){const p=ix(this.Mr.serializer,c);a=a.add(l.path.popLast());const y=Bf(p);i+=y-f.size,t.push(this.Mr.addEntry(e,l,p))}else if(i-=f.size,this.trackRemovals){const p=ix(this.Mr.serializer,c.convertToNoDocument(Se.min()));t.push(this.Mr.addEntry(e,l,p))}})),a.forEach((l=>{t.push(this.Mr.indexManager.addToCollectionParentIndex(e,l))})),t.push(this.Mr.updateMetadata(e,i)),q.waitFor(t)}getFromCache(e,t){return this.Mr.Dr(e,t).next((i=>(this.Or.set(t,{size:i.size,readTime:i.document.readTime}),i.document)))}getAllFromCache(e,t){return this.Mr.vr(e,t).next((({documents:i,Fr:a})=>(a.forEach(((l,c)=>{this.Or.set(l,{size:c,readTime:i.get(l).readTime})})),i)))}}function bx(s){return Kt(s,Vu)}function Ba(s){return Kt(s,kf)}function cu(s){const e=s.path.toArray();return[e.slice(0,e.length-2),e[e.length-2],e[e.length-1]]}function Tx(s,e){const t=e.documentKey.path.toArray();return[s,Uf(e.readTime),t.slice(0,t.length-2),t.length>0?t[t.length-1]:""]}function Ex(s,e){const t=s.path.toArray(),i=e.path.toArray();let a=0;for(let l=0;l<t.length-2&&l<i.length-2;++l)if(a=De(t[l],i[l]),a)return a;return a=De(t.length,i.length),a||(a=De(t[t.length-2],i[i.length-2]),a||De(t[t.length-1],i[i.length-1]))}class AV{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}class eA{constructor(e,t,i,a){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=i,this.indexManager=a}getDocument(e,t){let i=null;return this.documentOverlayCache.getOverlay(e,t).next((a=>(i=a,this.remoteDocumentCache.getEntry(e,t)))).next((a=>(i!==null&&Iu(i.mutation,a,Rn.empty(),it.now()),a)))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next((i=>this.getLocalViewOfDocuments(e,i,Pe()).next((()=>i))))}getLocalViewOfDocuments(e,t,i=Pe()){const a=ss();return this.populateOverlays(e,a,t).next((()=>this.computeViews(e,t,a,i).next((l=>{let c=pu();return l.forEach(((f,p)=>{c=c.insert(f,p.overlayedDocument)})),c}))))}getOverlayedDocuments(e,t){const i=ss();return this.populateOverlays(e,i,t).next((()=>this.computeViews(e,t,i,Pe())))}populateOverlays(e,t,i){const a=[];return i.forEach((l=>{t.has(l)||a.push(l)})),this.documentOverlayCache.getOverlays(e,a).next((l=>{l.forEach(((c,f)=>{t.set(c,f)}))}))}computeViews(e,t,i,a){let l=Hn();const c=Au(),f=(function(){return Au()})();return t.forEach(((p,y)=>{const v=i.get(y.key);a.has(y.key)&&(v===void 0||v.mutation instanceof Xs)?l=l.insert(y.key,y):v!==void 0?(c.set(y.key,v.mutation.getFieldMask()),Iu(v.mutation,y,v.mutation.getFieldMask(),it.now())):c.set(y.key,Rn.empty())})),this.recalculateAndSaveOverlays(e,l).next((p=>(p.forEach(((y,v)=>c.set(y,v))),t.forEach(((y,v)=>f.set(y,new AV(v,c.get(y)??null)))),f)))}recalculateAndSaveOverlays(e,t){const i=Au();let a=new ft(((c,f)=>c-f)),l=Pe();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next((c=>{for(const f of c)f.keys().forEach((p=>{const y=t.get(p);if(y===null)return;let v=i.get(p)||Rn.empty();v=f.applyToLocalView(y,v),i.set(p,v);const b=(a.get(f.batchId)||Pe()).add(p);a=a.insert(f.batchId,b)}))})).next((()=>{const c=[],f=a.getReverseIterator();for(;f.hasNext();){const p=f.getNext(),y=p.key,v=p.value,b=pw();v.forEach((x=>{if(!l.has(x)){const k=Ew(t.get(x),i.get(x));k!==null&&b.set(x,k),l=l.add(x)}})),c.push(this.documentOverlayCache.saveOverlays(e,y,b))}return q.waitFor(c)})).next((()=>i))}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next((i=>this.recalculateAndSaveOverlays(e,i)))}getDocumentsMatchingQuery(e,t,i,a){return NO(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):cw(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,i,a):this.getDocumentsMatchingCollectionQuery(e,t,i,a)}getNextDocuments(e,t,i,a){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,i,a).next((l=>{const c=a-l.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,i.largestBatchId,a-l.size):q.resolve(ss());let f=Il,p=l;return c.next((y=>q.forEach(y,((v,b)=>(f<b.largestBatchId&&(f=b.largestBatchId),l.get(v)?q.resolve():this.remoteDocumentCache.getEntry(e,v).next((x=>{p=p.insert(v,x)}))))).next((()=>this.populateOverlays(e,y,l))).next((()=>this.computeViews(e,p,y,Pe()))).next((v=>({batchId:f,changes:mw(v)})))))}))}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new me(t)).next((i=>{let a=pu();return i.isFoundDocument()&&(a=a.insert(i.key,i)),a}))}getDocumentsMatchingCollectionGroupQuery(e,t,i,a){const l=t.collectionGroup;let c=pu();return this.indexManager.getCollectionParents(e,l).next((f=>q.forEach(f,(p=>{const y=(function(b,x){return new Yl(x,null,b.explicitOrderBy.slice(),b.filters.slice(),b.limit,b.limitType,b.startAt,b.endAt)})(t,p.child(l));return this.getDocumentsMatchingCollectionQuery(e,y,i,a).next((v=>{v.forEach(((b,x)=>{c=c.insert(b,x)}))}))})).next((()=>c))))}getDocumentsMatchingCollectionQuery(e,t,i,a){let l;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,i.largestBatchId).next((c=>(l=c,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,i,l,a)))).next((c=>{l.forEach(((p,y)=>{const v=y.getKey();c.get(v)===null&&(c=c.insert(v,Et.newInvalidDocument(v)))}));let f=pu();return c.forEach(((p,y)=>{const v=l.get(p);v!==void 0&&Iu(v.mutation,y,Rn.empty(),it.now()),rh(t,y)&&(f=f.insert(p,y))})),f}))}}class IV{constructor(e){this.serializer=e,this.Nr=new Map,this.Br=new Map}getBundleMetadata(e,t){return q.resolve(this.Nr.get(t))}saveBundleMetadata(e,t){return this.Nr.set(t.id,(function(a){return{id:a.id,version:a.version,createTime:Jt(a.createTime)}})(t)),q.resolve()}getNamedQuery(e,t){return q.resolve(this.Br.get(t))}saveNamedQuery(e,t){return this.Br.set(t.name,(function(a){return{name:a.name,query:Fw(a.bundledQuery),readTime:Jt(a.readTime)}})(t)),q.resolve()}}class CV{constructor(){this.overlays=new ft(me.comparator),this.Lr=new Map}getOverlay(e,t){return q.resolve(this.overlays.get(t))}getOverlays(e,t){const i=ss();return q.forEach(t,(a=>this.getOverlay(e,a).next((l=>{l!==null&&i.set(a,l)})))).next((()=>i))}saveOverlays(e,t,i){return i.forEach(((a,l)=>{this.bt(e,t,l)})),q.resolve()}removeOverlaysForBatchId(e,t,i){const a=this.Lr.get(i);return a!==void 0&&(a.forEach((l=>this.overlays=this.overlays.remove(l))),this.Lr.delete(i)),q.resolve()}getOverlaysForCollection(e,t,i){const a=ss(),l=t.length+1,c=new me(t.child("")),f=this.overlays.getIteratorFrom(c);for(;f.hasNext();){const p=f.getNext().value,y=p.getKey();if(!t.isPrefixOf(y.path))break;y.path.length===l&&p.largestBatchId>i&&a.set(p.getKey(),p)}return q.resolve(a)}getOverlaysForCollectionGroup(e,t,i,a){let l=new ft(((y,v)=>y-v));const c=this.overlays.getIterator();for(;c.hasNext();){const y=c.getNext().value;if(y.getKey().getCollectionGroup()===t&&y.largestBatchId>i){let v=l.get(y.largestBatchId);v===null&&(v=ss(),l=l.insert(y.largestBatchId,v)),v.set(y.getKey(),y)}}const f=ss(),p=l.getIterator();for(;p.hasNext()&&(p.getNext().value.forEach(((y,v)=>f.set(y,v))),!(f.size()>=a)););return q.resolve(f)}bt(e,t,i){const a=this.overlays.get(i.key);if(a!==null){const c=this.Lr.get(a.largestBatchId).delete(i.key);this.Lr.set(a.largestBatchId,c)}this.overlays=this.overlays.insert(i.key,new vv(t,i));let l=this.Lr.get(t);l===void 0&&(l=Pe(),this.Lr.set(t,l)),this.Lr.set(t,l.add(i.key))}}class RV{constructor(){this.sessionToken=Ot.EMPTY_BYTE_STRING}getSessionToken(e){return q.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,q.resolve()}}class xv{constructor(){this.kr=new rt(Xt.Kr),this.qr=new rt(Xt.Ur)}isEmpty(){return this.kr.isEmpty()}addReference(e,t){const i=new Xt(e,t);this.kr=this.kr.add(i),this.qr=this.qr.add(i)}$r(e,t){e.forEach((i=>this.addReference(i,t)))}removeReference(e,t){this.Wr(new Xt(e,t))}Qr(e,t){e.forEach((i=>this.removeReference(i,t)))}Gr(e){const t=new me(new We([])),i=new Xt(t,e),a=new Xt(t,e+1),l=[];return this.qr.forEachInRange([i,a],(c=>{this.Wr(c),l.push(c.key)})),l}zr(){this.kr.forEach((e=>this.Wr(e)))}Wr(e){this.kr=this.kr.delete(e),this.qr=this.qr.delete(e)}jr(e){const t=new me(new We([])),i=new Xt(t,e),a=new Xt(t,e+1);let l=Pe();return this.qr.forEachInRange([i,a],(c=>{l=l.add(c.key)})),l}containsKey(e){const t=new Xt(e,0),i=this.kr.firstAfterOrEqual(t);return i!==null&&e.isEqual(i.key)}}class Xt{constructor(e,t){this.key=e,this.Hr=t}static Kr(e,t){return me.comparator(e.key,t.key)||De(e.Hr,t.Hr)}static Ur(e,t){return De(e.Hr,t.Hr)||me.comparator(e.key,t.key)}}class DV{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.Yn=1,this.Jr=new rt(Xt.Kr)}checkEmpty(e){return q.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,i,a){const l=this.Yn;this.Yn++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const c=new gv(l,t,i,a);this.mutationQueue.push(c);for(const f of a)this.Jr=this.Jr.add(new Xt(f.key,l)),this.indexManager.addToCollectionParentIndex(e,f.key.path.popLast());return q.resolve(c)}lookupMutationBatch(e,t){return q.resolve(this.Zr(t))}getNextMutationBatchAfterBatchId(e,t){const i=t+1,a=this.Xr(i),l=a<0?0:a;return q.resolve(this.mutationQueue.length>l?this.mutationQueue[l]:null)}getHighestUnacknowledgedBatchId(){return q.resolve(this.mutationQueue.length===0?Ya:this.Yn-1)}getAllMutationBatches(e){return q.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const i=new Xt(t,0),a=new Xt(t,Number.POSITIVE_INFINITY),l=[];return this.Jr.forEachInRange([i,a],(c=>{const f=this.Zr(c.Hr);l.push(f)})),q.resolve(l)}getAllMutationBatchesAffectingDocumentKeys(e,t){let i=new rt(De);return t.forEach((a=>{const l=new Xt(a,0),c=new Xt(a,Number.POSITIVE_INFINITY);this.Jr.forEachInRange([l,c],(f=>{i=i.add(f.Hr)}))})),q.resolve(this.Yr(i))}getAllMutationBatchesAffectingQuery(e,t){const i=t.path,a=i.length+1;let l=i;me.isDocumentKey(l)||(l=l.child(""));const c=new Xt(new me(l),0);let f=new rt(De);return this.Jr.forEachWhile((p=>{const y=p.key.path;return!!i.isPrefixOf(y)&&(y.length===a&&(f=f.add(p.Hr)),!0)}),c),q.resolve(this.Yr(f))}Yr(e){const t=[];return e.forEach((i=>{const a=this.Zr(i);a!==null&&t.push(a)})),t}removeMutationBatch(e,t){be(this.ei(t.batchId,"removed")===0,55003),this.mutationQueue.shift();let i=this.Jr;return q.forEach(t.mutations,(a=>{const l=new Xt(a.key,t.batchId);return i=i.delete(l),this.referenceDelegate.markPotentiallyOrphaned(e,a.key)})).next((()=>{this.Jr=i}))}nr(e){}containsKey(e,t){const i=new Xt(t,0),a=this.Jr.firstAfterOrEqual(i);return q.resolve(t.isEqual(a&&a.key))}performConsistencyCheck(e){return this.mutationQueue.length,q.resolve()}ei(e,t){return this.Xr(e)}Xr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Zr(e){const t=this.Xr(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}class NV{constructor(e){this.ti=e,this.docs=(function(){return new ft(me.comparator)})(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const i=t.key,a=this.docs.get(i),l=a?a.size:0,c=this.ti(t);return this.docs=this.docs.insert(i,{document:t.mutableCopy(),size:c}),this.size+=c-l,this.indexManager.addToCollectionParentIndex(e,i.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const i=this.docs.get(t);return q.resolve(i?i.document.mutableCopy():Et.newInvalidDocument(t))}getEntries(e,t){let i=Hn();return t.forEach((a=>{const l=this.docs.get(a);i=i.insert(a,l?l.document.mutableCopy():Et.newInvalidDocument(a))})),q.resolve(i)}getDocumentsMatchingQuery(e,t,i,a){let l=Hn();const c=t.path,f=new me(c.child("__id-9223372036854775808__")),p=this.docs.getIteratorFrom(f);for(;p.hasNext();){const{key:y,value:{document:v}}=p.getNext();if(!c.isPrefixOf(y.path))break;y.path.length>c.length+1||iv(DS(v),i)<=0||(a.has(v.key)||rh(t,v))&&(l=l.insert(v.key,v.mutableCopy()))}return q.resolve(l)}getAllFromCollectionGroup(e,t,i,a){ye(9500)}ni(e,t){return q.forEach(this.docs,(i=>t(i)))}newChangeBuffer(e){return new jV(this)}getSize(e){return q.resolve(this.size)}}class jV extends Jw{constructor(e){super(),this.Mr=e}applyChanges(e){const t=[];return this.changes.forEach(((i,a)=>{a.isValidDocument()?t.push(this.Mr.addEntry(e,a)):this.Mr.removeEntry(i)})),q.waitFor(t)}getFromCache(e,t){return this.Mr.getEntry(e,t)}getAllFromCache(e,t){return this.Mr.getEntries(e,t)}}class kV{constructor(e){this.persistence=e,this.ri=new Ys((t=>so(t)),sh),this.lastRemoteSnapshotVersion=Se.min(),this.highestTargetId=0,this.ii=0,this.si=new xv,this.targetCount=0,this.oi=oo._r()}forEachTarget(e,t){return this.ri.forEach(((i,a)=>t(a))),q.resolve()}getLastRemoteSnapshotVersion(e){return q.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return q.resolve(this.ii)}allocateTargetId(e){return this.highestTargetId=this.oi.next(),q.resolve(this.highestTargetId)}setTargetsMetadata(e,t,i){return i&&(this.lastRemoteSnapshotVersion=i),t>this.ii&&(this.ii=t),q.resolve()}lr(e){this.ri.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.oi=new oo(t),this.highestTargetId=t),e.sequenceNumber>this.ii&&(this.ii=e.sequenceNumber)}addTargetData(e,t){return this.lr(t),this.targetCount+=1,q.resolve()}updateTargetData(e,t){return this.lr(t),q.resolve()}removeTargetData(e,t){return this.ri.delete(t.target),this.si.Gr(t.targetId),this.targetCount-=1,q.resolve()}removeTargets(e,t,i){let a=0;const l=[];return this.ri.forEach(((c,f)=>{f.sequenceNumber<=t&&i.get(f.targetId)===null&&(this.ri.delete(c),l.push(this.removeMatchingKeysForTargetId(e,f.targetId)),a++)})),q.waitFor(l).next((()=>a))}getTargetCount(e){return q.resolve(this.targetCount)}getTargetData(e,t){const i=this.ri.get(t)||null;return q.resolve(i)}addMatchingKeys(e,t,i){return this.si.$r(t,i),q.resolve()}removeMatchingKeys(e,t,i){this.si.Qr(t,i);const a=this.persistence.referenceDelegate,l=[];return a&&t.forEach((c=>{l.push(a.markPotentiallyOrphaned(e,c))})),q.waitFor(l)}removeMatchingKeysForTargetId(e,t){return this.si.Gr(t),q.resolve()}getMatchingKeysForTargetId(e,t){const i=this.si.jr(t);return q.resolve(i)}containsKey(e,t){return q.resolve(this.si.containsKey(t))}}class Sv{constructor(e,t){this._i={},this.overlays={},this.ai=new Cn(0),this.ui=!1,this.ui=!0,this.ci=new RV,this.referenceDelegate=e(this),this.li=new kV(this),this.indexManager=new vV,this.remoteDocumentCache=(function(a){return new NV(a)})((i=>this.referenceDelegate.hi(i))),this.serializer=new zw(t),this.Pi=new IV(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.ui=!1,Promise.resolve()}get started(){return this.ui}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new CV,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let i=this._i[e.toKey()];return i||(i=new DV(t,this.referenceDelegate),this._i[e.toKey()]=i),i}getGlobalsCache(){return this.ci}getTargetCache(){return this.li}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Pi}runTransaction(e,t,i){ce("MemoryPersistence","Starting transaction:",e);const a=new OV(this.ai.next());return this.referenceDelegate.Ti(),i(a).next((l=>this.referenceDelegate.Ii(a).next((()=>l)))).toPromise().then((l=>(a.raiseOnCommittedEvent(),l)))}Ei(e,t){return q.or(Object.values(this._i).map((i=>()=>i.containsKey(e,t))))}}class OV extends jS{constructor(e){super(),this.currentSequenceNumber=e}}class _m{constructor(e){this.persistence=e,this.Ri=new xv,this.Ai=null}static Vi(e){return new _m(e)}get di(){if(this.Ai)return this.Ai;throw ye(60996)}addReference(e,t,i){return this.Ri.addReference(i,t),this.di.delete(i.toString()),q.resolve()}removeReference(e,t,i){return this.Ri.removeReference(i,t),this.di.add(i.toString()),q.resolve()}markPotentiallyOrphaned(e,t){return this.di.add(t.toString()),q.resolve()}removeTarget(e,t){this.Ri.Gr(t.targetId).forEach((a=>this.di.add(a.toString())));const i=this.persistence.getTargetCache();return i.getMatchingKeysForTargetId(e,t.targetId).next((a=>{a.forEach((l=>this.di.add(l.toString())))})).next((()=>i.removeTargetData(e,t)))}Ti(){this.Ai=new Set}Ii(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return q.forEach(this.di,(i=>{const a=me.fromPath(i);return this.mi(e,a).next((l=>{l||t.removeEntry(a,Se.min())}))})).next((()=>(this.Ai=null,t.apply(e))))}updateLimboDocument(e,t){return this.mi(e,t).next((i=>{i?this.di.delete(t.toString()):this.di.add(t.toString())}))}hi(e){return 0}mi(e,t){return q.or([()=>q.resolve(this.Ri.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Ei(e,t)])}}class Ff{constructor(e,t){this.persistence=e,this.fi=new Ys((i=>mn(i.path)),((i,a)=>i.isEqual(a))),this.garbageCollector=Xw(this,t)}static Vi(e,t){return new Ff(e,t)}Ti(){}Ii(e){return q.resolve()}forEachTarget(e,t){return this.persistence.getTargetCache().forEachTarget(e,t)}dr(e){const t=this.pr(e);return this.persistence.getTargetCache().getTargetCount(e).next((i=>t.next((a=>i+a))))}pr(e){let t=0;return this.mr(e,(i=>{t++})).next((()=>t))}mr(e,t){return q.forEach(this.fi,((i,a)=>this.wr(e,i,a).next((l=>l?q.resolve():t(a)))))}removeTargets(e,t,i){return this.persistence.getTargetCache().removeTargets(e,t,i)}removeOrphanedDocuments(e,t){let i=0;const a=this.persistence.getRemoteDocumentCache(),l=a.newChangeBuffer();return a.ni(e,(c=>this.wr(e,c,t).next((f=>{f||(i++,l.removeEntry(c,Se.min()))})))).next((()=>l.apply(e))).next((()=>i))}markPotentiallyOrphaned(e,t){return this.fi.set(t,e.currentSequenceNumber),q.resolve()}removeTarget(e,t){const i=t.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,i)}addReference(e,t,i){return this.fi.set(i,e.currentSequenceNumber),q.resolve()}removeReference(e,t,i){return this.fi.set(i,e.currentSequenceNumber),q.resolve()}updateLimboDocument(e,t){return this.fi.set(t,e.currentSequenceNumber),q.resolve()}hi(e){let t=e.key.toString().length;return e.isFoundDocument()&&(t+=mf(e.data.value)),t}wr(e,t,i){return q.or([()=>this.persistence.Ei(e,t),()=>this.persistence.getTargetCache().containsKey(e,t),()=>{const a=this.fi.get(t);return q.resolve(a!==void 0&&a>i)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}class VV{constructor(e){this.serializer=e}k(e,t,i,a){const l=new om("createOrUpgrade",t);i<1&&a>=1&&((function(p){p.createObjectStore(ih)})(e),(function(p){p.createObjectStore(Ou,{keyPath:Kk}),p.createObjectStore(wi,{keyPath:kE,autoIncrement:!0}).createIndex(Wa,OE,{unique:!0}),p.createObjectStore(Cl)})(e),xx(e),(function(p){p.createObjectStore(Ha)})(e));let c=q.resolve();return i<3&&a>=3&&(i!==0&&((function(p){p.deleteObjectStore(Dl),p.deleteObjectStore(Rl),p.deleteObjectStore(Xa)})(e),xx(e)),c=c.next((()=>(function(p){const y=p.store(Xa),v={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:Se.min().toTimestamp(),targetCount:0};return y.put(Of,v)})(l)))),i<4&&a>=4&&(i!==0&&(c=c.next((()=>(function(p,y){return y.store(wi).H().next((b=>{p.deleteObjectStore(wi),p.createObjectStore(wi,{keyPath:kE,autoIncrement:!0}).createIndex(Wa,OE,{unique:!0});const x=y.store(wi),k=b.map((O=>x.put(O)));return q.waitFor(k)}))})(e,l)))),c=c.next((()=>{(function(p){p.createObjectStore(Nl,{keyPath:nO})})(e)}))),i<5&&a>=5&&(c=c.next((()=>this.gi(l)))),i<6&&a>=6&&(c=c.next((()=>((function(p){p.createObjectStore(Vu)})(e),this.pi(l))))),i<7&&a>=7&&(c=c.next((()=>this.yi(l)))),i<8&&a>=8&&(c=c.next((()=>this.wi(e,l)))),i<9&&a>=9&&(c=c.next((()=>{(function(p){p.objectStoreNames.contains("remoteDocumentChanges")&&p.deleteObjectStore("remoteDocumentChanges")})(e)}))),i<10&&a>=10&&(c=c.next((()=>this.bi(l)))),i<11&&a>=11&&(c=c.next((()=>{(function(p){p.createObjectStore(lm,{keyPath:iO})})(e),(function(p){p.createObjectStore(cm,{keyPath:sO})})(e)}))),i<12&&a>=12&&(c=c.next((()=>{(function(p){const y=p.createObjectStore(um,{keyPath:hO});y.createIndex(gy,dO,{unique:!1}),y.createIndex(zS,fO,{unique:!1})})(e)}))),i<13&&a>=13&&(c=c.next((()=>(function(p){const y=p.createObjectStore(kf,{keyPath:Wk});y.createIndex(df,Yk),y.createIndex(MS,Xk)})(e))).next((()=>this.Si(e,l))).next((()=>e.deleteObjectStore(Ha)))),i<14&&a>=14&&(c=c.next((()=>this.Di(e,l)))),i<15&&a>=15&&(c=c.next((()=>(function(p){p.createObjectStore(av,{keyPath:rO,autoIncrement:!0}).createIndex(py,aO,{unique:!1}),p.createObjectStore(Eu,{keyPath:oO}).createIndex(LS,lO,{unique:!1}),p.createObjectStore(xu,{keyPath:cO}).createIndex(US,uO,{unique:!1})})(e)))),i<16&&a>=16&&(c=c.next((()=>{t.objectStore(Eu).clear()})).next((()=>{t.objectStore(xu).clear()}))),i<17&&a>=17&&(c=c.next((()=>{(function(p){p.createObjectStore(ov,{keyPath:mO})})(e)}))),i<18&&a>=18&&N1()&&(c=c.next((()=>{t.objectStore(Eu).clear()})).next((()=>{t.objectStore(xu).clear()}))),c}pi(e){let t=0;return e.store(Ha).ee(((i,a)=>{t+=Bf(a)})).next((()=>{const i={byteSize:t};return e.store(Vu).put(my,i)}))}gi(e){const t=e.store(Ou),i=e.store(wi);return t.H().next((a=>q.forEach(a,(l=>{const c=IDBKeyRange.bound([l.userId,Ya],[l.userId,l.lastAcknowledgedBatchId]);return i.H(Wa,c).next((f=>q.forEach(f,(p=>{be(p.userId===l.userId,18650,"Cannot process batch from unexpected user",{batchId:p.batchId});const y=Qa(this.serializer,p);return Qw(e,l.userId,y).next((()=>{}))}))))}))))}yi(e){const t=e.store(Dl),i=e.store(Ha);return e.store(Xa).get(Of).next((a=>{const l=[];return i.ee(((c,f)=>{const p=new We(c),y=(function(b){return[0,mn(b)]})(p);l.push(t.get(y).next((v=>v?q.resolve():(b=>t.put({targetId:0,path:mn(b),sequenceNumber:a.highestListenSequenceNumber}))(p))))})).next((()=>q.waitFor(l)))}))}wi(e,t){e.createObjectStore(Mu,{keyPath:tO});const i=t.store(Mu),a=new Ev,l=c=>{if(a.add(c)){const f=c.lastSegment(),p=c.popLast();return i.put({collectionId:f,parent:mn(p)})}};return t.store(Ha).ee({Y:!0},((c,f)=>{const p=new We(c);return l(p.popLast())})).next((()=>t.store(Cl).ee({Y:!0},(([c,f,p],y)=>{const v=is(f);return l(v.popLast())}))))}bi(e){const t=e.store(Rl);return t.ee(((i,a)=>{const l=yu(a),c=Bw(this.serializer,l);return t.put(c)}))}Si(e,t){const i=t.store(Ha),a=[];return i.ee(((l,c)=>{const f=t.store(kf),p=(function(b){return b.document?new me(We.fromString(b.document.name).popFirst(5)):b.noDocument?me.fromSegments(b.noDocument.path):b.unknownDocument?me.fromSegments(b.unknownDocument.path):ye(36783)})(c).path.toArray(),y={prefixPath:p.slice(0,p.length-2),collectionGroup:p[p.length-2],documentId:p[p.length-1],readTime:c.readTime||[0,0],unknownDocument:c.unknownDocument,noDocument:c.noDocument,document:c.document,hasCommittedMutations:!!c.hasCommittedMutations};a.push(f.put(y))})).next((()=>q.waitFor(a)))}Di(e,t){const i=t.store(wi),a=Zw(this.serializer),l=new Sv(_m.Vi,this.serializer.yt);return i.H().next((c=>{const f=new Map;return c.forEach((p=>{let y=f.get(p.userId)??Pe();Qa(this.serializer,p).keys().forEach((v=>y=y.add(v))),f.set(p.userId,y)})),q.forEach(f,((p,y)=>{const v=new dn(y),b=ym.wt(this.serializer,v),x=l.getIndexManager(v),k=vm.wt(v,this.serializer,x,l.referenceDelegate);return new eA(a,k,b,x).recalculateAndSaveOverlaysForDocumentKeys(new yy(t,Cn.ce),p).next()}))}))}}function xx(s){s.createObjectStore(Dl,{keyPath:Zk}).createIndex(rv,eO,{unique:!0}),s.createObjectStore(Rl,{keyPath:"targetId"}).createIndex(PS,Jk,{unique:!0}),s.createObjectStore(Xa)}const Pr="IndexedDbPersistence",Hg=18e5,Gg=5e3,Qg="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.",MV="main";class wv{constructor(e,t,i,a,l,c,f,p,y,v,b=18){if(this.allowTabSynchronization=e,this.persistenceKey=t,this.clientId=i,this.Ci=l,this.window=c,this.document=f,this.Fi=y,this.Mi=v,this.xi=b,this.ai=null,this.ui=!1,this.isPrimary=!1,this.networkEnabled=!0,this.Oi=null,this.inForeground=!1,this.Ni=null,this.Bi=null,this.Li=Number.NEGATIVE_INFINITY,this.ki=x=>Promise.resolve(),!wv.v())throw new he(te.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new xV(this,a),this.Ki=t+MV,this.serializer=new zw(p),this.qi=new Wr(this.Ki,this.xi,new VV(this.serializer)),this.ci=new dV,this.li=new bV(this.referenceDelegate,this.serializer),this.remoteDocumentCache=Zw(this.serializer),this.Pi=new hV,this.window&&this.window.localStorage?this.Ui=this.window.localStorage:(this.Ui=null,v===!1&&kt(Pr,"LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.$i().then((()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new he(te.FAILED_PRECONDITION,Qg);return this.Wi(),this.Qi(),this.Gi(),this.runTransaction("getHighestListenSequenceNumber","readonly",(e=>this.li.getHighestSequenceNumber(e)))})).then((e=>{this.ai=new Cn(e,this.Fi)})).then((()=>{this.ui=!0})).catch((e=>(this.qi&&this.qi.close(),Promise.reject(e))))}zi(e){return this.ki=async t=>{if(this.started)return e(t)},e(this.isPrimary)}setDatabaseDeletedListener(e){this.qi.q((async t=>{t.newVersion===null&&await e()}))}setNetworkEnabled(e){this.networkEnabled!==e&&(this.networkEnabled=e,this.Ci.enqueueAndForget((async()=>{this.started&&await this.$i()})))}$i(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",(e=>$d(e).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next((()=>{if(this.isPrimary)return this.ji(e).next((t=>{t||(this.isPrimary=!1,this.Ci.enqueueRetryable((()=>this.ki(!1))))}))})).next((()=>this.Hi(e))).next((t=>this.isPrimary&&!t?this.Ji(e).next((()=>!1)):!!t&&this.Zi(e).next((()=>!0)))))).catch((e=>{if(ra(e))return ce(Pr,"Failed to extend owner lease: ",e),this.isPrimary;if(!this.allowTabSynchronization)throw e;return ce(Pr,"Releasing owner lease after error during lease refresh",e),!1})).then((e=>{this.isPrimary!==e&&this.Ci.enqueueRetryable((()=>this.ki(e))),this.isPrimary=e}))}ji(e){return uu(e).get(sl).next((t=>q.resolve(this.Xi(t))))}Yi(e){return $d(e).delete(this.clientId)}async es(){if(this.isPrimary&&!this.ts(this.Li,Hg)){this.Li=Date.now();const e=await this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",(t=>{const i=Kt(t,Nl);return i.H().next((a=>{const l=this.ns(a,Hg),c=a.filter((f=>l.indexOf(f)===-1));return q.forEach(c,(f=>i.delete(f.clientId))).next((()=>c))}))})).catch((()=>[]));if(this.Ui)for(const t of e)this.Ui.removeItem(this.rs(t.clientId))}}Gi(){this.Bi=this.Ci.enqueueAfterDelay("client_metadata_refresh",4e3,(()=>this.$i().then((()=>this.es())).then((()=>this.Gi()))))}Xi(e){return!!e&&e.ownerId===this.clientId}Hi(e){return this.Mi?q.resolve(!0):uu(e).get(sl).next((t=>{if(t!==null&&this.ts(t.leaseTimestampMs,Gg)&&!this.ss(t.ownerId)){if(this.Xi(t)&&this.networkEnabled)return!0;if(!this.Xi(t)){if(!t.allowTabSynchronization)throw new he(te.FAILED_PRECONDITION,Qg);return!1}}return!(!this.networkEnabled||!this.inForeground)||$d(e).H().next((i=>this.ns(i,Gg).find((a=>{if(this.clientId!==a.clientId){const l=!this.networkEnabled&&a.networkEnabled,c=!this.inForeground&&a.inForeground,f=this.networkEnabled===a.networkEnabled;if(l||c&&f)return!0}return!1}))===void 0))})).next((t=>(this.isPrimary!==t&&ce(Pr,`Client ${t?"is":"is not"} eligible for a primary lease.`),t)))}async shutdown(){this.ui=!1,this._s(),this.Bi&&(this.Bi.cancel(),this.Bi=null),this.us(),this.cs(),await this.qi.runTransaction("shutdown","readwrite",[ih,Nl],(e=>{const t=new yy(e,Cn.ce);return this.Ji(t).next((()=>this.Yi(t)))})),this.qi.close(),this.ls()}ns(e,t){return e.filter((i=>this.ts(i.updateTimeMs,t)&&!this.ss(i.clientId)))}hs(){return this.runTransaction("getActiveClients","readonly",(e=>$d(e).H().next((t=>this.ns(t,Hg).map((i=>i.clientId))))))}get started(){return this.ui}getGlobalsCache(){return this.ci}getMutationQueue(e,t){return vm.wt(e,this.serializer,t,this.referenceDelegate)}getTargetCache(){return this.li}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(e){return new _V(e,this.serializer.yt.databaseId)}getDocumentOverlayCache(e){return ym.wt(this.serializer,e)}getBundleCache(){return this.Pi}runTransaction(e,t,i){ce(Pr,"Starting transaction:",e);const a=t==="readonly"?"readonly":"readwrite",l=(function(p){return p===18?yO:p===17?HS:p===16?gO:p===15?lv:p===14?qS:p===13?FS:p===12?pO:p===11?BS:void ye(60245)})(this.xi);let c;return this.qi.runTransaction(e,a,l,(f=>(c=new yy(f,this.ai?this.ai.next():Cn.ce),t==="readwrite-primary"?this.ji(c).next((p=>!!p||this.Hi(c))).next((p=>{if(!p)throw kt(`Failed to obtain primary lease for action '${e}'.`),this.isPrimary=!1,this.Ci.enqueueRetryable((()=>this.ki(!1))),new he(te.FAILED_PRECONDITION,NS);return i(c)})).next((p=>this.Zi(c).next((()=>p)))):this.Ps(c).next((()=>i(c)))))).then((f=>(c.raiseOnCommittedEvent(),f)))}Ps(e){return uu(e).get(sl).next((t=>{if(t!==null&&this.ts(t.leaseTimestampMs,Gg)&&!this.ss(t.ownerId)&&!this.Xi(t)&&!(this.Mi||this.allowTabSynchronization&&t.allowTabSynchronization))throw new he(te.FAILED_PRECONDITION,Qg)}))}Zi(e){const t={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return uu(e).put(sl,t)}static v(){return Wr.v()}Ji(e){const t=uu(e);return t.get(sl).next((i=>this.Xi(i)?(ce(Pr,"Releasing primary lease."),t.delete(sl)):q.resolve()))}ts(e,t){const i=Date.now();return!(e<i-t)&&(!(e>i)||(kt(`Detected an update time that is in the future: ${e} > ${i}`),!1))}Wi(){this.document!==null&&typeof this.document.addEventListener=="function"&&(this.Ni=()=>{this.Ci.enqueueAndForget((()=>(this.inForeground=this.document.visibilityState==="visible",this.$i())))},this.document.addEventListener("visibilitychange",this.Ni),this.inForeground=this.document.visibilityState==="visible")}us(){this.Ni&&(this.document.removeEventListener("visibilitychange",this.Ni),this.Ni=null)}Qi(){typeof this.window?.addEventListener=="function"&&(this.Oi=()=>{this._s();const e=/(?:Version|Mobile)\/1[456]/;D1()&&(navigator.appVersion.match(e)||navigator.userAgent.match(e))&&this.Ci.enterRestrictedMode(!0),this.Ci.enqueueAndForget((()=>this.shutdown()))},this.window.addEventListener("pagehide",this.Oi))}cs(){this.Oi&&(this.window.removeEventListener("pagehide",this.Oi),this.Oi=null)}ss(e){try{const t=this.Ui?.getItem(this.rs(e))!==null;return ce(Pr,`Client '${e}' ${t?"is":"is not"} zombied in LocalStorage`),t}catch(t){return kt(Pr,"Failed to get zombied client id.",t),!1}}_s(){if(this.Ui)try{this.Ui.setItem(this.rs(this.clientId),String(Date.now()))}catch(e){kt("Failed to set zombie client id.",e)}}ls(){if(this.Ui)try{this.Ui.removeItem(this.rs(this.clientId))}catch{}}rs(e){return`firestore_zombie_${this.persistenceKey}_${e}`}}function uu(s){return Kt(s,ih)}function $d(s){return Kt(s,Nl)}function tA(s,e){let t=s.projectId;return s.isDefaultDatabase||(t+="."+s.database),"firestore/"+e+"/"+t+"/"}class Av{constructor(e,t,i,a){this.targetId=e,this.fromCache=t,this.Ts=i,this.Is=a}static Es(e,t){let i=Pe(),a=Pe();for(const l of t.docChanges)switch(l.type){case 0:i=i.add(l.doc.key);break;case 1:a=a.add(l.doc.key)}return new Av(e,t.fromCache,i,a)}}class PV{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}class nA{constructor(){this.Rs=!1,this.As=!1,this.Vs=100,this.ds=(function(){return D1()?8:kS(Qt())>0?6:4})()}initialize(e,t){this.fs=e,this.indexManager=t,this.Rs=!0}getDocumentsMatchingQuery(e,t,i,a){const l={result:null};return this.gs(e,t).next((c=>{l.result=c})).next((()=>{if(!l.result)return this.ps(e,t,a,i).next((c=>{l.result=c}))})).next((()=>{if(l.result)return;const c=new PV;return this.ys(e,t,c).next((f=>{if(l.result=f,this.As)return this.ws(e,t,c,f.size)}))})).next((()=>l.result))}ws(e,t,i,a){return i.documentReadCount<this.Vs?(hl()<=Fe.DEBUG&&ce("QueryEngine","SDK will not create cache indexes for query:",dl(t),"since it only creates cache indexes for collection contains","more than or equal to",this.Vs,"documents"),q.resolve()):(hl()<=Fe.DEBUG&&ce("QueryEngine","Query:",dl(t),"scans",i.documentReadCount,"local documents and returns",a,"documents as results."),i.documentReadCount>this.ds*a?(hl()<=Fe.DEBUG&&ce("QueryEngine","The SDK decides to create cache indexes for query:",dl(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Gn(t))):q.resolve())}gs(e,t){if(KE(t))return q.resolve(null);let i=Gn(t);return this.indexManager.getIndexType(e,i).next((a=>a===0?null:(t.limit!==null&&a===1&&(t=Lf(t,null,"F"),i=Gn(t)),this.indexManager.getDocumentsMatchingTarget(e,i).next((l=>{const c=Pe(...l);return this.fs.getDocuments(e,c).next((f=>this.indexManager.getMinOffset(e,i).next((p=>{const y=this.bs(t,f);return this.Ss(t,y,c,p.readTime)?this.gs(e,Lf(t,null,"F")):this.Ds(e,y,t,p)}))))})))))}ps(e,t,i,a){return KE(t)||a.isEqual(Se.min())?q.resolve(null):this.fs.getDocuments(e,i).next((l=>{const c=this.bs(t,l);return this.Ss(t,c,i,a)?q.resolve(null):(hl()<=Fe.DEBUG&&ce("QueryEngine","Re-using previous result from %s to execute query: %s",a.toString(),dl(t)),this.Ds(e,c,t,RS(a,Il)).next((f=>f)))}))}bs(e,t){let i=new rt(dw(e));return t.forEach(((a,l)=>{rh(e,l)&&(i=i.add(l))})),i}Ss(e,t,i,a){if(e.limit===null)return!1;if(i.size!==t.size)return!0;const l=e.limitType==="F"?t.last():t.first();return!!l&&(l.hasPendingWrites||l.version.compareTo(a)>0)}ys(e,t,i){return hl()<=Fe.DEBUG&&ce("QueryEngine","Using full collection scan to execute query:",dl(t)),this.fs.getDocumentsMatchingQuery(e,t,Qn.min(),i)}Ds(e,t,i,a){return this.fs.getDocumentsMatchingQuery(e,i,a).next((l=>(t.forEach((c=>{l=l.insert(c.key,c)})),l)))}}const Iv="LocalStore",LV=3e8;class UV{constructor(e,t,i,a){this.persistence=e,this.Cs=t,this.serializer=a,this.vs=new ft(De),this.Fs=new Ys((l=>so(l)),sh),this.Ms=new Map,this.xs=e.getRemoteDocumentCache(),this.li=e.getTargetCache(),this.Pi=e.getBundleCache(),this.Os(i)}Os(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new eA(this.xs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.xs.setIndexManager(this.indexManager),this.Cs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",(t=>e.collect(t,this.vs)))}}function iA(s,e,t,i){return new UV(s,e,t,i)}async function sA(s,e){const t=_e(s);return await t.persistence.runTransaction("Handle user change","readonly",(i=>{let a;return t.mutationQueue.getAllMutationBatches(i).next((l=>(a=l,t.Os(e),t.mutationQueue.getAllMutationBatches(i)))).next((l=>{const c=[],f=[];let p=Pe();for(const y of a){c.push(y.batchId);for(const v of y.mutations)p=p.add(v.key)}for(const y of l){f.push(y.batchId);for(const v of y.mutations)p=p.add(v.key)}return t.localDocuments.getDocuments(i,p).next((y=>({Ns:y,removedBatchIds:c,addedBatchIds:f})))}))}))}function zV(s,e){const t=_e(s);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",(i=>{const a=e.batch.keys(),l=t.xs.newChangeBuffer({trackRemovals:!0});return(function(f,p,y,v){const b=y.batch,x=b.keys();let k=q.resolve();return x.forEach((O=>{k=k.next((()=>v.getEntry(p,O))).next((D=>{const M=y.docVersions.get(O);be(M!==null,48541),D.version.compareTo(M)<0&&(b.applyToRemoteDocument(D,y),D.isValidDocument()&&(D.setReadTime(y.commitVersion),v.addEntry(D)))}))})),k.next((()=>f.mutationQueue.removeMutationBatch(p,b)))})(t,i,e,l).next((()=>l.apply(i))).next((()=>t.mutationQueue.performConsistencyCheck(i))).next((()=>t.documentOverlayCache.removeOverlaysForBatchId(i,a,e.batch.batchId))).next((()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(i,(function(f){let p=Pe();for(let y=0;y<f.mutationResults.length;++y)f.mutationResults[y].transformResults.length>0&&(p=p.add(f.batch.mutations[y].key));return p})(e)))).next((()=>t.localDocuments.getDocuments(i,a)))}))}function rA(s){const e=_e(s);return e.persistence.runTransaction("Get last remote snapshot version","readonly",(t=>e.li.getLastRemoteSnapshotVersion(t)))}function BV(s,e){const t=_e(s),i=e.snapshotVersion;let a=t.vs;return t.persistence.runTransaction("Apply remote event","readwrite-primary",(l=>{const c=t.xs.newChangeBuffer({trackRemovals:!0});a=t.vs;const f=[];e.targetChanges.forEach(((v,b)=>{const x=a.get(b);if(!x)return;f.push(t.li.removeMatchingKeys(l,v.removedDocuments,b).next((()=>t.li.addMatchingKeys(l,v.addedDocuments,b))));let k=x.withSequenceNumber(l.currentSequenceNumber);e.targetMismatches.get(b)!==null?k=k.withResumeToken(Ot.EMPTY_BYTE_STRING,Se.min()).withLastLimboFreeSnapshotVersion(Se.min()):v.resumeToken.approximateByteSize()>0&&(k=k.withResumeToken(v.resumeToken,i)),a=a.insert(b,k),(function(D,M,Y){return D.resumeToken.approximateByteSize()===0||M.snapshotVersion.toMicroseconds()-D.snapshotVersion.toMicroseconds()>=LV?!0:Y.addedDocuments.size+Y.modifiedDocuments.size+Y.removedDocuments.size>0})(x,k,v)&&f.push(t.li.updateTargetData(l,k))}));let p=Hn(),y=Pe();if(e.documentUpdates.forEach((v=>{e.resolvedLimboDocuments.has(v)&&f.push(t.persistence.referenceDelegate.updateLimboDocument(l,v))})),f.push(FV(l,c,e.documentUpdates).next((v=>{p=v.Bs,y=v.Ls}))),!i.isEqual(Se.min())){const v=t.li.getLastRemoteSnapshotVersion(l).next((b=>t.li.setTargetsMetadata(l,l.currentSequenceNumber,i)));f.push(v)}return q.waitFor(f).next((()=>c.apply(l))).next((()=>t.localDocuments.getLocalViewOfDocuments(l,p,y))).next((()=>p))})).then((l=>(t.vs=a,l)))}function FV(s,e,t){let i=Pe(),a=Pe();return t.forEach((l=>i=i.add(l))),e.getEntries(s,i).next((l=>{let c=Hn();return t.forEach(((f,p)=>{const y=l.get(f);p.isFoundDocument()!==y.isFoundDocument()&&(a=a.add(f)),p.isNoDocument()&&p.version.isEqual(Se.min())?(e.removeEntry(f,p.readTime),c=c.insert(f,p)):!y.isValidDocument()||p.version.compareTo(y.version)>0||p.version.compareTo(y.version)===0&&y.hasPendingWrites?(e.addEntry(p),c=c.insert(f,p)):ce(Iv,"Ignoring outdated watch update for ",f,". Current version:",y.version," Watch version:",p.version)})),{Bs:c,Ls:a}}))}function qV(s,e){const t=_e(s);return t.persistence.runTransaction("Get next mutation batch","readonly",(i=>(e===void 0&&(e=Ya),t.mutationQueue.getNextMutationBatchAfterBatchId(i,e))))}function qf(s,e){const t=_e(s);return t.persistence.runTransaction("Allocate target","readwrite",(i=>{let a;return t.li.getTargetData(i,e).next((l=>l?(a=l,q.resolve(a)):t.li.allocateTargetId(i).next((c=>(a=new zs(e,c,"TargetPurposeListen",i.currentSequenceNumber),t.li.addTargetData(i,a).next((()=>a)))))))})).then((i=>{const a=t.vs.get(i.targetId);return(a===null||i.snapshotVersion.compareTo(a.snapshotVersion)>0)&&(t.vs=t.vs.insert(i.targetId,i),t.Fs.set(e,i.targetId)),i}))}async function zl(s,e,t){const i=_e(s),a=i.vs.get(e),l=t?"readwrite":"readwrite-primary";try{t||await i.persistence.runTransaction("Release target",l,(c=>i.persistence.referenceDelegate.removeTarget(c,a)))}catch(c){if(!ra(c))throw c;ce(Iv,`Failed to update sequence numbers for target ${e}: ${c}`)}i.vs=i.vs.remove(e),i.Fs.delete(a.target)}function Ny(s,e,t){const i=_e(s);let a=Se.min(),l=Pe();return i.persistence.runTransaction("Execute query","readwrite",(c=>(function(p,y,v){const b=_e(p),x=b.Fs.get(v);return x!==void 0?q.resolve(b.vs.get(x)):b.li.getTargetData(y,v)})(i,c,Gn(e)).next((f=>{if(f)return a=f.lastLimboFreeSnapshotVersion,i.li.getMatchingKeysForTargetId(c,f.targetId).next((p=>{l=p}))})).next((()=>i.Cs.getDocumentsMatchingQuery(c,e,t?a:Se.min(),t?l:Pe()))).next((f=>(lA(i,hw(e),f),{documents:f,ks:l})))))}function aA(s,e){const t=_e(s),i=_e(t.li),a=t.vs.get(e);return a?Promise.resolve(a.target):t.persistence.runTransaction("Get target data","readonly",(l=>i.At(l,e).next((c=>c?c.target:null))))}function oA(s,e){const t=_e(s),i=t.Ms.get(e)||Se.min();return t.persistence.runTransaction("Get new document changes","readonly",(a=>t.xs.getAllFromCollectionGroup(a,e,RS(i,Il),Number.MAX_SAFE_INTEGER))).then((a=>(lA(t,e,a),a)))}function lA(s,e,t){let i=s.Ms.get(e)||Se.min();t.forEach(((a,l)=>{l.readTime.compareTo(i)>0&&(i=l.readTime)})),s.Ms.set(e,i)}const cA="firestore_clients";function Sx(s,e){return`${cA}_${s}_${e}`}const uA="firestore_mutations";function wx(s,e,t){let i=`${uA}_${s}_${t}`;return e.isAuthenticated()&&(i+=`_${e.uid}`),i}const hA="firestore_targets";function Kg(s,e){return`${hA}_${s}_${e}`}const ns="SharedClientState";class Hf{constructor(e,t,i,a){this.user=e,this.batchId=t,this.state=i,this.error=a}static $s(e,t,i){const a=JSON.parse(i);let l,c=typeof a=="object"&&["pending","acknowledged","rejected"].indexOf(a.state)!==-1&&(a.error===void 0||typeof a.error=="object");return c&&a.error&&(c=typeof a.error.message=="string"&&typeof a.error.code=="string",c&&(l=new he(a.error.code,a.error.message))),c?new Hf(e,t,a.state,l):(kt(ns,`Failed to parse mutation state for ID '${t}': ${i}`),null)}Ws(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class Cu{constructor(e,t,i){this.targetId=e,this.state=t,this.error=i}static $s(e,t){const i=JSON.parse(t);let a,l=typeof i=="object"&&["not-current","current","rejected"].indexOf(i.state)!==-1&&(i.error===void 0||typeof i.error=="object");return l&&i.error&&(l=typeof i.error.message=="string"&&typeof i.error.code=="string",l&&(a=new he(i.error.code,i.error.message))),l?new Cu(e,i.state,a):(kt(ns,`Failed to parse target state for ID '${e}': ${t}`),null)}Ws(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class Gf{constructor(e,t){this.clientId=e,this.activeTargetIds=t}static $s(e,t){const i=JSON.parse(t);let a=typeof i=="object"&&i.activeTargetIds instanceof Array,l=fv();for(let c=0;a&&c<i.activeTargetIds.length;++c)a=OS(i.activeTargetIds[c]),l=l.add(i.activeTargetIds[c]);return a?new Gf(e,l):(kt(ns,`Failed to parse client data for instance '${e}': ${t}`),null)}}class Cv{constructor(e,t){this.clientId=e,this.onlineState=t}static $s(e){const t=JSON.parse(e);return typeof t=="object"&&["Unknown","Online","Offline"].indexOf(t.onlineState)!==-1&&typeof t.clientId=="string"?new Cv(t.clientId,t.onlineState):(kt(ns,`Failed to parse online state: ${e}`),null)}}class jy{constructor(){this.activeTargetIds=fv()}Qs(e){this.activeTargetIds=this.activeTargetIds.add(e)}Gs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Ws(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class $g{constructor(e,t,i,a,l){this.window=e,this.Ci=t,this.persistenceKey=i,this.zs=a,this.syncEngine=null,this.onlineStateHandler=null,this.sequenceNumberHandler=null,this.js=this.Hs.bind(this),this.Js=new ft(De),this.started=!1,this.Zs=[];const c=i.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=l,this.Xs=Sx(this.persistenceKey,this.zs),this.Ys=(function(p){return`firestore_sequence_number_${p}`})(this.persistenceKey),this.Js=this.Js.insert(this.zs,new jy),this.eo=new RegExp(`^${cA}_${c}_([^_]*)$`),this.no=new RegExp(`^${uA}_${c}_(\\d+)(?:_(.*))?$`),this.ro=new RegExp(`^${hA}_${c}_(\\d+)$`),this.io=(function(p){return`firestore_online_state_${p}`})(this.persistenceKey),this.so=(function(p){return`firestore_bundle_loaded_v2_${p}`})(this.persistenceKey),this.window.addEventListener("storage",this.js)}static v(e){return!(!e||!e.localStorage)}async start(){const e=await this.syncEngine.hs();for(const i of e){if(i===this.zs)continue;const a=this.getItem(Sx(this.persistenceKey,i));if(a){const l=Gf.$s(i,a);l&&(this.Js=this.Js.insert(l.clientId,l))}}this.oo();const t=this.storage.getItem(this.io);if(t){const i=this._o(t);i&&this.ao(i)}for(const i of this.Zs)this.Hs(i);this.Zs=[],this.window.addEventListener("pagehide",(()=>this.shutdown())),this.started=!0}writeSequenceNumber(e){this.setItem(this.Ys,JSON.stringify(e))}getAllActiveQueryTargets(){return this.uo(this.Js)}isActiveQueryTarget(e){let t=!1;return this.Js.forEach(((i,a)=>{a.activeTargetIds.has(e)&&(t=!0)})),t}addPendingMutation(e){this.co(e,"pending")}updateMutationState(e,t,i){this.co(e,t,i),this.lo(e)}addLocalQueryTarget(e,t=!0){let i="not-current";if(this.isActiveQueryTarget(e)){const a=this.storage.getItem(Kg(this.persistenceKey,e));if(a){const l=Cu.$s(e,a);l&&(i=l.state)}}return t&&this.ho.Qs(e),this.oo(),i}removeLocalQueryTarget(e){this.ho.Gs(e),this.oo()}isLocalQueryTarget(e){return this.ho.activeTargetIds.has(e)}clearQueryState(e){this.removeItem(Kg(this.persistenceKey,e))}updateQueryState(e,t,i){this.Po(e,t,i)}handleUserChange(e,t,i){t.forEach((a=>{this.lo(a)})),this.currentUser=e,i.forEach((a=>{this.addPendingMutation(a)}))}setOnlineState(e){this.To(e)}notifyBundleLoaded(e){this.Io(e)}shutdown(){this.started&&(this.window.removeEventListener("storage",this.js),this.removeItem(this.Xs),this.started=!1)}getItem(e){const t=this.storage.getItem(e);return ce(ns,"READ",e,t),t}setItem(e,t){ce(ns,"SET",e,t),this.storage.setItem(e,t)}removeItem(e){ce(ns,"REMOVE",e),this.storage.removeItem(e)}Hs(e){const t=e;if(t.storageArea===this.storage){if(ce(ns,"EVENT",t.key,t.newValue),t.key===this.Xs)return void kt("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.Ci.enqueueRetryable((async()=>{if(this.started){if(t.key!==null){if(this.eo.test(t.key)){if(t.newValue==null){const i=this.Eo(t.key);return this.Ro(i,null)}{const i=this.Ao(t.key,t.newValue);if(i)return this.Ro(i.clientId,i)}}else if(this.no.test(t.key)){if(t.newValue!==null){const i=this.Vo(t.key,t.newValue);if(i)return this.mo(i)}}else if(this.ro.test(t.key)){if(t.newValue!==null){const i=this.fo(t.key,t.newValue);if(i)return this.po(i)}}else if(t.key===this.io){if(t.newValue!==null){const i=this._o(t.newValue);if(i)return this.ao(i)}}else if(t.key===this.Ys){const i=(function(l){let c=Cn.ce;if(l!=null)try{const f=JSON.parse(l);be(typeof f=="number",30636,{yo:l}),c=f}catch(f){kt(ns,"Failed to read sequence number from WebStorage",f)}return c})(t.newValue);i!==Cn.ce&&this.sequenceNumberHandler(i)}else if(t.key===this.so){const i=this.wo(t.newValue);await Promise.all(i.map((a=>this.syncEngine.bo(a))))}}}else this.Zs.push(t)}))}}get ho(){return this.Js.get(this.zs)}oo(){this.setItem(this.Xs,this.ho.Ws())}co(e,t,i){const a=new Hf(this.currentUser,e,t,i),l=wx(this.persistenceKey,this.currentUser,e);this.setItem(l,a.Ws())}lo(e){const t=wx(this.persistenceKey,this.currentUser,e);this.removeItem(t)}To(e){const t={clientId:this.zs,onlineState:e};this.storage.setItem(this.io,JSON.stringify(t))}Po(e,t,i){const a=Kg(this.persistenceKey,e),l=new Cu(e,t,i);this.setItem(a,l.Ws())}Io(e){const t=JSON.stringify(Array.from(e));this.setItem(this.so,t)}Eo(e){const t=this.eo.exec(e);return t?t[1]:null}Ao(e,t){const i=this.Eo(e);return Gf.$s(i,t)}Vo(e,t){const i=this.no.exec(e),a=Number(i[1]),l=i[2]!==void 0?i[2]:null;return Hf.$s(new dn(l),a,t)}fo(e,t){const i=this.ro.exec(e),a=Number(i[1]);return Cu.$s(a,t)}_o(e){return Cv.$s(e)}wo(e){return JSON.parse(e)}async mo(e){if(e.user.uid===this.currentUser.uid)return this.syncEngine.So(e.batchId,e.state,e.error);ce(ns,`Ignoring mutation for non-active user ${e.user.uid}`)}po(e){return this.syncEngine.Do(e.targetId,e.state,e.error)}Ro(e,t){const i=t?this.Js.insert(e,t):this.Js.remove(e),a=this.uo(this.Js),l=this.uo(i),c=[],f=[];return l.forEach((p=>{a.has(p)||c.push(p)})),a.forEach((p=>{l.has(p)||f.push(p)})),this.syncEngine.Co(c,f).then((()=>{this.Js=i}))}ao(e){this.Js.get(e.clientId)&&this.onlineStateHandler(e.onlineState)}uo(e){let t=fv();return e.forEach(((i,a)=>{t=t.unionWith(a.activeTargetIds)})),t}}class dA{constructor(){this.vo=new jy,this.Fo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,i){}addLocalQueryTarget(e,t=!0){return t&&this.vo.Qs(e),this.Fo[e]||"not-current"}updateQueryState(e,t,i){this.Fo[e]=t}removeLocalQueryTarget(e){this.vo.Gs(e)}isLocalQueryTarget(e){return this.vo.activeTargetIds.has(e)}clearQueryState(e){delete this.Fo[e]}getAllActiveQueryTargets(){return this.vo.activeTargetIds}isActiveQueryTarget(e){return this.vo.activeTargetIds.has(e)}start(){return this.vo=new jy,Promise.resolve()}handleUserChange(e,t,i){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}class HV{Mo(e){}shutdown(){}}const Ax="ConnectivityMonitor";class Ix{constructor(){this.xo=()=>this.Oo(),this.No=()=>this.Bo(),this.Lo=[],this.ko()}Mo(e){this.Lo.push(e)}shutdown(){window.removeEventListener("online",this.xo),window.removeEventListener("offline",this.No)}ko(){window.addEventListener("online",this.xo),window.addEventListener("offline",this.No)}Oo(){ce(Ax,"Network connectivity changed: AVAILABLE");for(const e of this.Lo)e(0)}Bo(){ce(Ax,"Network connectivity changed: UNAVAILABLE");for(const e of this.Lo)e(1)}static v(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}let Wd=null;function ky(){return Wd===null?Wd=(function(){return 268435456+Math.round(2147483648*Math.random())})():Wd++,"0x"+Wd.toString(16)}const Wg="RestConnection",GV={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery",ExecutePipeline:"executePipeline"};class QV{get Ko(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const t=e.ssl?"https":"http",i=encodeURIComponent(this.databaseId.projectId),a=encodeURIComponent(this.databaseId.database);this.qo=t+"://"+e.host,this.Uo=`projects/${i}/databases/${a}`,this.$o=this.databaseId.database===Vf?`project_id=${i}`:`project_id=${i}&database_id=${a}`}Wo(e,t,i,a,l){const c=ky(),f=this.Qo(e,t.toUriEncodedString());ce(Wg,`Sending RPC '${e}' ${c}:`,f,i);const p={"google-cloud-resource-prefix":this.Uo,"x-goog-request-params":this.$o};this.Go(p,a,l);const{host:y}=new URL(f),v=uo(y);return this.zo(e,f,p,i,v).then((b=>(ce(Wg,`Received RPC '${e}' ${c}: `,b),b)),(b=>{throw wl(Wg,`RPC '${e}' ${c} failed with error: `,b,"url: ",f,"request:",i),b}))}jo(e,t,i,a,l,c){return this.Wo(e,t,i,a,l)}Go(e,t,i){e["X-Goog-Api-Client"]=(function(){return"gl-js/ fire/"+Wl})(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach(((a,l)=>e[l]=a)),i&&i.headers.forEach(((a,l)=>e[l]=a))}Qo(e,t){const i=GV[e];let a=`${this.qo}/v1/${t}:${i}`;return this.databaseInfo.apiKey&&(a=`${a}?key=${encodeURIComponent(this.databaseInfo.apiKey)}`),a}terminate(){}}class KV{constructor(e){this.Ho=e.Ho,this.Jo=e.Jo}Zo(e){this.Xo=e}Yo(e){this.e_=e}t_(e){this.n_=e}onMessage(e){this.r_=e}close(){this.Jo()}send(e){this.Ho(e)}i_(){this.Xo()}s_(){this.e_()}o_(e){this.n_(e)}__(e){this.r_(e)}}const un="WebChannelConnection",hu=(s,e,t)=>{s.listen(e,(i=>{try{t(i)}catch(a){setTimeout((()=>{throw a}),0)}}))};class Tl extends QV{constructor(e){super(e),this.a_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}static u_(){if(!Tl.c_){const e=xS();hu(e,ES.STAT_EVENT,(t=>{t.stat===hy.PROXY?ce(un,"STAT_EVENT: detected buffering proxy"):t.stat===hy.NOPROXY&&ce(un,"STAT_EVENT: detected no buffering proxy")})),Tl.c_=!0}}zo(e,t,i,a,l){const c=ky();return new Promise(((f,p)=>{const y=new bS;y.setWithCredentials(!0),y.listenOnce(TS.COMPLETE,(()=>{try{switch(y.getLastErrorCode()){case cf.NO_ERROR:const b=y.getResponseJson();ce(un,`XHR for RPC '${e}' ${c} received:`,JSON.stringify(b)),f(b);break;case cf.TIMEOUT:ce(un,`RPC '${e}' ${c} timed out`),p(new he(te.DEADLINE_EXCEEDED,"Request time out"));break;case cf.HTTP_ERROR:const x=y.getStatus();if(ce(un,`RPC '${e}' ${c} failed with status:`,x,"response text:",y.getResponseText()),x>0){let k=y.getResponseJson();Array.isArray(k)&&(k=k[0]);const O=k?.error;if(O&&O.status&&O.message){const D=(function(Y){const Z=Y.toLowerCase().replace(/_/g,"-");return Object.values(te).indexOf(Z)>=0?Z:te.UNKNOWN})(O.status);p(new he(D,O.message))}else p(new he(te.UNKNOWN,"Server responded with status "+y.getStatus()))}else p(new he(te.UNAVAILABLE,"Connection failed."));break;default:ye(9055,{l_:e,streamId:c,h_:y.getLastErrorCode(),P_:y.getLastError()})}}finally{ce(un,`RPC '${e}' ${c} completed.`)}}));const v=JSON.stringify(a);ce(un,`RPC '${e}' ${c} sending request:`,a),y.send(t,"POST",v,i,15)}))}T_(e,t,i){const a=ky(),l=[this.qo,"/","google.firestore.v1.Firestore","/",e,"/channel"],c=this.createWebChannelTransport(),f={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},p=this.longPollingOptions.timeoutSeconds;p!==void 0&&(f.longPollingTimeout=Math.round(1e3*p)),this.useFetchStreams&&(f.useFetchStreams=!0),this.Go(f.initMessageHeaders,t,i),f.encodeInitMessageHeaders=!0;const y=l.join("");ce(un,`Creating RPC '${e}' stream ${a}: ${y}`,f);const v=c.createWebChannel(y,f);this.I_(v);let b=!1,x=!1;const k=new KV({Ho:O=>{x?ce(un,`Not sending because RPC '${e}' stream ${a} is closed:`,O):(b||(ce(un,`Opening RPC '${e}' stream ${a} transport.`),v.open(),b=!0),ce(un,`RPC '${e}' stream ${a} sending:`,O),v.send(O))},Jo:()=>v.close()});return hu(v,mu.EventType.OPEN,(()=>{x||(ce(un,`RPC '${e}' stream ${a} transport opened.`),k.i_())})),hu(v,mu.EventType.CLOSE,(()=>{x||(x=!0,ce(un,`RPC '${e}' stream ${a} transport closed`),k.o_(),this.E_(v))})),hu(v,mu.EventType.ERROR,(O=>{x||(x=!0,wl(un,`RPC '${e}' stream ${a} transport errored. Name:`,O.name,"Message:",O.message),k.o_(new he(te.UNAVAILABLE,"The operation could not be completed")))})),hu(v,mu.EventType.MESSAGE,(O=>{if(!x){const D=O.data[0];be(!!D,16349);const M=D,Y=M?.error||M[0]?.error;if(Y){ce(un,`RPC '${e}' stream ${a} received error:`,Y);const Z=Y.status;let $=(function(se){const w=Ft[se];if(w!==void 0)return ww(w)})(Z),ne=Y.message;Z==="NOT_FOUND"&&ne.includes("database")&&ne.includes("does not exist")&&ne.includes(this.databaseId.database)&&wl(`Database '${this.databaseId.database}' not found. Please check your project configuration.`),$===void 0&&($=te.INTERNAL,ne="Unknown error status: "+Z+" with message "+Y.message),x=!0,k.o_(new he($,ne)),v.close()}else ce(un,`RPC '${e}' stream ${a} received:`,D),k.__(D)}})),Tl.u_(),setTimeout((()=>{k.s_()}),0),k}terminate(){this.a_.forEach((e=>e.close())),this.a_=[]}I_(e){this.a_.push(e)}E_(e){this.a_=this.a_.filter((t=>t===e))}Go(e,t,i){super.Go(e,t,i),this.databaseInfo.apiKey&&(e["x-goog-api-key"]=this.databaseInfo.apiKey)}createWebChannelTransport(){return SS()}}function $V(s){return new Tl(s)}function fA(){return typeof window<"u"?window:null}function _f(){return typeof document<"u"?document:null}function bm(s){return new ZO(s,!0)}Tl.c_=!1;class Rv{constructor(e,t,i=1e3,a=1.5,l=6e4){this.Ci=e,this.timerId=t,this.R_=i,this.A_=a,this.V_=l,this.d_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.d_=0}g_(){this.d_=this.V_}p_(e){this.cancel();const t=Math.floor(this.d_+this.y_()),i=Math.max(0,Date.now()-this.f_),a=Math.max(0,t-i);a>0&&ce("ExponentialBackoff",`Backing off for ${a} ms (base delay: ${this.d_} ms, delay with jitter: ${t} ms, last attempt: ${i} ms ago)`),this.m_=this.Ci.enqueueAfterDelay(this.timerId,a,(()=>(this.f_=Date.now(),e()))),this.d_*=this.A_,this.d_<this.R_&&(this.d_=this.R_),this.d_>this.V_&&(this.d_=this.V_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.d_}}const Cx="PersistentStream";class mA{constructor(e,t,i,a,l,c,f,p){this.Ci=e,this.b_=i,this.S_=a,this.connection=l,this.authCredentialsProvider=c,this.appCheckCredentialsProvider=f,this.listener=p,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new Rv(e,t)}x_(){return this.state===1||this.state===5||this.O_()}O_(){return this.state===2||this.state===3}start(){this.F_=0,this.state!==4?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&this.C_===null&&(this.C_=this.Ci.enqueueAfterDelay(this.b_,6e4,(()=>this.k_())))}K_(e){this.q_(),this.stream.send(e)}async k_(){if(this.O_())return this.close(0)}q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,t){this.q_(),this.U_(),this.M_.cancel(),this.D_++,e!==4?this.M_.reset():t&&t.code===te.RESOURCE_EXHAUSTED?(kt(t.toString()),kt("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):t&&t.code===te.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.W_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.t_(t)}W_(){}auth(){this.state=1;const e=this.Q_(this.D_),t=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then((([i,a])=>{this.D_===t&&this.G_(i,a)}),(i=>{e((()=>{const a=new he(te.UNKNOWN,"Fetching auth token failed: "+i.message);return this.z_(a)}))}))}G_(e,t){const i=this.Q_(this.D_);this.stream=this.j_(e,t),this.stream.Zo((()=>{i((()=>this.listener.Zo()))})),this.stream.Yo((()=>{i((()=>(this.state=2,this.v_=this.Ci.enqueueAfterDelay(this.S_,1e4,(()=>(this.O_()&&(this.state=3),Promise.resolve()))),this.listener.Yo())))})),this.stream.t_((a=>{i((()=>this.z_(a)))})),this.stream.onMessage((a=>{i((()=>++this.F_==1?this.H_(a):this.onNext(a)))}))}N_(){this.state=5,this.M_.p_((async()=>{this.state=0,this.start()}))}z_(e){return ce(Cx,`close with error: ${e}`),this.stream=null,this.close(4,e)}Q_(e){return t=>{this.Ci.enqueueAndForget((()=>this.D_===e?t():(ce(Cx,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())))}}}class WV extends mA{constructor(e,t,i,a,l,c){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,i,a,c),this.serializer=l}j_(e,t){return this.connection.T_("Listen",e,t)}H_(e){return this.onNext(e)}onNext(e){this.M_.reset();const t=iV(this.serializer,e),i=(function(l){if(!("targetChange"in l))return Se.min();const c=l.targetChange;return c.targetIds&&c.targetIds.length?Se.min():c.readTime?Jt(c.readTime):Se.min()})(e);return this.listener.J_(t,i)}Z_(e){const t={};t.database=Ay(this.serializer),t.addTarget=(function(l,c){let f;const p=c.target;if(f=Mf(p)?{documents:kw(l,p)}:{query:Ow(l,p).ft},f.targetId=c.targetId,c.resumeToken.approximateByteSize()>0){f.resumeToken=Cw(l,c.resumeToken);const y=Sy(l,c.expectedCount);y!==null&&(f.expectedCount=y)}else if(c.snapshotVersion.compareTo(Se.min())>0){f.readTime=Ul(l,c.snapshotVersion.toTimestamp());const y=Sy(l,c.expectedCount);y!==null&&(f.expectedCount=y)}return f})(this.serializer,e);const i=rV(this.serializer,e);i&&(t.labels=i),this.K_(t)}X_(e){const t={};t.database=Ay(this.serializer),t.removeTarget=e,this.K_(t)}}class YV extends mA{constructor(e,t,i,a,l,c){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,i,a,c),this.serializer=l}get Y_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}W_(){this.Y_&&this.ea([])}j_(e,t){return this.connection.T_("Write",e,t)}H_(e){return be(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,be(!e.writeResults||e.writeResults.length===0,55816),this.listener.ta()}onNext(e){be(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.M_.reset();const t=sV(e.writeResults,e.commitTime),i=Jt(e.commitTime);return this.listener.na(i,t)}ra(){const e={};e.database=Ay(this.serializer),this.K_(e)}ea(e){const t={streamToken:this.lastStreamToken,writes:e.map((i=>Hu(this.serializer,i)))};this.K_(t)}}class XV{}class JV extends XV{constructor(e,t,i,a){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=i,this.serializer=a,this.ia=!1}sa(){if(this.ia)throw new he(te.FAILED_PRECONDITION,"The client has already been terminated.")}Wo(e,t,i,a){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([l,c])=>this.connection.Wo(e,wy(t,i),a,l,c))).catch((l=>{throw l.name==="FirebaseError"?(l.code===te.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),l):new he(te.UNKNOWN,l.toString())}))}jo(e,t,i,a,l){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([c,f])=>this.connection.jo(e,wy(t,i),a,c,f,l))).catch((c=>{throw c.name==="FirebaseError"?(c.code===te.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),c):new he(te.UNKNOWN,c.toString())}))}terminate(){this.ia=!0,this.connection.terminate()}}function ZV(s,e,t,i){return new JV(s,e,t,i)}class eM{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){this.oa===0&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve()))))}ha(e){this.state==="Online"?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ca("Offline")))}set(e){this.Pa(),this.oa=0,e==="Online"&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){const t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(kt(t),this.aa=!1):ce("OnlineStateTracker",t)}Pa(){this._a!==null&&(this._a.cancel(),this._a=null)}}const lo="RemoteStore";class tM{constructor(e,t,i,a,l){this.localStore=e,this.datastore=t,this.asyncQueue=i,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.Ra=[],this.Aa=l,this.Aa.Mo((c=>{i.enqueueAndForget((async()=>{fo(this)&&(ce(lo,"Restarting streams for network reachability change."),await(async function(p){const y=_e(p);y.Ea.add(4),await lh(y),y.Va.set("Unknown"),y.Ea.delete(4),await Tm(y)})(this))}))})),this.Va=new eM(i,a)}}async function Tm(s){if(fo(s))for(const e of s.Ra)await e(!0)}async function lh(s){for(const e of s.Ra)await e(!1)}function Em(s,e){const t=_e(s);t.Ia.has(e.targetId)||(t.Ia.set(e.targetId,e),jv(t)?Nv(t):ec(t).O_()&&Dv(t,e))}function Bl(s,e){const t=_e(s),i=ec(t);t.Ia.delete(e),i.O_()&&pA(t,e),t.Ia.size===0&&(i.O_()?i.L_():fo(t)&&t.Va.set("Unknown"))}function Dv(s,e){if(s.da.$e(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(Se.min())>0){const t=s.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}ec(s).Z_(e)}function pA(s,e){s.da.$e(e),ec(s).X_(e)}function Nv(s){s.da=new WO({getRemoteKeysForTarget:e=>s.remoteSyncer.getRemoteKeysForTarget(e),At:e=>s.Ia.get(e)||null,ht:()=>s.datastore.serializer.databaseId}),ec(s).start(),s.Va.ua()}function jv(s){return fo(s)&&!ec(s).x_()&&s.Ia.size>0}function fo(s){return _e(s).Ea.size===0}function gA(s){s.da=void 0}async function nM(s){s.Va.set("Online")}async function iM(s){s.Ia.forEach(((e,t)=>{Dv(s,e)}))}async function sM(s,e){gA(s),jv(s)?(s.Va.ha(e),Nv(s)):s.Va.set("Unknown")}async function rM(s,e,t){if(s.Va.set("Online"),e instanceof Iw&&e.state===2&&e.cause)try{await(async function(a,l){const c=l.cause;for(const f of l.targetIds)a.Ia.has(f)&&(await a.remoteSyncer.rejectListen(f,c),a.Ia.delete(f),a.da.removeTarget(f))})(s,e)}catch(i){ce(lo,"Failed to remove targets %s: %s ",e.targetIds.join(","),i),await Qf(s,i)}else if(e instanceof yf?s.da.Xe(e):e instanceof Aw?s.da.st(e):s.da.tt(e),!t.isEqual(Se.min()))try{const i=await rA(s.localStore);t.compareTo(i)>=0&&await(function(l,c){const f=l.da.Tt(c);return f.targetChanges.forEach(((p,y)=>{if(p.resumeToken.approximateByteSize()>0){const v=l.Ia.get(y);v&&l.Ia.set(y,v.withResumeToken(p.resumeToken,c))}})),f.targetMismatches.forEach(((p,y)=>{const v=l.Ia.get(p);if(!v)return;l.Ia.set(p,v.withResumeToken(Ot.EMPTY_BYTE_STRING,v.snapshotVersion)),pA(l,p);const b=new zs(v.target,p,y,v.sequenceNumber);Dv(l,b)})),l.remoteSyncer.applyRemoteEvent(f)})(s,t)}catch(i){ce(lo,"Failed to raise snapshot:",i),await Qf(s,i)}}async function Qf(s,e,t){if(!ra(e))throw e;s.Ea.add(1),await lh(s),s.Va.set("Offline"),t||(t=()=>rA(s.localStore)),s.asyncQueue.enqueueRetryable((async()=>{ce(lo,"Retrying IndexedDB access"),await t(),s.Ea.delete(1),await Tm(s)}))}function yA(s,e){return e().catch((t=>Qf(s,t,e)))}async function Zl(s){const e=_e(s),t=ta(e);let i=e.Ta.length>0?e.Ta[e.Ta.length-1].batchId:Ya;for(;aM(e);)try{const a=await qV(e.localStore,i);if(a===null){e.Ta.length===0&&t.L_();break}i=a.batchId,oM(e,a)}catch(a){await Qf(e,a)}vA(e)&&_A(e)}function aM(s){return fo(s)&&s.Ta.length<10}function oM(s,e){s.Ta.push(e);const t=ta(s);t.O_()&&t.Y_&&t.ea(e.mutations)}function vA(s){return fo(s)&&!ta(s).x_()&&s.Ta.length>0}function _A(s){ta(s).start()}async function lM(s){ta(s).ra()}async function cM(s){const e=ta(s);for(const t of s.Ta)e.ea(t.mutations)}async function uM(s,e,t){const i=s.Ta.shift(),a=yv.from(i,e,t);await yA(s,(()=>s.remoteSyncer.applySuccessfulWrite(a))),await Zl(s)}async function hM(s,e){e&&ta(s).Y_&&await(async function(i,a){if((function(c){return Sw(c)&&c!==te.ABORTED})(a.code)){const l=i.Ta.shift();ta(i).B_(),await yA(i,(()=>i.remoteSyncer.rejectFailedWrite(l.batchId,a))),await Zl(i)}})(s,e),vA(s)&&_A(s)}async function Rx(s,e){const t=_e(s);t.asyncQueue.verifyOperationInProgress(),ce(lo,"RemoteStore received new credentials");const i=fo(t);t.Ea.add(3),await lh(t),i&&t.Va.set("Unknown"),await t.remoteSyncer.handleCredentialChange(e),t.Ea.delete(3),await Tm(t)}async function Oy(s,e){const t=_e(s);e?(t.Ea.delete(2),await Tm(t)):e||(t.Ea.add(2),await lh(t),t.Va.set("Unknown"))}function ec(s){return s.ma||(s.ma=(function(t,i,a){const l=_e(t);return l.sa(),new WV(i,l.connection,l.authCredentials,l.appCheckCredentials,l.serializer,a)})(s.datastore,s.asyncQueue,{Zo:nM.bind(null,s),Yo:iM.bind(null,s),t_:sM.bind(null,s),J_:rM.bind(null,s)}),s.Ra.push((async e=>{e?(s.ma.B_(),jv(s)?Nv(s):s.Va.set("Unknown")):(await s.ma.stop(),gA(s))}))),s.ma}function ta(s){return s.fa||(s.fa=(function(t,i,a){const l=_e(t);return l.sa(),new YV(i,l.connection,l.authCredentials,l.appCheckCredentials,l.serializer,a)})(s.datastore,s.asyncQueue,{Zo:()=>Promise.resolve(),Yo:lM.bind(null,s),t_:hM.bind(null,s),ta:cM.bind(null,s),na:uM.bind(null,s)}),s.Ra.push((async e=>{e?(s.fa.B_(),await Zl(s)):(await s.fa.stop(),s.Ta.length>0&&(ce(lo,`Stopping write stream with ${s.Ta.length} pending writes`),s.Ta=[]))}))),s.fa}class kv{constructor(e,t,i,a,l){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=i,this.op=a,this.removalCallback=l,this.deferred=new Ci,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((c=>{}))}get promise(){return this.deferred.promise}static createAndSchedule(e,t,i,a,l){const c=Date.now()+i,f=new kv(e,t,c,a,l);return f.start(i),f}start(e){this.timerHandle=setTimeout((()=>this.handleDelayElapsed()),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new he(te.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget((()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then((e=>this.deferred.resolve(e)))):Promise.resolve()))}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function Ov(s,e){if(kt("AsyncQueue",`${e}: ${s}`),ra(s))return new he(te.UNAVAILABLE,`${e}: ${s}`);throw s}class El{static emptySet(e){return new El(e.comparator)}constructor(e){this.comparator=e?(t,i)=>e(t,i)||me.comparator(t.key,i.key):(t,i)=>me.comparator(t.key,i.key),this.keyedMap=pu(),this.sortedSet=new ft(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal(((t,i)=>(e(t),!1)))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof El)||this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),i=e.sortedSet.getIterator();for(;t.hasNext();){const a=t.getNext().key,l=i.getNext().key;if(!a.isEqual(l))return!1}return!0}toString(){const e=[];return this.forEach((t=>{e.push(t.toString())})),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){const i=new El;return i.comparator=this.comparator,i.keyedMap=e,i.sortedSet=t,i}}class Dx{constructor(){this.ga=new ft(me.comparator)}track(e){const t=e.doc.key,i=this.ga.get(t);i?e.type!==0&&i.type===3?this.ga=this.ga.insert(t,e):e.type===3&&i.type!==1?this.ga=this.ga.insert(t,{type:i.type,doc:e.doc}):e.type===2&&i.type===2?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):e.type===2&&i.type===0?this.ga=this.ga.insert(t,{type:0,doc:e.doc}):e.type===1&&i.type===0?this.ga=this.ga.remove(t):e.type===1&&i.type===2?this.ga=this.ga.insert(t,{type:1,doc:i.doc}):e.type===0&&i.type===1?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):ye(63341,{Vt:e,pa:i}):this.ga=this.ga.insert(t,e)}ya(){const e=[];return this.ga.inorderTraversal(((t,i)=>{e.push(i)})),e}}class Fl{constructor(e,t,i,a,l,c,f,p,y){this.query=e,this.docs=t,this.oldDocs=i,this.docChanges=a,this.mutatedKeys=l,this.fromCache=c,this.syncStateChanged=f,this.excludesMetadataChanges=p,this.hasCachedResults=y}static fromInitialDocuments(e,t,i,a,l){const c=[];return t.forEach((f=>{c.push({type:0,doc:f})})),new Fl(e,t,El.emptySet(t),c,i,a,!0,!1,l)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&mm(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,i=e.docChanges;if(t.length!==i.length)return!1;for(let a=0;a<t.length;a++)if(t[a].type!==i[a].type||!t[a].doc.isEqual(i[a].doc))return!1;return!0}}class dM{constructor(){this.wa=void 0,this.ba=[]}Sa(){return this.ba.some((e=>e.Da()))}}class fM{constructor(){this.queries=Nx(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(t,i){const a=_e(t),l=a.queries;a.queries=Nx(),l.forEach(((c,f)=>{for(const p of f.ba)p.onError(i)}))})(this,new he(te.ABORTED,"Firestore shutting down"))}}function Nx(){return new Ys((s=>uw(s)),mm)}async function bA(s,e){const t=_e(s);let i=3;const a=e.query;let l=t.queries.get(a);l?!l.Sa()&&e.Da()&&(i=2):(l=new dM,i=e.Da()?0:1);try{switch(i){case 0:l.wa=await t.onListen(a,!0);break;case 1:l.wa=await t.onListen(a,!1);break;case 2:await t.onFirstRemoteStoreListen(a)}}catch(c){const f=Ov(c,`Initialization of query '${dl(e.query)}' failed`);return void e.onError(f)}t.queries.set(a,l),l.ba.push(e),e.va(t.onlineState),l.wa&&e.Fa(l.wa)&&Vv(t)}async function TA(s,e){const t=_e(s),i=e.query;let a=3;const l=t.queries.get(i);if(l){const c=l.ba.indexOf(e);c>=0&&(l.ba.splice(c,1),l.ba.length===0?a=e.Da()?0:1:!l.Sa()&&e.Da()&&(a=2))}switch(a){case 0:return t.queries.delete(i),t.onUnlisten(i,!0);case 1:return t.queries.delete(i),t.onUnlisten(i,!1);case 2:return t.onLastRemoteStoreUnlisten(i);default:return}}function mM(s,e){const t=_e(s);let i=!1;for(const a of e){const l=a.query,c=t.queries.get(l);if(c){for(const f of c.ba)f.Fa(a)&&(i=!0);c.wa=a}}i&&Vv(t)}function pM(s,e,t){const i=_e(s),a=i.queries.get(e);if(a)for(const l of a.ba)l.onError(t);i.queries.delete(e)}function Vv(s){s.Ca.forEach((e=>{e.next()}))}var Vy,jx;(jx=Vy||(Vy={})).Ma="default",jx.Cache="cache";class EA{constructor(e,t,i){this.query=e,this.xa=t,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=i||{}}Fa(e){if(!this.options.includeMetadataChanges){const i=[];for(const a of e.docChanges)a.type!==3&&i.push(a);e=new Fl(e.query,e.docs,e.oldDocs,i,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.Oa?this.Ba(e)&&(this.xa.next(e),t=!0):this.La(e,this.onlineState)&&(this.ka(e),t=!0),this.Na=e,t}onError(e){this.xa.error(e)}va(e){this.onlineState=e;let t=!1;return this.Na&&!this.Oa&&this.La(this.Na,e)&&(this.ka(this.Na),t=!0),t}La(e,t){if(!e.fromCache||!this.Da())return!0;const i=t!=="Offline";return(!this.options.Ka||!i)&&(!e.docs.isEmpty()||e.hasCachedResults||t==="Offline")}Ba(e){if(e.docChanges.length>0)return!0;const t=this.Na&&this.Na.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&this.options.includeMetadataChanges===!0}ka(e){e=Fl.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Oa=!0,this.xa.next(e)}Da(){return this.options.source!==Vy.Cache}}class xA{constructor(e){this.key=e}}class SA{constructor(e){this.key=e}}class gM{constructor(e,t){this.query=e,this.Za=t,this.Xa=null,this.hasCachedResults=!1,this.current=!1,this.Ya=Pe(),this.mutatedKeys=Pe(),this.eu=dw(e),this.tu=new El(this.eu)}get nu(){return this.Za}ru(e,t){const i=t?t.iu:new Dx,a=t?t.tu:this.tu;let l=t?t.mutatedKeys:this.mutatedKeys,c=a,f=!1;const p=this.query.limitType==="F"&&a.size===this.query.limit?a.last():null,y=this.query.limitType==="L"&&a.size===this.query.limit?a.first():null;if(e.inorderTraversal(((v,b)=>{const x=a.get(v),k=rh(this.query,b)?b:null,O=!!x&&this.mutatedKeys.has(x.key),D=!!k&&(k.hasLocalMutations||this.mutatedKeys.has(k.key)&&k.hasCommittedMutations);let M=!1;x&&k?x.data.isEqual(k.data)?O!==D&&(i.track({type:3,doc:k}),M=!0):this.su(x,k)||(i.track({type:2,doc:k}),M=!0,(p&&this.eu(k,p)>0||y&&this.eu(k,y)<0)&&(f=!0)):!x&&k?(i.track({type:0,doc:k}),M=!0):x&&!k&&(i.track({type:1,doc:x}),M=!0,(p||y)&&(f=!0)),M&&(k?(c=c.add(k),l=D?l.add(v):l.delete(v)):(c=c.delete(v),l=l.delete(v)))})),this.query.limit!==null)for(;c.size>this.query.limit;){const v=this.query.limitType==="F"?c.last():c.first();c=c.delete(v.key),l=l.delete(v.key),i.track({type:1,doc:v})}return{tu:c,iu:i,Ss:f,mutatedKeys:l}}su(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,i,a){const l=this.tu;this.tu=e.tu,this.mutatedKeys=e.mutatedKeys;const c=e.iu.ya();c.sort(((v,b)=>(function(k,O){const D=M=>{switch(M){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return ye(20277,{Vt:M})}};return D(k)-D(O)})(v.type,b.type)||this.eu(v.doc,b.doc))),this.ou(i),a=a??!1;const f=t&&!a?this._u():[],p=this.Ya.size===0&&this.current&&!a?1:0,y=p!==this.Xa;return this.Xa=p,c.length!==0||y?{snapshot:new Fl(this.query,e.tu,l,c,e.mutatedKeys,p===0,y,!1,!!i&&i.resumeToken.approximateByteSize()>0),au:f}:{au:f}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({tu:this.tu,iu:new Dx,mutatedKeys:this.mutatedKeys,Ss:!1},!1)):{au:[]}}uu(e){return!this.Za.has(e)&&!!this.tu.has(e)&&!this.tu.get(e).hasLocalMutations}ou(e){e&&(e.addedDocuments.forEach((t=>this.Za=this.Za.add(t))),e.modifiedDocuments.forEach((t=>{})),e.removedDocuments.forEach((t=>this.Za=this.Za.delete(t))),this.current=e.current)}_u(){if(!this.current)return[];const e=this.Ya;this.Ya=Pe(),this.tu.forEach((i=>{this.uu(i.key)&&(this.Ya=this.Ya.add(i.key))}));const t=[];return e.forEach((i=>{this.Ya.has(i)||t.push(new SA(i))})),this.Ya.forEach((i=>{e.has(i)||t.push(new xA(i))})),t}cu(e){this.Za=e.ks,this.Ya=Pe();const t=this.ru(e.documents);return this.applyChanges(t,!0)}lu(){return Fl.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,this.Xa===0,this.hasCachedResults)}}const tc="SyncEngine";class yM{constructor(e,t,i){this.query=e,this.targetId=t,this.view=i}}class vM{constructor(e){this.key=e,this.hu=!1}}class _M{constructor(e,t,i,a,l,c){this.localStore=e,this.remoteStore=t,this.eventManager=i,this.sharedClientState=a,this.currentUser=l,this.maxConcurrentLimboResolutions=c,this.Pu={},this.Tu=new Ys((f=>uw(f)),mm),this.Iu=new Map,this.Eu=new Set,this.Ru=new ft(me.comparator),this.Au=new Map,this.Vu=new xv,this.du={},this.mu=new Map,this.fu=oo.ar(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return this.gu===!0}}async function bM(s,e,t=!0){const i=xm(s);let a;const l=i.Tu.get(e);return l?(i.sharedClientState.addLocalQueryTarget(l.targetId),a=l.view.lu()):a=await wA(i,e,t,!0),a}async function TM(s,e){const t=xm(s);await wA(t,e,!0,!1)}async function wA(s,e,t,i){const a=await qf(s.localStore,Gn(e)),l=a.targetId,c=s.sharedClientState.addLocalQueryTarget(l,t);let f;return i&&(f=await Mv(s,e,l,c==="current",a.resumeToken)),s.isPrimaryClient&&t&&Em(s.remoteStore,a),f}async function Mv(s,e,t,i,a){s.pu=(b,x,k)=>(async function(D,M,Y,Z){let $=M.view.ru(Y);$.Ss&&($=await Ny(D.localStore,M.query,!1).then((({documents:w})=>M.view.ru(w,$))));const ne=Z&&Z.targetChanges.get(M.targetId),ee=Z&&Z.targetMismatches.get(M.targetId)!=null,se=M.view.applyChanges($,D.isPrimaryClient,ne,ee);return My(D,M.targetId,se.au),se.snapshot})(s,b,x,k);const l=await Ny(s.localStore,e,!0),c=new gM(e,l.ks),f=c.ru(l.documents),p=oh.createSynthesizedTargetChangeForCurrentChange(t,i&&s.onlineState!=="Offline",a),y=c.applyChanges(f,s.isPrimaryClient,p);My(s,t,y.au);const v=new yM(e,t,c);return s.Tu.set(e,v),s.Iu.has(t)?s.Iu.get(t).push(e):s.Iu.set(t,[e]),y.snapshot}async function EM(s,e,t){const i=_e(s),a=i.Tu.get(e),l=i.Iu.get(a.targetId);if(l.length>1)return i.Iu.set(a.targetId,l.filter((c=>!mm(c,e)))),void i.Tu.delete(e);i.isPrimaryClient?(i.sharedClientState.removeLocalQueryTarget(a.targetId),i.sharedClientState.isActiveQueryTarget(a.targetId)||await zl(i.localStore,a.targetId,!1).then((()=>{i.sharedClientState.clearQueryState(a.targetId),t&&Bl(i.remoteStore,a.targetId),ql(i,a.targetId)})).catch(sa)):(ql(i,a.targetId),await zl(i.localStore,a.targetId,!0))}async function xM(s,e){const t=_e(s),i=t.Tu.get(e),a=t.Iu.get(i.targetId);t.isPrimaryClient&&a.length===1&&(t.sharedClientState.removeLocalQueryTarget(i.targetId),Bl(t.remoteStore,i.targetId))}async function SM(s,e,t){const i=zv(s);try{const a=await(function(c,f){const p=_e(c),y=it.now(),v=f.reduce(((k,O)=>k.add(O.key)),Pe());let b,x;return p.persistence.runTransaction("Locally write mutations","readwrite",(k=>{let O=Hn(),D=Pe();return p.xs.getEntries(k,v).next((M=>{O=M,O.forEach(((Y,Z)=>{Z.isValidDocument()||(D=D.add(Y))}))})).next((()=>p.localDocuments.getOverlayedDocuments(k,O))).next((M=>{b=M;const Y=[];for(const Z of f){const $=GO(Z,b.get(Z.key).overlayedDocument);$!=null&&Y.push(new Xs(Z.key,$,ew($.value.mapValue),xt.exists(!0)))}return p.mutationQueue.addMutationBatch(k,y,Y,f)})).next((M=>{x=M;const Y=M.applyToLocalDocumentSet(b,D);return p.documentOverlayCache.saveOverlays(k,M.batchId,Y)}))})).then((()=>({batchId:x.batchId,changes:mw(b)})))})(i.localStore,e);i.sharedClientState.addPendingMutation(a.batchId),(function(c,f,p){let y=c.du[c.currentUser.toKey()];y||(y=new ft(De)),y=y.insert(f,p),c.du[c.currentUser.toKey()]=y})(i,a.batchId,t),await oa(i,a.changes),await Zl(i.remoteStore)}catch(a){const l=Ov(a,"Failed to persist write");t.reject(l)}}async function AA(s,e){const t=_e(s);try{const i=await BV(t.localStore,e);e.targetChanges.forEach(((a,l)=>{const c=t.Au.get(l);c&&(be(a.addedDocuments.size+a.modifiedDocuments.size+a.removedDocuments.size<=1,22616),a.addedDocuments.size>0?c.hu=!0:a.modifiedDocuments.size>0?be(c.hu,14607):a.removedDocuments.size>0&&(be(c.hu,42227),c.hu=!1))})),await oa(t,i,e)}catch(i){await sa(i)}}function kx(s,e,t){const i=_e(s);if(i.isPrimaryClient&&t===0||!i.isPrimaryClient&&t===1){const a=[];i.Tu.forEach(((l,c)=>{const f=c.view.va(e);f.snapshot&&a.push(f.snapshot)})),(function(c,f){const p=_e(c);p.onlineState=f;let y=!1;p.queries.forEach(((v,b)=>{for(const x of b.ba)x.va(f)&&(y=!0)})),y&&Vv(p)})(i.eventManager,e),a.length&&i.Pu.J_(a),i.onlineState=e,i.isPrimaryClient&&i.sharedClientState.setOnlineState(e)}}async function wM(s,e,t){const i=_e(s);i.sharedClientState.updateQueryState(e,"rejected",t);const a=i.Au.get(e),l=a&&a.key;if(l){let c=new ft(me.comparator);c=c.insert(l,Et.newNoDocument(l,Se.min()));const f=Pe().add(l),p=new ah(Se.min(),new Map,new ft(De),c,f);await AA(i,p),i.Ru=i.Ru.remove(l),i.Au.delete(e),Uv(i)}else await zl(i.localStore,e,!1).then((()=>ql(i,e,t))).catch(sa)}async function AM(s,e){const t=_e(s),i=e.batch.batchId;try{const a=await zV(t.localStore,e);Lv(t,i,null),Pv(t,i),t.sharedClientState.updateMutationState(i,"acknowledged"),await oa(t,a)}catch(a){await sa(a)}}async function IM(s,e,t){const i=_e(s);try{const a=await(function(c,f){const p=_e(c);return p.persistence.runTransaction("Reject batch","readwrite-primary",(y=>{let v;return p.mutationQueue.lookupMutationBatch(y,f).next((b=>(be(b!==null,37113),v=b.keys(),p.mutationQueue.removeMutationBatch(y,b)))).next((()=>p.mutationQueue.performConsistencyCheck(y))).next((()=>p.documentOverlayCache.removeOverlaysForBatchId(y,v,f))).next((()=>p.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(y,v))).next((()=>p.localDocuments.getDocuments(y,v)))}))})(i.localStore,e);Lv(i,e,t),Pv(i,e),i.sharedClientState.updateMutationState(e,"rejected",t),await oa(i,a)}catch(a){await sa(a)}}function Pv(s,e){(s.mu.get(e)||[]).forEach((t=>{t.resolve()})),s.mu.delete(e)}function Lv(s,e,t){const i=_e(s);let a=i.du[i.currentUser.toKey()];if(a){const l=a.get(e);l&&(t?l.reject(t):l.resolve(),a=a.remove(e)),i.du[i.currentUser.toKey()]=a}}function ql(s,e,t=null){s.sharedClientState.removeLocalQueryTarget(e);for(const i of s.Iu.get(e))s.Tu.delete(i),t&&s.Pu.yu(i,t);s.Iu.delete(e),s.isPrimaryClient&&s.Vu.Gr(e).forEach((i=>{s.Vu.containsKey(i)||IA(s,i)}))}function IA(s,e){s.Eu.delete(e.path.canonicalString());const t=s.Ru.get(e);t!==null&&(Bl(s.remoteStore,t),s.Ru=s.Ru.remove(e),s.Au.delete(t),Uv(s))}function My(s,e,t){for(const i of t)i instanceof xA?(s.Vu.addReference(i.key,e),CM(s,i)):i instanceof SA?(ce(tc,"Document no longer in limbo: "+i.key),s.Vu.removeReference(i.key,e),s.Vu.containsKey(i.key)||IA(s,i.key)):ye(19791,{wu:i})}function CM(s,e){const t=e.key,i=t.path.canonicalString();s.Ru.get(t)||s.Eu.has(i)||(ce(tc,"New document in limbo: "+t),s.Eu.add(i),Uv(s))}function Uv(s){for(;s.Eu.size>0&&s.Ru.size<s.maxConcurrentLimboResolutions;){const e=s.Eu.values().next().value;s.Eu.delete(e);const t=new me(We.fromString(e)),i=s.fu.next();s.Au.set(i,new vM(t)),s.Ru=s.Ru.insert(t,i),Em(s.remoteStore,new zs(Gn(fm(t.path)),i,"TargetPurposeLimboResolution",Cn.ce))}}async function oa(s,e,t){const i=_e(s),a=[],l=[],c=[];i.Tu.isEmpty()||(i.Tu.forEach(((f,p)=>{c.push(i.pu(p,e,t).then((y=>{if((y||t)&&i.isPrimaryClient){const v=y?!y.fromCache:t?.targetChanges.get(p.targetId)?.current;i.sharedClientState.updateQueryState(p.targetId,v?"current":"not-current")}if(y){a.push(y);const v=Av.Es(p.targetId,y);l.push(v)}})))})),await Promise.all(c),i.Pu.J_(a),await(async function(p,y){const v=_e(p);try{await v.persistence.runTransaction("notifyLocalViewChanges","readwrite",(b=>q.forEach(y,(x=>q.forEach(x.Ts,(k=>v.persistence.referenceDelegate.addReference(b,x.targetId,k))).next((()=>q.forEach(x.Is,(k=>v.persistence.referenceDelegate.removeReference(b,x.targetId,k)))))))))}catch(b){if(!ra(b))throw b;ce(Iv,"Failed to update sequence numbers: "+b)}for(const b of y){const x=b.targetId;if(!b.fromCache){const k=v.vs.get(x),O=k.snapshotVersion,D=k.withLastLimboFreeSnapshotVersion(O);v.vs=v.vs.insert(x,D)}}})(i.localStore,l))}async function RM(s,e){const t=_e(s);if(!t.currentUser.isEqual(e)){ce(tc,"User change. New user:",e.toKey());const i=await sA(t.localStore,e);t.currentUser=e,(function(l,c){l.mu.forEach((f=>{f.forEach((p=>{p.reject(new he(te.CANCELLED,c))}))})),l.mu.clear()})(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,i.removedBatchIds,i.addedBatchIds),await oa(t,i.Ns)}}function DM(s,e){const t=_e(s),i=t.Au.get(e);if(i&&i.hu)return Pe().add(i.key);{let a=Pe();const l=t.Iu.get(e);if(!l)return a;for(const c of l){const f=t.Tu.get(c);a=a.unionWith(f.view.nu)}return a}}async function NM(s,e){const t=_e(s),i=await Ny(t.localStore,e.query,!0),a=e.view.cu(i);return t.isPrimaryClient&&My(t,e.targetId,a.au),a}async function jM(s,e){const t=_e(s);return oA(t.localStore,e).then((i=>oa(t,i)))}async function kM(s,e,t,i){const a=_e(s),l=await(function(f,p){const y=_e(f),v=_e(y.mutationQueue);return y.persistence.runTransaction("Lookup mutation documents","readonly",(b=>v.Xn(b,p).next((x=>x?y.localDocuments.getDocuments(b,x):q.resolve(null)))))})(a.localStore,e);l!==null?(t==="pending"?await Zl(a.remoteStore):t==="acknowledged"||t==="rejected"?(Lv(a,e,i||null),Pv(a,e),(function(f,p){_e(_e(f).mutationQueue).nr(p)})(a.localStore,e)):ye(6720,"Unknown batchState",{bu:t}),await oa(a,l)):ce(tc,"Cannot apply mutation batch with id: "+e)}async function OM(s,e){const t=_e(s);if(xm(t),zv(t),e===!0&&t.gu!==!0){const i=t.sharedClientState.getAllActiveQueryTargets(),a=await Ox(t,i.toArray());t.gu=!0,await Oy(t.remoteStore,!0);for(const l of a)Em(t.remoteStore,l)}else if(e===!1&&t.gu!==!1){const i=[];let a=Promise.resolve();t.Iu.forEach(((l,c)=>{t.sharedClientState.isLocalQueryTarget(c)?i.push(c):a=a.then((()=>(ql(t,c),zl(t.localStore,c,!0)))),Bl(t.remoteStore,c)})),await a,await Ox(t,i),(function(c){const f=_e(c);f.Au.forEach(((p,y)=>{Bl(f.remoteStore,y)})),f.Vu.zr(),f.Au=new Map,f.Ru=new ft(me.comparator)})(t),t.gu=!1,await Oy(t.remoteStore,!1)}}async function Ox(s,e,t){const i=_e(s),a=[],l=[];for(const c of e){let f;const p=i.Iu.get(c);if(p&&p.length!==0){f=await qf(i.localStore,Gn(p[0]));for(const y of p){const v=i.Tu.get(y),b=await NM(i,v);b.snapshot&&l.push(b.snapshot)}}else{const y=await aA(i.localStore,c);f=await qf(i.localStore,y),await Mv(i,CA(y),c,!1,f.resumeToken)}a.push(f)}return i.Pu.J_(l),a}function CA(s){return lw(s.path,s.collectionGroup,s.orderBy,s.filters,s.limit,"F",s.startAt,s.endAt)}function VM(s){return(function(t){return _e(_e(t).persistence).hs()})(_e(s).localStore)}async function MM(s,e,t,i){const a=_e(s);if(a.gu)return void ce(tc,"Ignoring unexpected query state notification.");const l=a.Iu.get(e);if(l&&l.length>0)switch(t){case"current":case"not-current":{const c=await oA(a.localStore,hw(l[0])),f=ah.createSynthesizedRemoteEventForCurrentChange(e,t==="current",Ot.EMPTY_BYTE_STRING);await oa(a,c,f);break}case"rejected":await zl(a.localStore,e,!0),ql(a,e,i);break;default:ye(64155,t)}}async function PM(s,e,t){const i=xm(s);if(i.gu){for(const a of e){if(i.Iu.has(a)&&i.sharedClientState.isActiveQueryTarget(a)){ce(tc,"Adding an already active target "+a);continue}const l=await aA(i.localStore,a),c=await qf(i.localStore,l);await Mv(i,CA(l),c.targetId,!1,c.resumeToken),Em(i.remoteStore,c)}for(const a of t)i.Iu.has(a)&&await zl(i.localStore,a,!1).then((()=>{Bl(i.remoteStore,a),ql(i,a)})).catch(sa)}}function xm(s){const e=_e(s);return e.remoteStore.remoteSyncer.applyRemoteEvent=AA.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=DM.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=wM.bind(null,e),e.Pu.J_=mM.bind(null,e.eventManager),e.Pu.yu=pM.bind(null,e.eventManager),e}function zv(s){const e=_e(s);return e.remoteStore.remoteSyncer.applySuccessfulWrite=AM.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=IM.bind(null,e),e}class Gu{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=bm(e.databaseInfo.databaseId),this.sharedClientState=this.Du(e),this.persistence=this.Cu(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Fu(e,this.localStore),this.indexBackfillerScheduler=this.Mu(e,this.localStore)}Fu(e,t){return null}Mu(e,t){return null}vu(e){return iA(this.persistence,new nA,e.initialUser,this.serializer)}Cu(e){return new Sv(_m.Vi,this.serializer)}Du(e){return new dA}async terminate(){this.gcScheduler?.stop(),this.indexBackfillerScheduler?.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}Gu.provider={build:()=>new Gu};class LM extends Gu{constructor(e){super(),this.cacheSizeBytes=e}Fu(e,t){be(this.persistence.referenceDelegate instanceof Ff,46915);const i=this.persistence.referenceDelegate.garbageCollector;return new Yw(i,e.asyncQueue,t)}Cu(e){const t=this.cacheSizeBytes!==void 0?fn.withCacheSize(this.cacheSizeBytes):fn.DEFAULT;return new Sv((i=>Ff.Vi(i,t)),this.serializer)}}class RA extends Gu{constructor(e,t,i){super(),this.xu=e,this.cacheSizeBytes=t,this.forceOwnership=i,this.kind="persistent",this.synchronizeTabs=!1}async initialize(e){await super.initialize(e),await this.xu.initialize(this,e),await zv(this.xu.syncEngine),await Zl(this.xu.remoteStore),await this.persistence.zi((()=>(this.gcScheduler&&!this.gcScheduler.started&&this.gcScheduler.start(),this.indexBackfillerScheduler&&!this.indexBackfillerScheduler.started&&this.indexBackfillerScheduler.start(),Promise.resolve())))}vu(e){return iA(this.persistence,new nA,e.initialUser,this.serializer)}Fu(e,t){const i=this.persistence.referenceDelegate.garbageCollector;return new Yw(i,e.asyncQueue,t)}Mu(e,t){const i=new Gk(t,this.persistence);return new Hk(e.asyncQueue,i)}Cu(e){const t=tA(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),i=this.cacheSizeBytes!==void 0?fn.withCacheSize(this.cacheSizeBytes):fn.DEFAULT;return new wv(this.synchronizeTabs,t,e.clientId,i,e.asyncQueue,fA(),_f(),this.serializer,this.sharedClientState,!!this.forceOwnership)}Du(e){return new dA}}class UM extends RA{constructor(e,t){super(e,t,!1),this.xu=e,this.cacheSizeBytes=t,this.synchronizeTabs=!0}async initialize(e){await super.initialize(e);const t=this.xu.syncEngine;this.sharedClientState instanceof $g&&(this.sharedClientState.syncEngine={So:kM.bind(null,t),Do:MM.bind(null,t),Co:PM.bind(null,t),hs:VM.bind(null,t),bo:jM.bind(null,t)},await this.sharedClientState.start()),await this.persistence.zi((async i=>{await OM(this.xu.syncEngine,i),this.gcScheduler&&(i&&!this.gcScheduler.started?this.gcScheduler.start():i||this.gcScheduler.stop()),this.indexBackfillerScheduler&&(i&&!this.indexBackfillerScheduler.started?this.indexBackfillerScheduler.start():i||this.indexBackfillerScheduler.stop())}))}Du(e){const t=fA();if(!$g.v(t))throw new he(te.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");const i=tA(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey);return new $g(t,e.asyncQueue,i,e.clientId,e.initialUser)}}class Qu{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=i=>kx(this.syncEngine,i,1),this.remoteStore.remoteSyncer.handleCredentialChange=RM.bind(null,this.syncEngine),await Oy(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return(function(){return new fM})()}createDatastore(e){const t=bm(e.databaseInfo.databaseId),i=$V(e.databaseInfo);return ZV(e.authCredentials,e.appCheckCredentials,i,t)}createRemoteStore(e){return(function(i,a,l,c,f){return new tM(i,a,l,c,f)})(this.localStore,this.datastore,e.asyncQueue,(t=>kx(this.syncEngine,t,0)),(function(){return Ix.v()?new Ix:new HV})())}createSyncEngine(e,t){return(function(a,l,c,f,p,y,v){const b=new _M(a,l,c,f,p,y);return v&&(b.gu=!0),b})(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}async terminate(){await(async function(t){const i=_e(t);ce(lo,"RemoteStore shutting down."),i.Ea.add(5),await lh(i),i.Aa.shutdown(),i.Va.set("Unknown")})(this.remoteStore),this.datastore?.terminate(),this.eventManager?.terminate()}}Qu.provider={build:()=>new Qu};class DA{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ou(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ou(this.observer.error,e):kt("Uncaught Error in snapshot listener:",e.toString()))}Nu(){this.muted=!0}Ou(e,t){setTimeout((()=>{this.muted||e(t)}),0)}}let zM=class{constructor(e){this.datastore=e,this.readVersions=new Map,this.mutations=[],this.committed=!1,this.lastTransactionError=null,this.writtenDocs=new Set}async lookup(e){if(this.ensureCommitNotCalled(),this.mutations.length>0)throw this.lastTransactionError=new he(te.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes."),this.lastTransactionError;const t=await(async function(a,l){const c=_e(a),f={documents:l.map((b=>qu(c.serializer,b)))},p=await c.jo("BatchGetDocuments",c.serializer.databaseId,We.emptyPath(),f,l.length),y=new Map;p.forEach((b=>{const x=nV(c.serializer,b);y.set(x.key.toString(),x)}));const v=[];return l.forEach((b=>{const x=y.get(b.toString());be(!!x,55234,{key:b}),v.push(x)})),v})(this.datastore,e);return t.forEach((i=>this.recordVersion(i))),t}set(e,t){this.write(t.toMutation(e,this.precondition(e))),this.writtenDocs.add(e.toString())}update(e,t){try{this.write(t.toMutation(e,this.preconditionForUpdate(e)))}catch(i){this.lastTransactionError=i}this.writtenDocs.add(e.toString())}delete(e){this.write(new Jl(e,this.precondition(e))),this.writtenDocs.add(e.toString())}async commit(){if(this.ensureCommitNotCalled(),this.lastTransactionError)throw this.lastTransactionError;const e=this.readVersions;this.mutations.forEach((t=>{e.delete(t.key.toString())})),e.forEach(((t,i)=>{const a=me.fromPath(i);this.mutations.push(new pv(a,this.precondition(a)))})),await(async function(i,a){const l=_e(i),c={writes:a.map((f=>Hu(l.serializer,f)))};await l.Wo("Commit",l.serializer.databaseId,We.emptyPath(),c)})(this.datastore,this.mutations),this.committed=!0}recordVersion(e){let t;if(e.isFoundDocument())t=e.version;else{if(!e.isNoDocument())throw ye(50498,{Gu:e.constructor.name});t=Se.min()}const i=this.readVersions.get(e.key.toString());if(i){if(!t.isEqual(i))throw new he(te.ABORTED,"Document version changed between two reads.")}else this.readVersions.set(e.key.toString(),t)}precondition(e){const t=this.readVersions.get(e.toString());return!this.writtenDocs.has(e.toString())&&t?t.isEqual(Se.min())?xt.exists(!1):xt.updateTime(t):xt.none()}preconditionForUpdate(e){const t=this.readVersions.get(e.toString());if(!this.writtenDocs.has(e.toString())&&t){if(t.isEqual(Se.min()))throw new he(te.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return xt.updateTime(t)}return xt.exists(!0)}write(e){this.ensureCommitNotCalled(),this.mutations.push(e)}ensureCommitNotCalled(){}};class BM{constructor(e,t,i,a,l){this.asyncQueue=e,this.datastore=t,this.options=i,this.updateFunction=a,this.deferred=l,this.zu=i.maxAttempts,this.M_=new Rv(this.asyncQueue,"transaction_retry")}ju(){this.zu-=1,this.Hu()}Hu(){this.M_.p_((async()=>{const e=new zM(this.datastore),t=this.Ju(e);t&&t.then((i=>{this.asyncQueue.enqueueAndForget((()=>e.commit().then((()=>{this.deferred.resolve(i)})).catch((a=>{this.Zu(a)}))))})).catch((i=>{this.Zu(i)}))}))}Ju(e){try{const t=this.updateFunction(e);return!nh(t)&&t.catch&&t.then?t:(this.deferred.reject(Error("Transaction callback must return a Promise")),null)}catch(t){return this.deferred.reject(t),null}}Zu(e){this.zu>0&&this.Xu(e)?(this.zu-=1,this.asyncQueue.enqueueAndForget((()=>(this.Hu(),Promise.resolve())))):this.deferred.reject(e)}Xu(e){if(e?.name==="FirebaseError"){const t=e.code;return t==="aborted"||t==="failed-precondition"||t==="already-exists"||!Sw(t)}return!1}}const na="FirestoreClient";class FM{constructor(e,t,i,a,l){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=i,this._databaseInfo=a,this.user=dn.UNAUTHENTICATED,this.clientId=nv.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=l,this.authCredentials.start(i,(async c=>{ce(na,"Received user=",c.uid),await this.authCredentialListener(c),this.user=c})),this.appCheckCredentials.start(i,(c=>(ce(na,"Received new app check token=",c),this.appCheckCredentialListener(c,this.user))))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this._databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new Ci;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){const i=Ov(t,"Failed to shutdown persistence");e.reject(i)}})),e.promise}}async function Yg(s,e){s.asyncQueue.verifyOperationInProgress(),ce(na,"Initializing OfflineComponentProvider");const t=s.configuration;await e.initialize(t);let i=t.initialUser;s.setCredentialChangeListener((async a=>{i.isEqual(a)||(await sA(e.localStore,a),i=a)})),e.persistence.setDatabaseDeletedListener((()=>s.terminate())),s._offlineComponents=e}async function Vx(s,e){s.asyncQueue.verifyOperationInProgress();const t=await qM(s);ce(na,"Initializing OnlineComponentProvider"),await e.initialize(t,s.configuration),s.setCredentialChangeListener((i=>Rx(e.remoteStore,i))),s.setAppCheckTokenChangeListener(((i,a)=>Rx(e.remoteStore,a))),s._onlineComponents=e}async function qM(s){if(!s._offlineComponents)if(s._uninitializedComponentsProvider){ce(na,"Using user provided OfflineComponentProvider");try{await Yg(s,s._uninitializedComponentsProvider._offline)}catch(e){const t=e;if(!(function(a){return a.name==="FirebaseError"?a.code===te.FAILED_PRECONDITION||a.code===te.UNIMPLEMENTED:!(typeof DOMException<"u"&&a instanceof DOMException)||a.code===22||a.code===20||a.code===11})(t))throw t;wl("Error using user provided cache. Falling back to memory cache: "+t),await Yg(s,new Gu)}}else ce(na,"Using default OfflineComponentProvider"),await Yg(s,new LM(void 0));return s._offlineComponents}async function Bv(s){return s._onlineComponents||(s._uninitializedComponentsProvider?(ce(na,"Using user provided OnlineComponentProvider"),await Vx(s,s._uninitializedComponentsProvider._online)):(ce(na,"Using default OnlineComponentProvider"),await Vx(s,new Qu))),s._onlineComponents}function HM(s){return Bv(s).then((e=>e.syncEngine))}function GM(s){return Bv(s).then((e=>e.datastore))}async function NA(s){const e=await Bv(s),t=e.eventManager;return t.onListen=bM.bind(null,e.syncEngine),t.onUnlisten=EM.bind(null,e.syncEngine),t.onFirstRemoteStoreListen=TM.bind(null,e.syncEngine),t.onLastRemoteStoreUnlisten=xM.bind(null,e.syncEngine),t}function QM(s,e,t={}){const i=new Ci;return s.asyncQueue.enqueueAndForget((async()=>(function(l,c,f,p,y){const v=new DA({next:x=>{v.Nu(),c.enqueueAndForget((()=>TA(l,b)));const k=x.docs.has(f);!k&&x.fromCache?y.reject(new he(te.UNAVAILABLE,"Failed to get document because the client is offline.")):k&&x.fromCache&&p&&p.source==="server"?y.reject(new he(te.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):y.resolve(x)},error:x=>y.reject(x)}),b=new EA(fm(f.path),v,{includeMetadataChanges:!0,Ka:!0});return bA(l,b)})(await NA(s),s.asyncQueue,e,t,i))),i.promise}function KM(s,e,t={}){const i=new Ci;return s.asyncQueue.enqueueAndForget((async()=>(function(l,c,f,p,y){const v=new DA({next:x=>{v.Nu(),c.enqueueAndForget((()=>TA(l,b))),x.fromCache&&p.source==="server"?y.reject(new he(te.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):y.resolve(x)},error:x=>y.reject(x)}),b=new EA(f,v,{includeMetadataChanges:!0,Ka:!0});return bA(l,b)})(await NA(s),s.asyncQueue,e,t,i))),i.promise}function $M(s,e){const t=new Ci;return s.asyncQueue.enqueueAndForget((async()=>SM(await HM(s),e,t))),t.promise}function WM(s,e,t){const i=new Ci;return s.asyncQueue.enqueueAndForget((async()=>{const a=await GM(s);new BM(s.asyncQueue,a,t,e,i).ju()})),i.promise}function jA(s){const e={};return s.timeoutSeconds!==void 0&&(e.timeoutSeconds=s.timeoutSeconds),e}const YM="ComponentProvider",Mx=new Map;function XM(s,e,t,i,a){return new _O(s,e,t,a.host,a.ssl,a.experimentalForceLongPolling,a.experimentalAutoDetectLongPolling,jA(a.experimentalLongPollingOptions),a.useFetchStreams,a.isUsingEmulator,i)}const JM="firestore.googleapis.com",Px=!0;class Lx{constructor(e){if(e.host===void 0){if(e.ssl!==void 0)throw new he(te.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=JM,this.ssl=Px}else this.host=e.host,this.ssl=e.ssl??Px;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=Gw;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<Ww)throw new he(te.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}zk("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=jA(e.experimentalLongPollingOptions??{}),(function(i){if(i.timeoutSeconds!==void 0){if(isNaN(i.timeoutSeconds))throw new he(te.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (must not be NaN)`);if(i.timeoutSeconds<5)throw new he(te.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (minimum allowed value is 5)`);if(i.timeoutSeconds>30)throw new he(te.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (maximum allowed value is 30)`)}})(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&(function(i,a){return i.timeoutSeconds===a.timeoutSeconds})(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class Fv{constructor(e,t,i,a){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=i,this._app=a,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new Lx({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new he(te.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new he(te.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new Lx(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=(function(i){if(!i)return new Nk;switch(i.type){case"firstParty":return new Ok(i.sessionIndex||"0",i.iamToken||null,i.authTokenFactory||null);case"provider":return i.client;default:throw new he(te.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}})(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return(function(t){const i=Mx.get(t);i&&(ce(YM,"Removing Datastore"),Mx.delete(t),i.terminate())})(this),Promise.resolve()}}class la{constructor(e,t,i){this.converter=t,this._query=i,this.type="query",this.firestore=e}withConverter(e){return new la(this.firestore,e,this._query)}}class Rt{constructor(e,t,i){this.converter=t,this._key=i,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Yr(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new Rt(this.firestore,e,this._key)}toJSON(){return{type:Rt._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,t,i){if(th(t,Rt._jsonSchema))return new Rt(e,i||null,new me(We.fromString(t.referencePath)))}}Rt._jsonSchemaVersion="firestore/documentReference/1.0",Rt._jsonSchema={type:qt("string",Rt._jsonSchemaVersion),referencePath:qt("string")};class Yr extends la{constructor(e,t,i){super(e,t,fm(i)),this._path=i,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new Rt(this.firestore,null,new me(e))}withConverter(e){return new Yr(this.firestore,e,this._path)}}function di(s,e,...t){if(s=At(s),IS("collection","path",e),s instanceof Fv){const i=We.fromString(e,...t);return CE(i),new Yr(s,null,i)}{if(!(s instanceof Rt||s instanceof Yr))throw new he(te.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const i=s._path.child(We.fromString(e,...t));return CE(i),new Yr(s.firestore,null,i)}}function _n(s,e,...t){if(s=At(s),arguments.length===1&&(e=nv.newId()),IS("doc","path",e),s instanceof Fv){const i=We.fromString(e,...t);return IE(i),new Rt(s,null,new me(i))}{if(!(s instanceof Rt||s instanceof Yr))throw new he(te.INVALID_ARGUMENT,"Expected first argument to doc() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const i=s._path.child(We.fromString(e,...t));return IE(i),new Rt(s.firestore,s instanceof Yr?s.converter:null,new me(i))}}const Ux="AsyncQueue";class zx{constructor(e=Promise.resolve()){this.Yu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new Rv(this,"async_queue_retry"),this._c=()=>{const i=_f();i&&ce(Ux,"Visibility state changed to "+i.visibilityState),this.M_.w_()},this.ac=e;const t=_f();t&&typeof t.addEventListener=="function"&&t.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;const t=_f();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise((()=>{}));const t=new Ci;return this.cc((()=>this.ec&&this.sc?Promise.resolve():(e().then(t.resolve,t.reject),t.promise))).then((()=>t.promise))}enqueueRetryable(e){this.enqueueAndForget((()=>(this.Yu.push(e),this.lc())))}async lc(){if(this.Yu.length!==0){try{await this.Yu[0](),this.Yu.shift(),this.M_.reset()}catch(e){if(!ra(e))throw e;ce(Ux,"Operation failed with retryable error: "+e)}this.Yu.length>0&&this.M_.p_((()=>this.lc()))}}cc(e){const t=this.ac.then((()=>(this.rc=!0,e().catch((i=>{throw this.nc=i,this.rc=!1,kt("INTERNAL UNHANDLED ERROR: ",Bx(i)),i})).then((i=>(this.rc=!1,i))))));return this.ac=t,t}enqueueAfterDelay(e,t,i){this.uc(),this.oc.indexOf(e)>-1&&(t=0);const a=kv.createAndSchedule(this,e,t,i,(l=>this.hc(l)));return this.tc.push(a),a}uc(){this.nc&&ye(47125,{Pc:Bx(this.nc)})}verifyOperationInProgress(){}async Tc(){let e;do e=this.ac,await e;while(e!==this.ac)}Ic(e){for(const t of this.tc)if(t.timerId===e)return!0;return!1}Ec(e){return this.Tc().then((()=>{this.tc.sort(((t,i)=>t.targetTimeMs-i.targetTimeMs));for(const t of this.tc)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.Tc()}))}Rc(e){this.oc.push(e)}hc(e){const t=this.tc.indexOf(e);this.tc.splice(t,1)}}function Bx(s){let e=s.message||"";return s.stack&&(e=s.stack.includes(s.message)?s.stack:s.message+`
`+s.stack),e}class Js extends Fv{constructor(e,t,i,a){super(e,t,i,a),this.type="firestore",this._queue=new zx,this._persistenceKey=a?.name||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new zx(e),this._firestoreClient=void 0,await e}}}function ZM(s,e,t){t||(t=Vf);const i=nm(s,"firestore");if(i.isInitialized(t)){const a=i.getImmediate({identifier:t}),l=i.getOptions(t);if(Ja(l,e))return a;throw new he(te.FAILED_PRECONDITION,"initializeFirestore() has already been called with different options. To avoid this error, call initializeFirestore() with the same options as when it was originally called, or call getFirestore() to return the already initialized instance.")}if(e.cacheSizeBytes!==void 0&&e.localCache!==void 0)throw new he(te.INVALID_ARGUMENT,"cache and cacheSizeBytes cannot be specified at the same time as cacheSizeBytes willbe deprecated. Instead, specify the cache size in the cache object");if(e.cacheSizeBytes!==void 0&&e.cacheSizeBytes!==-1&&e.cacheSizeBytes<Ww)throw new he(te.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");return e.host&&uo(e.host)&&Hy(e.host),i.initialize({options:e,instanceIdentifier:t})}function ch(s){if(s._terminated)throw new he(te.FAILED_PRECONDITION,"The client has already been terminated.");return s._firestoreClient||e4(s),s._firestoreClient}function e4(s){const e=s._freezeSettings(),t=XM(s._databaseId,s._app?.options.appId||"",s._persistenceKey,s._app?.options.apiKey,e);s._componentsProvider||e.localCache?._offlineComponentProvider&&e.localCache?._onlineComponentProvider&&(s._componentsProvider={_offline:e.localCache._offlineComponentProvider,_online:e.localCache._onlineComponentProvider}),s._firestoreClient=new FM(s._authCredentials,s._appCheckCredentials,s._queue,t,s._componentsProvider&&(function(a){const l=a?._online.build();return{_offline:a?._offline.build(l),_online:l}})(s._componentsProvider))}class qn{constructor(e){this._byteString=e}static fromBase64String(e){try{return new qn(Ot.fromBase64String(e))}catch(t){throw new he(te.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new qn(Ot.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:qn._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(th(e,qn._jsonSchema))return qn.fromBase64String(e.bytes)}}qn._jsonSchemaVersion="firestore/bytes/1.0",qn._jsonSchema={type:qt("string",qn._jsonSchemaVersion),bytes:qt("string")};class uh{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new he(te.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new wt(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}class Sm{constructor(e){this._methodName=e}}class cs{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new he(te.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new he(te.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return De(this._lat,e._lat)||De(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:cs._jsonSchemaVersion}}static fromJSON(e){if(th(e,cs._jsonSchema))return new cs(e.latitude,e.longitude)}}cs._jsonSchemaVersion="firestore/geoPoint/1.0",cs._jsonSchema={type:qt("string",cs._jsonSchemaVersion),latitude:qt("number"),longitude:qt("number")};class Ri{constructor(e){this._values=(e||[]).map((t=>t))}toArray(){return this._values.map((e=>e))}isEqual(e){return(function(i,a){if(i.length!==a.length)return!1;for(let l=0;l<i.length;++l)if(i[l]!==a[l])return!1;return!0})(this._values,e._values)}toJSON(){return{type:Ri._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(th(e,Ri._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every((t=>typeof t=="number")))return new Ri(e.vectorValues);throw new he(te.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}Ri._jsonSchemaVersion="firestore/vectorValue/1.0",Ri._jsonSchema={type:qt("string",Ri._jsonSchemaVersion),vectorValues:qt("object")};const t4=/^__.*__$/;class n4{constructor(e,t,i){this.data=e,this.fieldMask=t,this.fieldTransforms=i}toMutation(e,t){return this.fieldMask!==null?new Xs(e,this.data,this.fieldMask,t,this.fieldTransforms):new Xl(e,this.data,t,this.fieldTransforms)}}class kA{constructor(e,t,i){this.data=e,this.fieldMask=t,this.fieldTransforms=i}toMutation(e,t){return new Xs(e,this.data,this.fieldMask,t,this.fieldTransforms)}}function OA(s){switch(s){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw ye(40011,{dataSource:s})}}class qv{constructor(e,t,i,a,l,c){this.settings=e,this.databaseId=t,this.serializer=i,this.ignoreUndefinedProperties=a,l===void 0&&this.validatePath(),this.fieldTransforms=l||[],this.fieldMask=c||[]}get path(){return this.settings.path}get dataSource(){return this.settings.dataSource}contextWith(e){return new qv({...this.settings,...e},this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}childContextForField(e){const t=this.path?.child(e),i=this.contextWith({path:t,arrayElement:!1});return i.validatePathSegment(e),i}childContextForFieldPath(e){const t=this.path?.child(e),i=this.contextWith({path:t,arrayElement:!1});return i.validatePath(),i}childContextForArray(e){return this.contextWith({path:void 0,arrayElement:!0})}createError(e){return Kf(e,this.settings.methodName,this.settings.hasConverter||!1,this.path,this.settings.targetDoc)}contains(e){return this.fieldMask.find((t=>e.isPrefixOf(t)))!==void 0||this.fieldTransforms.find((t=>e.isPrefixOf(t.field)))!==void 0}validatePath(){if(this.path)for(let e=0;e<this.path.length;e++)this.validatePathSegment(this.path.get(e))}validatePathSegment(e){if(e.length===0)throw this.createError("Document fields must not be empty");if(OA(this.dataSource)&&t4.test(e))throw this.createError('Document fields cannot begin and end with "__"')}}class i4{constructor(e,t,i){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=i||bm(e)}createContext(e,t,i,a=!1){return new qv({dataSource:e,methodName:t,targetDoc:i,path:wt.emptyPath(),arrayElement:!1,hasConverter:a},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function nc(s){const e=s._freezeSettings(),t=bm(s._databaseId);return new i4(s._databaseId,!!e.ignoreUndefinedProperties,t)}function wm(s,e,t,i,a,l={}){const c=s.createContext(l.merge||l.mergeFields?2:0,e,t,a);Kv("Data must be an object, but it was:",c,i);const f=VA(i,c);let p,y;if(l.merge)p=new Rn(c.fieldMask),y=c.fieldTransforms;else if(l.mergeFields){const v=[];for(const b of l.mergeFields){const x=co(e,b,t);if(!c.contains(x))throw new he(te.INVALID_ARGUMENT,`Field '${x}' is specified in your field mask but missing from your input data.`);LA(v,x)||v.push(x)}p=new Rn(v),y=c.fieldTransforms.filter((b=>p.covers(b.field)))}else p=null,y=c.fieldTransforms;return new n4(new on(f),p,y)}class Am extends Sm{_toFieldTransform(e){if(e.dataSource!==2)throw e.dataSource===1?e.createError(`${this._methodName}() can only appear at the top level of your update data`):e.createError(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof Am}}class Hv extends Sm{_toFieldTransform(e){return new Tw(e.path,new Ml)}isEqual(e){return e instanceof Hv}}function Gv(s,e,t,i){const a=s.createContext(1,e,t);Kv("Data must be an object, but it was:",a,i);const l=[],c=on.empty();aa(i,((p,y)=>{const v=PA(e,p,t);y=At(y);const b=a.childContextForFieldPath(v);if(y instanceof Am)l.push(v);else{const x=hh(y,b);x!=null&&(l.push(v),c.set(v,x))}}));const f=new Rn(l);return new kA(c,f,a.fieldTransforms)}function Qv(s,e,t,i,a,l){const c=s.createContext(1,e,t),f=[co(e,i,t)],p=[a];if(l.length%2!=0)throw new he(te.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let x=0;x<l.length;x+=2)f.push(co(e,l[x])),p.push(l[x+1]);const y=[],v=on.empty();for(let x=f.length-1;x>=0;--x)if(!LA(y,f[x])){const k=f[x];let O=p[x];O=At(O);const D=c.childContextForFieldPath(k);if(O instanceof Am)y.push(k);else{const M=hh(O,D);M!=null&&(y.push(k),v.set(k,M))}}const b=new Rn(y);return new kA(v,b,c.fieldTransforms)}function s4(s,e,t,i=!1){return hh(t,s.createContext(i?4:3,e))}function hh(s,e){if(MA(s=At(s)))return Kv("Unsupported field value:",e,s),VA(s,e);if(s instanceof Sm)return(function(i,a){if(!OA(a.dataSource))throw a.createError(`${i._methodName}() can only be used with update() and set()`);if(!a.path)throw a.createError(`${i._methodName}() is not currently supported inside arrays`);const l=i._toFieldTransform(a);l&&a.fieldTransforms.push(l)})(s,e),null;if(s===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),s instanceof Array){if(e.settings.arrayElement&&e.dataSource!==4)throw e.createError("Nested arrays are not supported");return(function(i,a){const l=[];let c=0;for(const f of i){let p=hh(f,a.childContextForArray(c));p==null&&(p={nullValue:"NULL_VALUE"}),l.push(p),c++}return{arrayValue:{values:l}}})(s,e)}return(function(i,a){if((i=At(i))===null)return{nullValue:"NULL_VALUE"};if(typeof i=="number")return UO(a.serializer,i);if(typeof i=="boolean")return{booleanValue:i};if(typeof i=="string")return{stringValue:i};if(i instanceof Date){const l=it.fromDate(i);return{timestampValue:Ul(a.serializer,l)}}if(i instanceof it){const l=new it(i.seconds,1e3*Math.floor(i.nanoseconds/1e3));return{timestampValue:Ul(a.serializer,l)}}if(i instanceof cs)return{geoPointValue:{latitude:i.latitude,longitude:i.longitude}};if(i instanceof qn)return{bytesValue:Cw(a.serializer,i._byteString)};if(i instanceof Rt){const l=a.databaseId,c=i.firestore._databaseId;if(!c.isEqual(l))throw a.createError(`Document reference is for database ${c.projectId}/${c.database} but should be for database ${l.projectId}/${l.database}`);return{referenceValue:bv(i.firestore._databaseId||a.databaseId,i._key.path)}}if(i instanceof Ri)return(function(c,f){const p=c instanceof Ri?c.toArray():c;return{mapValue:{fields:{[uv]:{stringValue:hv},[jl]:{arrayValue:{values:p.map((v=>{if(typeof v!="number")throw f.createError("VectorValues must only contain numeric values.");return mv(f.serializer,v)}))}}}}}})(i,a);if(Uw(i))return i._toProto(a.serializer);throw a.createError(`Unsupported field value: ${am(i)}`)})(s,e)}function VA(s,e){const t={};return GS(s)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):aa(s,((i,a)=>{const l=hh(a,e.childContextForField(i));l!=null&&(t[i]=l)})),{mapValue:{fields:t}}}function MA(s){return!(typeof s!="object"||s===null||s instanceof Array||s instanceof Date||s instanceof it||s instanceof cs||s instanceof qn||s instanceof Rt||s instanceof Sm||s instanceof Ri||Uw(s))}function Kv(s,e,t){if(!MA(t)||!CS(t)){const i=am(t);throw i==="an object"?e.createError(s+" a custom object"):e.createError(s+" "+i)}}function co(s,e,t){if((e=At(e))instanceof uh)return e._internalPath;if(typeof e=="string")return PA(s,e);throw Kf("Field path arguments must be of type string or ",s,!1,void 0,t)}const r4=new RegExp("[~\\*/\\[\\]]");function PA(s,e,t){if(e.search(r4)>=0)throw Kf(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,s,!1,void 0,t);try{return new uh(...e.split("."))._internalPath}catch{throw Kf(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,s,!1,void 0,t)}}function Kf(s,e,t,i,a){const l=i&&!i.isEmpty(),c=a!==void 0;let f=`Function ${e}() called with invalid data`;t&&(f+=" (via `toFirestore()`)"),f+=". ";let p="";return(l||c)&&(p+=" (found",l&&(p+=` in field ${i}`),c&&(p+=` in document ${a}`),p+=")"),new he(te.INVALID_ARGUMENT,f+s+p)}function LA(s,e){return s.some((t=>t.isEqual(e)))}class UA{convertValue(e,t="none"){switch(Zr(e)){case 0:return null;case 1:return e.booleanValue;case 2:return Tt(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes($s(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw ye(62114,{value:e})}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){const i={};return aa(e,((a,l)=>{i[a]=this.convertValue(l,t)})),i}convertVectorValue(e){const t=e.fields?.[jl].arrayValue?.values?.map((i=>Tt(i.doubleValue)));return new Ri(t)}convertGeoPoint(e){return new cs(Tt(e.latitude),Tt(e.longitude))}convertArray(e,t){return(e.values||[]).map((i=>this.convertValue(i,t)))}convertServerTimestamp(e,t){switch(t){case"previous":const i=hm(e);return i==null?null:this.convertValue(i,t);case"estimate":return this.convertTimestamp(Pu(e));default:return null}}convertTimestamp(e){const t=Ks(e);return new it(t.seconds,t.nanos)}convertDocumentKey(e,t){const i=We.fromString(e);be(Lw(i),9688,{name:e});const a=new io(i.get(1),i.get(3)),l=new me(i.popFirst(5));return a.isEqual(t)||kt(`Document ${l} contains a document reference within a different database (${a.projectId}/${a.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),l}}class $v extends UA{constructor(e){super(),this.firestore=e}convertBytes(e){return new qn(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new Rt(this.firestore,null,t)}}function Kn(){return new Hv("serverTimestamp")}const Fx="@firebase/firestore",qx="4.11.0";class $f{constructor(e,t,i,a,l){this._firestore=e,this._userDataWriter=t,this._key=i,this._document=a,this._converter=l}get id(){return this._key.path.lastSegment()}get ref(){return new Rt(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new a4(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}_fieldsProto(){return this._document?.data.clone().value.mapValue.fields??void 0}get(e){if(this._document){const t=this._document.data.field(co("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}}class a4 extends $f{data(){return super.data()}}function o4(s){if(s.limitType==="L"&&s.explicitOrderBy.length===0)throw new he(te.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class Wv{}class Yv extends Wv{}function ic(s,e,...t){let i=[];e instanceof Wv&&i.push(e),i=i.concat(t),(function(l){const c=l.filter((p=>p instanceof Jv)).length,f=l.filter((p=>p instanceof Im)).length;if(c>1||c>0&&f>0)throw new he(te.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")})(i);for(const a of i)s=a._apply(s);return s}class Im extends Yv{constructor(e,t,i){super(),this._field=e,this._op=t,this._value=i,this.type="where"}static _create(e,t,i){return new Im(e,t,i)}_apply(e){const t=this._parse(e);return zA(e._query,t),new la(e.firestore,e.converter,xy(e._query,t))}_parse(e){const t=nc(e.firestore);return(function(l,c,f,p,y,v,b){let x;if(y.isKeyField()){if(v==="array-contains"||v==="array-contains-any")throw new he(te.INVALID_ARGUMENT,`Invalid Query. You can't perform '${v}' queries on documentId().`);if(v==="in"||v==="not-in"){Gx(b,v);const O=[];for(const D of b)O.push(Hx(p,l,D));x={arrayValue:{values:O}}}else x=Hx(p,l,b)}else v!=="in"&&v!=="not-in"&&v!=="array-contains-any"||Gx(b,v),x=s4(f,c,b,v==="in"||v==="not-in");return qe.create(y,v,x)})(e._query,"where",t,e.firestore._databaseId,this._field,this._op,this._value)}}function Xv(s,e,t){const i=e,a=co("where",s);return Im._create(a,i,t)}class Jv extends Wv{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new Jv(e,t)}_parse(e){const t=this._queryConstraints.map((i=>i._parse(e))).filter((i=>i.getFilters().length>0));return t.length===1?t[0]:st.create(t,this._getOperator())}_apply(e){const t=this._parse(e);return t.getFilters().length===0?e:((function(a,l){let c=a;const f=l.getFlattenedFilters();for(const p of f)zA(c,p),c=xy(c,p)})(e._query,t),new la(e.firestore,e.converter,xy(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}class Zv extends Yv{constructor(e,t){super(),this._field=e,this._direction=t,this.type="orderBy"}static _create(e,t){return new Zv(e,t)}_apply(e){const t=(function(a,l,c){if(a.startAt!==null)throw new he(te.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(a.endAt!==null)throw new he(te.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new Bu(l,c)})(e._query,this._field,this._direction);return new la(e.firestore,e.converter,kO(e._query,t))}}function e_(s,e="asc"){const t=e,i=co("orderBy",s);return Zv._create(i,t)}class t_ extends Yv{constructor(e,t,i){super(),this.type=e,this._limit=t,this._limitType=i}static _create(e,t,i){return new t_(e,t,i)}_apply(e){return new la(e.firestore,e.converter,Lf(e._query,this._limit,this._limitType))}}function Cm(s){return Bk("limit",s),t_._create("limit",s,"F")}function Hx(s,e,t){if(typeof(t=At(t))=="string"){if(t==="")throw new he(te.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!cw(e)&&t.indexOf("/")!==-1)throw new he(te.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${t}' contains a '/' character.`);const i=e.path.child(We.fromString(t));if(!me.isDocumentKey(i))throw new he(te.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${i}' is not because it has an odd number of segments (${i.length}).`);return Uu(s,new me(i))}if(t instanceof Rt)return Uu(s,t._key);throw new he(te.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${am(t)}.`)}function Gx(s,e){if(!Array.isArray(s)||s.length===0)throw new he(te.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function zA(s,e){const t=(function(a,l){for(const c of a)for(const f of c.getFlattenedFilters())if(l.indexOf(f.op)>=0)return f.op;return null})(s.filters,(function(a){switch(a){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}})(e.op));if(t!==null)throw t===e.op?new he(te.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new he(te.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${t.toString()}' filters.`)}function Rm(s,e,t){let i;return i=s?t&&(t.merge||t.mergeFields)?s.toFirestore(e,t):s.toFirestore(e):e,i}class l4 extends UA{constructor(e){super(),this.firestore=e}convertBytes(e){return new qn(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new Rt(this.firestore,null,t)}}class c4{constructor(e){let t;this.kind="persistent",e?.tabManager?(e.tabManager._initialize(e),t=e.tabManager):(t=f4(void 0),t._initialize(e)),this._onlineComponentProvider=t._onlineComponentProvider,this._offlineComponentProvider=t._offlineComponentProvider}toJSON(){return{kind:this.kind}}}function u4(s){return new c4(s)}class h4{constructor(e){this.forceOwnership=e,this.kind="persistentSingleTab"}toJSON(){return{kind:this.kind}}_initialize(e){this._onlineComponentProvider=Qu.provider,this._offlineComponentProvider={build:t=>new RA(t,e?.cacheSizeBytes,this.forceOwnership)}}}class d4{constructor(){this.kind="PersistentMultipleTab"}toJSON(){return{kind:this.kind}}_initialize(e){this._onlineComponentProvider=Qu.provider,this._offlineComponentProvider={build:t=>new UM(t,e?.cacheSizeBytes)}}}function f4(s){return new h4(s?.forceOwnership)}function m4(){return new d4}class yl{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class Xr extends $f{constructor(e,t,i,a,l,c){super(e,t,i,a,c),this._firestore=e,this._firestoreImpl=e,this.metadata=l}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const t=new bf(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){const i=this._document.data.field(co("DocumentSnapshot.get",e));if(i!==null)return this._userDataWriter.convertValue(i,t.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new he(te.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,t={};return t.type=Xr._jsonSchemaVersion,t.bundle="",t.bundleSource="DocumentSnapshot",t.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?t:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),t.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),t)}}Xr._jsonSchemaVersion="firestore/documentSnapshot/1.0",Xr._jsonSchema={type:qt("string",Xr._jsonSchemaVersion),bundleSource:qt("string","DocumentSnapshot"),bundleName:qt("string"),bundle:qt("string")};class bf extends Xr{data(e={}){return super.data(e)}}class xl{constructor(e,t,i,a){this._firestore=e,this._userDataWriter=t,this._snapshot=a,this.metadata=new yl(a.hasPendingWrites,a.fromCache),this.query=i}get docs(){const e=[];return this.forEach((t=>e.push(t))),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach((i=>{e.call(t,new bf(this._firestore,this._userDataWriter,i.key,i,new yl(this._snapshot.mutatedKeys.has(i.key),this._snapshot.fromCache),this.query.converter))}))}docChanges(e={}){const t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new he(te.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=(function(a,l){if(a._snapshot.oldDocs.isEmpty()){let c=0;return a._snapshot.docChanges.map((f=>{const p=new bf(a._firestore,a._userDataWriter,f.doc.key,f.doc,new yl(a._snapshot.mutatedKeys.has(f.doc.key),a._snapshot.fromCache),a.query.converter);return f.doc,{type:"added",doc:p,oldIndex:-1,newIndex:c++}}))}{let c=a._snapshot.oldDocs;return a._snapshot.docChanges.filter((f=>l||f.type!==3)).map((f=>{const p=new bf(a._firestore,a._userDataWriter,f.doc.key,f.doc,new yl(a._snapshot.mutatedKeys.has(f.doc.key),a._snapshot.fromCache),a.query.converter);let y=-1,v=-1;return f.type!==0&&(y=c.indexOf(f.doc.key),c=c.delete(f.doc.key)),f.type!==1&&(c=c.add(f.doc),v=c.indexOf(f.doc.key)),{type:p4(f.type),doc:p,oldIndex:y,newIndex:v}}))}})(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new he(te.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=xl._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=nv.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const t=[],i=[],a=[];return this.docs.forEach((l=>{l._document!==null&&(t.push(l._document),i.push(this._userDataWriter.convertObjectMap(l._document.data.value.mapValue.fields,"previous")),a.push(l.ref.path))})),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function p4(s){switch(s){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return ye(61501,{type:s})}}xl._jsonSchemaVersion="firestore/querySnapshot/1.0",xl._jsonSchema={type:qt("string",xl._jsonSchemaVersion),bundleSource:qt("string","QuerySnapshot"),bundleName:qt("string"),bundle:qt("string")};const g4={maxAttempts:5};class y4{constructor(e,t){this._firestore=e,this._commitHandler=t,this._mutations=[],this._committed=!1,this._dataReader=nc(e)}set(e,t,i){this._verifyNotCommitted();const a=Gr(e,this._firestore),l=Rm(a.converter,t,i),c=wm(this._dataReader,"WriteBatch.set",a._key,l,a.converter!==null,i);return this._mutations.push(c.toMutation(a._key,xt.none())),this}update(e,t,i,...a){this._verifyNotCommitted();const l=Gr(e,this._firestore);let c;return c=typeof(t=At(t))=="string"||t instanceof uh?Qv(this._dataReader,"WriteBatch.update",l._key,t,i,a):Gv(this._dataReader,"WriteBatch.update",l._key,t),this._mutations.push(c.toMutation(l._key,xt.exists(!0))),this}delete(e){this._verifyNotCommitted();const t=Gr(e,this._firestore);return this._mutations=this._mutations.concat(new Jl(t._key,xt.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new he(te.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}}function Gr(s,e){if((s=At(s)).firestore!==e)throw new he(te.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return s}class v4{constructor(e,t){this._firestore=e,this._transaction=t,this._dataReader=nc(e)}get(e){const t=Gr(e,this._firestore),i=new l4(this._firestore);return this._transaction.lookup([t._key]).then((a=>{if(!a||a.length!==1)return ye(24041);const l=a[0];if(l.isFoundDocument())return new $f(this._firestore,i,l.key,l,t.converter);if(l.isNoDocument())return new $f(this._firestore,i,t._key,null,t.converter);throw ye(18433,{doc:l})}))}set(e,t,i){const a=Gr(e,this._firestore),l=Rm(a.converter,t,i),c=wm(this._dataReader,"Transaction.set",a._key,l,a.converter!==null,i);return this._transaction.set(a._key,c),this}update(e,t,i,...a){const l=Gr(e,this._firestore);let c;return c=typeof(t=At(t))=="string"||t instanceof uh?Qv(this._dataReader,"Transaction.update",l._key,t,i,a):Gv(this._dataReader,"Transaction.update",l._key,t),this._transaction.update(l._key,c),this}delete(e){const t=Gr(e,this._firestore);return this._transaction.delete(t._key),this}}class _4 extends v4{constructor(e,t){super(e,t),this._firestore=e}get(e){const t=Gr(e,this._firestore),i=new $v(this._firestore);return super.get(e).then((a=>new Xr(this._firestore,i,t._key,a._document,new yl(!1,!1),t.converter)))}}function b4(s,e,t){s=ci(s,Js);const i={...g4,...t};(function(c){if(c.maxAttempts<1)throw new he(te.INVALID_ARGUMENT,"Max attempts must be at least 1")})(i);const a=ch(s);return WM(a,(l=>e(new _4(s,l))),i)}function n_(s){s=ci(s,Rt);const e=ci(s.firestore,Js),t=ch(e);return QM(t,s._key).then((i=>E4(e,s,i)))}function ca(s){s=ci(s,la);const e=ci(s.firestore,Js),t=ch(e),i=new $v(e);return o4(s._query),KM(t,s._query).then((a=>new xl(e,i,s,a)))}function T4(s,e,t){s=ci(s,Rt);const i=ci(s.firestore,Js),a=Rm(s.converter,e,t),l=nc(i);return fh(i,[wm(l,"setDoc",s._key,a,s.converter!==null,t).toMutation(s._key,xt.none())])}function dh(s,e,t,...i){s=ci(s,Rt);const a=ci(s.firestore,Js),l=nc(a);let c;return c=typeof(e=At(e))=="string"||e instanceof uh?Qv(l,"updateDoc",s._key,e,t,i):Gv(l,"updateDoc",s._key,e),fh(a,[c.toMutation(s._key,xt.exists(!0))])}function i_(s){return fh(ci(s.firestore,Js),[new Jl(s._key,xt.none())])}function s_(s,e){const t=ci(s.firestore,Js),i=_n(s),a=Rm(s.converter,e),l=nc(s.firestore);return fh(t,[wm(l,"addDoc",i._key,a,s.converter!==null,{}).toMutation(i._key,xt.exists(!1))]).then((()=>i))}function fh(s,e){const t=ch(s);return $M(t,e)}function E4(s,e,t){const i=t.docs.get(e._key),a=new $v(s);return new Xr(s,a,e._key,i,new yl(t.hasPendingWrites,t.fromCache),e.converter)}function BA(s){return s=ci(s,Js),ch(s),new y4(s,(e=>fh(s,e)))}(function(e,t=!0){Rk(ho),Za(new Jr("firestore",((i,{instanceIdentifier:a,options:l})=>{const c=i.getProvider("app").getImmediate(),f=new Js(new jk(i.getProvider("auth-internal")),new Vk(c,i.getProvider("app-check-internal")),bO(c,a),c);return l={useFetchStreams:t,...l},f._setSettings(l),f}),"PUBLIC").setMultipleInstances(!0)),as(Fx,qx,e),as(Fx,qx,"esm2020")})();const FA="firebasestorage.googleapis.com",x4="storageBucket",S4=120*1e3,w4=600*1e3;class ms extends ds{constructor(e,t,i=0){super(Xg(e),`Firebase Storage: ${t} (${Xg(e)})`),this.status_=i,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,ms.prototype)}get status(){return this.status_}set status(e){this.status_=e}_codeEquals(e){return Xg(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.customData.serverResponse?this.message=`${this._baseMessage}
${this.customData.serverResponse}`:this.message=this._baseMessage}}var hs;(function(s){s.UNKNOWN="unknown",s.OBJECT_NOT_FOUND="object-not-found",s.BUCKET_NOT_FOUND="bucket-not-found",s.PROJECT_NOT_FOUND="project-not-found",s.QUOTA_EXCEEDED="quota-exceeded",s.UNAUTHENTICATED="unauthenticated",s.UNAUTHORIZED="unauthorized",s.UNAUTHORIZED_APP="unauthorized-app",s.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",s.INVALID_CHECKSUM="invalid-checksum",s.CANCELED="canceled",s.INVALID_EVENT_NAME="invalid-event-name",s.INVALID_URL="invalid-url",s.INVALID_DEFAULT_BUCKET="invalid-default-bucket",s.NO_DEFAULT_BUCKET="no-default-bucket",s.CANNOT_SLICE_BLOB="cannot-slice-blob",s.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",s.NO_DOWNLOAD_URL="no-download-url",s.INVALID_ARGUMENT="invalid-argument",s.INVALID_ARGUMENT_COUNT="invalid-argument-count",s.APP_DELETED="app-deleted",s.INVALID_ROOT_OPERATION="invalid-root-operation",s.INVALID_FORMAT="invalid-format",s.INTERNAL_ERROR="internal-error",s.UNSUPPORTED_ENVIRONMENT="unsupported-environment"})(hs||(hs={}));function Xg(s){return"storage/"+s}function A4(){const s="An unknown error occurred, please check the error payload for server response.";return new ms(hs.UNKNOWN,s)}function I4(){return new ms(hs.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function C4(){return new ms(hs.CANCELED,"User canceled the upload/download.")}function R4(s){return new ms(hs.INVALID_URL,"Invalid URL '"+s+"'.")}function D4(s){return new ms(hs.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+s+"'.")}function Qx(s){return new ms(hs.INVALID_ARGUMENT,s)}function qA(){return new ms(hs.APP_DELETED,"The Firebase app was deleted.")}function N4(s){return new ms(hs.INVALID_ROOT_OPERATION,"The operation '"+s+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}class Ii{constructor(e,t){this.bucket=e,this.path_=t}get path(){return this.path_}get isRoot(){return this.path.length===0}fullServerUrl(){const e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,t){let i;try{i=Ii.makeFromUrl(e,t)}catch{return new Ii(e,"")}if(i.path==="")return i;throw D4(e)}static makeFromUrl(e,t){let i=null;const a="([A-Za-z0-9.\\-_]+)";function l(ne){ne.path.charAt(ne.path.length-1)==="/"&&(ne.path_=ne.path_.slice(0,-1))}const c="(/(.*))?$",f=new RegExp("^gs://"+a+c,"i"),p={bucket:1,path:3};function y(ne){ne.path_=decodeURIComponent(ne.path)}const v="v[A-Za-z0-9_]+",b=t.replace(/[.]/g,"\\."),x="(/([^?#]*).*)?$",k=new RegExp(`^https?://${b}/${v}/b/${a}/o${x}`,"i"),O={bucket:1,path:3},D=t===FA?"(?:storage.googleapis.com|storage.cloud.google.com)":t,M="([^?#]*)",Y=new RegExp(`^https?://${D}/${a}/${M}`,"i"),$=[{regex:f,indices:p,postModify:l},{regex:k,indices:O,postModify:y},{regex:Y,indices:{bucket:1,path:2},postModify:y}];for(let ne=0;ne<$.length;ne++){const ee=$[ne],se=ee.regex.exec(e);if(se){const w=se[ee.indices.bucket];let C=se[ee.indices.path];C||(C=""),i=new Ii(w,C),ee.postModify(i);break}}if(i==null)throw R4(e);return i}}class j4{constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(e=!1){}}function k4(s,e,t){let i=1,a=null,l=null,c=!1,f=0;function p(){return f===2}let y=!1;function v(...M){y||(y=!0,e.apply(null,M))}function b(M){a=setTimeout(()=>{a=null,s(k,p())},M)}function x(){l&&clearTimeout(l)}function k(M,...Y){if(y){x();return}if(M){x(),v.call(null,M,...Y);return}if(p()||c){x(),v.call(null,M,...Y);return}i<64&&(i*=2);let $;f===1?(f=2,$=0):$=(i+Math.random())*1e3,b($)}let O=!1;function D(M){O||(O=!0,x(),!y&&(a!==null?(M||(f=2),clearTimeout(a),b(0)):M||(f=1)))}return b(0),l=setTimeout(()=>{c=!0,D(!0)},t),D}function O4(s){s(!1)}function V4(s){return s!==void 0}function Kx(s,e,t,i){if(i<e)throw Qx(`Invalid value for '${s}'. Expected ${e} or greater.`);if(i>t)throw Qx(`Invalid value for '${s}'. Expected ${t} or less.`)}function M4(s){const e=encodeURIComponent;let t="?";for(const i in s)if(s.hasOwnProperty(i)){const a=e(i)+"="+e(s[i]);t=t+a+"&"}return t=t.slice(0,-1),t}var Wf;(function(s){s[s.NO_ERROR=0]="NO_ERROR",s[s.NETWORK_ERROR=1]="NETWORK_ERROR",s[s.ABORT=2]="ABORT"})(Wf||(Wf={}));function P4(s,e){const t=s>=500&&s<600,a=[408,429].indexOf(s)!==-1,l=e.indexOf(s)!==-1;return t||a||l}class L4{constructor(e,t,i,a,l,c,f,p,y,v,b,x=!0,k=!1){this.url_=e,this.method_=t,this.headers_=i,this.body_=a,this.successCodes_=l,this.additionalRetryCodes_=c,this.callback_=f,this.errorCallback_=p,this.timeout_=y,this.progressCallback_=v,this.connectionFactory_=b,this.retry=x,this.isUsingEmulator=k,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((O,D)=>{this.resolve_=O,this.reject_=D,this.start_()})}start_(){const e=(i,a)=>{if(a){i(!1,new Yd(!1,null,!0));return}const l=this.connectionFactory_();this.pendingConnection_=l;const c=f=>{const p=f.loaded,y=f.lengthComputable?f.total:-1;this.progressCallback_!==null&&this.progressCallback_(p,y)};this.progressCallback_!==null&&l.addUploadProgressListener(c),l.send(this.url_,this.method_,this.isUsingEmulator,this.body_,this.headers_).then(()=>{this.progressCallback_!==null&&l.removeUploadProgressListener(c),this.pendingConnection_=null;const f=l.getErrorCode()===Wf.NO_ERROR,p=l.getStatus();if(!f||P4(p,this.additionalRetryCodes_)&&this.retry){const v=l.getErrorCode()===Wf.ABORT;i(!1,new Yd(!1,null,v));return}const y=this.successCodes_.indexOf(p)!==-1;i(!0,new Yd(y,l))})},t=(i,a)=>{const l=this.resolve_,c=this.reject_,f=a.connection;if(a.wasSuccessCode)try{const p=this.callback_(f,f.getResponse());V4(p)?l(p):l()}catch(p){c(p)}else if(f!==null){const p=A4();p.serverResponse=f.getErrorText(),this.errorCallback_?c(this.errorCallback_(f,p)):c(p)}else if(a.canceled){const p=this.appDelete_?qA():C4();c(p)}else{const p=I4();c(p)}};this.canceled_?t(!1,new Yd(!1,null,!0)):this.backoffId_=k4(e,t,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,this.backoffId_!==null&&O4(this.backoffId_),this.pendingConnection_!==null&&this.pendingConnection_.abort()}}class Yd{constructor(e,t,i){this.wasSuccessCode=e,this.connection=t,this.canceled=!!i}}function U4(s,e){e!==null&&e.length>0&&(s.Authorization="Firebase "+e)}function z4(s,e){s["X-Firebase-Storage-Version"]="webjs/"+(e??"AppManager")}function B4(s,e){e&&(s["X-Firebase-GMPID"]=e)}function F4(s,e){e!==null&&(s["X-Firebase-AppCheck"]=e)}function q4(s,e,t,i,a,l,c=!0,f=!1){const p=M4(s.urlParams),y=s.url+p,v=Object.assign({},s.headers);return B4(v,e),U4(v,t),z4(v,l),F4(v,i),new L4(y,s.method,v,s.body,s.successCodes,s.additionalRetryCodes,s.handler,s.errorHandler,s.timeout,s.progressCallback,a,c,f)}function H4(s){if(s.length===0)return null;const e=s.lastIndexOf("/");return e===-1?"":s.slice(0,e)}function G4(s){const e=s.lastIndexOf("/",s.length-2);return e===-1?s:s.slice(e+1)}class Yf{constructor(e,t){this._service=e,t instanceof Ii?this._location=t:this._location=Ii.makeFromUrl(t,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,t){return new Yf(e,t)}get root(){const e=new Ii(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return G4(this._location.path)}get storage(){return this._service}get parent(){const e=H4(this._location.path);if(e===null)return null;const t=new Ii(this._location.bucket,e);return new Yf(this._service,t)}_throwIfRoot(e){if(this._location.path==="")throw N4(e)}}function $x(s,e){const t=e?.[x4];return t==null?null:Ii.makeFromBucketSpec(t,s)}function Q4(s,e,t,i={}){s.host=`${e}:${t}`;const a=uo(e);a&&(Hy(`https://${s.host}/b`),C1("Storage",!0)),s._isUsingEmulator=!0,s._protocol=a?"https":"http";const{mockUserToken:l}=i;l&&(s._overrideAuthToken=typeof l=="string"?l:PR(l,s.app.options.projectId))}class K4{constructor(e,t,i,a,l,c=!1){this.app=e,this._authProvider=t,this._appCheckProvider=i,this._url=a,this._firebaseVersion=l,this._isUsingEmulator=c,this._bucket=null,this._host=FA,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=S4,this._maxUploadRetryTime=w4,this._requests=new Set,a!=null?this._bucket=Ii.makeFromBucketSpec(a,this._host):this._bucket=$x(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,this._url!=null?this._bucket=Ii.makeFromBucketSpec(this._url,e):this._bucket=$x(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){Kx("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){Kx("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}async _getAuthToken(){if(this._overrideAuthToken)return this._overrideAuthToken;const e=this._authProvider.getImmediate({optional:!0});if(e){const t=await e.getToken();if(t!==null)return t.accessToken}return null}async _getAppCheckToken(){if(Fn(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=this._appCheckProvider.getImmediate({optional:!0});return e?(await e.getToken()).token:null}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(e=>e.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new Yf(this,e)}_makeRequest(e,t,i,a,l=!0){if(this._deleted)return new j4(qA());{const c=q4(e,this._appId,i,a,t,this._firebaseVersion,l,this._isUsingEmulator);return this._requests.add(c),c.getPromise().then(()=>this._requests.delete(c),()=>this._requests.delete(c)),c}}async makeRequestWithTokens(e,t){const[i,a]=await Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(e,t,i,a).getPromise()}}const Wx="@firebase/storage",Yx="0.14.0";const HA="storage";function $4(s=M1(),e){s=At(s);const i=nm(s,HA).getImmediate({identifier:e}),a=VR("storage");return a&&W4(i,...a),i}function W4(s,e,t,i={}){Q4(s,e,t,i)}function Y4(s,{instanceIdentifier:e}){const t=s.getProvider("app").getImmediate(),i=s.getProvider("auth-internal"),a=s.getProvider("app-check-internal");return new K4(t,i,a,e,ho)}function X4(){Za(new Jr(HA,Y4,"PUBLIC").setMultipleInstances(!0)),as(Wx,Yx,""),as(Wx,Yx,"esm2020")}X4();const J4={apiKey:"AIzaSyC_Y5AYNw-qfHRncEuzwOA9d1jReKztInY",authDomain:"neuralprep-e2d1b.firebaseapp.com",projectId:"neuralprep-e2d1b",storageBucket:"neuralprep-e2d1b.firebasestorage.app",messagingSenderId:"740904166312",appId:"1:740904166312:web:ac188708063855b5ec739d"},r_=V1(J4),mh=wk(r_),ut=ZM(r_,{localCache:u4({tabManager:m4()})});$4(r_);async function Z4(s,e,t){const i=await oj(mh,s,e);return t&&await uj(i.user,{displayName:t}),i.user}async function e6(s,e){return(await lj(mh,s,e)).user}async function t6(){await mj(mh)}function n6(s){return fj(mh,s)}async function i6(s){await aj(mh,s)}async function s6(s,e){await T4(_n(ut,"users",s),{...e,createdAt:Kn(),updatedAt:Kn()})}async function a_(s){const e=await n_(_n(ut,"users",s));return e.exists()?{id:e.id,...e.data()}:null}async function GA(s,e){await dh(_n(ut,"users",s),{...e,updatedAt:Kn()})}async function r6(s,e){const t=di(ut,"users",s,"subjects");return(await s_(t,{name:e.name,color:e.color||"#6C63FF",icon:e.icon||"",questionCount:0,masteredCount:0,createdAt:Kn(),updatedAt:Kn()})).id}async function a6(s){const e=di(ut,"users",s,"subjects"),t=ic(e,e_("createdAt","desc"));return(await ca(t)).docs.map(a=>({id:a.id,...a.data()}))}async function o6(s,e,t){await dh(_n(ut,"users",s,"subjects",e),{...t,updatedAt:Kn()})}async function l6(s,e){await i_(_n(ut,"users",s,"subjects",e))}async function c6(s,e,t){const i=di(ut,"users",s,"subjects",e,"chapters");return(await s_(i,{name:t.name,questionCount:0,masteredCount:0,createdAt:Kn(),updatedAt:Kn()})).id}async function u6(s,e){const t=di(ut,"users",s,"subjects",e,"chapters"),i=ic(t,e_("createdAt","desc"));return(await ca(i)).docs.map(l=>({id:l.id,...l.data()}))}async function h6(s,e,t){await i_(_n(ut,"users",s,"subjects",e,"chapters",t))}async function d6(s,e,t,i){const a=BA(ut),l=di(ut,"users",s,"subjects",e,"chapters",t,"questions");i.forEach(c=>{const f=_n(l);a.set(f,{text:c.text,options:c.options,correctOption:c.correctOption,explanation:c.explanation||"",important:c.important||!1,masteryLevel:0,flagged:!1,timesAnswered:0,timesCorrect:0,nextReviewDate:null,createdAt:Kn()})}),await a.commit()}async function f6(s,e,t){const i=di(ut,"users",s,"subjects",e,"chapters",t,"questions");return(await ca(i)).docs.map(l=>({id:l.id,...l.data()}))}async function m6(s,e,t,i){await i_(_n(ut,"users",s,"subjects",e,"chapters",t,"questions",i))}const pn=em(s=>({user:null,loading:!0,isAuthenticated:!1,userProfile:null,error:null,setUser:e=>s({user:e,isAuthenticated:!!e,loading:!1}),setUserProfile:e=>s({userProfile:e}),setLoading:e=>s({loading:e}),setError:e=>s({error:e}),clearError:()=>s({error:null}),logout:()=>s({user:null,isAuthenticated:!1,userProfile:null,error:null})}));function p6({children:s}){const{setUser:e,setUserProfile:t,setLoading:i}=pn();return N.useEffect(()=>{const a=n6(async l=>{if(l){e(l);try{const c=await a_(l.uid);t(c)}catch(c){console.error("Failed to fetch user profile:",c)}}else e(null),t(null);i(!1)});return()=>a()},[e,t,i]),s}function Jg({children:s}){const{isAuthenticated:e,loading:t}=pn();return t?d.jsx("div",{style:{minHeight:"100vh",display:"flex",alignItems:"center",justifyContent:"center",background:"var(--bg)"},children:d.jsx(IR,{})}):e?s:d.jsx(UC,{to:"/login",replace:!0})}const g6=[{path:"/",label:"Dashboard",icon:d.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[d.jsx("path",{d:"M3 9l9-7 9 7v11a2 2 0 01-2 2H5a2 2 0 01-2-2z"}),d.jsx("polyline",{points:"9 22 9 12 15 12 15 22"})]})},{path:"/practice",label:"Practice",icon:d.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:d.jsx("polygon",{points:"13 2 3 14 12 14 11 22 21 10 12 10 13 2"})})},{path:"/subjects",label:"Subjects",icon:d.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[d.jsx("path",{d:"M4 19.5A2.5 2.5 0 016.5 17H20"}),d.jsx("path",{d:"M6.5 2H20v20H6.5A2.5 2.5 0 014 19.5v-15A2.5 2.5 0 016.5 2z"})]})},{path:"/wrong-questions",label:"Wrong Questions",icon:d.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[d.jsx("circle",{cx:"12",cy:"12",r:"10"}),d.jsx("line",{x1:"15",y1:"9",x2:"9",y2:"15"}),d.jsx("line",{x1:"9",y1:"9",x2:"15",y2:"15"})]})},{path:"/analytics",label:"Analytics",icon:d.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[d.jsx("line",{x1:"18",y1:"20",x2:"18",y2:"10"}),d.jsx("line",{x1:"12",y1:"20",x2:"12",y2:"4"}),d.jsx("line",{x1:"6",y1:"20",x2:"6",y2:"14"})]})},{path:"/settings",label:"Settings",icon:d.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[d.jsx("circle",{cx:"12",cy:"12",r:"3"}),d.jsx("path",{d:"M19.4 15a1.65 1.65 0 00.33 1.82l.06.06a2 2 0 010 2.83 2 2 0 01-2.83 0l-.06-.06a1.65 1.65 0 00-1.82-.33 1.65 1.65 0 00-1 1.51V21a2 2 0 01-2 2 2 2 0 01-2-2v-.09A1.65 1.65 0 009 19.4a1.65 1.65 0 00-1.82.33l-.06.06a2 2 0 01-2.83 0 2 2 0 010-2.83l.06-.06A1.65 1.65 0 004.68 15a1.65 1.65 0 00-1.51-1H3a2 2 0 01-2-2 2 2 0 012-2h.09A1.65 1.65 0 004.6 9a1.65 1.65 0 00-.33-1.82l-.06-.06a2 2 0 010-2.83 2 2 0 012.83 0l.06.06A1.65 1.65 0 009 4.68a1.65 1.65 0 001-1.51V3a2 2 0 012-2 2 2 0 012 2v.09a1.65 1.65 0 001 1.51 1.65 1.65 0 001.82-.33l.06-.06a2 2 0 012.83 0 2 2 0 010 2.83l-.06.06a1.65 1.65 0 00-.33 1.82V9a1.65 1.65 0 001.51 1H21a2 2 0 012 2 2 2 0 01-2 2h-.09a1.65 1.65 0 00-1.51 1z"})]})}];function y6({mobileOpen:s,onClose:e}){const{sidebarCollapsed:t,toggleSidebar:i}=Kl(),a=hi(),l=()=>{window.innerWidth<=768&&e&&e()};return d.jsxs(d.Fragment,{children:[d.jsx("div",{className:`np-sidebar-overlay ${s?"visible":""}`,onClick:e}),d.jsxs("aside",{className:`np-sidebar ${t?"np-sidebar-collapsed":"np-sidebar-expanded"} ${s?"mobile-open":""}`,children:[d.jsxs("div",{className:"np-sidebar-header",children:[d.jsx("div",{className:"np-sidebar-logo",children:d.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"white",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:d.jsx("polygon",{points:"13 2 3 14 12 14 11 22 21 10 12 10 13 2"})})}),d.jsx("span",{className:"np-sidebar-brand",children:"NeuralPrep"}),s&&d.jsx("button",{onClick:e,style:{marginLeft:"auto",width:32,height:32,borderRadius:8,display:"flex",alignItems:"center",justifyContent:"center",color:"var(--muted)",transition:"color 0.15s"},children:d.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:d.jsx("path",{d:"M18 6L6 18M6 6l12 12"})})})]}),d.jsx("nav",{className:"np-nav",children:g6.map(c=>{const f=a.pathname===c.path||c.path!=="/"&&a.pathname.startsWith(c.path);return d.jsxs(y1,{to:c.path,className:`np-nav-item ${f?"active":""}`,onClick:l,children:[d.jsx("span",{className:"np-nav-icon",children:c.icon}),d.jsx("span",{children:c.label})]},c.path)})}),d.jsx("div",{className:"np-sidebar-collapse",style:{padding:12,borderTop:"1px solid var(--border)"},children:d.jsxs("button",{onClick:i,className:"np-nav-item",style:{width:"100%",justifyContent:t?"center":"flex-start"},children:[d.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",style:{transition:"transform 0.3s",transform:t?"rotate(180deg)":"none"},children:[d.jsx("polyline",{points:"11 17 6 12 11 7"}),d.jsx("polyline",{points:"18 17 13 12 18 7"})]}),d.jsx("span",{children:"Collapse"})]})})]})]})}const v6={"/":"Dashboard","/practice":"Practice Hub","/subjects":"Subjects","/wrong-questions":"Wrong Questions","/flashcards":"Flashcards","/analytics":"Analytics","/settings":"Settings","/test":"Test Session","/test/results":"Results","/rapid-fire":"Rapid Fire"};function _6({onMenuToggle:s}){const e=hi(),{sidebarCollapsed:t}=Kl(),i=v6[e.pathname]||"NeuralPrep";return d.jsxs("header",{className:"np-topbar",style:{marginLeft:t?"var(--sidebar-collapsed)":"var(--sidebar-width)"},children:[d.jsxs("div",{style:{display:"flex",alignItems:"center",gap:12},children:[d.jsx("button",{className:"np-mobile-menu-btn",onClick:s,children:d.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[d.jsx("line",{x1:"3",y1:"6",x2:"21",y2:"6"}),d.jsx("line",{x1:"3",y1:"12",x2:"21",y2:"12"}),d.jsx("line",{x1:"3",y1:"18",x2:"21",y2:"18"})]})}),d.jsx("h1",{className:"np-topbar-title",children:i})]}),d.jsx("div",{style:{display:"flex",alignItems:"center",gap:12},children:d.jsxs("div",{className:"np-streak-badge",children:[d.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:d.jsx("path",{d:"M12 2L15.09 8.26L22 9.27L17 14.14L18.18 21.02L12 17.77L5.82 21.02L7 14.14L2 9.27L8.91 8.26L12 2z"})}),d.jsx("span",{children:"0 day streak"})]})})]})}function b6(){const[s,e]=N.useState(navigator.onLine),t=Kl(i=>i.setIsOnline);return N.useEffect(()=>{const i=()=>{e(!0),t(!0)},a=()=>{e(!1),t(!1)};return window.addEventListener("online",i),window.addEventListener("offline",a),()=>{window.removeEventListener("online",i),window.removeEventListener("offline",a)}},[t]),s}function T6(){return b6()?null:d.jsx("div",{className:"fixed top-0 left-0 right-0 z-50 bg-[var(--warning)]/90 backdrop-blur-sm px-4 py-2 text-center animate-fade-in-down",children:d.jsxs("p",{className:"text-sm font-medium text-[var(--bg)] flex items-center justify-center gap-2",children:[d.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[d.jsx("line",{x1:"1",y1:"1",x2:"23",y2:"23"}),d.jsx("path",{d:"M16.72 11.06A10.94 10.94 0 0119 12.55"}),d.jsx("path",{d:"M5 12.55a10.94 10.94 0 015.17-2.39"}),d.jsx("path",{d:"M10.71 5.05A16 16 0 0122.56 9"}),d.jsx("path",{d:"M1.42 9a15.91 15.91 0 014.7-2.88"}),d.jsx("path",{d:"M8.53 16.11a6 6 0 016.95 0"}),d.jsx("line",{x1:"12",y1:"20",x2:"12.01",y2:"20"})]}),"You're offline  changes will sync when you reconnect"]})})}function E6(){const{sidebarCollapsed:s}=Kl(),[e,t]=N.useState(!1),i=N.useCallback(()=>{t(l=>!l)},[]),a=N.useCallback(()=>{t(!1)},[]);return d.jsxs("div",{style:{minHeight:"100vh",background:"var(--bg)"},children:[d.jsx(T6,{}),d.jsx(y6,{mobileOpen:e,onClose:a}),d.jsx(_6,{onMenuToggle:i}),d.jsx("main",{style:{marginLeft:s?"var(--sidebar-collapsed)":"var(--sidebar-width)",transition:"margin-left 0.3s cubic-bezier(0.4,0,0.2,1)",minHeight:"calc(100vh - 64px)",padding:"28px 32px"},children:d.jsx("div",{className:"np-page",style:{maxWidth:1200,margin:"0 auto"},children:d.jsx(zC,{})})})]})}const x6={0:"#8A8A9A",1:"#FF6B6B",2:"#FFB347",3:"#6C63FF",4:"#00D9A3"},S6=30,Xx=[{text:"The expert in anything was once a beginner.",author:"Helen Hayes"},{text:"Small daily improvements are the key to staggering long-term results.",author:"Unknown"},{text:"Don't watch the clock; do what it does. Keep going.",author:"Sam Levenson"},{text:"Success is the sum of small efforts repeated day in and day out.",author:"Robert Collier"},{text:"The only way to do great work is to love what you do.",author:"Steve Jobs"},{text:"It does not matter how slowly you go as long as you do not stop.",author:"Confucius"},{text:"The secret of getting ahead is getting started.",author:"Mark Twain"},{text:"Believe you can and you're halfway there.",author:"Theodore Roosevelt"},{text:"The mind is everything. What you think you become.",author:"Buddha"},{text:"Education is the most powerful weapon you can use to change the world.",author:"Nelson Mandela"}];function w6(s,e=2.5,t=0,i=0){const a=Math.max(0,Math.min(5,s));let l=e+(.1-(5-a)*(.08+(5-a)*.02));l=Math.max(1.3,l);let c,f;return a<3?(c=1,f=0):(f=i+1,f===1?c=1:f===2?c=6:c=Math.round(t*l)),{interval:Math.max(1,Math.min(365,c)),ef:Math.round(l*100)/100,repetitions:f}}function A6(s,e){if(!s)return 1;switch(e){case"guessed":return 2;case"unsure":return 3;case"sure":return 5;default:return 4}}function I6(s,e,t,i){return t===0?0:s<.4?1:s<.7?2:s<.9?3:s>=.9&&e>=3&&i!=="guessed"?4:3}function QA(s,e=S6){if(!s)return!1;const t=new Date(s);return(new Date().getTime()-t.getTime())/(1e3*60*60*24)>=e}function C6(s){if(!s)return null;const e=new Date(s);return Math.floor((new Date().getTime()-e.getTime())/(1e3*60*60*24))}async function o_(s,e){const t=di(ut,"sessions");return(await s_(t,{userId:s,status:"in_progress",type:e.type,scope:e.scope,config:e.config,questionIds:e.questionIds,startTime:Kn(),endTime:null,totalQuestions:e.totalQuestions,answered:0,correct:0,wrong:0,skipped:0,score:0,questionResults:[],templateId:e.templateId||null})).id}async function R6(s,e){await dh(_n(ut,"sessions",s),e)}async function KA(s,e){await dh(_n(ut,"sessions",s),{...e,status:"completed",endTime:Kn()})}async function D6(s,e){const t=_n(ut,"users",s);try{await b4(ut,async i=>{const a=await i.get(t);if(!a.exists())return;const l=a.data(),c=new Date,f=c.getFullYear()+"-"+String(c.getMonth()+1).padStart(2,"0")+"-"+String(c.getDate()).padStart(2,"0");let{streak:p=0,lastSessionDate:y=null,todayStats:v={date:"",answered:0,correct:0,sessions:0}}=l;if(v.date!==f&&(v={date:f,answered:0,correct:0,sessions:0}),v.answered+=e.answered||0,v.correct+=e.correct||0,v.sessions+=1,y!==f){if(y){const b=new Date(y);b.setHours(0,0,0,0);const x=new Date;x.setHours(0,0,0,0);const k=Math.round((x-b)/(1e3*60*60*24));k===1?p+=1:k>1&&(p=1)}else p=1;y=f}i.update(t,{streak:p,lastSessionDate:y,todayStats:v,updatedAt:Kn()})})}catch(i){console.error("Failed to update aggregate stats:",i)}}async function $A(s){await dh(_n(ut,"sessions",s),{status:"abandoned",endTime:Kn()})}async function N6(s){const e=await n_(_n(ut,"sessions",s));return e.exists()?{id:e.id,...e.data()}:null}async function j6(s){const e=di(ut,"sessions"),t=ic(e,Xv("userId","==",s),Cm(10)),a=(await ca(t)).docs.map(c=>({id:c.id,...c.data()})).filter(c=>c.status==="in_progress");if(a.length===0)return null;a.sort((c,f)=>{const p=c.startTime?.toDate?c.startTime.toDate().getTime():0;return(f.startTime?.toDate?f.startTime.toDate().getTime():0)-p});const l=a[0];if(l.startTime){const c=l.startTime.toDate?l.startTime.toDate().getTime():l.startTime;if(Date.now()-c>1440*60*1e3)return await $A(l.id),null}return l}async function l_(s,e=5){const t=di(ut,"sessions"),i=ic(t,Xv("userId","==",s),Cm(50)),l=(await ca(i)).docs.map(c=>({id:c.id,...c.data()})).filter(c=>c.status==="completed");return l.sort((c,f)=>{const p=c.endTime?.toDate?c.endTime.toDate().getTime():0;return(f.endTime?.toDate?f.endTime.toDate().getTime():0)-p}),l.slice(0,e)}async function k6(s){const e=di(ut,"sessions"),t=ic(e,Xv("userId","==",s),Cm(150)),a=(await ca(t)).docs.map(O=>({id:O.id,...O.data()})).filter(O=>O.status==="completed");a.sort((O,D)=>{const M=O.endTime?.toDate?O.endTime.toDate().getTime():0;return(D.endTime?.toDate?D.endTime.toDate().getTime():0)-M});const l=a.slice(0,5),c=new Date,f=c.getFullYear()+"-"+String(c.getMonth()+1).padStart(2,"0")+"-"+String(c.getDate()).padStart(2,"0"),p=a.filter(O=>{if(!O.endTime)return!1;const D=O.endTime.toDate?O.endTime.toDate():new Date(O.endTime);return D.getFullYear()+"-"+String(D.getMonth()+1).padStart(2,"0")+"-"+String(D.getDate()).padStart(2,"0")===f}),y=p.reduce((O,D)=>O+(D.answered||0),0),v=p.reduce((O,D)=>O+(D.correct||0),0),b=y>0?Math.round(v/y*100):0;let x=0;const k=new Date;k.setHours(0,0,0,0);for(let O=0;O<60;O++){const D=new Date(k);D.setDate(D.getDate()-O);const M=D.getFullYear()+"-"+String(D.getMonth()+1).padStart(2,"0")+"-"+String(D.getDate()).padStart(2,"0");if(a.some(Z=>{if(!Z.endTime)return!1;const $=Z.endTime?.toDate?Z.endTime.toDate():new Date(Z.endTime);return $.getFullYear()+"-"+String($.getMonth()+1).padStart(2,"0")+"-"+String($.getDate()).padStart(2,"0")===M}))x++;else if(O>0)break}return{recentSessions:l,todayStats:{sessions:p.length,answered:y,correct:v,accuracy:b},streak:x}}async function O6(s){const e=di(ut,"users",s,"templates"),t=ic(e,e_("createdAt","desc"),Cm(5));return(await ca(t)).docs.map(a=>({id:a.id,...a.data()}))}async function WA(s){const e=di(ut,"users",s,"performance"),t=await ca(e),i={};return t.docs.forEach(a=>{i[a.id]=a.data()}),i}async function YA(s,e){const t=BA(ut);for(const i of e){if(!i.questionId||i.userAnswer===null)continue;const a=_n(ut,"users",s,"performance",i.questionId),l=await n_(a),c=l.exists()?l.data():{timesAsked:0,timesCorrect:0,timesWrong:0,streak:0,intervalDays:1,easeFactor:2.5,repetitions:0,flagged:!1},f=(c.timesAsked||0)+1,p=(c.timesCorrect||0)+(i.isCorrect?1:0),y=(c.timesWrong||0)+(i.isCorrect?0:1);let v=c.streak||0;i.isCorrect&&i.confidence!=="guessed"?v+=1:i.isCorrect||(v=0);const b=A6(i.isCorrect,i.confidence),x=w6(b,c.easeFactor||2.5,c.intervalDays||0,c.repetitions||0),k=new Date;k.setHours(0,0,0,0);const O=new Date(k.getTime()+x.interval*24*60*60*1e3),D=f>0?p/f:0,M=I6(D,v,f,i.confidence),Y=i.flagged!==void 0?i.flagged:c.flagged||!1,Z={timesAsked:f,timesCorrect:p,timesWrong:y,streak:v,intervalDays:x.interval,easeFactor:x.ef,repetitions:x.repetitions,nextDue:O.toISOString(),lastAsked:new Date().toISOString(),lastConfidence:i.confidence||null,masteryLevel:M,flagged:Y};l.exists()?t.update(a,Z):t.set(a,Z)}await t.commit()}const Zs=em((s,e)=>({subjects:[],subjectsLoading:!1,chapters:{},chaptersLoading:!1,questions:{},questionsLoading:!1,performanceMap:{},performanceLoading:!1,fetchSubjects:async t=>{s({subjectsLoading:!0});try{const i=await a6(t);s({subjects:i,subjectsLoading:!1})}catch(i){console.error("Failed to fetch subjects:",i),s({subjectsLoading:!1})}},addSubject:async(t,i)=>{const a=await r6(t,i);return await e().fetchSubjects(t),a},updateSubject:async(t,i,a)=>{await o6(t,i,a),await e().fetchSubjects(t)},deleteSubject:async(t,i)=>{await l6(t,i),s(a=>({subjects:a.subjects.filter(l=>l.id!==i)}))},fetchChapters:async(t,i)=>{s({chaptersLoading:!0});try{const a=await u6(t,i);s(l=>({chapters:{...l.chapters,[i]:a},chaptersLoading:!1}))}catch(a){console.error("Failed to fetch chapters:",a),s({chaptersLoading:!1})}},addChapter:async(t,i,a)=>{const l=await c6(t,i,a);return await e().fetchChapters(t,i),l},deleteChapter:async(t,i,a)=>{await h6(t,i,a),await e().fetchChapters(t,i)},fetchQuestions:async(t,i,a)=>{s({questionsLoading:!0});try{const l=await f6(t,i,a);s(c=>({questions:{...c.questions,[a]:l},questionsLoading:!1}))}catch(l){console.error("Failed to fetch questions:",l),s({questionsLoading:!1})}},addQuestions:async(t,i,a,l)=>{await d6(t,i,a,l),await e().fetchQuestions(t,i,a)},deleteQuestion:async(t,i,a,l)=>{await m6(t,i,a,l),s(c=>({questions:{...c.questions,[a]:(c.questions[a]||[]).filter(f=>f.id!==l)}}))},fetchPerformance:async t=>{s({performanceLoading:!0});try{const i=await WA(t);return s({performanceMap:i,performanceLoading:!1}),i}catch(i){return console.error("Failed to fetch performance:",i),s({performanceLoading:!1}),{}}},clearData:()=>s({subjects:[],chapters:{},questions:{},performanceMap:{}})}));function V6(){const s=new Date().getHours();return s<12?"Good morning":s<17?"Good afternoon":s<21?"Good evening":"Burning the midnight oil"}function M6(){const s=ln(),{user:e,userProfile:t}=pn(),{subjects:i,fetchSubjects:a,performanceMap:l,fetchPerformance:c}=Zs(),[f,p]=N.useState([]),[y,v]=N.useState({sessions:0,answered:0,correct:0,accuracy:0}),[b,x]=N.useState(0),[k,O]=N.useState(!0),[D]=N.useState(()=>{const w=Math.floor(Math.random()*Xx.length);return Xx[w]});N.useEffect(()=>{e?.uid&&(async()=>{O(!0);try{i.length===0&&await a(e.uid),await c(e.uid);const w=await a_(e.uid);w&&pn.getState().setUserProfile(w);const C=await k6(e.uid);p(C.recentSessions),v(C.todayStats),x(C.streak)}catch(w){console.error("Dashboard load error:",w)}finally{O(!1)}})()},[e?.uid]);const M=t?.displayName||e?.displayName||"Student",Y=t?.dailyGoal||50,Z=N.useMemo(()=>{if(!t?.examDate)return null;const w=Math.ceil((new Date(t.examDate)-new Date)/(1e3*60*60*24));return w>0?w:0},[t?.examDate]),$=N.useMemo(()=>{const w=Object.values(l||{});let C=0,A=0,R=0,j=0,L=0,V=0,we=0;if(w.length>0){R=w.length,C=w.filter(oe=>(oe.masteryLevel||0)>=4).length,A=w.filter(oe=>(oe.timesWrong||0)>0&&(oe.masteryLevel||0)<4).length,j=w.reduce((oe,pe)=>oe+(pe.timesCorrect||0),0),L=w.reduce((oe,pe)=>oe+(pe.timesAsked||0),0);const G=new Date;G.setHours(23,59,59,999),V=w.filter(oe=>oe.nextDue?new Date(oe.nextDue)<=G:!1).length,we=w.filter(oe=>oe.lastAsked?(Date.now()-new Date(oe.lastAsked).getTime())/(1e3*60*60*24)>=30:!1).length}const Te=L>0?Math.round(j/L*100):0;return{mastered:C,wrongRemaining:A,totalTracked:R,overallAccuracy:Te,dueToday:V,stale:we}},[l]),ne=N.useMemo(()=>{const w=[];return $.dueToday>0&&w.push({icon:"",color:"#00D9A3",title:`${$.dueToday} question${$.dueToday!==1?"s":""} due today`,desc:"Spaced repetition reviews waiting",action:()=>s("/test?mode=due_today")}),$.wrongRemaining>0&&w.push({icon:"",color:"#FF6B6B",title:`${$.wrongRemaining} wrong question${$.wrongRemaining!==1?"s":""} to fix`,desc:"Focus on your mistakes",action:()=>s("/wrong-questions")}),$.stale>0&&w.push({icon:"",color:"#FFB347",title:`${$.stale} stale question${$.stale!==1?"s":""}`,desc:"Not reviewed in 30+ days",action:()=>s("/test?mode=unseen")}),w.length===0&&w.push({icon:"",color:"#6C63FF",title:"All caught up!",desc:"Start a practice session to keep learning",action:()=>s("/practice")}),w.slice(0,4)},[$]),ee=Math.min(100,Math.round(y.answered/Y*100)),se=i.reduce((w,C)=>w+(C.questionCount||0),0);return d.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:24},children:[d.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",flexWrap:"wrap",gap:16},children:[d.jsxs("div",{children:[d.jsxs("h2",{className:"np-page-greeting",children:[V6(),", ",M," "]}),d.jsx("p",{className:"np-page-greeting-sub",children:Z!==null&&Z>0?`${Z} day${Z!==1?"s":""} until ${t?.examName||"your exam"}. Keep going!`:"Ready to crush some questions today?"})]}),d.jsxs("div",{style:{display:"flex",alignItems:"center",gap:10,padding:"10px 20px",borderRadius:16,background:b>0?"rgba(255,179,71,0.08)":"rgba(255,255,255,0.03)",border:`1px solid ${b>0?"rgba(255,179,71,0.2)":"var(--border)"}`},children:[d.jsx("span",{style:{fontSize:"1.5rem"},children:b>0?"":""}),d.jsxs("div",{children:[d.jsx("div",{style:{fontFamily:"var(--font-heading)",fontWeight:800,fontSize:"1.3rem",color:b>0?"#FFB347":"var(--muted)"},children:b}),d.jsx("div",{style:{fontSize:"0.68rem",color:"var(--muted)"},children:"day streak"})]})]})]}),d.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 2fr",gap:16},children:[d.jsxs("div",{className:"np-card-surface",style:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",padding:"28px 20px"},children:[d.jsx("div",{style:{position:"relative",display:"inline-flex",alignItems:"center",justifyContent:"center"},children:d.jsx(b1,{progress:ee,size:130,strokeWidth:10,color:ee>=100?"#00D9A3":"#6C63FF",children:d.jsxs("div",{style:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",textAlign:"center"},children:[d.jsx("div",{style:{fontFamily:"var(--font-heading)",fontWeight:800,fontSize:"1.5rem",color:ee>=100?"#00D9A3":"#6C63FF"},children:y.answered}),d.jsxs("div",{style:{fontSize:"0.65rem",color:"var(--muted)"},children:["/ ",Y]})]})})}),d.jsxs("div",{style:{marginTop:12,textAlign:"center"},children:[d.jsx("div",{style:{fontSize:"0.82rem",fontWeight:600},children:"Daily Goal"}),d.jsx("div",{style:{fontSize:"0.7rem",color:"var(--muted)"},children:ee>=100?" Goal reached!":`${Y-y.answered} more to go`})]})]}),d.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(2, 1fr)",gap:12},children:[d.jsx(Xd,{icon:"",label:"Today's Accuracy",value:`${y.accuracy}%`,color:"#6C63FF",sub:`${y.correct}/${y.answered} correct`}),d.jsx(Xd,{icon:"",label:"Mastered",value:$.mastered.toString(),color:"#00D9A3",sub:`of ${se} questions`}),d.jsx(Xd,{icon:"",label:"Wrong Remaining",value:$.wrongRemaining.toString(),color:"#FF6B6B",sub:"need more practice"}),d.jsx(Xd,{icon:"",label:"Days Left",value:Z!==null&&Z>0?Z.toString():"",color:"#FFB347",sub:t?.examName||"No exam set"})]})]}),d.jsxs("div",{className:"np-card-surface",children:[d.jsx("h3",{style:{fontFamily:"var(--font-heading)",fontWeight:700,fontSize:"1.05rem",marginBottom:16},children:" Focus Recommendations"}),d.jsx("div",{style:{display:"flex",flexDirection:"column",gap:10},children:ne.map((w,C)=>d.jsxs("div",{onClick:w.action,className:"np-dash-focus-item",style:{display:"flex",alignItems:"center",gap:14,padding:"14px 16px",borderRadius:12,background:"rgba(255,255,255,0.02)",border:"1px solid var(--border)",cursor:"pointer",transition:"all 0.2s"},onMouseEnter:A=>{A.currentTarget.style.background=`${w.color}08`,A.currentTarget.style.borderColor=`${w.color}30`},onMouseLeave:A=>{A.currentTarget.style.background="rgba(255,255,255,0.02)",A.currentTarget.style.borderColor="var(--border)"},children:[d.jsx("span",{style:{fontSize:"1.3rem",width:42,height:42,borderRadius:10,display:"flex",alignItems:"center",justifyContent:"center",background:`${w.color}15`,flexShrink:0},children:w.icon}),d.jsxs("div",{style:{flex:1},children:[d.jsx("div",{style:{fontSize:"0.88rem",fontWeight:600},children:w.title}),d.jsx("div",{style:{fontSize:"0.72rem",color:"var(--muted)"},children:w.desc})]}),d.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"var(--muted)",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",style:{flexShrink:0},children:d.jsx("polyline",{points:"9 18 15 12 9 6"})})]},C))})]}),d.jsxs("div",{style:{display:"grid",gridTemplateColumns:"3fr 2fr",gap:16},children:[d.jsxs("div",{className:"np-card-surface",children:[d.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:16},children:[d.jsx("h3",{style:{fontFamily:"var(--font-heading)",fontWeight:700,fontSize:"1.05rem"},children:" Recent Sessions"}),d.jsx("button",{className:"np-btn np-btn-ghost np-btn-sm",onClick:()=>s("/analytics"),style:{fontSize:"0.75rem"},children:"View all "})]}),f.length===0?d.jsxs("div",{className:"np-empty",style:{padding:"40px 16px"},children:[d.jsx("div",{style:{fontSize:"2rem",marginBottom:10,opacity:.5},children:""}),d.jsx("p",{style:{color:"var(--muted)",fontSize:"0.82rem"},children:"No sessions yet. Start practicing!"})]}):d.jsx("div",{style:{display:"flex",flexDirection:"column",gap:8},children:f.map(w=>{const C=w.score>=70?"#00D9A3":w.score>=40?"#FFB347":"#FF6B6B",A=w.endTime?.toDate?w.endTime.toDate():w.endTime?new Date(w.endTime):null,R=A?L6(A):"";return d.jsxs("div",{onClick:()=>s(`/test/results?session=${w.id}`),style:{display:"flex",alignItems:"center",justifyContent:"space-between",padding:"12px 14px",borderRadius:10,background:"rgba(255,255,255,0.02)",border:"1px solid var(--border)",cursor:"pointer",transition:"all 0.2s"},onMouseEnter:j=>{j.currentTarget.style.background="rgba(255,255,255,0.04)",j.currentTarget.style.borderColor="var(--border-hover)"},onMouseLeave:j=>{j.currentTarget.style.background="rgba(255,255,255,0.02)",j.currentTarget.style.borderColor="var(--border)"},children:[d.jsxs("div",{style:{display:"flex",alignItems:"center",gap:10},children:[d.jsxs("div",{style:{width:38,height:38,borderRadius:10,display:"flex",alignItems:"center",justifyContent:"center",background:`${C}12`,fontSize:"0.82rem",fontWeight:800,color:C,fontFamily:"var(--font-heading)"},children:[w.score,"%"]}),d.jsxs("div",{children:[d.jsx("div",{style:{fontSize:"0.82rem",fontWeight:600},children:w.scope?.subjectNames?.join(", ")||"All Subjects"}),d.jsxs("div",{style:{fontSize:"0.68rem",color:"var(--muted)"},children:[w.answered,"/",w.totalQuestions," answered  ",P6(w.type)]})]})]}),d.jsx("div",{style:{fontSize:"0.68rem",color:"var(--muted)",flexShrink:0},children:R})]},w.id)})})]}),d.jsxs("div",{className:"np-card-surface",children:[d.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:16},children:[d.jsx("h3",{style:{fontFamily:"var(--font-heading)",fontWeight:700,fontSize:"1.05rem"},children:" Subjects"}),d.jsx("button",{className:"np-btn np-btn-ghost np-btn-sm",onClick:()=>s("/subjects"),style:{fontSize:"0.75rem"},children:"Manage "})]}),i.length===0?d.jsxs("div",{className:"np-empty",style:{padding:"40px 16px"},children:[d.jsx("div",{style:{fontSize:"2rem",marginBottom:10,opacity:.5},children:""}),d.jsx("p",{style:{color:"var(--muted)",fontSize:"0.82rem"},children:"No subjects yet."}),d.jsx("button",{className:"np-btn np-btn-primary np-btn-sm",onClick:()=>s("/subjects"),style:{marginTop:12},children:"Add Subject"})]}):d.jsx("div",{style:{display:"flex",flexDirection:"column",gap:8},children:i.map(w=>{const C=w.questionCount?Math.round((w.masteredCount||0)/w.questionCount*100):0;return d.jsxs("div",{onClick:()=>s(`/subjects/${w.id}`),style:{display:"flex",alignItems:"center",gap:12,padding:"12px 14px",borderRadius:10,background:"rgba(255,255,255,0.02)",border:"1px solid var(--border)",cursor:"pointer",transition:"all 0.2s"},onMouseEnter:A=>{A.currentTarget.style.borderColor=w.color||"var(--border-hover)"},onMouseLeave:A=>{A.currentTarget.style.borderColor="var(--border)"},children:[d.jsx("span",{style:{fontSize:"1.2rem",width:38,height:38,borderRadius:10,display:"flex",alignItems:"center",justifyContent:"center",background:`${w.color||"#6C63FF"}15`},children:w.icon||""}),d.jsxs("div",{style:{flex:1,minWidth:0},children:[d.jsx("div",{style:{fontSize:"0.85rem",fontWeight:600,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:w.name}),d.jsxs("div",{style:{fontSize:"0.68rem",color:"var(--muted)"},children:[w.questionCount||0," Q  ",C,"% mastered"]})]}),d.jsx("div",{style:{width:50,height:4,borderRadius:999,background:"rgba(255,255,255,0.06)",overflow:"hidden",flexShrink:0},children:d.jsx("div",{style:{height:"100%",borderRadius:999,width:`${C}%`,background:w.color||"#6C63FF",transition:"width 0.3s ease"}})})]},w.id)})})]})]}),d.jsxs("div",{style:{textAlign:"center",padding:"24px 28px",borderRadius:16,background:"linear-gradient(135deg, rgba(108,99,255,0.06), rgba(0,217,163,0.04))",border:"1px solid rgba(108,99,255,0.12)"},children:[d.jsxs("p",{style:{fontStyle:"italic",color:"var(--text-secondary)",fontSize:"0.95rem",lineHeight:1.6},children:['"',D.text,'"']}),d.jsxs("p",{style:{color:"var(--muted)",fontSize:"0.75rem",marginTop:8},children:[" ",D.author]})]})]})}function Xd({icon:s,label:e,value:t,color:i,sub:a}){return d.jsxs("div",{className:"np-card-surface",style:{padding:"18px 16px",display:"flex",alignItems:"center",gap:14},children:[d.jsx("div",{style:{width:44,height:44,borderRadius:12,display:"flex",alignItems:"center",justifyContent:"center",background:`${i}12`,fontSize:"1.3rem",flexShrink:0},children:s}),d.jsxs("div",{children:[d.jsx("div",{style:{fontFamily:"var(--font-heading)",fontWeight:800,fontSize:"1.3rem",color:i,lineHeight:1},children:t}),d.jsx("div",{style:{fontSize:"0.72rem",color:"var(--muted)",marginTop:2},children:e}),a&&d.jsx("div",{style:{fontSize:"0.65rem",color:"var(--muted)",opacity:.7},children:a})]})]})}function P6(s){return{smart:"Smart",wrong:"Wrong Qs",due_today:"Due Today",unseen:"Unseen",flagged:"Flagged",random:"Quick Mix"}[s]||s}function L6(s){const t=new Date-s,i=Math.floor(t/6e4),a=Math.floor(t/36e5),l=Math.floor(t/864e5);return i<1?"just now":i<60?`${i}m ago`:a<24?`${a}h ago`:l===1?"yesterday":l<7?`${l}d ago`:s.toLocaleDateString("en-US",{month:"short",day:"numeric"})}function qs(s){const e=[...s];for(let t=e.length-1;t>0;t--){const i=Math.floor(Math.random()*(t+1));[e[t],e[i]]=[e[i],e[t]]}return e}function U6(s,e,t){const i=s.filter(v=>v.important===!0),a=s.filter(v=>!v.important),l=Math.min(Math.ceil(t*.7),i.length),c=Math.min(t-l,a.length),f=qs(i).slice(0,l);let p=qs(a).slice(0,c);const y=t-f.length-p.length;if(y>0){const v=qs(a.filter(b=>!p.includes(b))).slice(0,y);p=[...p,...v]}return H6(f,p)}function XA(s,e){return s.filter(i=>{const a=e[i.id];return a&&a.timesWrong>0&&(a.masteryLevel||0)<4}).sort((i,a)=>{const l=e[i.id]||{},c=e[a.id]||{},f=(l.timesWrong||0)*3-(l.timesCorrect||0)*1;return(c.timesWrong||0)*3-(c.timesCorrect||0)*1-f})}function JA(s,e){const t=new Date;t.setHours(23,59,59,999);const i=t.getTime();return s.filter(l=>{const c=e[l.id];return!c||!c.nextDue?!1:new Date(c.nextDue).getTime()<=i}).sort((l,c)=>{const f=new Date(e[l.id].nextDue).getTime(),p=new Date(e[c.id].nextDue).getTime();return f-p})}function z6(s,e){const t=s.filter(a=>{const l=e[a.id];return!l||(l.timesAsked||0)===0}),i=s.filter(a=>{const l=e[a.id];return l&&(l.timesAsked||0)>0});return i.sort((a,l)=>(e[a.id]?.timesAsked||0)-(e[l.id]?.timesAsked||0)),[...qs(t),...i]}function ZA(s,e){return s.filter(t=>{const i=e[t.id];return i&&i.flagged===!0})}function B6(s,e){return qs(s).slice(0,e)}function F6(s,e,t=30){const i=Date.now(),a=t*24*60*60*1e3;return s.filter(c=>{const f=e[c.id];if(!f||!f.lastAsked)return!1;const p=new Date(f.lastAsked).getTime();return i-p>=a}).sort((c,f)=>{const p=new Date(e[c.id].lastAsked).getTime(),y=new Date(e[f.id].lastAsked).getTime();return p-y})}function q6(s){const e=qs(s),t=e.map(i=>i.label);return{options:e,optionOrder:t}}function H6(s,e){const t=[],i=s.length+e.length;let a=0,l=0;for(let c=0;c<i;c++){const f=s.length/i;a<s.length&&(l>=e.length||Math.random()<f)?t.push(s[a++]):l<e.length?t.push(e[l++]):t.push(s[a++])}return t}async function ph(s,e,t){const{subjects:i,fetchChapters:a,fetchQuestions:l,chapters:c,questions:f}=t,p=e.subjectIds[0]==="all"?i:i.filter(v=>e.subjectIds.includes(v.id)),y=[];for(const v of p){c[v.id]||await a(s,v.id);const b=t.chapters[v.id]||[],x=!e.chapterIds||e.chapterIds[0]==="all"?b:b.filter(k=>e.chapterIds.includes(k.id));for(const k of x){f[k.id]||await l(s,v.id,k.id);const O=t.questions[k.id]||[];for(const D of O)y.push({...D,subjectId:v.id,subjectName:v.name,subjectColor:v.color,chapterId:k.id,chapterName:k.name})}}return y}const G6=[{key:"smart",title:"Smart Session",icon:"",color:"#8B5CF6",desc:"70% important, 30% normal  optimized mix"},{key:"wrong",title:"Wrong Questions",icon:"",color:"#FF6B6B",desc:"Focus on your past mistakes"},{key:"due_today",title:"Due Today",icon:"",color:"#00D9A3",desc:"Spaced repetition reviews"},{key:"unseen",title:"Unseen First",icon:"",color:"#FFB347",desc:"Tackle new questions first"},{key:"flagged",title:"Flagged Only",icon:"",color:"#FF006E",desc:"Your bookmarked questions"},{key:"random",title:"Quick Mix",icon:"",color:"#6C63FF",desc:"Pure random selection"}];function Q6(){const s=ln(),{user:e}=pn(),t=Zs(),{subjects:i,fetchSubjects:a,performanceMap:l,fetchPerformance:c}=t,[f,p]=N.useState(null),[y,v]=N.useState([]),[b,x]=N.useState([]);N.useEffect(()=>{e?.uid&&(i.length===0&&a(e.uid),c(e.uid),l_(e.uid,1).then(O=>{O.length>0&&p(O[0])}),O6(e.uid).then(v))},[e?.uid]),N.useEffect(()=>{!e?.uid||i.length===0||(async()=>{const O=await ph(e.uid,{subjectIds:["all"]},t);x(O)})()},[e?.uid,i,t.chapters,t.questions]);const k=N.useMemo(()=>b.length===0||!l?{}:{wrong:XA(b,l).length,due_today:JA(b,l).length,flagged:ZA(b,l).length,stale:F6(b,l).length},[b,l]);return d.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:28},children:[d.jsxs("div",{children:[d.jsx("h2",{className:"np-section-title",children:"Practice Hub"}),d.jsx("p",{className:"np-section-subtitle",children:"Choose your practice mode and start learning"})]}),i.length>0&&d.jsx("div",{style:{display:"flex",gap:8,overflowX:"auto",paddingBottom:4},children:i.map(O=>d.jsxs("button",{className:"np-pill",style:{borderColor:O.color,color:O.color,flexShrink:0},onClick:()=>s(`/test?subject=${O.id}`),children:[O.icon," ",O.name]},O.id))}),k.stale>0&&d.jsxs("div",{style:{display:"flex",alignItems:"center",gap:12,padding:"14px 20px",borderRadius:12,background:"rgba(255,179,71,0.08)",border:"1px solid rgba(255,179,71,0.2)",fontSize:"0.85rem"},children:[d.jsx("span",{style:{fontSize:"1.3rem"},children:""}),d.jsxs("div",{children:[d.jsxs("span",{style:{fontWeight:600,color:"#FFB347"},children:[k.stale," stale question",k.stale!==1?"s":""]}),d.jsx("span",{style:{color:"var(--muted)"},children:"  not reviewed in 30+ days. Consider revisiting!"})]})]}),d.jsx("div",{className:"np-stagger",style:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(280px, 1fr))",gap:16},children:G6.map(O=>{const D=k[O.key];return d.jsxs("div",{className:"np-mode-card",style:{"--accent-color":O.color,cursor:"pointer"},onClick:()=>s(`/test?mode=${O.key}`),children:[d.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[d.jsx("div",{className:"np-mode-icon",style:{background:`${O.color}18`},children:O.icon}),D>0&&d.jsx("span",{style:{padding:"3px 10px",borderRadius:20,background:`${O.color}15`,color:O.color,fontSize:"0.72rem",fontWeight:700},children:D})]}),d.jsx("div",{className:"np-mode-title",children:O.title}),d.jsx("div",{className:"np-mode-desc",children:O.desc}),d.jsxs("div",{style:{display:"flex",alignItems:"center",gap:6,marginTop:16,color:O.color,fontSize:"0.8rem",fontWeight:600},children:[d.jsx("span",{children:"Start session"}),d.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:d.jsx("polyline",{points:"9 18 15 12 9 6"})})]})]},O.key)})}),d.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",padding:"20px 28px",borderRadius:16,background:"linear-gradient(135deg, rgba(255,107,53,0.12), rgba(255,0,110,0.08))",border:"1px solid rgba(255,107,53,0.2)"},children:[d.jsxs("div",{style:{display:"flex",alignItems:"center",gap:16},children:[d.jsx("span",{style:{fontSize:"2rem"},children:""}),d.jsxs("div",{children:[d.jsx("div",{style:{fontFamily:"var(--font-heading)",fontWeight:700,fontSize:"1.05rem"},children:"Rapid Fire Mode"}),d.jsx("div",{style:{fontSize:"0.8rem",color:"var(--muted)",marginTop:2},children:"Speed drill with streak multipliers  test your reflexes"})]})]}),d.jsx("button",{className:"np-btn np-btn-outline np-btn-sm",onClick:()=>s("/rapid-fire"),style:{borderColor:"rgba(255,107,53,0.3)",color:"#FF6B35",flexShrink:0},children:"Try it "})]}),f&&d.jsx("div",{className:"np-card-surface",style:{padding:"20px 24px"},children:d.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[d.jsxs("div",{children:[d.jsx("h3",{style:{fontFamily:"var(--font-heading)",fontWeight:700,fontSize:"0.95rem",marginBottom:6},children:" Last Session"}),d.jsxs("div",{style:{display:"flex",gap:16,fontSize:"0.82rem",color:"var(--text-secondary)"},children:[d.jsx("span",{children:f.scope?.subjectNames?.join(", ")||"All Subjects"}),d.jsxs("span",{children:["Score: ",d.jsxs("strong",{style:{color:f.score>=70?"#00D9A3":f.score>=40?"#FFB347":"#FF6B6B"},children:[f.score,"%"]})]}),d.jsxs("span",{children:[f.answered,"/",f.totalQuestions," answered"]})]})]}),d.jsx("button",{className:"np-btn np-btn-outline np-btn-sm",onClick:()=>s(`/test?mode=${f.type}`),children:"Retry "})]})}),d.jsxs("div",{children:[d.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:16},children:[d.jsx("h3",{style:{fontFamily:"var(--font-heading)",fontWeight:700,fontSize:"1.1rem"},children:" Saved Templates"}),d.jsxs("span",{style:{fontSize:"0.75rem",color:"var(--muted)"},children:[y.length," / 5"]})]}),y.length===0?d.jsx("div",{className:"np-card-surface",children:d.jsxs("div",{className:"np-empty",style:{padding:"36px 16px"},children:[d.jsx("div",{style:{fontSize:"2.5rem",marginBottom:12,opacity:.6},children:""}),d.jsxs("p",{style:{color:"var(--muted)",fontSize:"0.85rem",lineHeight:1.5},children:["No saved templates yet.",d.jsx("br",{}),"Configure a session and save it for quick access."]})]})}):d.jsx("div",{style:{display:"flex",flexDirection:"column",gap:10},children:y.map(O=>d.jsx("div",{className:"np-card-surface",style:{padding:"14px 20px",cursor:"pointer"},onClick:()=>s(`/test?mode=${O.type}`),children:d.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[d.jsxs("div",{children:[d.jsx("div",{style:{fontWeight:600,fontSize:"0.9rem"},children:O.name||O.type}),d.jsxs("div",{style:{fontSize:"0.75rem",color:"var(--muted)"},children:[O.totalQuestions," Q  ",O.type]})]}),d.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"var(--muted)",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:d.jsx("polyline",{points:"9 18 15 12 9 6"})})]})},O.id))})]})]})}const Jd=["#6C63FF","#00D9A3","#FF6B6B","#FFB347","#00D4FF","#FF006E","#8B5CF6","#FF6B35","#7CFC00","#FFD700"],Zd=["","","","","","","","","","","",""];function K6(){const s=ln(),{user:e}=pn(),{subjects:t,subjectsLoading:i,fetchSubjects:a,addSubject:l,updateSubject:c,deleteSubject:f}=Zs(),[p,y]=N.useState(!1),[v,b]=N.useState(null),[x,k]=N.useState(""),[O,D]=N.useState(Jd[0]),[M,Y]=N.useState(Zd[0]),[Z,$]=N.useState(!1),[ne,ee]=N.useState(null);N.useEffect(()=>{e?.uid&&a(e.uid)},[e?.uid,a]);const se=()=>{b(null),k(""),D(Jd[0]),Y(Zd[0]),y(!0)},w=R=>{b(R),k(R.name),D(R.color||Jd[0]),Y(R.icon||Zd[0]),y(!0)},C=async()=>{if(!(!x.trim()||!e?.uid)){$(!0);try{v?await c(e.uid,v.id,{name:x.trim(),color:O,icon:M}):await l(e.uid,{name:x.trim(),color:O,icon:M}),y(!1)}catch(R){console.error("Failed to save subject:",R)}finally{$(!1)}}},A=async R=>{if(e?.uid)try{await f(e.uid,R),ee(null)}catch(j){console.error("Failed to delete subject:",j)}};return d.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:24},children:[d.jsxs("div",{className:"np-section-header",children:[d.jsxs("div",{children:[d.jsx("h2",{className:"np-section-title",children:"Subjects"}),d.jsx("p",{className:"np-section-subtitle",children:"Manage your study content"})]}),d.jsxs("button",{className:"np-btn np-btn-primary np-btn-md",onClick:se,children:[d.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:[d.jsx("line",{x1:"12",y1:"5",x2:"12",y2:"19"}),d.jsx("line",{x1:"5",y1:"12",x2:"19",y2:"12"})]}),"Add Subject"]})]}),i?d.jsxs("div",{className:"np-card-surface",style:{padding:60,textAlign:"center"},children:[d.jsx("div",{className:"np-auth-spinner",style:{width:32,height:32,borderWidth:3,margin:"0 auto"}}),d.jsx("p",{style:{color:"var(--muted)",marginTop:16,fontSize:"0.9rem"},children:"Loading subjects..."})]}):t.length===0?d.jsx("div",{className:"np-card-surface",children:d.jsxs("div",{className:"np-empty",children:[d.jsx("div",{className:"np-empty-icon",children:""}),d.jsx("div",{className:"np-empty-title",children:"No subjects yet"}),d.jsx("div",{className:"np-empty-desc",children:"Create your first subject to start organizing your questions. You can add chapters and questions within each subject."}),d.jsx("button",{className:"np-btn np-btn-primary np-btn-md",onClick:se,children:"Create First Subject"})]})}):d.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(300px, 1fr))",gap:16},children:t.map(R=>d.jsxs("div",{className:"np-subject-card",style:{"--subject-color":R.color||"#6C63FF",cursor:"pointer"},onClick:()=>s(`/subjects/${R.id}`),children:[d.jsxs("div",{style:{display:"flex",alignItems:"flex-start",justifyContent:"space-between"},children:[d.jsxs("div",{style:{display:"flex",alignItems:"center",gap:14},children:[d.jsx("div",{className:"np-subject-icon",style:{background:`${R.color||"#6C63FF"}18`},children:R.icon||""}),d.jsxs("div",{children:[d.jsx("div",{style:{fontFamily:"var(--font-heading)",fontWeight:700,fontSize:"1.05rem"},children:R.name}),d.jsxs("div",{style:{fontSize:"0.8rem",color:"var(--muted)",marginTop:2},children:[R.questionCount||0," questions  ",R.masteredCount||0," mastered"]})]})]}),d.jsxs("div",{style:{display:"flex",gap:4},onClick:j=>j.stopPropagation(),children:[d.jsx("button",{className:"np-icon-btn",title:"Edit",onClick:()=>w(R),children:d.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[d.jsx("path",{d:"M11 4H4a2 2 0 00-2 2v14a2 2 0 002 2h14a2 2 0 002-2v-7"}),d.jsx("path",{d:"M18.5 2.5a2.121 2.121 0 013 3L12 15l-4 1 1-4 9.5-9.5z"})]})}),d.jsx("button",{className:"np-icon-btn np-icon-btn-danger",title:"Delete",onClick:()=>ee(R.id),children:d.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[d.jsx("polyline",{points:"3 6 5 6 21 6"}),d.jsx("path",{d:"M19 6v14a2 2 0 01-2 2H7a2 2 0 01-2-2V6m3 0V4a2 2 0 012-2h4a2 2 0 012 2v2"})]})})]})]}),d.jsx("div",{style:{marginTop:16},children:d.jsx("div",{style:{height:4,borderRadius:999,background:"rgba(255,255,255,0.06)",overflow:"hidden"},children:d.jsx("div",{style:{height:"100%",borderRadius:999,background:R.color||"#6C63FF",width:R.questionCount?`${Math.round((R.masteredCount||0)/R.questionCount*100)}%`:"0%",transition:"width 0.4s ease"}})})}),ne===R.id&&d.jsxs("div",{className:"np-delete-confirm",children:[d.jsx("span",{style:{fontSize:"0.8rem",color:"var(--error)"},children:"Delete this subject?"}),d.jsxs("div",{style:{display:"flex",gap:8},children:[d.jsx("button",{className:"np-btn np-btn-danger np-btn-sm",onClick:()=>A(R.id),children:"Delete"}),d.jsx("button",{className:"np-btn np-btn-outline np-btn-sm",onClick:()=>ee(null),children:"Cancel"})]})]})]},R.id))}),d.jsx(sf,{isOpen:p,onClose:()=>y(!1),title:v?"Edit Subject":"New Subject",children:d.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:20},children:[d.jsxs("div",{children:[d.jsx("label",{style:{display:"block",fontSize:"0.8rem",color:"var(--muted)",marginBottom:8,fontWeight:500},children:"Subject Name"}),d.jsx("input",{type:"text",placeholder:"e.g. Physics, Mathematics...",value:x,onChange:R=>k(R.target.value),autoFocus:!0})]}),d.jsxs("div",{children:[d.jsx("label",{style:{display:"block",fontSize:"0.8rem",color:"var(--muted)",marginBottom:8,fontWeight:500},children:"Icon"}),d.jsx("div",{style:{display:"flex",flexWrap:"wrap",gap:8},children:Zd.map(R=>d.jsx("button",{onClick:()=>Y(R),style:{width:42,height:42,borderRadius:10,fontSize:"1.3rem",display:"flex",alignItems:"center",justifyContent:"center",background:M===R?"rgba(108,99,255,0.2)":"rgba(255,255,255,0.04)",border:M===R?"2px solid var(--primary)":"1px solid var(--border)",cursor:"pointer",transition:"all 0.15s"},children:R},R))})]}),d.jsxs("div",{children:[d.jsx("label",{style:{display:"block",fontSize:"0.8rem",color:"var(--muted)",marginBottom:8,fontWeight:500},children:"Color"}),d.jsx("div",{style:{display:"flex",flexWrap:"wrap",gap:10},children:Jd.map(R=>d.jsx("button",{onClick:()=>D(R),className:`np-color-swatch ${O===R?"active":""}`,style:{background:R}},R))})]}),d.jsxs("div",{style:{display:"flex",gap:12,justifyContent:"flex-end",marginTop:8},children:[d.jsx("button",{className:"np-btn np-btn-outline np-btn-md",onClick:()=>y(!1),children:"Cancel"}),d.jsx("button",{className:"np-btn np-btn-primary np-btn-md",onClick:C,disabled:Z||!x.trim(),children:Z?"Saving...":v?"Save Changes":"Create Subject"})]})]})})]})}function Zg(s){const e=s.split(/\r?\n/).map(p=>p.trim()).filter(p=>p.length>0);if(e.length<2)return{valid:[],errors:["File must have a header row and at least one data row."]};const t=e[0].includes("	")?"	":",",i=Jx(e[0],t).map(p=>p.trim().toLowerCase()),a={question:Lr(i,["question","text","q"]),optionA:Lr(i,["optiona","option_a","a","opt_a","option a"]),optionB:Lr(i,["optionb","option_b","b","opt_b","option b"]),optionC:Lr(i,["optionc","option_c","c","opt_c","option c"]),optionD:Lr(i,["optiond","option_d","d","opt_d","option d"]),correct:Lr(i,["correctoption","correct_option","correct","answer","correctanswer","correct_answer"]),explanation:Lr(i,["explanation","explain","solution"]),important:Lr(i,["important","imp","priority"])},l=[];if(a.question===-1&&l.push("question"),a.optionA===-1&&l.push("optionA"),a.optionB===-1&&l.push("optionB"),a.optionC===-1&&l.push("optionC"),a.optionD===-1&&l.push("optionD"),a.correct===-1&&l.push("correctOption"),l.length>0)return{valid:[],errors:[`Missing required columns: ${l.join(", ")}. Expected: question, optionA, optionB, optionC, optionD, correctOption`]};const c=[],f=[];for(let p=1;p<e.length;p++){const y=Jx(e[p],t),v=p+1,b=(y[a.question]||"").trim(),x=(y[a.optionA]||"").trim(),k=(y[a.optionB]||"").trim(),O=(y[a.optionC]||"").trim(),D=(y[a.optionD]||"").trim(),M=(y[a.correct]||"").trim().toUpperCase(),Y=a.explanation!==-1?(y[a.explanation]||"").trim():"",Z=a.important!==-1?(y[a.important]||"false").trim().toLowerCase():"false",$=["true","1","yes","y"].includes(Z);if(!b){f.push(`Row ${v}: Missing question text`);continue}if(!x||!k||!O||!D){f.push(`Row ${v}: Missing one or more options`);continue}if(!["A","B","C","D"].includes(M)){f.push(`Row ${v}: correctOption must be A, B, C, or D (got "${M}")`);continue}c.push({text:b,options:[{label:"A",text:x},{label:"B",text:k},{label:"C",text:O},{label:"D",text:D}],correctOption:M,explanation:Y,important:$})}return{valid:c,errors:f}}function Jx(s,e=","){const t=[];let i="",a=!1;for(let l=0;l<s.length;l++){const c=s[l];c==='"'?a&&s[l+1]==='"'?(i+='"',l++):a=!a:c===e&&!a?(t.push(i),i=""):i+=c}return t.push(i),t}function Lr(s,e){for(const t of e){const i=s.indexOf(t);if(i!==-1)return i}return-1}function $6(){return`question,optionA,optionB,optionC,optionD,correctOption,explanation,important
"What is the capital of France?","Berlin","Madrid","Paris","Rome","C","Paris is the capital of France","true"
"What is 2 + 2?","3","4","5","6","B","Basic arithmetic","false"`}function W6(){const{subjectId:s}=wC(),e=ln(),{user:t}=pn(),{subjects:i,fetchSubjects:a,chapters:l,chaptersLoading:c,fetchChapters:f,addChapter:p,deleteChapter:y,questions:v,questionsLoading:b,fetchQuestions:x,addQuestions:k,deleteQuestion:O}=Zs(),[D,M]=N.useState(null),[Y,Z]=N.useState(!1),[$,ne]=N.useState(""),[ee,se]=N.useState(!1),[w,C]=N.useState(null),[A,R]=N.useState(null),[j,L]=N.useState(!1),[V,we]=N.useState(null),[Te,G]=N.useState(""),[oe,pe]=N.useState(""),[xe,Me]=N.useState(""),[U,z]=N.useState(""),[ue,re]=N.useState(""),[ge,Ie]=N.useState("A"),[Ne,Qe]=N.useState(""),[$e,Ni]=N.useState(!1),[ps,gs]=N.useState(!1),[er,gn]=N.useState(!1),[tr,ys]=N.useState(null),[ji,ki]=N.useState(""),[He,mt]=N.useState(null),[fi,mo]=N.useState(!1),ua=N.useRef(null),vt=i.find(de=>de.id===s),Wn=l[s]||[];N.useEffect(()=>{t?.uid&&s&&(i.length===0&&a(t.uid),f(t.uid,s))},[t?.uid,s]);const ha=de=>{if(D===de){M(null);return}M(de),t?.uid&&!v[de]&&x(t.uid,s,de)},da=async()=>{if(!(!$.trim()||!t?.uid)){se(!0);try{await p(t.uid,s,{name:$.trim()}),Z(!1),ne("")}catch(de){console.error("Failed to add chapter:",de)}finally{se(!1)}}},Oi=async de=>{if(t?.uid)try{await y(t.uid,s,de),C(null),D===de&&M(null)}catch(Zt){console.error("Failed to delete chapter:",Zt)}},po=de=>{we(de),G(""),pe(""),Me(""),z(""),re(""),Ie("A"),Qe(""),Ni(!1),L(!0)},go=async()=>{if(!(!Te.trim()||!oe.trim()||!xe.trim()||!U.trim()||!ue.trim())&&!(!t?.uid||!V)){gs(!0);try{await k(t.uid,s,V,[{text:Te.trim(),options:[{label:"A",text:oe.trim()},{label:"B",text:xe.trim()},{label:"C",text:U.trim()},{label:"D",text:ue.trim()}],correctOption:ge,explanation:Ne.trim(),important:$e}]),L(!1)}catch(de){console.error("Failed to add question:",de)}finally{gs(!1)}}},fa=de=>{ys(de),ki(""),mt(null),gn(!0)},yo=de=>{const Zt=de.target.files?.[0];if(!Zt)return;const Nn=new FileReader;Nn.onload=nr=>{const dt=nr.target?.result;ki(dt),mt(Zg(dt))},Nn.readAsText(Zt),de.target.value=""},Dn=()=>{ji.trim()&&mt(Zg(ji))},Ht=async()=>{if(!(!He?.valid?.length||!t?.uid||!tr)){mo(!0);try{await k(t.uid,s,tr,He.valid),gn(!1)}catch(de){console.error("Failed to import CSV:",de)}finally{mo(!1)}}},bn=()=>{const de=$6();ki(de),mt(Zg(de))};return!vt&&!c?d.jsx("div",{style:{display:"flex",flexDirection:"column",gap:24},children:d.jsx("div",{className:"np-card-surface",children:d.jsxs("div",{className:"np-empty",children:[d.jsx("div",{className:"np-empty-icon",children:""}),d.jsx("div",{className:"np-empty-title",children:"Subject not found"}),d.jsx("div",{className:"np-empty-desc",children:"This subject may have been deleted."}),d.jsx("button",{className:"np-btn np-btn-primary np-btn-md",onClick:()=>e("/subjects"),children:"Back to Subjects"})]})})}):d.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:24},children:[d.jsxs("div",{style:{display:"flex",alignItems:"center",gap:16},children:[d.jsx("button",{className:"np-icon-btn",onClick:()=>e("/subjects"),title:"Back",children:d.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:d.jsx("polyline",{points:"15 18 9 12 15 6"})})}),vt&&d.jsxs("div",{style:{display:"flex",alignItems:"center",gap:14,flex:1},children:[d.jsx("div",{className:"np-subject-icon",style:{background:`${vt.color||"#6C63FF"}18`},children:vt.icon||""}),d.jsxs("div",{children:[d.jsx("h2",{style:{fontFamily:"var(--font-heading)",fontWeight:800,fontSize:"1.5rem"},children:vt.name}),d.jsxs("p",{style:{fontSize:"0.85rem",color:"var(--muted)"},children:[Wn.length," chapter",Wn.length!==1?"s":"","  ",vt.questionCount||0," questions"]})]})]}),d.jsxs("button",{className:"np-btn np-btn-primary np-btn-md",onClick:()=>{ne(""),Z(!0)},children:[d.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:[d.jsx("line",{x1:"12",y1:"5",x2:"12",y2:"19"}),d.jsx("line",{x1:"5",y1:"12",x2:"19",y2:"12"})]}),"Add Chapter"]})]}),c?d.jsxs("div",{className:"np-card-surface",style:{padding:60,textAlign:"center"},children:[d.jsx("div",{className:"np-auth-spinner",style:{width:32,height:32,borderWidth:3,margin:"0 auto"}}),d.jsx("p",{style:{color:"var(--muted)",marginTop:16,fontSize:"0.9rem"},children:"Loading chapters..."})]}):Wn.length===0?d.jsx("div",{className:"np-card-surface",children:d.jsxs("div",{className:"np-empty",children:[d.jsx("div",{className:"np-empty-icon",children:""}),d.jsx("div",{className:"np-empty-title",children:"No chapters yet"}),d.jsx("div",{className:"np-empty-desc",children:"Create chapters to organize questions within this subject."}),d.jsx("button",{className:"np-btn np-btn-primary np-btn-md",onClick:()=>{ne(""),Z(!0)},children:"Create First Chapter"})]})}):d.jsx("div",{style:{display:"flex",flexDirection:"column",gap:12},children:Wn.map(de=>{const Zt=D===de.id,Nn=v[de.id]||[],nr=b&&Zt&&!v[de.id];return d.jsxs("div",{className:"np-chapter-card",children:[d.jsxs("div",{className:"np-chapter-header",onClick:()=>ha(de.id),children:[d.jsxs("div",{style:{display:"flex",alignItems:"center",gap:12,flex:1},children:[d.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"var(--muted)",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",style:{transition:"transform 0.2s",transform:Zt?"rotate(90deg)":"none",flexShrink:0},children:d.jsx("polyline",{points:"9 18 15 12 9 6"})}),d.jsx("span",{style:{fontWeight:600,fontSize:"0.95rem"},children:de.name}),d.jsxs("span",{className:"np-badge",style:{background:`${vt?.color||"#6C63FF"}18`,color:vt?.color||"#6C63FF"},children:[de.questionCount||Nn.length||0," Q"]})]}),d.jsxs("div",{style:{display:"flex",gap:4},onClick:dt=>dt.stopPropagation(),children:[d.jsx("button",{className:"np-icon-btn",title:"Add Question",onClick:()=>po(de.id),children:d.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[d.jsx("line",{x1:"12",y1:"5",x2:"12",y2:"19"}),d.jsx("line",{x1:"5",y1:"12",x2:"19",y2:"12"})]})}),d.jsx("button",{className:"np-icon-btn",title:"Import CSV",onClick:()=>fa(de.id),children:d.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[d.jsx("path",{d:"M21 15v4a2 2 0 01-2 2H5a2 2 0 01-2-2v-4"}),d.jsx("polyline",{points:"17 8 12 3 7 8"}),d.jsx("line",{x1:"12",y1:"3",x2:"12",y2:"15"})]})}),d.jsx("button",{className:"np-icon-btn np-icon-btn-danger",title:"Delete Chapter",onClick:()=>C(de.id),children:d.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[d.jsx("polyline",{points:"3 6 5 6 21 6"}),d.jsx("path",{d:"M19 6v14a2 2 0 01-2 2H7a2 2 0 01-2-2V6m3 0V4a2 2 0 012-2h4a2 2 0 012 2v2"})]})})]})]}),w===de.id&&d.jsxs("div",{className:"np-delete-confirm",style:{margin:"0 16px 12px"},children:[d.jsx("span",{style:{fontSize:"0.8rem",color:"var(--error)"},children:"Delete this chapter and all its questions?"}),d.jsxs("div",{style:{display:"flex",gap:8},children:[d.jsx("button",{className:"np-btn np-btn-danger np-btn-sm",onClick:()=>Oi(de.id),children:"Delete"}),d.jsx("button",{className:"np-btn np-btn-outline np-btn-sm",onClick:()=>C(null),children:"Cancel"})]})]}),Zt&&d.jsx("div",{className:"np-chapter-questions",children:nr?d.jsx("div",{style:{padding:24,textAlign:"center"},children:d.jsx("div",{className:"np-auth-spinner",style:{width:24,height:24,borderWidth:2,margin:"0 auto"}})}):Nn.length===0?d.jsxs("div",{style:{padding:"24px 16px",textAlign:"center",color:"var(--muted)",fontSize:"0.85rem"},children:["No questions in this chapter yet.",d.jsxs("div",{style:{display:"flex",gap:8,justifyContent:"center",marginTop:12},children:[d.jsx("button",{className:"np-btn np-btn-outline np-btn-sm",onClick:()=>po(de.id),children:"Add Manually"}),d.jsx("button",{className:"np-btn np-btn-outline np-btn-sm",onClick:()=>fa(de.id),children:" Import CSV"})]})]}):d.jsx("div",{style:{display:"flex",flexDirection:"column",gap:8,padding:"8px 0"},children:Nn.map((dt,vs)=>d.jsx("div",{className:"np-question-item",children:d.jsxs("div",{style:{display:"flex",gap:10,alignItems:"flex-start"},children:[d.jsx("span",{className:"np-q-num",children:vs+1}),d.jsxs("div",{style:{flex:1},children:[d.jsx("p",{style:{fontSize:"0.9rem",fontWeight:500,marginBottom:8,lineHeight:1.5},children:dt.text}),d.jsx("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:6},children:dt.options?.map(pt=>d.jsxs("div",{className:`np-q-option ${pt.label===dt.correctOption?"np-q-option-correct":""}`,children:[d.jsx("span",{className:"np-q-option-label",children:pt.label}),d.jsx("span",{children:pt.text})]},pt.label))}),dt.explanation&&d.jsxs("p",{style:{fontSize:"0.78rem",color:"var(--muted)",marginTop:8,fontStyle:"italic"},children:[" ",dt.explanation]}),A===dt.id&&d.jsxs("div",{className:"np-delete-confirm",style:{marginTop:8,paddingTop:8},children:[d.jsx("span",{style:{fontSize:"0.78rem",color:"var(--error)"},children:"Delete this question?"}),d.jsxs("div",{style:{display:"flex",gap:8},children:[d.jsx("button",{className:"np-btn np-btn-danger np-btn-sm",onClick:()=>{O(t.uid,s,de.id,dt.id),R(null)},children:"Delete"}),d.jsx("button",{className:"np-btn np-btn-outline np-btn-sm",onClick:()=>R(null),children:"Cancel"})]})]})]}),d.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",gap:4,flexShrink:0},children:[dt.important&&d.jsx("span",{className:"np-badge",style:{background:"rgba(255,179,71,0.12)",color:"#FFB347",fontSize:"0.7rem"},children:" Important"}),d.jsx("button",{className:"np-icon-btn np-icon-btn-danger",title:"Delete Question",onClick:()=>R(dt.id),children:d.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[d.jsx("polyline",{points:"3 6 5 6 21 6"}),d.jsx("path",{d:"M19 6v14a2 2 0 01-2 2H7a2 2 0 01-2-2V6m3 0V4a2 2 0 012-2h4a2 2 0 012 2v2"})]})})]})]})},dt.id))})})]},de.id)})}),d.jsx(sf,{isOpen:Y,onClose:()=>Z(!1),title:"New Chapter",children:d.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:16},children:[d.jsxs("div",{children:[d.jsx("label",{style:{display:"block",fontSize:"0.8rem",color:"var(--muted)",marginBottom:8,fontWeight:500},children:"Chapter Name"}),d.jsx("input",{type:"text",placeholder:"e.g. Newton's Laws, Trigonometry...",value:$,onChange:de=>ne(de.target.value),autoFocus:!0})]}),d.jsxs("div",{style:{display:"flex",gap:12,justifyContent:"flex-end"},children:[d.jsx("button",{className:"np-btn np-btn-outline np-btn-md",onClick:()=>Z(!1),children:"Cancel"}),d.jsx("button",{className:"np-btn np-btn-primary np-btn-md",onClick:da,disabled:ee||!$.trim(),children:ee?"Creating...":"Create Chapter"})]})]})}),d.jsx(sf,{isOpen:j,onClose:()=>L(!1),title:"Add Question",size:"lg",children:d.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:16},children:[d.jsxs("div",{children:[d.jsx("label",{style:{display:"block",fontSize:"0.8rem",color:"var(--muted)",marginBottom:6,fontWeight:500},children:"Question"}),d.jsx("textarea",{rows:3,placeholder:"Enter question text...",value:Te,onChange:de=>G(de.target.value),style:{resize:"vertical",minHeight:80}})]}),d.jsx("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:12},children:[{label:"A",value:oe,set:pe},{label:"B",value:xe,set:Me},{label:"C",value:U,set:z},{label:"D",value:ue,set:re}].map(de=>d.jsxs("div",{children:[d.jsxs("label",{style:{display:"flex",alignItems:"center",gap:6,fontSize:"0.8rem",color:"var(--muted)",marginBottom:6,fontWeight:500},children:[d.jsx("span",{style:{width:20,height:20,borderRadius:6,fontSize:"0.7rem",fontWeight:700,display:"flex",alignItems:"center",justifyContent:"center",background:ge===de.label?"rgba(0,217,163,0.2)":"rgba(255,255,255,0.06)",color:ge===de.label?"#00D9A3":"var(--muted)"},children:de.label}),"Option ",de.label]}),d.jsx("input",{type:"text",placeholder:`Option ${de.label}`,value:de.value,onChange:Zt=>de.set(Zt.target.value)})]},de.label))}),d.jsxs("div",{style:{display:"flex",gap:16},children:[d.jsxs("div",{style:{flex:1},children:[d.jsx("label",{style:{display:"block",fontSize:"0.8rem",color:"var(--muted)",marginBottom:6,fontWeight:500},children:"Correct Answer"}),d.jsx("div",{style:{display:"flex",gap:8},children:["A","B","C","D"].map(de=>d.jsx("button",{className:`np-btn np-btn-sm ${ge===de?"np-btn-secondary":"np-btn-outline"}`,onClick:()=>Ie(de),style:{minWidth:42},children:de},de))})]}),d.jsxs("div",{style:{flex:1},children:[d.jsx("label",{style:{display:"block",fontSize:"0.8rem",color:"var(--muted)",marginBottom:6,fontWeight:500},children:"Mark as Important"}),d.jsx("button",{className:`np-btn np-btn-sm ${$e?"np-btn-primary":"np-btn-outline"}`,onClick:()=>Ni(!$e),style:{display:"flex",alignItems:"center",gap:6},children:$e?" Important":" Not Important"})]})]}),d.jsxs("div",{children:[d.jsx("label",{style:{display:"block",fontSize:"0.8rem",color:"var(--muted)",marginBottom:6,fontWeight:500},children:"Explanation (optional)"}),d.jsx("textarea",{rows:2,placeholder:"Why is this the correct answer?",value:Ne,onChange:de=>Qe(de.target.value),style:{resize:"vertical"}})]}),d.jsxs("div",{style:{display:"flex",gap:12,justifyContent:"flex-end"},children:[d.jsx("button",{className:"np-btn np-btn-outline np-btn-md",onClick:()=>L(!1),children:"Cancel"}),d.jsx("button",{className:"np-btn np-btn-primary np-btn-md",onClick:go,disabled:ps||!Te.trim()||!oe.trim()||!xe.trim()||!U.trim()||!ue.trim(),children:ps?"Adding...":"Add Question"})]})]})}),d.jsx(sf,{isOpen:er,onClose:()=>gn(!1),title:"Import Questions from CSV",size:"lg",children:d.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:16},children:[d.jsxs("div",{style:{fontSize:"0.85rem",color:"var(--text-secondary)",lineHeight:1.6},children:["Upload a CSV file or paste CSV content below. Required columns:",d.jsx("code",{style:{display:"block",marginTop:8,padding:"10px 14px",borderRadius:8,background:"rgba(255,255,255,0.04)",fontSize:"0.78rem",color:"var(--primary)"},children:"question, optionA, optionB, optionC, optionD, correctOption, explanation, important"})]}),d.jsxs("div",{style:{display:"flex",gap:8},children:[d.jsx("button",{className:"np-btn np-btn-outline np-btn-sm",onClick:()=>ua.current?.click(),children:" Choose File"}),d.jsx("button",{className:"np-btn np-btn-outline np-btn-sm",onClick:bn,children:" Load Sample"}),d.jsx("input",{ref:ua,type:"file",accept:".csv,.tsv,.txt",style:{display:"none"},onChange:yo})]}),d.jsx("textarea",{rows:8,placeholder:"Paste CSV content here...",value:ji,onChange:de=>{ki(de.target.value),mt(null)},style:{resize:"vertical",fontFamily:"monospace",fontSize:"0.8rem"}}),!He&&ji.trim()&&d.jsx("button",{className:"np-btn np-btn-outline np-btn-md",onClick:Dn,children:" Preview Import"}),He&&d.jsxs("div",{style:{padding:16,borderRadius:12,background:"rgba(255,255,255,0.02)",border:"1px solid var(--border)"},children:[d.jsxs("div",{style:{display:"flex",gap:16,marginBottom:He.errors.length?12:0},children:[d.jsxs("span",{style:{fontSize:"0.85rem",fontWeight:600,color:"#00D9A3"},children:[" ",He.valid.length," valid question",He.valid.length!==1?"s":""]}),He.errors.length>0&&d.jsxs("span",{style:{fontSize:"0.85rem",fontWeight:600,color:"var(--error)"},children:[" ",He.errors.length," error",He.errors.length!==1?"s":""]})]}),He.errors.length>0&&d.jsx("div",{style:{maxHeight:120,overflowY:"auto",fontSize:"0.78rem",color:"var(--error)",lineHeight:1.6},children:He.errors.map((de,Zt)=>d.jsxs("div",{children:[" ",de]},Zt))})]}),d.jsxs("div",{style:{display:"flex",gap:12,justifyContent:"flex-end"},children:[d.jsx("button",{className:"np-btn np-btn-outline np-btn-md",onClick:()=>gn(!1),children:"Cancel"}),d.jsx("button",{className:"np-btn np-btn-primary np-btn-md",onClick:Ht,disabled:fi||!He?.valid?.length,children:fi?"Importing...":`Import ${He?.valid?.length||0} Questions`})]})]})})]})}const Zx=[{key:"week",label:"This Week",days:7},{key:"month",label:"This Month",days:30},{key:"all",label:"All Time",days:9999}];function Y6(){const s=ln(),{user:e}=pn(),{subjects:t,fetchSubjects:i,performanceMap:a,fetchPerformance:l}=Zs(),[c,f]=N.useState([]),[p,y]=N.useState("month"),[v,b]=N.useState(!0);N.useEffect(()=>{e?.uid&&(async()=>{b(!0);try{t.length===0&&await i(e.uid),await l(e.uid);const A=await l_(e.uid,50);f(A)}catch(A){console.error("Analytics load error:",A)}finally{b(!1)}})()},[e?.uid]);const x=Zx.find(A=>A.key===p)?.days||9999,k=new Date(Date.now()-x*864e5),O=N.useMemo(()=>c.filter(A=>{const R=A.endTime?.toDate?A.endTime.toDate():A.endTime?new Date(A.endTime):null;return R&&R>=k}),[c,p]),D=N.useMemo(()=>{const A=Object.values(a||{}),R=A.length,j=A.reduce((pe,xe)=>pe+(xe.timesCorrect||0),0),L=A.reduce((pe,xe)=>pe+(xe.timesAsked||0),0),V=L>0?Math.round(j/L*100):0,we=O.reduce((pe,xe)=>pe+(xe.durationSeconds||0),0)/60,Te=we>=60?`${Math.floor(we/60)}h ${Math.round(we%60)}m`:`${Math.round(we)}m`;let G=0;const oe=new Date;oe.setHours(0,0,0,0);for(let pe=0;pe<90;pe++){const xe=new Date(oe);xe.setDate(xe.getDate()-pe);const Me=xe.toISOString().split("T")[0];if(c.some(z=>{const ue=z.endTime?.toDate?z.endTime.toDate():z.endTime?new Date(z.endTime):null;return ue&&ue.toISOString().split("T")[0]===Me}))G++;else if(pe>0)break}return{totalQ:R,accuracy:V,studyTime:Te,streak:G,totalSessions:O.length}},[a,O,c]),M=N.useMemo(()=>{const R=new Date;R.setHours(0,0,0,0);const j=R.getDay(),L=new Date(R);L.setDate(L.getDate()-j-77);const V=[],we={};c.forEach(Te=>{const G=Te.endTime?.toDate?Te.endTime.toDate():Te.endTime?new Date(Te.endTime):null;if(!G)return;const oe=G.toISOString().split("T")[0];we[oe]=(we[oe]||0)+(Te.answered||1)});for(let Te=0;Te<84;Te++){const G=new Date(L);if(G.setDate(G.getDate()+Te),G>R)break;const oe=G.toISOString().split("T")[0];V.push({date:oe,count:we[oe]||0,day:G.getDay(),week:Math.floor(Te/7)})}return V},[c]),Y=N.useMemo(()=>O.slice().reverse().map((A,R)=>({index:R,score:A.score||0,label:`S${R+1}`})),[O]),Z=N.useMemo(()=>{if(t.length===0)return[];const A={};return t.forEach(R=>{A[R.id]={name:R.name,icon:R.icon||"",color:R.color||"#6C63FF",correct:0,asked:0}}),O.forEach(R=>{(R.scope?.subjectIds||[]).forEach(L=>{A[L]&&(A[L].correct+=R.correct||0,A[L].asked+=R.answered||0)})}),Object.values(A).filter(R=>R.asked>0).map(R=>({...R,accuracy:Math.round(R.correct/R.asked*100)})).sort((R,j)=>j.accuracy-R.accuracy)},[t,O]),$=N.useMemo(()=>{const A=Object.values(a||{}),R=[0,0,0,0,0];return A.forEach(j=>{R[j.masteryLevel||0]++}),R},[a]),ne=["Unseen","Struggling","Learning","Proficient","Mastered"],ee=["#64748B","#FF6B6B","#FFB347","#6C63FF","#00D9A3"],se=$.reduce((A,R)=>A+R,0),w=N.useMemo(()=>{const A=[];Object.values(a||{}),D.accuracy>0&&(D.accuracy>=80?A.push({icon:"",text:`Great accuracy of ${D.accuracy}%! You're performing well.`,color:"#00D9A3"}):D.accuracy<50&&A.push({icon:"",text:`Your overall accuracy is ${D.accuracy}%. Consider reviewing fundamentals.`,color:"#FF6B6B"})),D.streak>=7?A.push({icon:"",text:`${D.streak}-day streak! Consistency is key to mastery.`,color:"#FFB347"}):D.streak===0&&c.length>0&&A.push({icon:"",text:"Start a session today to build your streak!",color:"#6C63FF"});const R=se>0?Math.round($[4]/se*100):0;R>0&&A.push({icon:"",text:`${R}% of tracked questions are mastered. ${R>=50?"Excellent!":"Keep going!"}`,color:"#00D9A3"}),$[1]>5&&A.push({icon:"",text:`${$[1]} questions are in "Struggling"  focus on wrong questions mode.`,color:"#FF6B6B"});const j=Z.find(L=>L.accuracy<50&&L.asked>=5);return j&&A.push({icon:j.icon,text:`${j.name} accuracy is only ${j.accuracy}%. Practice this subject more.`,color:j.color}),A.length===0&&A.push({icon:"",text:"Complete more sessions to unlock personalized insights!",color:"#6C63FF"}),A.slice(0,5)},[D,$,Z,c,se]),C=[{label:"TOTAL QUESTIONS",value:D.totalQ.toString(),color:"#6C63FF"},{label:"OVERALL ACCURACY",value:D.accuracy>0?`${D.accuracy}%`:"",color:"#00D9A3"},{label:"STUDY TIME",value:D.studyTime,color:"#FFB347"},{label:"CURRENT STREAK",value:`${D.streak} day${D.streak!==1?"s":""}`,color:"#FF6B6B"}];return v?d.jsx("div",{style:{display:"flex",flexDirection:"column",gap:24},children:d.jsxs("div",{className:"np-card-surface",style:{padding:60,textAlign:"center"},children:[d.jsx("div",{className:"np-auth-spinner",style:{width:32,height:32,borderWidth:3,margin:"0 auto"}}),d.jsx("p",{style:{color:"var(--muted)",marginTop:16},children:"Loading analytics..."})]})}):d.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:24},children:[d.jsxs("div",{children:[d.jsx("h2",{className:"np-section-title",children:"Analytics"}),d.jsx("p",{className:"np-section-subtitle",children:"Track your progress and find patterns"})]}),d.jsx("div",{style:{display:"flex",gap:8},children:Zx.map(A=>d.jsx("button",{onClick:()=>y(A.key),className:`np-btn ${p===A.key?"np-btn-primary":"np-btn-ghost"} np-btn-sm`,style:p!==A.key?{background:"rgba(255,255,255,0.04)",border:"1px solid var(--border)"}:{},children:A.label},A.key))}),d.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(4, 1fr)",gap:16},children:C.map(A=>d.jsxs("div",{className:"np-card",style:{borderLeft:`3px solid ${A.color}`},children:[d.jsx("p",{style:{fontSize:"0.7rem",color:"var(--muted)",fontWeight:600,letterSpacing:"0.05em",marginBottom:8},children:A.label}),d.jsx("p",{style:{fontFamily:"var(--font-heading)",fontWeight:800,fontSize:"1.75rem",color:A.color},children:A.value})]},A.label))}),d.jsxs("div",{style:{display:"grid",gridTemplateColumns:"2fr 1fr",gap:16},children:[d.jsx(X6,{data:M}),d.jsx(J6,{dist:$,labels:ne,colors:ee,total:se})]}),d.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:16},children:[d.jsx(Z6,{data:Y}),d.jsx(eP,{data:Z})]}),d.jsxs("div",{className:"np-card-surface",children:[d.jsx("h3",{style:{fontFamily:"var(--font-heading)",fontWeight:700,fontSize:"1.05rem",marginBottom:16},children:" Insights"}),d.jsx("div",{style:{display:"flex",flexDirection:"column",gap:10},children:w.map((A,R)=>d.jsxs("div",{style:{display:"flex",alignItems:"center",gap:12,padding:"12px 16px",borderRadius:10,background:`${A.color}08`,border:`1px solid ${A.color}20`},children:[d.jsx("span",{style:{fontSize:"1.2rem"},children:A.icon}),d.jsx("span",{style:{fontSize:"0.85rem",color:"var(--text-secondary)"},children:A.text})]},R))})]}),d.jsxs("div",{className:"np-card-surface",children:[d.jsx("h3",{style:{fontFamily:"var(--font-heading)",fontWeight:700,fontSize:"1.05rem",marginBottom:16},children:" Session History"}),O.length===0?d.jsxs("div",{className:"np-empty",style:{padding:"40px 16px"},children:[d.jsx("div",{style:{fontSize:"2rem",marginBottom:10,opacity:.5},children:""}),d.jsx("p",{style:{color:"var(--muted)",fontSize:"0.82rem"},children:"No sessions in this period."})]}):d.jsx("div",{style:{display:"flex",flexDirection:"column",gap:8},children:O.map(A=>{const R=A.score>=70?"#00D9A3":A.score>=40?"#FFB347":"#FF6B6B",j=A.endTime?.toDate?A.endTime.toDate():A.endTime?new Date(A.endTime):null;return d.jsxs("div",{onClick:()=>s(`/test/results?session=${A.id}`),style:{display:"flex",alignItems:"center",justifyContent:"space-between",padding:"12px 14px",borderRadius:10,background:"rgba(255,255,255,0.02)",border:"1px solid var(--border)",cursor:"pointer",transition:"all 0.2s"},onMouseEnter:L=>{L.currentTarget.style.borderColor="var(--border-hover)"},onMouseLeave:L=>{L.currentTarget.style.borderColor="var(--border)"},children:[d.jsxs("div",{style:{display:"flex",alignItems:"center",gap:10},children:[d.jsxs("div",{style:{width:40,height:40,borderRadius:10,display:"flex",alignItems:"center",justifyContent:"center",background:`${R}12`,fontSize:"0.82rem",fontWeight:800,color:R,fontFamily:"var(--font-heading)"},children:[A.score,"%"]}),d.jsxs("div",{children:[d.jsx("div",{style:{fontSize:"0.82rem",fontWeight:600},children:A.scope?.subjectNames?.join(", ")||"All Subjects"}),d.jsxs("div",{style:{fontSize:"0.68rem",color:"var(--muted)"},children:[A.answered||0,"/",A.totalQuestions||0," answered  ",A.type||"practice"]})]})]}),d.jsx("div",{style:{fontSize:"0.68rem",color:"var(--muted)",flexShrink:0},children:j?j.toLocaleDateString("en-US",{month:"short",day:"numeric"}):""})]},A.id)})})]})]})}function X6({data:s}){if(s.length===0)return null;const e=Math.max(1,...s.map(a=>a.count)),t=["","Mon","","Wed","","Fri",""],i=[...new Set(s.map(a=>a.week))];return d.jsxs("div",{className:"np-card-surface",children:[d.jsx("h3",{style:{fontFamily:"var(--font-heading)",fontWeight:700,fontSize:"1.05rem",marginBottom:16},children:" Activity"}),d.jsxs("div",{style:{display:"flex",gap:6},children:[d.jsx("div",{style:{display:"flex",flexDirection:"column",gap:3,paddingTop:0},children:t.map((a,l)=>d.jsx("div",{style:{height:14,fontSize:"0.58rem",color:"var(--muted)",lineHeight:"14px",width:24,textAlign:"right"},children:a},l))}),d.jsx("div",{style:{display:"flex",gap:3,flex:1},children:i.map(a=>d.jsx("div",{style:{display:"flex",flexDirection:"column",gap:3,flex:1},children:[0,1,2,3,4,5,6].map(l=>{const c=s.find(y=>y.week===a&&y.day===l);if(!c)return d.jsx("div",{style:{height:14,borderRadius:3}},l);const f=c.count/e,p=c.count===0?"rgba(255,255,255,0.04)":`rgba(0, 217, 163, ${.15+f*.85})`;return d.jsx("div",{title:`${c.date}: ${c.count} questions`,style:{height:14,borderRadius:3,background:p,cursor:"default",transition:"background 0.2s"}},l)})},a))})]}),d.jsxs("div",{style:{display:"flex",alignItems:"center",gap:6,marginTop:12,justifyContent:"flex-end"},children:[d.jsx("span",{style:{fontSize:"0.6rem",color:"var(--muted)"},children:"Less"}),[0,.25,.5,.75,1].map((a,l)=>d.jsx("div",{style:{width:12,height:12,borderRadius:3,background:a===0?"rgba(255,255,255,0.04)":`rgba(0,217,163,${.15+a*.85})`}},l)),d.jsx("span",{style:{fontSize:"0.6rem",color:"var(--muted)"},children:"More"})]})]})}function J6({dist:s,labels:e,colors:t,total:i}){const f=2*Math.PI*59;let p=0;const y=s.map((v,b)=>{const x=i>0?v/i:0,k=x*f,O=p;return p+=k,{color:t[b],dashLength:k,gapLength:f-k,offset:O,count:v,label:e[b],pct:x}}).filter(v=>v.count>0);return d.jsxs("div",{className:"np-card-surface",style:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center"},children:[d.jsx("h3",{style:{fontFamily:"var(--font-heading)",fontWeight:700,fontSize:"1.05rem",marginBottom:16,alignSelf:"flex-start"},children:" Mastery"}),i===0?d.jsx("p",{style:{color:"var(--muted)",fontSize:"0.82rem"},children:"No data yet"}):d.jsxs(d.Fragment,{children:[d.jsxs("div",{style:{position:"relative",width:140,height:140},children:[d.jsxs("svg",{width:140,height:140,style:{transform:"rotate(-90deg)"},children:[d.jsx("circle",{cx:140/2,cy:140/2,r:59,fill:"none",stroke:"rgba(255,255,255,0.04)",strokeWidth:22}),y.map((v,b)=>d.jsx("circle",{cx:140/2,cy:140/2,r:59,fill:"none",stroke:v.color,strokeWidth:22,strokeDasharray:`${v.dashLength} ${f-v.dashLength}`,strokeDashoffset:-v.offset,strokeLinecap:"butt"},b))]}),d.jsxs("div",{style:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",textAlign:"center"},children:[d.jsxs("div",{style:{fontFamily:"var(--font-heading)",fontWeight:800,fontSize:"1.3rem",color:"#00D9A3"},children:[i>0?Math.round(s[4]/i*100):0,"%"]}),d.jsx("div",{style:{fontSize:"0.6rem",color:"var(--muted)"},children:"mastered"})]})]}),d.jsx("div",{style:{display:"flex",gap:10,flexWrap:"wrap",marginTop:14,justifyContent:"center"},children:s.map((v,b)=>v===0?null:d.jsxs("div",{style:{display:"flex",alignItems:"center",gap:4,fontSize:"0.65rem"},children:[d.jsx("span",{style:{width:8,height:8,borderRadius:"50%",background:t[b],display:"inline-block"}}),d.jsxs("span",{style:{color:"var(--muted)"},children:[e[b],": ",v]})]},b))})]})]})}function Z6({data:s}){return d.jsxs("div",{className:"np-card-surface",children:[d.jsx("h3",{style:{fontFamily:"var(--font-heading)",fontWeight:700,fontSize:"1.05rem",marginBottom:16},children:" Accuracy Trend"}),s.length<2?d.jsx("p",{style:{color:"var(--muted)",fontSize:"0.82rem",textAlign:"center",padding:"30px 0"},children:"Need at least 2 sessions to show trend"}):d.jsx("div",{style:{width:"100%",overflowX:"auto"},children:d.jsxs("svg",{viewBox:"0 0 400 160",style:{width:"100%",maxHeight:200},children:[[0,25,50,75,100].map(l=>{const c=140-l/100*140;return d.jsxs("g",{children:[d.jsx("line",{x1:30,y1:c,x2:400,y2:c,stroke:"rgba(255,255,255,0.06)",strokeWidth:"1"}),d.jsxs("text",{x:26,y:c+4,fill:"var(--muted)",fontSize:"8",textAnchor:"end",children:[l,"%"]})]},l)}),d.jsx("polyline",{points:s.map(l=>{const c=30+l.index/(s.length-1)*360,f=140-l.score/100*140;return`${c},${f}`}).join(" "),fill:"none",stroke:"#6C63FF",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round"}),d.jsx("polygon",{points:[...s.map(l=>{const c=30+l.index/(s.length-1)*360,f=140-l.score/100*140;return`${c},${f}`}),`${30+(s.length-1)/(s.length-1)*360},140`,"30,140"].join(" "),fill:"url(#trendGrad)",opacity:"0.3"}),d.jsx("defs",{children:d.jsxs("linearGradient",{id:"trendGrad",x1:"0",y1:"0",x2:"0",y2:"1",children:[d.jsx("stop",{offset:"0%",stopColor:"#6C63FF"}),d.jsx("stop",{offset:"100%",stopColor:"#6C63FF",stopOpacity:"0"})]})}),s.map(l=>{const c=30+l.index/(s.length-1)*360,f=140-l.score/100*140;return d.jsxs("g",{children:[d.jsx("circle",{cx:c,cy:f,r:"4",fill:"#6C63FF"}),d.jsx("circle",{cx:c,cy:f,r:"2",fill:"#fff"})]},l.index)})]})})]})}function eP({data:s}){return d.jsxs("div",{className:"np-card-surface",children:[d.jsx("h3",{style:{fontFamily:"var(--font-heading)",fontWeight:700,fontSize:"1.05rem",marginBottom:16},children:" Subject Accuracy"}),s.length===0?d.jsx("p",{style:{color:"var(--muted)",fontSize:"0.82rem",textAlign:"center",padding:"30px 0"},children:"No subject data yet"}):d.jsx("div",{style:{display:"flex",flexDirection:"column",gap:14},children:s.map(t=>d.jsxs("div",{children:[d.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:6},children:[d.jsxs("span",{style:{fontSize:"0.78rem",fontWeight:600},children:[t.icon," ",t.name]}),d.jsxs("span",{style:{fontSize:"0.75rem",fontWeight:700,color:t.accuracy>=60?"#00D9A3":"#FF6B6B"},children:[t.accuracy,"%"]})]}),d.jsx("div",{style:{height:8,background:"rgba(255,255,255,0.06)",borderRadius:4,overflow:"hidden"},children:d.jsx("div",{style:{height:"100%",borderRadius:4,width:`${t.accuracy/100*100}%`,background:`linear-gradient(90deg, ${t.color}, ${t.color}AA)`,transition:"width 0.5s ease"}})}),d.jsxs("div",{style:{fontSize:"0.62rem",color:"var(--muted)",marginTop:3},children:[t.correct,"/",t.asked," correct"]})]},t.name))})]})}const gh=em((s,e)=>({sessionId:null,status:null,type:null,scope:null,config:null,questions:[],currentIndex:0,answers:{},questionOrder:{},totalQuestions:0,answered:0,correct:0,wrong:0,skipped:0,timerActive:!1,timeRemaining:0,questionStartTime:null,paused:!1,showingAnswer:!1,selectedOption:null,sessionStartTime:null,initSession:t=>s({sessionId:t.sessionId,status:"in_progress",type:t.type,scope:t.scope,config:t.config,questions:t.questions,currentIndex:0,answers:{},questionOrder:t.questionOrder||{},totalQuestions:t.questions.length,answered:0,correct:0,wrong:0,skipped:0,timerActive:t.config.timerType!=="none",timeRemaining:t.config.timerType==="per_question"?t.config.timerValue:t.config.timerType==="full_session"?t.config.timerValue*60:0,questionStartTime:Date.now(),paused:!1,showingAnswer:!1,selectedOption:null,sessionStartTime:Date.now()}),answerQuestion:(t,i,a)=>{const l=e(),c=i===a,f=Math.round((Date.now()-(l.questionStartTime||Date.now()))/1e3),p=l.answers[t],y=!!(p&&p.userAnswer!=null),v=y?p.isCorrect:!1;let b=l.answered,x=l.correct,k=l.wrong;y?v&&!c?(x-=1,k+=1):!v&&c&&(x+=1,k-=1):(b+=1,c?x+=1:k+=1);const O={questionId:t,questionText:l.questions[l.currentIndex]?.text||"",userAnswer:i,userAnswerText:l.questions[l.currentIndex]?.options.find(D=>D.label===i)?.text||"",correctAnswer:a,correctAnswerText:l.questions[l.currentIndex]?.options.find(D=>D.label===a)?.text||"",isCorrect:c,timeSpent:y?(p.timeSpent||0)+f:f,confidence:p?.confidence||null,flagged:p?.flagged||!1,attemptedAt:new Date().toISOString(),optionOrder:l.questionOrder[t]||["A","B","C","D"]};if(s(D=>({answers:{...D.answers,[t]:O},answered:b,correct:x,wrong:k,showingAnswer:!0,selectedOption:i})),b%10===0&&l.sessionId){const D={...l.answers,[t]:O};R6(l.sessionId,{answered:b,correct:x,wrong:k,questionResults:Object.values(D)}).catch(M=>console.error("Checkpoint save failed:",M))}},setConfidence:(t,i)=>{s(a=>({answers:{...a.answers,[t]:{...a.answers[t],confidence:i}}}))},skipQuestion:t=>{const i=e(),a=Math.round((Date.now()-(i.questionStartTime||Date.now()))/1e3),l={questionId:t,questionText:i.questions[i.currentIndex]?.text||"",userAnswer:null,userAnswerText:"",correctAnswer:i.questions[i.currentIndex]?.correctOption||"",correctAnswerText:i.questions[i.currentIndex]?.options.find(c=>c.label===(i.questions[i.currentIndex]?.correctOption||""))?.text||"",isCorrect:!1,timeSpent:a,confidence:null,flagged:!1,attemptedAt:new Date().toISOString(),optionOrder:i.questionOrder[t]||["A","B","C","D"]};s(c=>{const f=c.answers[t]?.userAnswer===null&&c.answers[t]?.isSkipped===!0;return{answers:{...c.answers,[t]:{...l,isSkipped:!0}},skipped:f?c.skipped:c.skipped+1}})},flagQuestion:t=>{s(i=>{const a=i.answers[t];return a?{answers:{...i.answers,[t]:{...a,flagged:!a.flagged}}}:{answers:{...i.answers,[t]:{questionId:t,questionText:"",userAnswer:null,correctAnswer:"",isCorrect:!1,timeSpent:0,confidence:null,flagged:!0,attemptedAt:new Date().toISOString(),optionOrder:i.questionOrder[t]||["A","B","C","D"]}}}})},nextQuestion:()=>{const t=e(),i=t.currentIndex+1;i<t.questions.length&&s({currentIndex:i,showingAnswer:!1,selectedOption:null,questionStartTime:Date.now(),timeRemaining:t.config?.timerType==="per_question"?t.config.timerValue:t.timeRemaining})},goToQuestion:t=>{s({currentIndex:t,showingAnswer:!1,selectedOption:null,questionStartTime:Date.now()})},tickTimer:()=>{const t=e();if(!t.timerActive||t.paused)return;const i=t.timeRemaining-1;if(i<=0){if(t.config?.timerType==="per_question"){const a=t.questions[t.currentIndex];a&&!t.answers[a.id]&&e().skipQuestion(a.id),t.currentIndex<t.questions.length-1&&e().nextQuestion()}s({timeRemaining:Math.max(0,i)})}else s({timeRemaining:i})},pauseSession:()=>s({paused:!0}),resumeSession:()=>s({paused:!1}),endSession:async()=>{const t=e();if(!t.sessionId)return null;const i=t.answered>0?Math.round(t.correct/t.answered*100):0,a={answered:t.answered,correct:t.correct,wrong:t.wrong,skipped:t.skipped,score:i,questionResults:Object.values(t.answers)};return await KA(t.sessionId,a),s({status:"completed"}),{sessionId:t.sessionId,score:i,...a}},resetSession:()=>s({sessionId:null,status:null,type:null,scope:null,config:null,questions:[],currentIndex:0,answers:{},questionOrder:{},totalQuestions:0,answered:0,correct:0,wrong:0,skipped:0,timerActive:!1,timeRemaining:0,questionStartTime:null,paused:!1,showingAnswer:!1,selectedOption:null,sessionStartTime:null})}));function tP(){const s=ln(),{user:e}=pn(),t=Zs(),{subjects:i}=t;gh(ee=>ee.initSession);const[a,l]=N.useState("all"),[c,f]=N.useState([]),[p,y]=N.useState(0),[v,b]=N.useState(!1),[x,k]=N.useState([]),[O,D]=N.useState(!1),[M,Y]=N.useState(!1);N.useEffect(()=>{e?.uid&&i.length===0&&t.fetchSubjects(e.uid)},[e?.uid]);const Z=async()=>{if(e?.uid){D(!0);try{const ee={subjectIds:[a],chapterIds:["all"]},se=await ph(e.uid,ee,t),w=qs(se).slice(0,20);if(w.length===0){D(!1);return}const C=await o_(e.uid,{type:"flashcard",scope:{subjectIds:[a],chapterIds:["all"],subjectNames:[a==="all"?"All":i.find(A=>A.id===a)?.name]},config:{totalQuestions:w.length,timerType:"none",timerValue:0,shuffled:!0,optionsShuffled:!1,showExplanation:!1},questionIds:w.map(A=>A.id),totalQuestions:w.length});f(w),y(0),b(!1),k([]),Y(!0)}catch(ee){console.error(ee)}finally{D(!1)}}},$=async ee=>{const se=c[p],w={questionId:se.id,questionText:se.text,userAnswer:ee?"knew_it":null,correctAnswer:se.correctOption,isCorrect:ee,timeSpent:0,confidence:null,flagged:!1,attemptedAt:new Date().toISOString(),optionOrder:["A","B","C","D"]},C=[...x,w];if(k(C),p<c.length-1)y(p+1),b(!1);else{const A=C.filter(j=>j.isCorrect).length,R=Math.round(A/C.length*100);if(e?.uid){await l_(e.uid,1);const j=await j6(e.uid);if(j){await KA(j.id,{answered:C.length,correct:A,wrong:C.length-A,skipped:0,score:R,questionResults:C}),await YA(e.uid,C),s(`/test/results?session=${j.id}`);return}}Y(!1)}};if(!M)return c.length>0&&c[p],d.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:24},children:[d.jsxs("div",{children:[d.jsx("h2",{className:"np-section-title",children:"Flashcards"}),d.jsx("p",{className:"np-section-subtitle",children:"Review questions with flip cards"})]}),d.jsxs("div",{className:"np-config-section",children:[d.jsx("h3",{className:"np-config-title",children:" Select Scope"}),d.jsxs("div",{style:{display:"flex",flexWrap:"wrap",gap:8},children:[d.jsx("button",{className:`np-pill ${a==="all"?"np-pill-active":""}`,onClick:()=>l("all"),children:"All Subjects"}),i.map(ee=>d.jsxs("button",{className:`np-pill ${a===ee.id?"np-pill-active":""}`,onClick:()=>l(ee.id),children:[ee.icon," ",ee.name]},ee.id))]})]}),d.jsx("button",{className:"np-btn np-btn-primary np-btn-lg",onClick:Z,disabled:O,style:{alignSelf:"center",minWidth:200},children:O?"Loading...":"Start Flashcards"})]});const ne=c[p];return d.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:24,maxWidth:600,margin:"0 auto"},children:[d.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[d.jsxs("span",{style:{fontFamily:"var(--font-heading)",fontWeight:700},children:["Card ",p+1," of ",c.length]}),d.jsx("button",{className:"np-btn np-btn-outline np-btn-sm",onClick:()=>Y(!1),children:"Exit"})]}),d.jsx("div",{className:"np-card-surface",style:{padding:"48px 32px",textAlign:"center",cursor:"pointer",minHeight:220,display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center"},onClick:()=>b(!v),children:v?d.jsxs(d.Fragment,{children:[d.jsxs("p",{style:{fontSize:"0.85rem",color:"var(--muted)",marginBottom:12},children:["Answer: ",d.jsx("strong",{style:{color:"#00D9A3"},children:ne.correctOption})]}),d.jsx("p",{style:{fontSize:"1rem",fontWeight:500,color:"#00D9A3"},children:ne.options?.find(ee=>ee.label===ne.correctOption)?.text}),ne.explanation&&d.jsxs("p",{style:{fontSize:"0.8rem",color:"var(--muted)",marginTop:12,fontStyle:"italic"},children:[" ",ne.explanation]})]}):d.jsxs(d.Fragment,{children:[d.jsx("p",{style:{fontSize:"1.1rem",fontWeight:500,lineHeight:1.6,marginBottom:16},children:ne.text}),d.jsx("span",{style:{fontSize:"0.75rem",color:"var(--muted)"},children:"Tap to reveal answer"})]})}),v&&d.jsxs("div",{style:{display:"flex",gap:12,justifyContent:"center"},children:[d.jsx("button",{className:"np-btn np-btn-danger np-btn-lg",style:{flex:1},onClick:()=>$(!1),children:"Didn't Know"}),d.jsx("button",{className:"np-btn np-btn-secondary np-btn-lg",style:{flex:1},onClick:()=>$(!0),children:" Knew It"})]})]})}function nP(){const s=ln(),{user:e,userProfile:t,setUserProfile:i,logout:a}=pn(),{accentColor:l,setAccentColor:c,fontSize:f,setFontSize:p,addToast:y}=Kl(),[v,b]=N.useState(""),[x,k]=N.useState(""),[O,D]=N.useState(50),[M,Y]=N.useState(!1),[Z,$]=N.useState(!1);N.useEffect(()=>{t&&(b(t.examName||""),k(t.examDate||""),D(t.dailyGoal||50))},[t]);const ne=async()=>{if(e?.uid){Y(!0);try{const se={examName:v,examDate:x,dailyGoal:O};await GA(e.uid,se),i({...t,...se}),y({type:"success",message:"Settings saved!"})}catch(se){console.error("Failed to save profile:",se),y({type:"error",message:"Failed to save settings"})}finally{Y(!1)}}},ee=async()=>{$(!0);try{await t6(),a(),s("/login")}catch(se){console.error("Failed to sign out:",se),$(!1)}};return d.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:24,maxWidth:720},children:[d.jsxs("div",{children:[d.jsx("h2",{className:"np-section-title",children:"Settings"}),d.jsx("p",{className:"np-section-subtitle",children:"Customize your experience"})]}),d.jsxs("div",{className:"np-settings-section",children:[d.jsxs("div",{className:"np-settings-title",children:[d.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"var(--primary)",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[d.jsx("path",{d:"M20 21v-2a4 4 0 00-4-4H8a4 4 0 00-4 4v2"}),d.jsx("circle",{cx:"12",cy:"7",r:"4"})]}),"Account"]}),d.jsxs("div",{style:{display:"flex",alignItems:"center",gap:16,padding:"8px 0"},children:[d.jsx("div",{style:{width:48,height:48,borderRadius:14,background:"linear-gradient(135deg, #6C63FF, #8B5CF6)",display:"flex",alignItems:"center",justifyContent:"center",fontWeight:700,fontSize:"1.1rem",color:"white",flexShrink:0},children:(t?.displayName||e?.email||"?")[0].toUpperCase()}),d.jsxs("div",{children:[d.jsx("div",{style:{fontWeight:600,fontSize:"0.95rem"},children:t?.displayName||"User"}),d.jsx("div",{style:{fontSize:"0.8rem",color:"var(--muted)"},children:e?.email})]})]})]}),d.jsxs("div",{className:"np-settings-section",children:[d.jsxs("div",{className:"np-settings-title",children:[d.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"var(--primary)",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[d.jsx("rect",{x:"3",y:"4",width:"18",height:"18",rx:"2",ry:"2"}),d.jsx("line",{x1:"16",y1:"2",x2:"16",y2:"6"}),d.jsx("line",{x1:"8",y1:"2",x2:"8",y2:"6"}),d.jsx("line",{x1:"3",y1:"10",x2:"21",y2:"10"})]}),"Exam Information"]}),d.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:16},children:[d.jsxs("div",{children:[d.jsx("label",{children:"Exam Name"}),d.jsx("input",{type:"text",placeholder:"e.g. JEE Main 2026",value:v,onChange:se=>b(se.target.value)})]}),d.jsxs("div",{children:[d.jsx("label",{children:"Exam Date"}),d.jsx("input",{type:"date",value:x,onChange:se=>k(se.target.value)})]}),d.jsxs("div",{children:[d.jsx("label",{children:"Daily Question Goal"}),d.jsx("input",{type:"number",placeholder:"50",min:"1",max:"500",value:O,onChange:se=>D(Number(se.target.value))})]}),d.jsx("button",{className:"np-btn np-btn-primary np-btn-md",onClick:ne,disabled:M,style:{alignSelf:"flex-start"},children:M?"Saving...":"Save Changes"})]})]}),d.jsxs("div",{className:"np-settings-section",children:[d.jsxs("div",{className:"np-settings-title",children:[d.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"var(--secondary)",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[d.jsx("circle",{cx:"12",cy:"12",r:"5"}),d.jsx("line",{x1:"12",y1:"1",x2:"12",y2:"3"}),d.jsx("line",{x1:"12",y1:"21",x2:"12",y2:"23"}),d.jsx("line",{x1:"4.22",y1:"4.22",x2:"5.64",y2:"5.64"}),d.jsx("line",{x1:"18.36",y1:"18.36",x2:"19.78",y2:"19.78"}),d.jsx("line",{x1:"1",y1:"12",x2:"3",y2:"12"}),d.jsx("line",{x1:"21",y1:"12",x2:"23",y2:"12"}),d.jsx("line",{x1:"4.22",y1:"19.78",x2:"5.64",y2:"18.36"}),d.jsx("line",{x1:"18.36",y1:"5.64",x2:"19.78",y2:"4.22"})]}),"Appearance"]}),d.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:20},children:[d.jsxs("div",{children:[d.jsx("label",{children:"Accent Color"}),d.jsx("div",{style:{display:"flex",gap:12,marginTop:4},children:[{name:"Violet",value:"#6C63FF"},{name:"Cyan",value:"#00D4FF"},{name:"Pink",value:"#FF006E"},{name:"Orange",value:"#FF6B35"},{name:"Lime",value:"#7CFC00"},{name:"Gold",value:"#FFD700"}].map(se=>d.jsx("button",{className:`np-color-swatch ${se.value===l?"active":""}`,style:{background:se.value},title:se.name,onClick:()=>c(se.value)},se.value))})]}),d.jsxs("div",{children:[d.jsx("label",{children:"Font Size"}),d.jsx("div",{style:{display:"flex",gap:8,marginTop:4},children:[{label:"Small",value:"small"},{label:"Medium",value:"medium"},{label:"Large",value:"large"}].map(se=>d.jsx("button",{className:`np-btn np-btn-sm ${se.value===f?"np-btn-primary":"np-btn-outline"}`,onClick:()=>p(se.value),children:se.label},se.value))})]})]})]}),d.jsxs("div",{className:"np-settings-section",children:[d.jsxs("div",{className:"np-settings-title",children:[d.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"var(--warning)",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[d.jsx("ellipse",{cx:"12",cy:"5",rx:"9",ry:"3"}),d.jsx("path",{d:"M21 12c0 1.66-4 3-9 3s-9-1.34-9-3"}),d.jsx("path",{d:"M3 5v14c0 1.66 4 3 9 3s9-1.34 9-3V5"})]}),"Data Management"]}),d.jsxs("div",{style:{display:"flex",flexWrap:"wrap",gap:10},children:[d.jsx("button",{className:"np-btn np-btn-outline np-btn-sm",children:" Export Questions"}),d.jsx("button",{className:"np-btn np-btn-outline np-btn-sm",children:" Export Sessions"}),d.jsx("button",{className:"np-btn np-btn-outline np-btn-sm",children:" Import CSV"}),d.jsx("button",{className:"np-btn np-btn-danger np-btn-sm",children:" Clear Performance Data"})]})]}),d.jsxs("div",{className:"np-settings-section",style:{borderColor:"rgba(255,107,107,0.15)"},children:[d.jsxs("div",{className:"np-settings-title",children:[d.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"var(--error)",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[d.jsx("path",{d:"M9 21H5a2 2 0 01-2-2V5a2 2 0 012-2h4"}),d.jsx("polyline",{points:"16 17 21 12 16 7"}),d.jsx("line",{x1:"21",y1:"12",x2:"9",y2:"12"})]}),"Account Actions"]}),d.jsx("button",{className:"np-btn np-btn-danger np-btn-md",onClick:ee,disabled:Z,children:Z?"Signing out...":"Sign Out"})]}),d.jsx("p",{style:{textAlign:"center",fontSize:"0.75rem",color:"var(--muted)",paddingBottom:8},children:"NeuralPrep v1.0.0"})]})}const iP=[{key:"smart",title:"Smart Session",icon:"",color:"#8B5CF6",desc:"70% important, 30% normal"},{key:"wrong",title:"Wrong Questions",icon:"",color:"#FF6B6B",desc:"Focus on past mistakes"},{key:"due_today",title:"Due Today",icon:"",color:"#00D9A3",desc:"Spaced repetition queue"},{key:"unseen",title:"Unseen First",icon:"",color:"#FFB347",desc:"New questions first"},{key:"flagged",title:"Flagged Only",icon:"",color:"#FF006E",desc:"Bookmarked questions"},{key:"random",title:"Quick Mix",icon:"",color:"#6C63FF",desc:"Pure random selection"}],sP=[10,25,50,100];function rP(){const s=ln(),[e]=_1(),{user:t}=pn(),i=Zs(),{subjects:a}=i,l=gh(z=>z.initSession),[c,f]=N.useState(e.get("mode")||"smart"),[p,y]=N.useState(e.get("subject")?[e.get("subject")]:["all"]),[v,b]=N.useState(["all"]),[x,k]=N.useState(25),[O,D]=N.useState(""),[M,Y]=N.useState("none"),[Z,$]=N.useState(60),[ne,ee]=N.useState(!0),[se,w]=N.useState(!0),[C,A]=N.useState(!1),[R,j]=N.useState([]),[L,V]=N.useState({}),[we,Te]=N.useState(!0),[G,oe]=N.useState(!1);N.useEffect(()=>{t?.uid&&(async()=>{Te(!0);try{a.length===0&&await i.fetchSubjects(t.uid);const z=await WA(t.uid);V(z)}catch(z){console.error("Failed to load config data:",z)}finally{Te(!1)}})()},[t?.uid]),N.useEffect(()=>{!t?.uid||a.length===0||(async()=>{const z={subjectIds:p,chapterIds:v},ue=await ph(t.uid,z,i);j(ue)})()},[t?.uid,p,v,a,i.chapters,i.questions]);const pe=N.useMemo(()=>{if(p[0]==="all")return[];const z=p[0];return i.chapters[z]||[]},[p,i.chapters]);N.useEffect(()=>{if(p[0]!=="all"&&t?.uid){const z=p[0];i.chapters[z]||i.fetchChapters(t.uid,z)}},[p,t?.uid]);const xe=R.length,Me=O?parseInt(O,10):x,U=async()=>{if(!(!t?.uid||xe===0)){oe(!0);try{let z=[];const ue=Math.min(Me,xe);switch(c){case"smart":z=U6(R,L,ue);break;case"wrong":z=XA(R,L).slice(0,ue);break;case"due_today":z=JA(R,L).slice(0,ue);break;case"unseen":z=z6(R,L).slice(0,ue);break;case"flagged":z=ZA(R,L).slice(0,ue);break;default:z=B6(R,ue);break}if(z.length===0){oe(!1);return}ne&&(z=qs(z));const re={};se&&z.forEach(Qe=>{const{optionOrder:$e}=q6(Qe.options);re[Qe.id]=$e});const ge={subjectIds:p,chapterIds:v,subjectNames:p[0]==="all"?["All Subjects"]:a.filter(Qe=>p.includes(Qe.id)).map(Qe=>Qe.name)},Ie={totalQuestions:z.length,timerType:M,timerValue:Z,shuffled:ne,optionsShuffled:se,showExplanation:C},Ne=await o_(t.uid,{type:c,scope:ge,config:Ie,questionIds:z.map(Qe=>Qe.id),totalQuestions:z.length});l({sessionId:Ne,type:c,scope:ge,config:Ie,questions:z,questionOrder:re}),s("/test/session")}catch(z){console.error("Failed to start session:",z),oe(!1)}}};return we?d.jsx("div",{style:{display:"flex",flexDirection:"column",gap:24,maxWidth:800,margin:"0 auto"},children:d.jsxs("div",{className:"np-card-surface",style:{padding:60,textAlign:"center"},children:[d.jsx("div",{className:"np-auth-spinner",style:{width:32,height:32,borderWidth:3,margin:"0 auto"}}),d.jsx("p",{style:{color:"var(--muted)",marginTop:16},children:"Loading..."})]})}):d.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:24,maxWidth:800,margin:"0 auto"},children:[d.jsxs("div",{children:[d.jsx("h2",{className:"np-section-title",children:"Configure Practice Session"}),d.jsx("p",{className:"np-section-subtitle",children:"Set up your test parameters"})]}),d.jsxs("div",{className:"np-config-section",children:[d.jsx("h3",{className:"np-config-title",children:" Scope"}),d.jsxs("div",{style:{display:"flex",flexWrap:"wrap",gap:8},children:[d.jsx("button",{className:`np-pill ${p[0]==="all"?"np-pill-active":""}`,onClick:()=>{y(["all"]),b(["all"])},children:"All Subjects"}),a.map(z=>d.jsxs("button",{className:`np-pill ${p.includes(z.id)?"np-pill-active":""}`,style:p.includes(z.id)?{borderColor:z.color,background:`${z.color}18`,color:z.color}:{},onClick:()=>{y([z.id]),b(["all"])},children:[z.icon," ",z.name]},z.id))]}),p[0]!=="all"&&pe.length>0&&d.jsxs("div",{style:{marginTop:12},children:[d.jsx("label",{style:{fontSize:"0.78rem",color:"var(--muted)",marginBottom:8,display:"block"},children:"Chapters"}),d.jsxs("div",{style:{display:"flex",flexWrap:"wrap",gap:6},children:[d.jsx("button",{className:`np-pill np-pill-sm ${v[0]==="all"?"np-pill-active":""}`,onClick:()=>b(["all"]),children:"All"}),pe.map(z=>d.jsx("button",{className:`np-pill np-pill-sm ${v.includes(z.id)?"np-pill-active":""}`,onClick:()=>{b(ue=>{if(ue[0]==="all")return[z.id];if(ue.includes(z.id)){const re=ue.filter(ge=>ge!==z.id);return re.length===0?["all"]:re}return[...ue,z.id]})},children:z.name},z.id))]})]}),d.jsxs("div",{className:"np-config-count",children:[xe," question",xe!==1?"s":""," available"]})]}),d.jsxs("div",{className:"np-config-section",children:[d.jsx("h3",{className:"np-config-title",children:" Practice Mode"}),d.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(220px, 1fr))",gap:10},children:iP.map(z=>d.jsxs("div",{className:`np-mode-select-card ${c===z.key?"np-mode-select-active":""}`,style:c===z.key?{borderColor:z.color,background:`${z.color}10`}:{},onClick:()=>f(z.key),children:[d.jsx("span",{style:{fontSize:"1.4rem"},children:z.icon}),d.jsxs("div",{children:[d.jsx("div",{style:{fontWeight:600,fontSize:"0.88rem"},children:z.title}),d.jsx("div",{style:{fontSize:"0.72rem",color:"var(--muted)"},children:z.desc})]})]},z.key))})]}),d.jsxs("div",{className:"np-config-section",children:[d.jsx("h3",{className:"np-config-title",children:" Question Count"}),d.jsxs("div",{style:{display:"flex",gap:8,flexWrap:"wrap",alignItems:"center"},children:[sP.map(z=>d.jsx("button",{className:`np-pill ${x===z&&!O?"np-pill-active":""}`,onClick:()=>{k(z),D("")},disabled:z>xe,children:z},z)),d.jsx("input",{type:"number",min:"1",max:xe,placeholder:"Custom",value:O,onChange:z=>D(z.target.value),style:{width:90,fontSize:"0.85rem"}}),d.jsxs("span",{style:{fontSize:"0.75rem",color:"var(--muted)"},children:["/ ",xe," available"]})]})]}),d.jsxs("div",{className:"np-config-section",children:[d.jsx("h3",{className:"np-config-title",children:" Timer"}),d.jsx("div",{style:{display:"flex",gap:8,marginBottom:12},children:[{key:"none",label:"Off"},{key:"per_question",label:"Per Question"},{key:"full_session",label:"Full Session"}].map(z=>d.jsx("button",{className:`np-pill ${M===z.key?"np-pill-active":""}`,onClick:()=>Y(z.key),children:z.label},z.key))}),M==="per_question"&&d.jsxs("div",{style:{display:"flex",alignItems:"center",gap:12},children:[d.jsx("input",{type:"range",min:30,max:180,step:15,value:Z,onChange:z=>$(Number(z.target.value)),style:{flex:1}}),d.jsxs("span",{style:{fontSize:"0.85rem",fontWeight:600,minWidth:60},children:[Z,"s/Q"]})]}),M==="full_session"&&d.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8},children:[d.jsx("input",{type:"number",min:1,max:180,value:Z,onChange:z=>$(Number(z.target.value)),style:{width:80}}),d.jsx("span",{style:{fontSize:"0.85rem",color:"var(--muted)"},children:"minutes"})]})]}),d.jsxs("div",{className:"np-config-section",children:[d.jsx("h3",{className:"np-config-title",children:" Options"}),d.jsx("div",{style:{display:"flex",flexDirection:"column",gap:12},children:[{label:"Shuffle Questions",value:ne,set:ee},{label:"Shuffle Options",value:se,set:w},{label:"Show Explanation After Wrong",value:C,set:A}].map(z=>d.jsxs("label",{className:"np-toggle-row",children:[d.jsx("span",{children:z.label}),d.jsx("div",{className:`np-toggle ${z.value?"np-toggle-on":""}`,onClick:()=>z.set(!z.value),children:d.jsx("div",{className:"np-toggle-thumb"})})]},z.label))})]}),d.jsxs("div",{style:{display:"flex",gap:12,justifyContent:"flex-end",paddingBottom:32},children:[d.jsx("button",{className:"np-btn np-btn-outline np-btn-md",onClick:()=>s("/practice"),children:"Cancel"}),d.jsx("button",{className:"np-btn np-btn-primary np-btn-lg",onClick:U,disabled:G||xe===0||Me<1,style:{minWidth:200},children:G?"Starting...":`Start Test  ${Math.min(Me,xe)} Q`})]})]})}function aP(){const s=ln(),{user:e}=pn(),t=gh(),i=N.useRef(null),[a,l]=N.useState(!1),[c,f]=N.useState(!1),[p,y]=N.useState(!1),[v,b]=N.useState(null),[x,k]=N.useState(new Set),[O,D]=N.useState(new Set),[M,Y]=N.useState(!1),[Z,$]=N.useState(0),ne=t.questions[t.currentIndex],ee=t.currentIndex>=t.questions.length-1;if(N.useEffect(()=>{(!t.sessionId||t.questions.length===0)&&s("/test")},[t.sessionId]),N.useEffect(()=>{if(ne){D(ge=>new Set(ge).add(ne.id));const re=t.answers[ne.id];b(re?.userAnswer||null)}},[t.currentIndex,ne?.id]),N.useEffect(()=>{if(!(t.paused||t.status!=="in_progress"))return i.current=setInterval(()=>{t.config?.timerType!=="none"&&t.tickTimer(),$(re=>re+1)},1e3),()=>clearInterval(i.current)},[t.paused,t.status]),!ne)return null;const w=(t.questionOrder[ne.id]||["A","B","C","D"]).map(re=>ne.options.find(ge=>ge.label===re)).filter(Boolean),C=re=>{const ge=Math.floor(re/3600),Ie=Math.floor(re%3600/60),Ne=re%60;return ge>0?`${ge}:${String(Ie).padStart(2,"0")}:${String(Ne).padStart(2,"0")}`:`${String(Ie).padStart(2,"0")}:${String(Ne).padStart(2,"0")}`},A=re=>{const ge=t.questions[re],Ne=t.answers[ge.id]?.userAnswer!=null,Qe=x.has(ge.id),$e=O.has(ge.id);return re===t.currentIndex?"current":Qe&&Ne?"marked-answered":Qe?"marked":Ne?"answered":$e?"not-answered":"not-visited"},R=t.questions.filter(re=>t.answers[re.id]?.userAnswer!=null).length,j=x.size,L=t.questions.filter(re=>O.has(re.id)&&(!t.answers[re.id]||t.answers[re.id].userAnswer==null)).length,V=t.answers[ne.id]?.flagged||!1,we=re=>{b(re),t.answerQuestion(ne.id,re,ne.correctOption),M&&(ee||setTimeout(()=>t.nextQuestion(),150))},Te=()=>{v&&ne&&t.answerQuestion(ne.id,v,ne.correctOption),ee||t.nextQuestion()},G=()=>{k(re=>new Set(re).add(ne.id)),v&&ne&&t.answerQuestion(ne.id,v,ne.correctOption),ee||t.nextQuestion()},oe=()=>{b(null)},pe=re=>{v&&ne&&!t.answers[ne.id]?.userAnswer&&t.answerQuestion(ne.id,v,ne.correctOption),t.goToQuestion(re)},xe=()=>{t.flagQuestion(ne.id)},Me=async()=>{l(!0),v&&ne&&!t.answers[ne.id]?.userAnswer&&t.answerQuestion(ne.id,v,ne.correctOption),t.questions.forEach(re=>{(!t.answers[re.id]||t.answers[re.id].userAnswer==null)&&t.skipQuestion(re.id)});try{const re=await t.endSession();e?.uid&&re&&(await YA(e.uid,re.questionResults),await D6(e.uid,re)),s(`/test/results?session=${re.sessionId}`)}catch(re){console.error("Failed to end session:",re),l(!1)}},U=async()=>{t.sessionId&&await $A(t.sessionId),t.resetSession(),s("/practice")},z=t.config?.timerType!=="none"?C(t.timeRemaining):C(Z),ue=t.config?.timerType==="per_question"?"Per Question":t.config?.timerType==="full_session"?"Time Left":"Elapsed";return d.jsxs("div",{className:"np-exam-layout",children:[d.jsxs("div",{className:"np-exam-main",children:[d.jsxs("div",{className:"np-exam-topbar",children:[d.jsxs("div",{className:"np-exam-topbar-left",children:[d.jsxs("span",{className:"np-exam-qnum",children:["Q",t.currentIndex+1]}),d.jsxs("span",{className:"np-exam-qcount",children:["of ",t.totalQuestions]}),ne.important&&d.jsx("span",{className:"np-exam-important-badge",children:" Important"}),d.jsxs("span",{className:"np-exam-mobile-timer",children:[" ",z]})]}),d.jsxs("div",{className:"np-exam-topbar-right",children:[d.jsxs("label",{className:"np-exam-autonext",children:[d.jsx("input",{type:"checkbox",checked:M,onChange:re=>Y(re.target.checked)}),d.jsx("span",{children:"Auto Next"})]}),d.jsx("button",{className:`np-exam-action-btn ${V?"np-exam-action-btn-active":""}`,onClick:xe,title:"Flag this question",children:d.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:V?"currentColor":"none",stroke:"currentColor",strokeWidth:"2",children:[d.jsx("path",{d:"M4 15s1-1 4-1 5 2 8 2 4-1 4-1V3s-1 1-4 1-5-2-8-2-4 1-4 1z"}),d.jsx("line",{x1:"4",y1:"22",x2:"4",y2:"15"})]})}),d.jsx("button",{className:"np-exam-action-btn",onClick:()=>{t.pauseSession(),f(!0)},title:"Pause",children:d.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",children:[d.jsx("rect",{x:"6",y:"4",width:"4",height:"16",rx:"1"}),d.jsx("rect",{x:"14",y:"4",width:"4",height:"16",rx:"1"})]})})]})]}),d.jsxs("div",{className:"np-exam-body",children:[d.jsxs("div",{className:"np-exam-breadcrumb",children:[ne.subjectName,ne.chapterName?`  ${ne.chapterName}`:""]}),d.jsx("div",{className:"np-exam-question-text",children:ne.text}),d.jsx("div",{className:"np-exam-options",children:w.map(re=>{const ge=v===re.label;return d.jsxs("div",{className:`np-exam-option ${ge?"np-exam-option-selected":""}`,onClick:()=>we(re.label),children:[d.jsx("div",{className:`np-exam-option-letter ${ge?"np-exam-option-letter-active":""}`,children:re.label}),d.jsx("div",{className:"np-exam-option-text",children:re.text})]},re.label)})})]}),d.jsxs("div",{className:"np-exam-bottom",children:[d.jsxs("div",{className:"np-exam-bottom-left",children:[d.jsx("button",{className:"np-exam-btn np-exam-btn-mark",onClick:G,children:" Mark for Review & Next"}),d.jsx("button",{className:"np-exam-btn np-exam-btn-clear",onClick:oe,children:"Clear Response"})]}),d.jsx("button",{className:"np-exam-btn np-exam-btn-save",onClick:Te,children:ee?"Save":"Save & Next "}),d.jsx("button",{className:"np-exam-mobile-submit",onClick:()=>y(!0),children:"Submit"})]})]}),d.jsxs("div",{className:"np-exam-sidebar",children:[d.jsxs("div",{className:"np-exam-timer",children:[d.jsx("div",{className:"np-exam-timer-label",children:ue}),d.jsx("div",{className:"np-exam-timer-value",children:z})]}),d.jsx("div",{className:"np-exam-palette-header",children:d.jsx("div",{className:"np-exam-palette-title",children:"Question Palette"})}),d.jsxs("div",{className:"np-exam-legend",children:[d.jsxs("div",{className:"np-exam-legend-row",children:[d.jsx("span",{className:"np-exam-legend-dot np-dot-answered"}),d.jsxs("span",{children:["Answered (",R,")"]})]}),d.jsxs("div",{className:"np-exam-legend-row",children:[d.jsx("span",{className:"np-exam-legend-dot np-dot-not-answered"}),d.jsxs("span",{children:["Not Answered (",L,")"]})]}),d.jsxs("div",{className:"np-exam-legend-row",children:[d.jsx("span",{className:"np-exam-legend-dot np-dot-marked"}),d.jsxs("span",{children:["Marked (",j,")"]})]}),d.jsxs("div",{className:"np-exam-legend-row",children:[d.jsx("span",{className:"np-exam-legend-dot np-dot-not-visited"}),d.jsx("span",{children:"Not Visited"})]})]}),d.jsx("div",{className:"np-exam-palette-grid",children:t.questions.map((re,ge)=>{const Ie=A(ge);return d.jsx("button",{className:`np-exam-palette-btn np-pq-${Ie}`,onClick:()=>pe(ge),children:ge+1},re.id)})}),d.jsx("div",{className:"np-exam-sidebar-footer",children:d.jsx("button",{className:"np-exam-submit",onClick:()=>y(!0),children:"Submit Test"})})]}),c&&d.jsx("div",{className:"np-exam-overlay",children:d.jsxs("div",{className:"np-exam-modal",children:[d.jsx("div",{className:"np-exam-modal-icon",children:""}),d.jsx("h3",{className:"np-exam-modal-title",children:"Session Paused"}),d.jsxs("div",{className:"np-exam-modal-stats",children:[d.jsxs("div",{className:"np-exam-modal-stat",children:[d.jsx("span",{className:"np-exam-modal-stat-num",style:{color:"#10B981"},children:R}),d.jsx("span",{className:"np-exam-modal-stat-label",children:"Answered"})]}),d.jsxs("div",{className:"np-exam-modal-stat",children:[d.jsx("span",{className:"np-exam-modal-stat-num",style:{color:"#8B5CF6"},children:j}),d.jsx("span",{className:"np-exam-modal-stat-label",children:"Marked"})]}),d.jsxs("div",{className:"np-exam-modal-stat",children:[d.jsx("span",{className:"np-exam-modal-stat-num",style:{color:"#94A3B8"},children:t.totalQuestions-R}),d.jsx("span",{className:"np-exam-modal-stat-label",children:"Remaining"})]})]}),d.jsxs("div",{className:"np-exam-modal-actions",children:[d.jsx("button",{className:"np-exam-btn np-exam-btn-save",style:{flex:1},onClick:()=>{t.resumeSession(),f(!1)},children:" Resume"}),d.jsx("button",{className:"np-exam-btn np-exam-btn-clear",onClick:U,children:"Quit"})]})]})}),p&&d.jsx("div",{className:"np-exam-overlay",children:d.jsxs("div",{className:"np-exam-modal",children:[d.jsx("div",{className:"np-exam-modal-icon",children:""}),d.jsx("h3",{className:"np-exam-modal-title",children:"Submit Test?"}),d.jsxs("div",{className:"np-exam-modal-summary",children:[d.jsxs("div",{className:"np-exam-modal-summary-row",children:[d.jsx("span",{children:"Answered"}),d.jsx("strong",{style:{color:"#10B981"},children:R})]}),d.jsxs("div",{className:"np-exam-modal-summary-row",children:[d.jsx("span",{children:"Unanswered"}),d.jsx("strong",{style:{color:"#EF4444"},children:t.totalQuestions-R})]}),d.jsxs("div",{className:"np-exam-modal-summary-row",children:[d.jsx("span",{children:"Marked for Review"}),d.jsx("strong",{style:{color:"#8B5CF6"},children:j})]}),d.jsxs("div",{className:"np-exam-modal-summary-row np-exam-modal-summary-row-total",children:[d.jsx("span",{children:"Total"}),d.jsx("strong",{children:t.totalQuestions})]})]}),t.totalQuestions-R>0&&d.jsxs("p",{className:"np-exam-modal-warning",children:[" You have ",t.totalQuestions-R," unanswered question",t.totalQuestions-R>1?"s":"","."]}),d.jsxs("div",{className:"np-exam-modal-actions",children:[d.jsx("button",{className:"np-exam-btn np-exam-btn-clear",style:{flex:1},onClick:()=>y(!1),children:"Go Back"}),d.jsx("button",{className:"np-exam-btn np-exam-btn-save",style:{flex:1},onClick:Me,disabled:a,children:a?"Submitting...":"Confirm Submit"})]})]})})]})}function oP(){const s=ln(),[e]=_1(),t=e.get("session"),i=gh(D=>D.resetSession),[a,l]=N.useState(null),[c,f]=N.useState(!0),[p,y]=N.useState(null);if(N.useEffect(()=>{if(!t){s("/practice");return}(async()=>{const D=await N6(t);l(D),f(!1)})(),i()},[t]),c)return d.jsx("div",{style:{display:"flex",flexDirection:"column",gap:24,maxWidth:760,margin:"0 auto"},children:d.jsxs("div",{className:"np-card-surface",style:{padding:60,textAlign:"center"},children:[d.jsx("div",{className:"np-auth-spinner",style:{width:32,height:32,borderWidth:3,margin:"0 auto"}}),d.jsx("p",{style:{color:"var(--muted)",marginTop:16},children:"Loading results..."})]})});if(!a)return d.jsx("div",{style:{display:"flex",flexDirection:"column",gap:24,maxWidth:760,margin:"0 auto"},children:d.jsx("div",{className:"np-card-surface",children:d.jsxs("div",{className:"np-empty",children:[d.jsx("div",{className:"np-empty-icon",children:""}),d.jsx("div",{className:"np-empty-title",children:"Session not found"}),d.jsx("button",{className:"np-btn np-btn-primary np-btn-md",onClick:()=>s("/practice"),children:"Back to Practice"})]})})});const v=a.score>=70?"#00D9A3":a.score>=40?"#FFB347":"#FF6B6B",b=a.questionResults||[],x=b.reduce((D,M)=>D+(M.timeSpent||0),0),k=b.length>0?Math.round(x/b.length):0;a.answered>0&&Math.round(a.correct/a.answered*100);const O=[{label:"Correct",value:a.correct,color:"#00D9A3",bg:"rgba(0,217,163,0.08)",border:"rgba(0,217,163,0.15)"},{label:"Wrong",value:a.wrong,color:"#FF6B6B",bg:"rgba(255,107,107,0.08)",border:"rgba(255,107,107,0.15)"},{label:"Skipped",value:a.skipped,color:"#FFB347",bg:"rgba(255,179,71,0.08)",border:"rgba(255,179,71,0.15)"},{label:"Avg Time",value:`${k}s`,color:"#6C63FF",bg:"rgba(108,99,255,0.08)",border:"rgba(108,99,255,0.15)"}];return d.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:24,maxWidth:760,margin:"0 auto",paddingBottom:32},children:[d.jsxs("div",{className:"np-card-surface",style:{overflow:"hidden"},children:[d.jsxs("div",{style:{background:`linear-gradient(135deg, ${v}10, ${v}05)`,borderBottom:`1px solid ${v}20`,padding:"36px 24px",textAlign:"center"},children:[d.jsx(b1,{progress:a.score,size:140,strokeWidth:10,children:d.jsxs("div",{style:{textAlign:"center"},children:[d.jsxs("p",{style:{fontFamily:"var(--font-heading)",fontWeight:800,fontSize:"2.2rem",color:v},children:[a.score,"%"]}),d.jsx("p",{style:{fontSize:"0.75rem",color:"var(--muted)"},children:"Score"})]})}),d.jsxs("p",{style:{marginTop:16,fontSize:"0.85rem",color:"var(--text-secondary)"},children:[a.scope?.subjectNames?.join(", ")||"All Subjects","  ",a.totalQuestions," Questions  ",lP(x)]})]}),d.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(4, 1fr)",gap:0},children:O.map(D=>d.jsxs("div",{style:{textAlign:"center",padding:"20px 8px",borderRight:"1px solid var(--border)"},children:[d.jsx("div",{style:{fontSize:"1.4rem",fontWeight:800,color:D.color,fontFamily:"var(--font-heading)"},children:D.value}),d.jsx("div",{style:{fontSize:"0.72rem",color:"var(--muted)",marginTop:4},children:D.label})]},D.label))})]}),d.jsxs("div",{children:[d.jsxs("h3",{style:{fontFamily:"var(--font-heading)",fontWeight:700,fontSize:"1.05rem",marginBottom:16},children:[" Question Review (",b.length,")"]}),d.jsx("div",{style:{display:"flex",flexDirection:"column",gap:8},children:b.map((D,M)=>{const Y=p===M;return d.jsxs("div",{className:"np-result-item",onClick:()=>y(Y?null:M),style:{padding:Y?"16px 20px":"14px 16px"},children:[d.jsxs("div",{style:{display:"flex",alignItems:"center",gap:12},children:[d.jsx("span",{style:{width:30,height:30,borderRadius:"50%",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"0.75rem",fontWeight:700,flexShrink:0,background:D.isCorrect?"rgba(0,217,163,0.15)":D.userAnswer===null?"rgba(255,179,71,0.15)":"rgba(255,107,107,0.15)",color:D.isCorrect?"#00D9A3":D.userAnswer===null?"#FFB347":"#FF6B6B"},children:M+1}),d.jsx("div",{style:{flex:1,minWidth:0},children:d.jsx("p",{style:{fontSize:"0.85rem",lineHeight:1.4,overflow:Y?"visible":"hidden",textOverflow:Y?"unset":"ellipsis",whiteSpace:Y?"normal":"nowrap"},children:D.questionText})}),d.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8,flexShrink:0},children:[d.jsx("span",{style:{padding:"2px 8px",borderRadius:6,fontSize:"0.7rem",fontWeight:600,background:D.isCorrect?"rgba(0,217,163,0.1)":D.userAnswer===null?"rgba(255,179,71,0.1)":"rgba(255,107,107,0.1)",color:D.isCorrect?"#00D9A3":D.userAnswer===null?"#FFB347":"#FF6B6B"},children:D.isCorrect?"Correct":D.userAnswer===null?"Skipped":"Wrong"}),d.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"var(--muted)",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",style:{transition:"transform 0.2s",transform:Y?"rotate(180deg)":"none"},children:d.jsx("polyline",{points:"6 9 12 15 18 9"})})]})]}),Y&&d.jsxs("div",{style:{marginTop:16,paddingTop:16,borderTop:"1px solid var(--border)"},children:[d.jsxs("div",{style:{display:"flex",gap:24,fontSize:"0.82rem",marginBottom:12},children:[d.jsxs("div",{children:[d.jsx("span",{style:{color:"var(--muted)"},children:"Your answer: "}),d.jsxs("strong",{style:{color:D.isCorrect?"#00D9A3":D.userAnswer===null?"#FFB347":"#FF6B6B"},children:[D.userAnswer||"Skipped"," ",D.userAnswerText&&D.userAnswer!==null?`- ${D.userAnswerText}`:""]})]}),!D.isCorrect&&D.userAnswer!==null&&d.jsxs("div",{children:[d.jsx("span",{style:{color:"var(--muted)"},children:"Correct: "}),d.jsxs("strong",{style:{color:"#00D9A3"},children:[D.correctAnswer," ",D.correctAnswerText?`- ${D.correctAnswerText}`:""]})]}),d.jsxs("div",{children:[d.jsx("span",{style:{color:"var(--muted)"},children:"Time: "}),d.jsxs("strong",{children:[D.timeSpent,"s"]})]})]}),D.confidence&&d.jsxs("div",{style:{fontSize:"0.78rem",color:"var(--muted)",marginBottom:4},children:["Confidence: ",D.confidence==="guessed"?" Guessed":D.confidence==="unsure"?" Unsure":" Sure"]})]})]},D.questionId||M)})})]}),d.jsxs("div",{style:{display:"flex",gap:12,justifyContent:"center",paddingTop:8},children:[d.jsx("button",{className:"np-btn np-btn-outline np-btn-md",onClick:()=>s("/practice"),children:" Back to Practice"}),d.jsx("button",{className:"np-btn np-btn-primary np-btn-md",onClick:()=>s(`/test?mode=${a.type}`),children:"Retry this Mode"})]})]})}function lP(s){const e=Math.floor(s/60),t=s%60;return`${e}m ${t}s`}function cP(){const s=ln(),{setError:e,clearError:t,error:i}=pn(),[a,l]=N.useState(!1),[c,f]=N.useState(!1),[p,y]=N.useState(""),[v,b]=N.useState(""),[x,k]=N.useState(""),[O,D]=N.useState(""),[M,Y]=N.useState(!1),[Z,$]=N.useState(!1),ne=w=>({"auth/email-already-in-use":"An account with this email already exists","auth/invalid-email":"Please enter a valid email address","auth/weak-password":"Password should be at least 6 characters","auth/user-not-found":"No account found with this email","auth/wrong-password":"Incorrect password","auth/invalid-credential":"Invalid email or password","auth/too-many-requests":"Too many attempts. Please try again later","auth/network-request-failed":"Network error. Check your connection"})[w]||"Something went wrong. Please try again.",ee=async w=>{if(w.preventDefault(),t(),a&&v!==x){e("Passwords do not match");return}if(a&&!O.trim()){e("Please enter your name");return}Y(!0);try{if(a){const C=await Z4(p,v,O.trim());await s6(C.uid,{displayName:O.trim(),email:C.email,onboardingComplete:!1,examName:"",examDate:"",dailyGoal:50}),s("/onboarding")}else{const C=await e6(p,v),A=await a_(C.uid);A&&A.onboardingComplete?s("/"):s("/onboarding")}}catch(C){e(ne(C.code))}finally{Y(!1)}},se=async w=>{if(w.preventDefault(),t(),!p.trim()){e("Please enter your email address");return}Y(!0);try{await i6(p),$(!0)}catch(C){e(ne(C.code))}finally{Y(!1)}};return c?d.jsx("div",{className:"np-login-container",children:d.jsxs("div",{className:"np-login-card",children:[d.jsx("div",{className:"np-login-logo",children:d.jsx("svg",{width:"32",height:"32",viewBox:"0 0 24 24",fill:"none",stroke:"white",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:d.jsx("polygon",{points:"13 2 3 14 12 14 11 22 21 10 12 10 13 2"})})}),d.jsx("h1",{className:"np-login-title",children:"Reset Password"}),d.jsx("p",{className:"np-login-desc",children:"We'll send you a link to reset your password"}),i&&d.jsx("div",{className:"np-auth-error",children:i}),Z?d.jsxs("div",{className:"np-auth-success",children:[d.jsxs("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[d.jsx("path",{d:"M22 11.08V12a10 10 0 11-5.93-9.14"}),d.jsx("polyline",{points:"22 4 12 14.01 9 11.01"})]}),d.jsx("span",{children:"Reset link sent! Check your email inbox."})]}):d.jsxs("form",{onSubmit:se,className:"np-auth-form",children:[d.jsxs("div",{className:"np-auth-field",children:[d.jsx("label",{htmlFor:"reset-email",children:"Email Address"}),d.jsxs("div",{className:"np-auth-input-wrap",children:[d.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"var(--muted)",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[d.jsx("path",{d:"M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z"}),d.jsx("polyline",{points:"22,6 12,13 2,6"})]}),d.jsx("input",{id:"reset-email",type:"email",placeholder:"you@example.com",value:p,onChange:w=>y(w.target.value),required:!0})]})]}),d.jsxs("button",{type:"submit",className:"np-login-btn",disabled:M,children:[M?d.jsx("span",{className:"np-auth-spinner"}):null,"Send Reset Link"]})]}),d.jsx("button",{className:"np-auth-link",onClick:()=>{f(!1),t(),$(!1)},children:" Back to Sign In"})]})}):d.jsx("div",{className:"np-login-container",children:d.jsxs("div",{className:"np-login-card",children:[d.jsx("div",{className:"np-login-logo",children:d.jsx("svg",{width:"32",height:"32",viewBox:"0 0 24 24",fill:"none",stroke:"white",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:d.jsx("polygon",{points:"13 2 3 14 12 14 11 22 21 10 12 10 13 2"})})}),d.jsx("h1",{className:"np-login-title",children:"NeuralPrep"}),d.jsx("p",{className:"np-login-desc",children:a?"Create your account to get started":"Your personal MCQ practice companion"}),i&&d.jsx("div",{className:"np-auth-error",children:i}),d.jsxs("form",{onSubmit:ee,className:"np-auth-form",children:[a&&d.jsxs("div",{className:"np-auth-field",children:[d.jsx("label",{htmlFor:"display-name",children:"Full Name"}),d.jsxs("div",{className:"np-auth-input-wrap",children:[d.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"var(--muted)",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[d.jsx("path",{d:"M20 21v-2a4 4 0 00-4-4H8a4 4 0 00-4 4v2"}),d.jsx("circle",{cx:"12",cy:"7",r:"4"})]}),d.jsx("input",{id:"display-name",type:"text",placeholder:"John Doe",value:O,onChange:w=>D(w.target.value)})]})]}),d.jsxs("div",{className:"np-auth-field",children:[d.jsx("label",{htmlFor:"email",children:"Email Address"}),d.jsxs("div",{className:"np-auth-input-wrap",children:[d.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"var(--muted)",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[d.jsx("path",{d:"M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z"}),d.jsx("polyline",{points:"22,6 12,13 2,6"})]}),d.jsx("input",{id:"email",type:"email",placeholder:"you@example.com",value:p,onChange:w=>y(w.target.value),required:!0})]})]}),d.jsxs("div",{className:"np-auth-field",children:[d.jsx("label",{htmlFor:"password",children:"Password"}),d.jsxs("div",{className:"np-auth-input-wrap",children:[d.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"var(--muted)",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[d.jsx("rect",{x:"3",y:"11",width:"18",height:"11",rx:"2",ry:"2"}),d.jsx("path",{d:"M7 11V7a5 5 0 0110 0v4"})]}),d.jsx("input",{id:"password",type:"password",placeholder:a?"At least 6 characters":"Enter your password",value:v,onChange:w=>b(w.target.value),required:!0,minLength:6})]})]}),a&&d.jsxs("div",{className:"np-auth-field",children:[d.jsx("label",{htmlFor:"confirm-password",children:"Confirm Password"}),d.jsxs("div",{className:"np-auth-input-wrap",children:[d.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"var(--muted)",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[d.jsx("rect",{x:"3",y:"11",width:"18",height:"11",rx:"2",ry:"2"}),d.jsx("path",{d:"M7 11V7a5 5 0 0110 0v4"})]}),d.jsx("input",{id:"confirm-password",type:"password",placeholder:"Repeat password",value:x,onChange:w=>k(w.target.value),required:!0,minLength:6})]})]}),!a&&d.jsx("div",{style:{textAlign:"right",marginTop:-4},children:d.jsx("button",{type:"button",className:"np-auth-link np-auth-link-sm",onClick:()=>{f(!0),t()},children:"Forgot password?"})}),d.jsxs("button",{type:"submit",className:"np-login-btn",disabled:M,children:[M?d.jsx("span",{className:"np-auth-spinner"}):null,a?"Create Account":"Sign In"]})]}),d.jsxs("div",{className:"np-auth-switch",children:[a?"Already have an account?":"Don't have an account?",d.jsx("button",{className:"np-auth-link",onClick:()=>{l(!a),t()},children:a?"Sign In":"Sign Up"})]}),d.jsx("p",{className:"np-login-footer",children:"Your data is encrypted and stays private."})]})})}const ul=[{icon:"",title:"Organize Your Content",description:"Create Subjects, add Chapters, and load your questions. A clean three-level hierarchy keeps everything organized."},{icon:"",title:"Upload Questions Easily",description:"Bulk import questions via CSV  just format them, upload, and the wizard handles validation, matching, and import."},{icon:"",title:"Practice Smarter",description:"Smart modes prioritize what matters  wrong questions, spaced repetition, and data-driven insights help you master every topic."}];function uP(){const s=ln(),{user:e,setUserProfile:t}=pn(),[i,a]=N.useState(0),[l,c]=N.useState(""),[f,p]=N.useState(""),[y,v]=N.useState(50),[b,x]=N.useState(!1),k=i>=ul.length,O=async()=>{if(e){x(!0);try{const D={examName:l,examDate:f,dailyGoal:y,onboardingComplete:!0};await GA(e.uid,D),t(M=>({...M,...D})),s("/")}catch(D){console.error("Failed to save onboarding:",D)}finally{x(!1)}}};return d.jsx("div",{className:"np-onboarding",children:d.jsx("div",{style:{width:"100%",maxWidth:480},children:k?d.jsxs("div",{style:{animation:"fadeInUp 0.4s ease-out"},children:[d.jsx("h2",{style:{fontFamily:"var(--font-heading)",fontWeight:800,fontSize:"1.75rem",textAlign:"center",marginBottom:28},children:"Set Up Your Goal"}),d.jsx("div",{className:"np-setup-form",children:d.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:20},children:[d.jsxs("div",{children:[d.jsx("label",{children:"Exam Name"}),d.jsx("input",{type:"text",placeholder:"e.g. JEE Main 2026",value:l,onChange:D=>c(D.target.value)})]}),d.jsxs("div",{children:[d.jsx("label",{children:"Exam Date"}),d.jsx("input",{type:"date",value:f,onChange:D=>p(D.target.value)})]}),d.jsxs("div",{children:[d.jsxs("label",{children:["Daily Question Goal: ",d.jsx("span",{style:{color:"var(--primary)",fontWeight:700},children:y})]}),d.jsx("input",{type:"range",min:"10",max:"200",value:y,onChange:D=>v(Number(D.target.value))}),d.jsxs("div",{style:{display:"flex",justifyContent:"space-between",fontSize:"0.75rem",color:"var(--muted)",marginTop:4},children:[d.jsx("span",{children:"10"}),d.jsx("span",{children:"200"})]})]})]})}),d.jsx("div",{style:{textAlign:"center",marginTop:28},children:d.jsx("button",{className:"np-btn np-btn-primary np-btn-lg",onClick:O,disabled:b,children:b?"Saving...":"Start Practicing "})})]}):d.jsxs("div",{className:"np-onboarding-slide",children:[d.jsx("div",{className:"np-onboarding-icon",children:ul[i].icon}),d.jsx("h2",{className:"np-onboarding-title",children:ul[i].title}),d.jsx("p",{className:"np-onboarding-desc",children:ul[i].description}),d.jsx("div",{className:"np-onboarding-dots",children:ul.map((D,M)=>d.jsx("div",{className:`np-onboarding-dot ${M===i?"np-onboarding-dot-active":"np-onboarding-dot-inactive"}`},M))}),d.jsx("button",{className:"np-btn np-btn-primary np-btn-lg",onClick:()=>a(D=>D+1),children:i===ul.length-1?"Let's Set Up":"Next"})]},i)})})}const hP=[{key:"active",label:"Active",icon:""},{key:"graduated",label:"Graduated",icon:""}];function dP(){const s=ln(),{user:e}=pn(),t=Zs(),{subjects:i,fetchSubjects:a,fetchPerformance:l,performanceMap:c}=t,[f,p]=N.useState([]),[y,v]=N.useState(!0),[b,x]=N.useState("active"),[k,O]=N.useState(null);N.useEffect(()=>{e?.uid&&(async()=>{v(!0);try{i.length===0&&await a(e.uid),await l(e.uid)}catch(ee){console.error("Failed to load wrong questions:",ee)}finally{v(!1)}})()},[e?.uid]),N.useEffect(()=>{!e?.uid||i.length===0||(async()=>{const ee={subjectIds:["all"]},se=await ph(e.uid,ee,t);p(se)})()},[e?.uid,i,t.chapters,t.questions]);const{subjectGroups:D,totalWrong:M,totalGraduated:Y,overallStats:Z}=N.useMemo(()=>{const ee={};let se=0,w=0,C=0,A=0;f.forEach(j=>{const L=c[j.id];if(!L||L.timesWrong===0)return;const V=(L.masteryLevel||0)>=4;V?w++:se++,C+=L.timesCorrect||0,A+=L.timesAsked||0;const we=j.subjectId;ee[we]||(ee[we]={subjectId:we,subjectName:j.subjectName,subjectColor:j.subjectColor,subjectIcon:i.find(G=>G.id===we)?.icon||"",questions:[],chapters:{}}),ee[we].questions.push({...j,perf:L,isGraduated:V});const Te=j.chapterId;ee[we].chapters[Te]||(ee[we].chapters[Te]={chapterId:Te,chapterName:j.chapterName,questions:[]}),ee[we].chapters[Te].questions.push({...j,perf:L,isGraduated:V})}),Object.values(ee).forEach(j=>{const L=j.questions.filter(G=>!G.isGraduated),V=j.questions.filter(G=>G.isGraduated),we=j.questions.reduce((G,oe)=>G+(oe.perf.timesCorrect||0),0),Te=j.questions.reduce((G,oe)=>G+(oe.perf.timesAsked||0),0);j.stats={activeCount:L.length,graduatedCount:V.length,totalCount:j.questions.length,accuracy:Te>0?Math.round(we/Te*100):0,staleCount:L.filter(G=>QA(G.perf.lastAsked)).length,masteryDistribution:[0,1,2,3,4].map(G=>j.questions.filter(oe=>(oe.perf.masteryLevel||0)===G).length)}});const R={accuracy:A>0?Math.round(C/A*100):0};return{subjectGroups:Object.values(ee).sort((j,L)=>L.stats.activeCount-j.stats.activeCount),totalWrong:se,totalGraduated:w,overallStats:R}},[f,c,i]);if(y)return d.jsx("div",{style:{display:"flex",flexDirection:"column",gap:24},children:d.jsxs("div",{className:"np-card-surface",style:{padding:60,textAlign:"center"},children:[d.jsx("div",{className:"np-auth-spinner",style:{width:32,height:32,borderWidth:3,margin:"0 auto"}}),d.jsx("p",{style:{color:"var(--muted)",marginTop:16},children:"Loading wrong questions..."})]})});const $=D.map(ee=>({...ee,filteredQuestions:ee.questions.filter(se=>b==="graduated"?se.isGraduated:!se.isGraduated),filteredChapters:Object.values(ee.chapters).map(se=>({...se,filteredQuestions:se.questions.filter(w=>b==="graduated"?w.isGraduated:!w.isGraduated)})).filter(se=>se.filteredQuestions.length>0)})).filter(ee=>ee.filteredQuestions.length>0),ne=b==="active"?M:Y;return d.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:24},children:[d.jsxs("div",{children:[d.jsx("h2",{className:"np-section-title",children:"Wrong Questions"}),d.jsx("p",{className:"np-section-subtitle",children:"Focus on your mistakes to improve faster"})]}),d.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(140px, 1fr))",gap:12},children:[d.jsx(ef,{label:"Active Wrong",value:M,color:"#FF6B6B",icon:""}),d.jsx(ef,{label:"Graduated",value:Y,color:"#00D9A3",icon:""}),d.jsx(ef,{label:"Subjects",value:D.length,color:"#6C63FF",icon:""}),d.jsx(ef,{label:"Accuracy",value:`${Z.accuracy}%`,color:"#FFB347",icon:""})]}),d.jsx("div",{style:{display:"flex",gap:4,background:"var(--surface-2)",borderRadius:12,padding:4},children:hP.map(ee=>d.jsxs("button",{onClick:()=>x(ee.key),style:{flex:1,padding:"10px 16px",borderRadius:10,border:"none",background:b===ee.key?"var(--surface)":"transparent",color:b===ee.key?"var(--text)":"var(--muted)",fontWeight:600,fontSize:"0.85rem",cursor:"pointer",transition:"all 0.2s ease",boxShadow:b===ee.key?"0 2px 8px rgba(0,0,0,0.15)":"none"},children:[ee.icon," ",ee.label," (",ee.key==="active"?M:Y,")"]},ee.key))}),ne===0?d.jsx("div",{className:"np-card-surface",children:d.jsxs("div",{className:"np-empty",children:[d.jsx("div",{className:"np-empty-icon",children:b==="active"?"":""}),d.jsx("div",{className:"np-empty-title",children:b==="active"?"No wrong questions!":"No graduated questions yet"}),d.jsx("div",{className:"np-empty-desc",children:b==="active"?"Great job! Complete practice sessions to track your mistakes here.":"Questions graduate when they reach Mastery Level 4. Keep practicing!"})]})}):d.jsx("div",{style:{display:"flex",flexDirection:"column",gap:16},children:$.map(ee=>d.jsx(fP,{group:ee,activeTab:b,expanded:k===ee.subjectId,onToggle:()=>O(k===ee.subjectId?null:ee.subjectId),onPractice:()=>s(`/test?mode=wrong&subject=${ee.subjectId}`),masteryColors:x6},ee.subjectId))})]})}function ef({label:s,value:e,color:t,icon:i}){return d.jsxs("div",{className:"np-card-surface",style:{padding:"16px 20px",textAlign:"center"},children:[d.jsx("div",{style:{fontSize:"1.5rem",marginBottom:4},children:i}),d.jsx("div",{style:{fontSize:"1.5rem",fontWeight:800,color:t,fontFamily:"var(--font-heading)"},children:e}),d.jsx("div",{style:{fontSize:"0.72rem",color:"var(--muted)",marginTop:2},children:s})]})}function fP({group:s,activeTab:e,expanded:t,onToggle:i,onPractice:a,masteryColors:l}){const c=s.filteredQuestions;return d.jsxs("div",{className:"np-card-surface",style:{overflow:"hidden"},children:[d.jsxs("div",{onClick:i,style:{display:"flex",alignItems:"center",justifyContent:"space-between",padding:"16px 20px",cursor:"pointer",borderBottom:t?"1px solid var(--border)":"none"},children:[d.jsxs("div",{style:{display:"flex",alignItems:"center",gap:14},children:[d.jsx("div",{style:{width:42,height:42,borderRadius:12,display:"flex",alignItems:"center",justifyContent:"center",fontSize:"1.3rem",background:`${s.subjectColor}15`},children:s.subjectIcon}),d.jsxs("div",{children:[d.jsx("div",{style:{fontFamily:"var(--font-heading)",fontWeight:700,fontSize:"0.95rem",marginBottom:4},children:s.subjectName}),d.jsxs("div",{style:{display:"flex",gap:12,fontSize:"0.75rem",color:"var(--muted)"},children:[d.jsxs("span",{children:[c.length," question",c.length!==1?"s":""]}),d.jsxs("span",{children:["Accuracy: ",d.jsxs("strong",{style:{color:s.stats.accuracy>=60?"#00D9A3":"#FF6B6B"},children:[s.stats.accuracy,"%"]})]}),s.stats.staleCount>0&&e==="active"&&d.jsxs("span",{style:{color:"#FFB347"},children:[" ",s.stats.staleCount," stale"]})]})]})]}),d.jsxs("div",{style:{display:"flex",alignItems:"center",gap:10},children:[e==="active"&&d.jsxs("button",{className:"np-btn np-btn-primary np-btn-sm",onClick:f=>{f.stopPropagation(),a()},style:{fontSize:"0.75rem"},children:["Practice (",c.length,")"]}),d.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"var(--muted)",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",style:{transition:"transform 0.2s",transform:t?"rotate(180deg)":"none"},children:d.jsx("polyline",{points:"6 9 12 15 18 9"})})]})]}),t&&d.jsxs("div",{style:{padding:"12px 20px",borderBottom:"1px solid var(--border)"},children:[d.jsx("div",{style:{fontSize:"0.72rem",color:"var(--muted)",marginBottom:6},children:"Mastery Distribution"}),d.jsx("div",{style:{display:"flex",height:6,borderRadius:3,overflow:"hidden",background:"var(--surface-2)"},children:s.stats.masteryDistribution.map((f,p)=>{const y=s.stats.totalCount>0?f/s.stats.totalCount*100:0;return y===0?null:d.jsx("div",{style:{width:`${y}%`,background:l?.[p]||["#64748B","#FF6B6B","#FFB347","#6C63FF","#00D9A3"][p],transition:"width 0.3s ease"},title:`Level ${p}: ${f}`},p)})}),d.jsx("div",{style:{display:"flex",gap:12,marginTop:8,flexWrap:"wrap"},children:s.stats.masteryDistribution.map((f,p)=>{if(f===0)return null;const y=l?.[p]||["#64748B","#FF6B6B","#FFB347","#6C63FF","#00D9A3"][p];return d.jsxs("div",{style:{display:"flex",alignItems:"center",gap:4,fontSize:"0.68rem"},children:[d.jsx("span",{style:{width:6,height:6,borderRadius:"50%",background:y,display:"inline-block"}}),d.jsxs("span",{style:{color:"var(--muted)"},children:["L",p,": ",f]})]},p)})})]}),t&&d.jsx("div",{style:{padding:"0 0 8px"},children:s.filteredChapters.map(f=>d.jsxs("div",{children:[d.jsxs("div",{style:{padding:"10px 20px",fontSize:"0.78rem",fontWeight:600,color:"var(--text-secondary)",background:"var(--surface-2)",borderBottom:"1px solid var(--border)"},children:[f.chapterName," (",f.filteredQuestions.length,")"]}),f.filteredQuestions.map(p=>d.jsx(mP,{question:p,masteryColors:l},p.id))]},f.chapterId))})]})}function mP({question:s,masteryColors:e}){const{perf:t,isGraduated:i}=s,a=t.timesAsked>0?Math.round(t.timesCorrect/t.timesAsked*100):0,l=QA(t.lastAsked),c=C6(t.lastAsked),f=t.masteryLevel||0,p=e?.[f]||["#64748B","#FF6B6B","#FFB347","#6C63FF","#00D9A3"][f];return d.jsxs("div",{style:{padding:"12px 20px",borderBottom:"1px solid var(--border)",display:"flex",alignItems:"center",justifyContent:"space-between",gap:12,opacity:i?.7:1},children:[d.jsx("div",{style:{flex:1,minWidth:0},children:d.jsx("p",{style:{fontSize:"0.82rem",lineHeight:1.4,whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},children:s.text})}),d.jsxs("div",{style:{display:"flex",alignItems:"center",gap:10,flexShrink:0,fontSize:"0.72rem"},children:[l&&d.jsxs("span",{style:{padding:"2px 6px",borderRadius:6,fontSize:"0.65rem",fontWeight:600,background:"rgba(255,179,71,0.12)",color:"#FFB347"},children:[" ",c,"d"]}),d.jsxs("span",{style:{color:"var(--muted)"},children:["W:",d.jsx("strong",{style:{color:"#FF6B6B"},children:t.timesWrong})]}),d.jsxs("span",{style:{color:"var(--muted)"},children:["C:",d.jsx("strong",{style:{color:"#00D9A3"},children:t.timesCorrect})]}),d.jsxs("span",{style:{color:"var(--muted)"},children:[a,"%"]}),d.jsxs("span",{style:{padding:"2px 8px",borderRadius:6,fontSize:"0.65rem",fontWeight:600,background:`${p}18`,color:p},children:[i?"":""," L",f]})]})]})}function pP(){const s=ln(),{user:e}=pn(),t=Zs(),i=gh(v=>v.initSession),{subjects:a}=t,[l,c]=N.useState("all"),[f,p]=N.useState(!1);N.useEffect(()=>{e?.uid&&a.length===0&&t.fetchSubjects(e.uid)},[e?.uid]);const y=async()=>{if(e?.uid){p(!0);try{const v={subjectIds:[l],chapterIds:["all"]},b=await ph(e.uid,v,t),x=qs(b).slice(0,30);if(x.length===0){p(!1);return}const k={subjectIds:[l],chapterIds:["all"],subjectNames:[l==="all"?"All Subjects":a.find(M=>M.id===l)?.name||"Rapid Fire"]},O={totalQuestions:x.length,timerType:"per_question",timerValue:15,shuffled:!0,optionsShuffled:!1,showExplanation:!1},D=await o_(e.uid,{type:"rapid_fire",scope:k,config:O,questionIds:x.map(M=>M.id),totalQuestions:x.length});i({sessionId:D,type:"rapid_fire",scope:k,config:O,questions:x,questionOrder:{}}),s("/test/session")}catch(v){console.error(v)}finally{p(!1)}}};return d.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:24},children:[d.jsxs("div",{children:[d.jsx("h2",{className:"np-section-title",children:" Rapid Fire"}),d.jsx("p",{className:"np-section-subtitle",children:"Speed drill  15 seconds per question, no going back"})]}),d.jsxs("div",{className:"np-config-section",children:[d.jsx("h3",{className:"np-config-title",children:" Select Scope"}),d.jsxs("div",{style:{display:"flex",flexWrap:"wrap",gap:8},children:[d.jsx("button",{className:`np-pill ${l==="all"?"np-pill-active":""}`,onClick:()=>c("all"),children:"All Subjects"}),a.map(v=>d.jsxs("button",{className:`np-pill ${l===v.id?"np-pill-active":""}`,onClick:()=>c(v.id),children:[v.icon," ",v.name]},v.id))]})]}),d.jsxs("div",{className:"np-card-surface",style:{padding:"24px",textAlign:"center"},children:[d.jsx("div",{style:{fontSize:"3rem",marginBottom:12},children:""}),d.jsx("h3",{style:{fontFamily:"var(--font-heading)",fontWeight:700,marginBottom:8},children:"How it works"}),d.jsxs("ul",{style:{fontSize:"0.85rem",color:"var(--text-secondary)",lineHeight:1.8,listStyle:"none",padding:0},children:[d.jsx("li",{children:"15 seconds per question  auto-skips when time runs out"}),d.jsx("li",{children:"Uses the same exam interface for answering"}),d.jsx("li",{children:"Up to 30 questions per round"})]})]}),d.jsx("button",{className:"np-btn np-btn-primary np-btn-lg",onClick:y,disabled:f,style:{alignSelf:"center",minWidth:200},children:f?"Loading...":" Start Rapid Fire"})]})}function gP(){return d.jsx(p6,{children:d.jsxs(fR,{basename:"/quiz/",children:[d.jsx(AR,{}),d.jsxs(FC,{children:[d.jsx(hn,{path:"/login",element:d.jsx(cP,{})}),d.jsx(hn,{path:"/onboarding",element:d.jsx(Jg,{children:d.jsx(uP,{})})}),d.jsx(hn,{path:"/test/session",element:d.jsx(Jg,{children:d.jsx(aP,{})})}),d.jsxs(hn,{element:d.jsx(Jg,{children:d.jsx(E6,{})}),children:[d.jsx(hn,{path:"/",element:d.jsx(M6,{})}),d.jsx(hn,{path:"/practice",element:d.jsx(Q6,{})}),d.jsx(hn,{path:"/subjects",element:d.jsx(K6,{})}),d.jsx(hn,{path:"/subjects/:subjectId",element:d.jsx(W6,{})}),d.jsx(hn,{path:"/wrong-questions",element:d.jsx(dP,{})}),d.jsx(hn,{path:"/flashcards",element:d.jsx(tP,{})}),d.jsx(hn,{path:"/analytics",element:d.jsx(Y6,{})}),d.jsx(hn,{path:"/settings",element:d.jsx(nP,{})}),d.jsx(hn,{path:"/test",element:d.jsx(rP,{})}),d.jsx(hn,{path:"/test/results",element:d.jsx(oP,{})}),d.jsx(hn,{path:"/rapid-fire",element:d.jsx(pP,{})})]})]})]})})}z2.createRoot(document.getElementById("root")).render(d.jsx(N.StrictMode,{children:d.jsx(gP,{})}));
